const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-XNFtkdrW.js","assets/vendor-eVk5PToZ.js","assets/router-BKj_Buqz.js","assets/ui-GLcuv0J2.js"])))=>i.map(i=>d[i]);
import{r as e,a as t,g as s}from"./vendor-eVk5PToZ.js";import{L as r,u as a,r as n,a as i,R as l,b as o,N as d,O as c,c as u,d as m,B as h}from"./router-BKj_Buqz.js";import{P as x,r as g,R as f,B as p,C as b,X as y,Y as v,T as j,L as N,a as w,b as S,c as k,d as C,e as $,f as _}from"./ui-GLcuv0J2.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var A,P,L={exports:{}},E={};var T,I=(P||(P=1,L.exports=function(){if(A)return E;A=1;var t=e(),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,n=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var l,o={},d=null,c=null;for(l in void 0!==r&&(d=""+r),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,l)&&!i.hasOwnProperty(l)&&(o[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps)void 0===o[l]&&(o[l]=t[l]);return{$$typeof:s,type:e,key:d,ref:c,props:o,_owner:n.current}}return E.Fragment=r,E.jsx=l,E.jsxs=l,E}()),L.exports),O={};var F=function(){if(T)return O;T=1;var e=t();return O.createRoot=e.createRoot,O.hydrateRoot=e.hydrateRoot,O}();function R(){return I.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center px-4",children:I.jsxs("div",{className:"max-w-2xl w-full text-center",children:[I.jsxs("div",{className:"relative mb-8",children:[I.jsx("h1",{className:"text-9xl md:text-[12rem] font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 animate-pulse",children:"404"}),I.jsx("div",{className:"absolute inset-0 text-9xl md:text-[12rem] font-bold text-gray-200 -z-10 blur-sm",children:"404"})]}),I.jsxs("div",{className:"space-y-6",children:[I.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-4",children:"Oops! Page Not Found"}),I.jsx("p",{className:"text-lg md:text-xl text-gray-600 leading-relaxed",children:"The page you're looking for seems to have vanished into the digital void. Don't worry, even the best explorers sometimes take a wrong turn!"}),I.jsxs("div",{className:"flex justify-center space-x-2 my-8",children:[I.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce"}),I.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),I.jsx("div",{className:"w-3 h-3 bg-indigo-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[I.jsx(r,{to:"/",className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-lg hover:from-blue-700 hover:to-indigo-700 transform hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl",children:"🏠 Go Home"}),I.jsx("button",{onClick:()=>window.history.back(),className:"px-8 py-3 bg-white text-gray-700 font-semibold rounded-lg border-2 border-gray-300 hover:border-gray-400 hover:bg-gray-50 transform hover:scale-105 transition-all duration-200 shadow-md hover:shadow-lg",children:"← Go Back"})]}),I.jsxs("div",{className:"mt-12 p-6 bg-white/50 backdrop-blur-sm rounded-xl border border-gray-200",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"What can you do?"}),I.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[I.jsx("li",{children:"• Check the URL for typos"}),I.jsx("li",{children:"• Use the navigation menu to find what you need"}),I.jsx("li",{children:"• Contact support if you believe this is an error"})]})]})]})]})})}function D(){const e=e=>{const t=e.getItem("userInfo");if(t)try{const e=JSON.parse(t),s=e.role||e.userType||"user";if(e.token&&"string"==typeof e.token&&e.token.length>10)return{isAuthenticated:!0,userData:{...e,userType:s},userType:s}}catch(Nh){}const s=e.getItem("user");if(s)try{const t=JSON.parse(s),r=e.getItem("token")||e.getItem("userToken");if(r)return{isAuthenticated:!0,userData:{...t,userType:"user",token:r},userType:"user"}}catch(Nh){}const r=e.getItem("admin");if(r)try{const t=JSON.parse(r),s=e.getItem("adminToken");if(s)return{isAuthenticated:!0,userData:{...t,userType:"admin",token:s},userType:"admin"}}catch(Nh){}const a=e.getItem("staff");if(a)try{const t=JSON.parse(a),s=e.getItem("staffToken")||e.getItem("token");if(s)return{isAuthenticated:!0,userData:{...t,userType:"staff",token:s},userType:"staff"}}catch(Nh){}return null},t=e(localStorage);if(t)return t;const s=e(sessionStorage);return s||{isAuthenticated:!1,userData:null,userType:null}}function M(){localStorage.removeItem("userInfo"),sessionStorage.removeItem("userInfo"),localStorage.removeItem("user"),localStorage.removeItem("admin"),localStorage.removeItem("staff"),sessionStorage.removeItem("user"),sessionStorage.removeItem("admin"),sessionStorage.removeItem("staff"),window.dispatchEvent(new Event("authStateChanged"))}function B(e){const t=D();if(!t.isAuthenticated||!t.userType)return;const s=t.userType,r=sessionStorage;r.setItem(s,JSON.stringify(e)),r.setItem("userInfo",JSON.stringify({...e,role:e.userType||"user"})),window.dispatchEvent(new Event("authStateChanged"))}const U="/api",q=()=>{const e=localStorage.getItem("userInfo");if(e)try{const t=JSON.parse(e);if(t.token&&"string"==typeof t.token&&t.token.length>10)return t.token}catch(Nh){}const t=sessionStorage.getItem("userInfo");if(t)try{const e=JSON.parse(t);if(e.token&&"string"==typeof e.token&&e.token.length>10)return e.token}catch(Nh){}const s=localStorage.getItem("adminToken");if(s&&s.length>10)return s;const r=localStorage.getItem("token")||localStorage.getItem("userToken");return r&&r.length>10?r:null},z=()=>{localStorage.removeItem("userInfo"),sessionStorage.removeItem("userInfo"),localStorage.removeItem("adminToken"),window.dispatchEvent(new Event("authStateChanged"))},W=async(e,t,s={})=>{const r=`${U}${e}`,a={},n=q();n&&(a.Authorization=`Bearer ${n}`);const i={method:"POST",body:t,headers:a,...s};try{const t=await fetch(r,i);if(401===t.status||403===t.status&&!e.includes("/routing/")){let e;try{e=await t.json()}catch{e={message:"Authentication failed"}}throw z(),new Error(e.message||"Authentication failed. Please log in again.")}if(!t.ok){let e,s=`HTTP error! status: ${t.status}`;try{e=await t.json(),e.message?s=e.message:e.error&&(s=e.error)}catch(l){s=t.statusText||s}throw new Error(s)}return await t.json()}catch(o){if(o instanceof Error){if(o.message.includes("Authentication")||o.message.includes("token"))throw new Error(`Authentication error: ${o.message}`);throw o}throw new Error(`Unknown error occurred: ${String(o)}`)}},V=async(e,t={})=>{const s=`${U}${e}`,r={headers:(()=>{const e={"Content-Type":"application/json"},t=q();return t&&(e.Authorization=`Bearer ${t}`),e})(),...t};e.includes("/auth/login/");try{const t=await fetch(s,r);if(401===t.status||403===t.status&&!e.includes("/routing/")){let s;e.includes("/auth/login/");try{s=await t.json()}catch{s={message:"Authentication failed"}}if(!e.includes("/auth/login/"))throw z(),new Error(s.message||"Authentication failed. Please log in again.")}if(!t.ok){if(e.includes("/auth/login/")&&401===t.status){let e;try{e=await t.json()}catch{e={success:!1,message:"Authentication failed"}}return e}let s,r=`HTTP error! status: ${t.status}`;try{s=await t.json(),s.message?r=s.message:s.error&&(r=s.error)}catch(a){r=t.statusText||r}throw new Error(r)}const n=await t.json();return e.includes("/auth/login/"),n}catch(n){if(e.includes("/auth/login/"),n instanceof Error){if(n.message.includes("Authentication")||n.message.includes("token"))throw new Error(`Authentication error: ${n.message}`);throw n}throw new Error(`Unknown error occurred: ${String(n)}`)}},H=async(e,t,s)=>V("/admin/auth/register",{method:"POST",body:JSON.stringify({name:e,email:t,password:s})}),G=async(e,t)=>V("/admin/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})}),J=async()=>V("/admin/auth/logout",{method:"POST"}),K=async()=>V("/admin/auth/profile"),Y=async e=>V("/admin/auth/profile",{method:"PUT",body:JSON.stringify(e)}),Z=async(e,t)=>V("/admin/auth/change-password",{method:"POST",body:JSON.stringify({currentPassword:e,newPassword:t})}),X=async()=>V("/auth/logout/user",{method:"POST"}),Q=async()=>V("/auth/logout/staff",{method:"POST"}),ee=async()=>V("/admin/dashboard/stats"),te=async()=>V("/admin/dashboard/overview"),se=async()=>V("/admin/dashboard/analytics"),re=async()=>V("/admin/dashboard/location-incidents"),ae=async()=>V("/admin/dashboard/seasonal-patterns"),ne=async(e="months",t=12)=>V(`/admin/dashboard/monthly-trends?period=${e}&limit=${t}`),ie=async(e={})=>{const t=new URLSearchParams(Object.entries(e).reduce((e,[t,s])=>(null!=s&&""!==s&&(e[t]=String(s)),e),{})).toString();return V(`/users?${t}`)},le=async(e,t,s)=>{const r={status:t};return void 0!==s&&(r.created_by=s),V(`/users/${e}/status`,{method:"PUT",body:JSON.stringify(r)})},oe=async e=>V(`/users/${e}`,{method:"DELETE"}),de=async(e={})=>{const t=new URLSearchParams(Object.entries(e).reduce((e,[t,s])=>(null!=s&&""!==s&&(e[t]=String(s)),e),{})).toString();return V(`/staff?${t}`)},ce=async e=>V(`/staff/${e}`),ue=async(e,t)=>V(`/staff/${e}`,{method:"PUT",body:JSON.stringify(t)}),me=async(e,t)=>V(`/staff/${e}/availability`,{method:"PUT",body:JSON.stringify({availability:t})}),he=async(e={})=>{const t=new URLSearchParams(Object.entries(e).reduce((e,[t,s])=>(null!=s&&""!==s&&(e[t]=String(s)),e),{})).toString();return V(`/activity-logs?${t}`)},xe=async()=>V("/activity-logs/stats"),ge=async()=>V("/alerts"),fe=async e=>V("/alerts",{method:"POST",body:JSON.stringify(e)}),pe=async(e,t)=>V(`/alerts/${e}`,{method:"PUT",body:JSON.stringify(t)}),be=async e=>V(`/alerts/${e}/send`,{method:"POST"}),ye=async e=>V(`/alerts/${e}`,{method:"DELETE"}),ve=async e=>V(e?`/evacuation-routes?center_id=${e}`:"/evacuation-routes"),je=async e=>V("/evacuation-routes",{method:"POST",body:JSON.stringify(e)}),Ne=async(e,t)=>V(`/evacuation-routes/${e}`,{method:"PUT",body:JSON.stringify(t)}),we=async e=>V(`/evacuation-routes/${e}`,{method:"DELETE"}),Se=async()=>V("/evacuation-centers"),ke=async e=>V("/evacuation-centers",{method:"POST",body:JSON.stringify(e)}),Ce=async(e,t)=>V(`/evacuation-centers/${e}`,{method:"PUT",body:JSON.stringify(t)}),$e=async e=>V(`/evacuation-centers/${e}`,{method:"DELETE"}),_e=async e=>V(`/evacuation-centers/${e}/resources`),Ae=async(e,t)=>V(`/evacuation-centers/${e}/resources`,{method:"POST",body:JSON.stringify(t)}),Pe=async(e,t,s)=>V(`/evacuation-centers/${e}/resources/${t}`,{method:"PUT",body:JSON.stringify(s)}),Le=async(e,t)=>V(`/evacuation-centers/${e}/resources/${t}`,{method:"DELETE"}),Ee=async(e,t,s)=>{const r=new FormData;return r.append("picture",s),W(`/evacuation-centers/${e}/resources/${t}/picture`,r)},Te=async()=>V("/teams"),Ie=async e=>V(`/teams/${e}`),Oe=async()=>V("/incidents"),Fe=async e=>V(`/incidents/staff/${e}`),Re=async e=>V(`/incidents/${e}`),De=async(e,t)=>V(`/incidents/${e}/validate`,{method:"PUT",body:JSON.stringify(t)}),Me=async(e,t)=>V(`/incidents/${e}/assign-team`,{method:"PUT",body:JSON.stringify({teamId:t})}),Be=async(e,t)=>V(`/incidents/${e}/assign-teams`,{method:"PUT",body:JSON.stringify({teamIds:t})}),Ue=async(e,t)=>V(`/incidents/${e}/assign-staff`,{method:"PUT",body:JSON.stringify({staffId:t})}),qe=async(e,t)=>V(`/incidents/${e}/update-status`,{method:"PUT",body:JSON.stringify(t)}),ze=async()=>V("/profile/me"),We=async e=>V("/profile/update",{method:"PUT",body:JSON.stringify(e)}),Ve=async(e,t)=>V("/profile/change-password",{method:"POST",body:JSON.stringify({currentPassword:e,newPassword:t})}),He=async e=>{const t=new FormData;return t.append("profilePicture",e),W("/profile/upload-picture",t)},Ge=async()=>V("/profile/delete-picture",{method:"DELETE"}),Je=async e=>V("/feedback/submit",{method:"POST",body:JSON.stringify(e)}),Ke=async(e={})=>{const t=new URLSearchParams(Object.entries(e).reduce((e,[t,s])=>(null!=s&&""!==s&&(e[t]=String(s)),e),{})).toString();return V(`/feedback?${t}`)},Ye=async()=>V("/public/stats"),Ze=async e=>V(`/public/testimonials${e?`?limit=${e}`:""}`),Xe=async()=>V("/safety-protocols/public"),Qe=async e=>{const t=new FormData;return t.append("attachment",e),W("/safety-protocols/upload",t)},et=async e=>V("/safety-protocols",{method:"POST",body:JSON.stringify(e)}),tt=async(e,t)=>V(`/safety-protocols/${e}`,{method:"PUT",body:JSON.stringify(t)}),st=async e=>V(`/safety-protocols/${e}`,{method:"DELETE"}),rt=async()=>V("/staff/dashboard/stats"),at=async(e,t)=>{const s=new URLSearchParams;e&&s.append("limit",e.toString()),t&&s.append("offset",t.toString());const r=s.toString();return V("/notifications"+(r?`?${r}`:""))},nt=async e=>V(`/notifications/${e}/read`,{method:"PUT"}),it=async()=>V("/notifications/read-all",{method:"PUT"});function lt({children:e,variant:t="primary",size:s="md",fullWidth:r=!1,disabled:a=!1,onClick:n,type:i="button",className:l=""}){const o=r?"w-full":"";return I.jsx("button",{type:i,onClick:n,disabled:a,className:`whitespace-nowrap cursor-pointer font-medium rounded-lg transition-all duration-200 flex items-center justify-center gap-2 focus:ring-4 focus:outline-none ${{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-100 disabled:bg-gray-300",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-100 disabled:bg-gray-300",outline:"border-2 border-blue-600 text-blue-600 hover:bg-blue-50 focus:ring-blue-100 disabled:border-gray-300 disabled:text-gray-400",ghost:"text-blue-600 hover:bg-blue-50 focus:ring-blue-100 disabled:text-gray-400"}[t]} ${{sm:"px-3 py-2 text-sm",md:"px-4 py-2.5 text-sm",lg:"px-6 py-3 text-base"}[s]} ${o} ${l}`,children:e})}function ot({isOpen:e,onClose:t,onConfirm:s,isLoading:r=!1}){return e?I.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-300",onClick:t}),I.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:I.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md transform transition-all duration-300 scale-100 overflow-hidden",onClick:e=>e.stopPropagation(),children:[I.jsx("div",{className:"bg-gradient-to-r from-red-500 to-pink-600 px-6 py-8 text-center",children:I.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Are You Sure?"})}),I.jsxs("div",{className:"p-6",children:[I.jsx("p",{className:"text-center text-gray-700 mb-6",children:"Are you sure you want to sign out?"}),I.jsxs("div",{className:"flex flex-col gap-3",children:[I.jsx(lt,{variant:"secondary",size:"lg",onClick:s,disabled:r,fullWidth:!0,children:r?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Signing out..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-logout-box-line mr-2"}),"Yes"]})}),I.jsxs(lt,{variant:"outline",size:"lg",onClick:t,disabled:r,fullWidth:!0,children:[I.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Cancel"]})]})]})]})})]}):null}const dt=({isOpen:e,onClose:t,alert:s})=>{if(!e||!s)return null;const r=e=>{switch(e){case"emergency":return"text-red-600 bg-red-50 border-red-200";case"warning":return"text-orange-600 bg-orange-50 border-orange-200";case"info":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}};return I.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:I.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),I.jsxs("div",{className:"relative w-full max-w-md transform overflow-hidden rounded-lg bg-white shadow-xl transition-all",children:[I.jsx("div",{className:`px-6 py-4 border-b ${r(s.severity)}`,children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${r(s.severity)}`,children:I.jsx("i",{className:`${(e=>{switch(e){case"emergency":return"ri-error-warning-fill";case"warning":return"ri-alarm-warning-line";case"info":return"ri-information-line";default:return"ri-notification-line"}})(s.severity)} text-xl`})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:(e=>{switch(e){case"emergency":return"Emergency Alert";case"warning":return"Warning Alert";case"info":return"Information Alert";default:return"Alert"}})(s.severity)}),I.jsx("p",{className:"text-sm text-gray-600",children:s.created_at?new Date(s.created_at).toLocaleString():"Unknown time"})]})]}),I.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:I.jsx("i",{className:"ri-close-line text-xl"})})]})}),I.jsxs("div",{className:"px-6 py-4",children:[I.jsx("h4",{className:"text-xl font-semibold text-gray-900 mb-3",children:s.title||"Alert Notification"}),I.jsx("div",{className:"mb-4",children:I.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-800",children:s.alert_type?s.alert_type.replace("_"," ").toUpperCase():"ALERT"})}),I.jsx("div",{className:"text-gray-700 leading-relaxed",children:s.description||s.message||"No description available"})]}),I.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:I.jsx("div",{className:"flex justify-end",children:I.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Close"})})})]})]})})};function ct({name:e,email:t,profilePicture:s,size:r="md",className:a="",showBadge:n=!1,badgeColor:i="green",badgeIcon:l="ri-check-line",onClick:o}){const d=o?"cursor-pointer hover:shadow-xl transition-shadow duration-200":"",c=(()=>{if(!s)return null;if(s.startsWith("http"))return s;if(s.startsWith("/uploads")){return`${"http://localhost:5000"}${s}`}return s})();return I.jsxs("div",{className:"relative inline-block",children:[I.jsx("div",{className:`bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center shadow-lg text-white font-bold relative overflow-hidden ${{xs:"w-6 h-6 text-xs",sm:"w-8 h-8 text-sm",md:"w-10 h-10 text-base",lg:"w-12 h-12 text-lg",xl:"w-16 h-16 text-xl","2xl":"w-20 h-20 text-2xl"}[r]} ${d} ${a}`,onClick:o,children:c?I.jsx("img",{src:c,alt:e||t||"Profile",className:"w-full h-full object-cover",onError:e=>{e.currentTarget.style.display="none"}}):(()=>{if(e){const t=e.trim().split(" ");return t.length>=2?`${t[0].charAt(0)}${t[1].charAt(0)}`.toUpperCase():t[0].charAt(0).toUpperCase()}return t?t.charAt(0).toUpperCase():"U"})()}),n&&I.jsx("div",{className:`absolute ${{xs:"-bottom-0.5 -right-0.5",sm:"-bottom-0.5 -right-0.5",md:"-bottom-1 -right-1",lg:"-bottom-1 -right-1",xl:"-bottom-2 -right-2","2xl":"-bottom-2 -right-2"}[r]} ${{xs:"w-2 h-2",sm:"w-3 h-3",md:"w-4 h-4",lg:"w-5 h-5",xl:"w-6 h-6","2xl":"w-8 h-8"}[r]} ${{green:"bg-green-500",red:"bg-red-500",yellow:"bg-yellow-500",blue:"bg-blue-500"}[i]} rounded-full border-2 border-white flex items-center justify-center`,children:I.jsx("i",{className:`${l} text-white text-xs`})})]})}const ut=({isAuthenticated:e,userData:t})=>{const s=a(),[r,i]=n.useState(!1),[l,o]=n.useState(!1),[d,c]=n.useState(e||!1),[u,m]=n.useState(t||null),[h,x]=n.useState(null),[g,f]=n.useState(!1),[p,b]=n.useState(!1),[y,v]=n.useState(!1),[j,N]=n.useState(null),[w,S]=n.useState([]),[k,C]=n.useState(!1),[$,_]=n.useState(()=>{const e=localStorage.getItem("readNotifications");return e?new Set(JSON.parse(e)):new Set});n.useEffect(()=>{const e=D(),t=e.isAuthenticated&&"user"===e.userType;c(t),m(t?e.userData:null),x(t?e.userType:null);const s=()=>{const e=D(),t=e.isAuthenticated&&"user"===e.userType;c(t),m(t?e.userData:null),x(t?e.userType:null)};return window.addEventListener("storage",s),window.addEventListener("authStateChanged",s),()=>{window.removeEventListener("storage",s),window.removeEventListener("authStateChanged",s)}},[]),n.useEffect(()=>{localStorage.setItem("readNotifications",JSON.stringify([...$]))},[$]),n.useEffect(()=>{d&&A()},[d]),n.useEffect(()=>{if(!d)return;const e=setInterval(()=>{A()},3e4);return()=>clearInterval(e)},[d]),n.useEffect(()=>{const e=e=>{"Escape"===e.key&&(r&&i(!1),l&&o(!1))},t=e=>{const t=e.target;l&&!t.closest(".profile-dropdown")&&o(!1),k&&!t.closest(".notification-dropdown")&&C(!1)};return r?(document.addEventListener("keydown",e),document.body.style.overflow="hidden"):document.body.style.overflow="unset",(l||k)&&(document.addEventListener("keydown",e),document.addEventListener("click",t)),()=>{document.removeEventListener("keydown",e),document.removeEventListener("click",t),document.body.style.overflow="unset"}},[r,l,k]);const A=async()=>{if(d)try{const e=await at(10,0);if(e.success&&Array.isArray(e.notifications)){S(e.notifications);const t=new Set(e.notifications.map(e=>e.id));_(e=>new Set([...e].filter(e=>t.has(e))))}}catch(e){S([])}},P=async e=>{try{await nt(e),_(t=>new Set([...t,e]))}catch(t){_(t=>new Set([...t,e]))}},L=async()=>{try{await it();const e=w.map(e=>e.id);_(new Set(e))}catch(e){const t=w.map(e=>e.id);_(new Set(t))}},E=w.filter(e=>!$.has(e.id)).length,T=()=>{k||A(),C(!k),o(!1)},O=()=>{C(!1)},F=()=>{i(!1)},R=()=>{o(!1)},B=e=>{if(R(),F(),"/profile"!==window.location.pathname)if(window.location.pathname!==e)try{s(e,{replace:!1})}catch(t){window.location.href=e}else window.location.reload();else window.location.href=e},U=()=>{f(!0),R(),F()};return I.jsxs(I.Fragment,{children:[I.jsx("nav",{className:"bg-white/95 backdrop-blur-sm shadow-lg border-b border-gray-200 sticky top-0 z-50 transition-all duration-200",children:I.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:I.jsxs("div",{className:"flex items-center justify-between h-16",children:[I.jsx("div",{className:"flex items-center min-w-0 flex-shrink-0",children:I.jsx("img",{src:"/images/soterblue.png",alt:"Logo",className:"w-[130px] h-[130px] sm:w-[160px] sm:h-[160px] lg:w-[200px] lg:h-[200px] object-contain flex-shrink-0 cursor-pointer hover:opacity-80 transition-opacity duration-200",onClick:()=>{if("/"===window.location.pathname){const e=document.getElementById("hero-section");e&&e.scrollIntoView({behavior:"smooth"})}else B("/")}})}),I.jsxs("div",{className:"hidden lg:flex items-center space-x-4 xl:space-x-6",children:[I.jsx("button",{onClick:()=>{if("/"===window.location.pathname){const e=document.getElementById("hero-section");e&&e.scrollIntoView({behavior:"smooth"})}else B("/")},className:"text-gray-700 hover:text-blue-600 transition-colors font-medium text-sm xl:text-base whitespace-nowrap",children:"Home"}),I.jsx("button",{onClick:()=>B("/evacuation-center"),className:"text-gray-700 hover:text-blue-600 transition-colors font-medium text-sm xl:text-base whitespace-nowrap",children:"Evacuation Centers"}),I.jsx("button",{onClick:()=>B("/incident-report"),className:"text-gray-700 hover:text-blue-600 transition-colors font-medium text-sm xl:text-base whitespace-nowrap",children:"Report"}),I.jsx("button",{onClick:()=>{if("/"===window.location.pathname){const e=document.getElementById("faq-section");e&&e.scrollIntoView({behavior:"smooth"})}else window.location.href="/#faq-section"},className:"text-gray-700 hover:text-blue-600 transition-colors font-medium text-sm xl:text-base whitespace-nowrap",children:"FAQs"})]}),I.jsx("div",{className:"hidden md:flex items-center space-x-2 lg:space-x-4 min-w-0",children:d?I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"relative notification-dropdown",children:[I.jsxs("button",{onClick:T,className:"relative p-2 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 focus:outline-none",children:[I.jsx("i",{className:"ri-notification-line text-xl"}),E>0&&I.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:E>9?"9+":E})]}),k&&I.jsxs("div",{className:"absolute right-0 mt-2 w-80 sm:w-96 bg-white border border-gray-200 rounded-lg shadow-xl z-50 cursor-pointer",onClick:()=>{O(),B("/notifications")},children:[I.jsx("div",{className:"px-4 py-3 bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-200 rounded-t-lg",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("h3",{className:"font-semibold text-gray-900",children:"Notifications"}),E>0&&I.jsx("button",{onClick:async e=>{e.stopPropagation(),await L()},className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Mark all as read"})]})}),I.jsx("div",{className:"max-h-96 overflow-y-auto",children:0===w.length?I.jsxs("div",{className:"text-center py-8",children:[I.jsx("i",{className:"ri-notification-off-line text-4xl text-gray-300"}),I.jsx("p",{className:"text-gray-500 mt-2",children:"No notifications"})]}):I.jsx("div",{className:"divide-y divide-gray-100",children:w.map(e=>{const t=$.has(e.id)||e.is_read;return I.jsx("div",{onClick:async s=>{s.stopPropagation(),t||await P(e.id),"safety_protocol"===e.type?(O(),B("/safety-protocols")):"alert"===e.type?(O(),N(e),v(!0)):"welfare"===e.type?(O(),B("/welfare-check")):"system"===e.type&&(O(),B("/history-report"))},className:"p-4 hover:bg-gray-50 cursor-pointer transition-colors "+(t?"":"bg-blue-50"),children:I.jsx("div",{className:"flex items-start space-x-3",children:I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),!t&&I.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0"})]}),I.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:e.message}),I.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.created_at).toLocaleString()})]})})},e.id)})})})]})]}),I.jsxs("div",{className:"relative profile-dropdown",children:[I.jsxs("button",{onClick:()=>{o(!l),i(!1)},className:"flex items-center space-x-2 lg:space-x-3 px-2 lg:px-3 py-2 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 font-medium focus:outline-none group min-w-0",children:[I.jsx(ct,{name:u?.firstName&&u?.lastName?`${u.firstName} ${u.lastName}`:u?.first_name&&u?.last_name?`${u.first_name} ${u.last_name}`:void 0,email:u?.email,profilePicture:u?.profile_picture,size:"md",className:"flex-shrink-0"}),I.jsxs("div",{className:"hidden lg:block text-left min-w-0 flex-1",children:[I.jsx("p",{className:"text-sm font-medium text-gray-900 group-hover:text-blue-600 truncate max-w-32",children:(u?.firstName||u?.first_name)&&(u?.lastName||u?.last_name)?`${u.firstName||u.first_name} ${u.lastName||u.last_name}`:u?.email?.split("@")[0]||"User"}),I.jsx("p",{className:"text-xs text-gray-500 truncate max-w-32",title:u?.email||"No email",children:u?.email||"No email"})]}),I.jsx("i",{className:`ri-arrow-down-s-line ml-1 transition-transform duration-200 ${l?"rotate-180":""} group-hover:text-blue-600 flex-shrink-0`})]}),l&&I.jsxs("div",{className:"absolute right-0 mt-2 w-64 sm:w-72 bg-white border border-gray-200 rounded-lg shadow-xl z-50 animate-in fade-in slide-in-from-top-2 duration-200",children:[I.jsx("div",{className:"px-4 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-200 rounded-t-lg",children:I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx(ct,{name:u?.firstName&&u?.lastName?`${u.firstName} ${u.lastName}`:u?.first_name&&u?.last_name?`${u.first_name} ${u.last_name}`:void 0,email:u?.email,profilePicture:u?.profile_picture,size:"lg",className:"flex-shrink-0"}),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsx("p",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:(u?.firstName||u?.first_name)&&(u?.lastName||u?.last_name)?`${u.firstName||u.first_name} ${u.lastName||u.last_name}`:u?.email?.split("@")[0]||"User"}),I.jsx("p",{className:"text-gray-600 text-xs sm:text-sm truncate",title:u?.email||"No email",children:u?.email||"No email provided"})]})]})}),I.jsxs("div",{className:"py-2",children:[I.jsxs("button",{onClick:()=>{B("/profile")},className:"flex items-center w-full text-left px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group",children:[I.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-blue-100 transition-colors",children:I.jsx("i",{className:"ri-user-settings-line text-gray-600 group-hover:text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"font-medium text-sm",children:"Account Settings"}),I.jsx("p",{className:"text-xs text-gray-500",children:"Manage your profile"})]})]}),I.jsxs("button",{onClick:()=>B("/history-report"),className:"flex items-center w-full text-left px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group",children:[I.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-blue-100 transition-colors",children:I.jsx("i",{className:"ri-file-list-line text-gray-600 group-hover:text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"font-medium text-sm",children:"History Report"}),I.jsx("p",{className:"text-xs text-gray-500",children:"View your incident reports"})]})]}),I.jsxs("button",{onClick:()=>B("/feedback"),className:"flex items-center w-full text-left px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group",children:[I.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-blue-100 transition-colors",children:I.jsx("i",{className:"ri-feedback-line text-gray-600 group-hover:text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"font-medium text-sm",children:"Submit Feedback"}),I.jsx("p",{className:"text-xs text-gray-500",children:"Share your thoughts"})]})]}),I.jsx("div",{className:"border-t border-gray-100 my-1"}),I.jsxs("button",{onClick:U,className:"flex items-center w-full text-left px-4 py-3 text-gray-700 hover:bg-red-50 hover:text-red-600 transition-all duration-200 group",children:[I.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-red-100 transition-colors",children:I.jsx("i",{className:"ri-logout-box-line text-gray-600 group-hover:text-red-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"font-medium text-sm",children:"Sign Out"}),I.jsx("p",{className:"text-xs text-gray-500",children:"Logout from your account"})]})]})]})]})]})]}):I.jsxs("div",{className:"flex items-center space-x-2 lg:space-x-4",children:[I.jsx("button",{onClick:()=>B("/auth/login"),className:"text-gray-700 hover:text-blue-600 transition-colors font-medium text-sm lg:text-base whitespace-nowrap",children:"Sign In"}),I.jsxs("button",{onClick:()=>B("/auth/signup"),className:"bg-blue-600 text-white px-3 lg:px-6 py-2 rounded-lg hover:bg-blue-700 transition-all duration-200 font-medium text-sm lg:text-base whitespace-nowrap",children:[I.jsx("span",{className:"hidden lg:inline",children:"Get Started"}),I.jsx("span",{className:"lg:hidden",children:"Join"})]})]})}),I.jsxs("div",{className:"md:hidden flex items-center space-x-2",children:[d&&I.jsxs("div",{className:"relative notification-dropdown",children:[I.jsxs("button",{onClick:T,className:"relative p-2 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 focus:outline-none",children:[I.jsx("i",{className:"ri-notification-line text-xl"}),E>0&&I.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:E>9?"9+":E})]}),k&&I.jsxs("div",{className:"absolute right-0 mt-2 w-80 sm:w-96 bg-white border border-gray-200 rounded-lg shadow-xl z-50 cursor-pointer",onClick:()=>{O(),B("/notifications")},children:[I.jsx("div",{className:"px-4 py-3 bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-200 rounded-t-lg",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("h3",{className:"font-semibold text-gray-900",children:"Notifications"}),E>0&&I.jsx("button",{onClick:e=>{e.stopPropagation(),L()},className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Mark all as read"})]})}),I.jsx("div",{className:"max-h-96 overflow-y-auto",children:0===w.length?I.jsxs("div",{className:"text-center py-8",children:[I.jsx("i",{className:"ri-notification-off-line text-4xl text-gray-300"}),I.jsx("p",{className:"text-gray-500 mt-2",children:"No notifications"})]}):I.jsx("div",{className:"divide-y divide-gray-100",children:w.map(e=>{const t=$.has(e.id)||e.is_read;return I.jsx("div",{onClick:async s=>{s.stopPropagation(),t||await P(e.id),"safety_protocol"===e.type?(O(),B("/safety-protocols")):"alert"===e.type?(O(),N(e),v(!0)):"welfare"===e.type?(O(),B("/welfare-check")):"system"===e.type&&(O(),B("/history-report"))},className:"p-4 hover:bg-gray-50 cursor-pointer transition-colors "+(t?"":"bg-blue-50"),children:I.jsx("div",{className:"flex items-start space-x-3",children:I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),!t&&I.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0"})]}),I.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:e.message}),I.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.created_at).toLocaleString()})]})})},e.id)})})})]})]}),I.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors focus:outline-none flex-shrink-0",onClick:()=>{i(!r),o(!1),C(!1)},"aria-label":"Toggle mobile menu",children:I.jsx("i",{className:`ri-${r?"close":"menu"}-line text-xl text-gray-700`})})]})]})})}),r&&I.jsxs("div",{className:"fixed inset-0 z-40 md:hidden",children:[I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:F}),I.jsx("div",{className:"fixed top-16 left-0 right-0 bg-white shadow-xl border-t border-gray-200 max-h-[calc(100vh-4rem)] overflow-y-auto",children:I.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-6 space-y-2",children:[I.jsxs("button",{onClick:()=>{if("/"===window.location.pathname){const e=document.getElementById("hero-section");e&&e.scrollIntoView({behavior:"smooth"}),F()}else B("/")},className:"flex items-center w-full px-3 sm:px-4 py-3 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 font-medium",children:[I.jsx("i",{className:"ri-home-line text-lg mr-3 flex-shrink-0"}),I.jsx("span",{className:"text-sm sm:text-base",children:"Home"})]}),I.jsxs("button",{onClick:()=>B("/evacuation-center"),className:"flex items-center w-full px-3 sm:px-4 py-3 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 font-medium",children:[I.jsx("i",{className:"ri-building-2-line text-lg mr-3 flex-shrink-0"}),I.jsx("span",{className:"text-sm sm:text-base",children:"Centers"})]}),I.jsxs("button",{onClick:()=>B("/incident-report"),className:"flex items-center w-full px-3 sm:px-4 py-3 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 font-medium",children:[I.jsx("i",{className:"ri-error-warning-line text-lg mr-3 flex-shrink-0"}),I.jsx("span",{className:"text-sm sm:text-base",children:"Report"})]}),I.jsxs("button",{onClick:()=>{if("/"===window.location.pathname){const e=document.getElementById("faq-section");e&&e.scrollIntoView({behavior:"smooth"})}else window.location.href="/#faq-section";F()},className:"flex items-center w-full px-3 sm:px-4 py-3 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 font-medium",children:[I.jsx("i",{className:"ri-question-line text-lg mr-3 flex-shrink-0"}),I.jsx("span",{className:"text-sm sm:text-base",children:"FAQ"})]}),I.jsx("div",{className:"border-t border-gray-200 my-4"}),d?I.jsxs("div",{className:"space-y-3",children:[I.jsx("div",{className:"px-3 sm:px-4 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100",children:I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx(ct,{name:u?.firstName&&u?.lastName?`${u.firstName} ${u.lastName}`:u?.first_name&&u?.last_name?`${u.first_name} ${u.last_name}`:void 0,email:u?.email,profilePicture:u?.profile_picture,size:"lg",className:"flex-shrink-0"}),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsx("p",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:u?.first_name&&u?.last_name?`${u.first_name} ${u.last_name}`:u?.email?.split("@")[0]||"User"}),I.jsx("p",{className:"text-gray-600 text-xs sm:text-sm truncate",title:u?.email||"No email",children:u?.email||"No email provided"}),I.jsxs("div",{className:"flex items-center mt-1",children:[I.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-1 flex-shrink-0"}),I.jsx("span",{className:"text-xs text-gray-500",children:"Online"})]})]})]})}),I.jsxs("button",{onClick:()=>B("/profile"),className:"flex items-center w-full px-3 sm:px-4 py-3 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 group",children:[I.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-blue-100 transition-colors flex-shrink-0",children:I.jsx("i",{className:"ri-settings-line text-gray-600 group-hover:text-blue-600"})}),I.jsxs("div",{className:"text-left min-w-0 flex-1",children:[I.jsx("p",{className:"font-medium text-sm sm:text-base",children:"Account Settings"}),I.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Manage your profile"})]})]}),I.jsxs("button",{onClick:()=>B("/history-report"),className:"flex items-center w-full px-3 sm:px-4 py-3 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 group",children:[I.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-blue-100 transition-colors flex-shrink-0",children:I.jsx("i",{className:"ri-file-list-line text-gray-600 group-hover:text-blue-600"})}),I.jsxs("div",{className:"text-left min-w-0 flex-1",children:[I.jsx("p",{className:"font-medium text-sm sm:text-base",children:"History Report"}),I.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"View your incident reports"})]})]}),I.jsxs("button",{onClick:()=>B("/feedback"),className:"flex items-center w-full px-3 sm:px-4 py-3 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 group",children:[I.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-blue-100 transition-colors flex-shrink-0",children:I.jsx("i",{className:"ri-feedback-line text-gray-600 group-hover:text-blue-600"})}),I.jsxs("div",{className:"text-left min-w-0 flex-1",children:[I.jsx("p",{className:"font-medium text-sm sm:text-base",children:"Submit Feedback"}),I.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Share your thoughts"})]})]}),I.jsxs("button",{onClick:U,className:"flex items-center w-full px-3 sm:px-4 py-3 rounded-lg text-gray-700 hover:text-red-600 hover:bg-red-50 transition-all duration-200 group",children:[I.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-red-100 transition-colors flex-shrink-0",children:I.jsx("i",{className:"ri-logout-box-line text-gray-600 group-hover:text-red-600"})}),I.jsxs("div",{className:"text-left min-w-0 flex-1",children:[I.jsx("p",{className:"font-medium text-sm sm:text-base",children:"Sign Out"}),I.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Logout from your account"})]})]})]}):I.jsxs("div",{className:"space-y-2",children:[I.jsxs("button",{onClick:()=>B("/auth/login"),className:"flex items-center w-full px-3 sm:px-4 py-3 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 font-medium",children:[I.jsx("i",{className:"ri-login-box-line text-lg mr-3 flex-shrink-0"}),I.jsx("span",{className:"text-sm sm:text-base",children:"Sign In"})]}),I.jsxs("button",{onClick:()=>B("/auth/signup"),className:"flex items-center justify-center w-full px-3 sm:px-4 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 font-medium shadow-lg",children:[I.jsx("i",{className:"ri-user-add-line text-lg mr-2 flex-shrink-0"}),I.jsx("span",{className:"text-sm sm:text-base",children:"Get Started"})]})]})]})})]}),I.jsx(ot,{isOpen:g,onClose:()=>{f(!1)},onConfirm:async()=>{b(!0);try{await X(),M(),s("/")}catch(e){M(),s("/")}finally{b(!1),f(!1)}},isLoading:p}),I.jsx(dt,{isOpen:y,onClose:()=>v(!1),alert:j})]})},mt=({items:e,itemsPerView:t=3,autoPlay:s=!0,autoPlayInterval:r=3e3,showDots:a=!0,showArrows:i=!0,className:l="",itemClassName:o="",renderItem:d})=>{const[c,u]=n.useState(0),[m,h]=n.useState(!1),x=Math.max(0,e.length-t);n.useEffect(()=>{if(s&&!m){const e=setInterval(()=>{u(e=>e>=x?0:e+1)},r);return()=>clearInterval(e)}},[s,r,m,x]);return I.jsxs("div",{className:`relative ${l}`,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[I.jsx("div",{className:"overflow-hidden",children:I.jsx("div",{className:"flex transition-transform duration-500 ease-in-out",style:{transform:`translateX(-${c*(100/t)}%)`},children:e.map((e,s)=>I.jsx("div",{className:`flex-shrink-0 ${o}`,style:{width:100/t+"%"},children:d(e,s)},s))})}),i&&e.length>t&&I.jsxs(I.Fragment,{children:[I.jsx("button",{onClick:()=>{u(e=>e<=0?x:e-1)},className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 bg-white/90 hover:bg-white shadow-lg rounded-full p-2 transition-all duration-200 hover:scale-110 z-10","aria-label":"Previous slide",children:I.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),I.jsx("button",{onClick:()=>{u(e=>e>=x?0:e+1)},className:"absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 bg-white/90 hover:bg-white shadow-lg rounded-full p-2 transition-all duration-200 hover:scale-110 z-10","aria-label":"Next slide",children:I.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),a&&e.length>t&&I.jsx("div",{className:"flex justify-center mt-6 space-x-2",children:Array.from({length:x+1},(e,t)=>I.jsx("button",{onClick:()=>(e=>{u(Math.min(e,x))})(t),className:"w-2 h-2 rounded-full transition-all duration-200 "+(t===c?"bg-blue-600 scale-125":"bg-gray-300 hover:bg-gray-400"),"aria-label":`Go to slide ${t+1}`},t))})]})},ht=({value:e,duration:t=2e3,isVisible:s,suffix:r="",prefix:a="",className:i=""})=>{const[l,o]=n.useState(0),[d,c]=n.useState(!1);return n.useEffect(()=>{if(s&&!d){c(!0);const s=Date.now(),r=0,a=e,n=()=>{const e=Date.now()-s,i=Math.min(e/t,1),l=1-Math.pow(1-i,3),d=Math.floor(r+(a-r)*l);o(d),i<1?requestAnimationFrame(n):o(a)};requestAnimationFrame(n)}},[s,e,t,d]),n.useEffect(()=>{s&&c(!1)},[e,s]),I.jsxs("span",{className:i,children:[a,l.toLocaleString(),r]})};function xt({isOpen:e,onClose:t}){return e?I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:I.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl mx-4 shadow-2xl max-h-[90vh] flex flex-col",children:[I.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 rounded-t-xl flex-shrink-0",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-shield-check-line text-xl"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-2xl font-bold",children:"Privacy Policy"}),I.jsx("p",{className:"text-blue-100 text-sm",children:"MDRRMO Rosario, Batangas"})]})]}),I.jsx("button",{onClick:t,className:"text-white hover:text-blue-100 transition-colors p-2 hover:bg-white/20 rounded-lg",children:I.jsx("i",{className:"ri-close-line text-2xl"})})]})}),I.jsx("div",{className:"flex-1 overflow-y-auto",children:I.jsx("div",{className:"p-6 md:p-8",children:I.jsxs("div",{className:"prose prose-lg max-w-none",children:[I.jsx("div",{className:"mb-6",children:I.jsxs("p",{className:"text-gray-600 text-lg leading-relaxed",children:["Last updated: ",(new Date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"1. Information We Collect"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"We collect information you provide directly to us, such as when you:"}),I.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[I.jsx("li",{children:"Create an account or register for our services"}),I.jsx("li",{children:"Report incidents or emergencies"}),I.jsx("li",{children:"Submit welfare check information"}),I.jsx("li",{children:"Contact us for support or assistance"}),I.jsx("li",{children:"Participate in surveys or feedback forms"})]}),I.jsx("p",{children:"This may include your name, email address, phone number, location data, and emergency contact information."})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"2. How We Use Your Information"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"We use the information we collect to:"}),I.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[I.jsx("li",{children:"Provide emergency response services and assistance"}),I.jsx("li",{children:"Process and respond to incident reports"}),I.jsx("li",{children:"Send emergency alerts and safety notifications"}),I.jsx("li",{children:"Coordinate evacuation and welfare check procedures"}),I.jsx("li",{children:"Improve our services and emergency response capabilities"}),I.jsx("li",{children:"Comply with legal obligations and emergency protocols"})]})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"3. Information Sharing"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"We may share your information with:"}),I.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[I.jsx("li",{children:"Emergency response agencies (PNP, BFP, Medical Services)"}),I.jsx("li",{children:"Local government units for disaster management"}),I.jsx("li",{children:"Healthcare providers during medical emergencies"}),I.jsx("li",{children:"Authorized personnel for evacuation coordination"})]}),I.jsx("p",{children:"We only share information when necessary for emergency response, public safety, or as required by law."})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"4. Data Security"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"We implement appropriate security measures to protect your personal information against unauthorized access, alteration, disclosure, or destruction. This includes:"}),I.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[I.jsx("li",{children:"Encryption of sensitive data"}),I.jsx("li",{children:"Secure server infrastructure"}),I.jsx("li",{children:"Access controls and authentication"}),I.jsx("li",{children:"Regular security audits and updates"})]})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"5. Your Rights"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"You have the right to:"}),I.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[I.jsx("li",{children:"Access your personal information"}),I.jsx("li",{children:"Correct inaccurate information"}),I.jsx("li",{children:"Request deletion of your data (subject to legal requirements)"}),I.jsx("li",{children:"Opt-out of non-emergency communications"}),I.jsx("li",{children:"File a complaint with relevant authorities"})]})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"6. Data Retention"}),I.jsx("div",{className:"space-y-4 text-gray-700",children:I.jsx("p",{children:"We retain your information for as long as necessary to provide our services and comply with legal obligations. Emergency incident reports may be retained for historical and statistical purposes as required by disaster management protocols."})})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"7. Contact Information"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"If you have questions about this Privacy Policy, please contact us:"}),I.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:I.jsxs("div",{className:"space-y-2",children:[I.jsx("p",{children:I.jsx("strong",{children:"MDRRMO Rosario, Batangas"})}),I.jsx("p",{children:"📍 Municipal Hall, Rosario, Batangas, Philippines"}),I.jsx("p",{children:"📞 (043) 311.2935"}),I.jsx("p",{children:"📧 mdrrmo@rosario.gov.ph"})]})})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"8. Changes to This Policy"}),I.jsx("div",{className:"space-y-4 text-gray-700",children:I.jsx("p",{children:'We may update this Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the "Last updated" date.'})})]})]})})}),I.jsx("div",{className:"bg-gray-50 p-6 rounded-b-xl border-t border-gray-200 flex-shrink-0",children:I.jsxs("div",{className:"flex justify-between items-center",children:[I.jsxs("div",{className:"flex items-center text-gray-600",children:[I.jsx("i",{className:"ri-shield-check-line mr-2 text-blue-500"}),I.jsx("span",{className:"text-sm font-medium",children:"Your privacy is protected"})]}),I.jsx("button",{onClick:t,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-semibold shadow-md hover:shadow-lg",children:"Close"})]})})]})}):null}function gt({isOpen:e,onClose:t}){return e?I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:I.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl mx-4 shadow-2xl max-h-[90vh] flex flex-col",children:[I.jsx("div",{className:"bg-gradient-to-r from-green-600 to-green-700 text-white p-6 rounded-t-xl flex-shrink-0",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-file-text-line text-xl"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-2xl font-bold",children:"Terms of Service"}),I.jsx("p",{className:"text-green-100 text-sm",children:"MDRRMO Rosario, Batangas"})]})]}),I.jsx("button",{onClick:t,className:"text-white hover:text-green-100 transition-colors p-2 hover:bg-white/20 rounded-lg",children:I.jsx("i",{className:"ri-close-line text-2xl"})})]})}),I.jsx("div",{className:"flex-1 overflow-y-auto",children:I.jsx("div",{className:"p-6 md:p-8",children:I.jsxs("div",{className:"prose prose-lg max-w-none",children:[I.jsx("div",{className:"mb-6",children:I.jsxs("p",{className:"text-gray-600 text-lg leading-relaxed",children:["Last updated: ",(new Date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"1. Acceptance of Terms"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:'By accessing and using the MDRRMO Rosario Emergency Management System ("Service"), you accept and agree to be bound by the terms and provision of this agreement.'}),I.jsx("p",{children:"If you do not agree to abide by the above, please do not use this service."})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"2. Service Description"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"Our service provides:"}),I.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[I.jsx("li",{children:"Emergency incident reporting and tracking"}),I.jsx("li",{children:"Evacuation center information and routing"}),I.jsx("li",{children:"Safety protocols and emergency procedures"}),I.jsx("li",{children:"Welfare check and status reporting"}),I.jsx("li",{children:"Emergency alerts and notifications"}),I.jsx("li",{children:"Community safety resources and information"})]})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"3. User Responsibilities"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"As a user of this service, you agree to:"}),I.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[I.jsx("li",{children:"Provide accurate and truthful information"}),I.jsx("li",{children:"Use the service only for legitimate emergency and safety purposes"}),I.jsx("li",{children:"Not submit false or misleading incident reports"}),I.jsx("li",{children:"Respect the privacy and safety of other users"}),I.jsx("li",{children:"Follow all applicable laws and regulations"}),I.jsx("li",{children:"Not interfere with or disrupt the service"})]})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"4. Emergency Use"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsxs("p",{children:[I.jsx("strong",{children:"Important:"})," This service is designed to complement, not replace, traditional emergency services."]}),I.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:I.jsxs("div",{className:"flex items-start",children:[I.jsx("i",{className:"ri-error-warning-line text-red-500 text-xl mr-3 mt-1"}),I.jsxs("div",{children:[I.jsx("p",{className:"font-semibold text-red-800 mb-2",children:"For Life-Threatening Emergencies:"}),I.jsx("p",{className:"text-red-700",children:"Call emergency hotlines directly:"}),I.jsxs("ul",{className:"list-disc pl-4 mt-2 text-red-700",children:[I.jsx("li",{children:"MDRRMO: (043) 311.2935"}),I.jsx("li",{children:"PNP: (043) 724.7026"}),I.jsx("li",{children:"BFP: (043) 312.1102"})]})]})]})})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"5. Account Registration"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"To access certain features, you may need to register for an account. You agree to:"}),I.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[I.jsx("li",{children:"Provide accurate registration information"}),I.jsx("li",{children:"Maintain the security of your account credentials"}),I.jsx("li",{children:"Notify us immediately of any unauthorized use"}),I.jsx("li",{children:"Accept responsibility for all activities under your account"})]})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"6. Data and Privacy"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"Your privacy is important to us. Please review our Privacy Policy to understand how we collect, use, and protect your information."}),I.jsx("p",{children:"By using this service, you consent to the collection and use of your information as described in our Privacy Policy."})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"7. Service Availability"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"While we strive to maintain continuous service availability:"}),I.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[I.jsx("li",{children:"Service may be temporarily unavailable due to maintenance or technical issues"}),I.jsx("li",{children:"We do not guarantee uninterrupted access"}),I.jsx("li",{children:"Emergency services should not rely solely on this platform"}),I.jsx("li",{children:"We reserve the right to modify or discontinue features"})]})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"8. Prohibited Uses"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"You may not use this service to:"}),I.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[I.jsx("li",{children:"Submit false emergency reports or information"}),I.jsx("li",{children:"Harass, threaten, or harm others"}),I.jsx("li",{children:"Violate any laws or regulations"}),I.jsx("li",{children:"Interfere with emergency response operations"}),I.jsx("li",{children:"Attempt to gain unauthorized access to systems"}),I.jsx("li",{children:"Distribute malware or harmful content"})]})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"9. Limitation of Liability"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"MDRRMO Rosario and its affiliates shall not be liable for:"}),I.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[I.jsx("li",{children:"Service interruptions or technical failures"}),I.jsx("li",{children:"Delays in emergency response"}),I.jsx("li",{children:"Inaccurate information provided by third parties"}),I.jsx("li",{children:"Consequences of user actions based on service information"})]}),I.jsx("p",{children:'This service is provided "as is" without warranties of any kind.'})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"10. Termination"}),I.jsx("div",{className:"space-y-4 text-gray-700",children:I.jsx("p",{children:"We may terminate or suspend your access to the service immediately, without prior notice, for conduct that we believe violates these Terms of Service or is harmful to other users, us, or third parties."})})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"11. Changes to Terms"}),I.jsx("div",{className:"space-y-4 text-gray-700",children:I.jsx("p",{children:"We reserve the right to modify these terms at any time. Changes will be effective immediately upon posting. Your continued use of the service constitutes acceptance of the modified terms."})})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"12. Contact Information"}),I.jsxs("div",{className:"space-y-4 text-gray-700",children:[I.jsx("p",{children:"For questions about these Terms of Service, contact us:"}),I.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:I.jsxs("div",{className:"space-y-2",children:[I.jsx("p",{children:I.jsx("strong",{children:"MDRRMO Rosario, Batangas"})}),I.jsx("p",{children:"📍 Municipal Hall, Rosario, Batangas, Philippines"}),I.jsx("p",{children:"📞 (043) 311.2935"}),I.jsx("p",{children:"📧 mdrrmo@rosario.gov.ph"})]})})]})]}),I.jsxs("section",{className:"mb-8",children:[I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:"13. Governing Law"}),I.jsx("div",{className:"space-y-4 text-gray-700",children:I.jsx("p",{children:"These Terms of Service are governed by the laws of the Republic of the Philippines. Any disputes shall be resolved in the appropriate courts of Batangas Province."})})]})]})})}),I.jsx("div",{className:"bg-gray-50 p-6 rounded-b-xl border-t border-gray-200 flex-shrink-0",children:I.jsxs("div",{className:"flex justify-between items-center",children:[I.jsxs("div",{className:"flex items-center text-gray-600",children:[I.jsx("i",{className:"ri-file-text-line mr-2 text-green-500"}),I.jsx("span",{className:"text-sm font-medium",children:"Terms effective immediately"})]}),I.jsx("button",{onClick:t,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors font-semibold shadow-md hover:shadow-lg",children:"Close"})]})})]})}):null}function ft(){const e=a(),[t,s]=n.useState(!1),[i,l]=n.useState(null),[o,d]=n.useState(!0),[c,u]=n.useState(!1),[m,h]=n.useState(!1),[x,g]=n.useState(!1),[f,p]=n.useState(0),[b,y]=n.useState({responders:0,evacuationCenters:0,residentsCovered:0,totalIncidents:0}),v={responders:25,evacuationCenters:8,residentsCovered:1500,totalIncidents:12},[j,N]=n.useState(!0),[w,S]=n.useState(null),[k,C]=n.useState([]),[$,_]=n.useState(!0),[A,P]=n.useState(null),[L,E]=n.useState(3),[T,O]=n.useState(!1),{ref:F}=((e={})=>{const{threshold:t=.1,rootMargin:s="0px",triggerOnce:r=!0}=e,[a,i]=n.useState(!1),l=n.useRef(null);return n.useEffect(()=>{const e=l.current;if(!e)return;const a=new IntersectionObserver(([t])=>{t.isIntersecting?(i(!0),r&&a.unobserve(e)):r||i(!1)},{threshold:t,rootMargin:s});return a.observe(e),()=>{a.unobserve(e)}},[t,s,r]),{ref:l,isVisible:a}})({threshold:.2,rootMargin:"0px 0px -100px 0px",triggerOnce:!0});n.useEffect(()=>{const t=D();if(t.isAuthenticated){if("admin"===t.userType)return void e("/admin");if("staff"===t.userType)return void e("/staff")}const r=t.isAuthenticated&&"user"===t.userType;s(r),l(r?t.userData:null),d(!1);const a=()=>{const t=D();if(t.isAuthenticated){if("admin"===t.userType)return void e("/admin");if("staff"===t.userType)return void e("/staff")}const r=t.isAuthenticated&&"user"===t.userType;s(r),l(r?t.userData:null)};return window.addEventListener("storage",a),window.addEventListener("authStateChanged",a),()=>{window.removeEventListener("storage",a),window.removeEventListener("authStateChanged",a)}},[e]),n.useEffect(()=>{"#faq-section"===window.location.hash&&setTimeout(()=>{const e=document.getElementById("faq-section");e&&e.scrollIntoView({behavior:"smooth"})},100)},[]),n.useEffect(()=>{(async()=>{N(!0),S(null);try{const e=await Ye();if(e.success){const t=e.stats;y({responders:t?.staff?.total||0,evacuationCenters:t?.evacuation_centers?.total||0,residentsCovered:t?.users?.total||0,totalIncidents:t?.incidents?.total||0})}else S("Failed to load stats")}catch(e){y(v),S("Using sample data - API unavailable")}finally{N(!1)}})()},[]),n.useEffect(()=>{(async()=>{_(!0),P(null);try{const e=await Ze(L);e.success?C(e.testimonials):P("Failed to load testimonials")}catch(e){P("Failed to load testimonials")}finally{_(!1)}})()},[L]);const R=[{name:"MDRRMO",description:"Municipal Disaster Risk Reduction & Management Office",number:"(043) 311.2935 | 703.2646 | 0917.133.9605",icon:"ri-shield-cross-line",logo:"/images/partners/MDRRMO.png",priority:"high"},{name:"PNP",description:"Municipal Police Station",number:"(043) 724.7026 | 0915.254.2577",icon:"ri-police-car-line",logo:"/images/partners/pnp.jpg",priority:"high"},{name:"BFP",description:"Municipal Fire Station",number:"(043) 312.1102 | 0915.602.4435",icon:"ri-fire-line",logo:"/images/partners/bfp.jpg",priority:"high"},{name:"RHU I",description:"Municipal Health Office",number:"(043) 740.1338 | 0908.280.1497",icon:"ri-hospital-line",logo:"/images/partners/mho.png",priority:"medium"},{name:"MSWDO",description:"Municipal Social Welfare & Development Office",number:"(043) 312.1367",icon:"ri-community-line",logo:"/images/partners/msdw.jpg",priority:"medium"},{name:"MVM Hospital",description:"Rosario District Hospital",number:"(043) 312.0411",icon:"ri-hospital-fill",logo:"/images/partners/mvm.jpg",priority:"medium"},{name:"BATELEC II - AREA II",description:"Batangas II Electric Cooperative Inc.",number:"0917.550.0754 | 0998.548.6153",icon:"ri-flashlight-line",logo:"/images/partners/batelec.jpg",priority:"medium"},{name:"PRC",description:"Philippine Red Cross Batangas Chapter - Lipa City Branch",number:"(043) 740.0768 | 0917.142.9378",icon:"ri-first-aid-kit-line",logo:"/images/partners/prc.png",priority:"medium"}];return o?I.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50 flex items-center justify-center",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-blue-100 to-blue-200 rounded-2xl flex items-center justify-center mx-auto mb-6 animate-pulse",children:I.jsx("i",{className:"ri-shield-check-line text-3xl md:text-4xl text-blue-600"})}),I.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-4",children:"Loading..."}),I.jsx("p",{className:"text-gray-600",children:"Please wait while we verify your access"})]})}):I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50",children:[I.jsx(ut,{isAuthenticated:t,userData:i}),I.jsxs("div",{id:"hero-section",className:"relative overflow-hidden",children:[I.jsxs("div",{className:"relative h-[500px] md:h-[700px] lg:h-[800px] bg-gradient-to-r from-blue-900/90 to-blue-800/80",children:[I.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url('/images/rosario-hero.png')"}}),I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-900/90 to-blue-800/85"}),I.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_30%_40%,rgba(255,255,255,0.1),transparent_50%)]"})]}),I.jsx("div",{className:"absolute inset-0 flex items-center",children:I.jsx("div",{className:"container mx-auto px-4 lg:px-8",children:I.jsx("div",{className:"max-w-5xl",children:t?I.jsxs("div",{className:"text-left",children:[I.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 md:w-20 md:h-20 lg:w-24 lg:h-24 bg-white/95 backdrop-blur-sm rounded-2xl mb-6 md:mb-8 shadow-2xl border border-white/20",children:I.jsx("i",{className:"ri-shield-check-line text-2xl md:text-3xl lg:text-4xl text-blue-600"})}),I.jsxs("h1",{className:"text-3xl md:text-5xl lg:text-6xl font-bold text-white mb-4 md:mb-6 leading-tight text-balance",children:["Welcome back to",I.jsx("span",{className:"block text-yellow-300 bg-gradient-to-r from-yellow-300 to-yellow-400 bg-clip-text text-transparent",children:"SoteROS Emergency Hub"})]}),I.jsx("p",{className:"text-lg md:text-xl lg:text-2xl text-blue-100 max-w-3xl mb-8 md:mb-10 leading-relaxed text-pretty",children:"Your comprehensive emergency management dashboard is ready. Access real-time incident tracking, evacuation routing, and safety protocols."})]}):I.jsxs("div",{className:"text-left",children:[I.jsxs("h1",{className:"text-3xl md:text-5xl lg:text-7xl font-bold text-white mb-3 md:mb-4 leading-tight text-balance",children:["Municipal Disaster Risk Reduction",I.jsx("span",{className:"block text-yellow-300 bg-gradient-to-r from-yellow-300 to-yellow-400 bg-clip-text text-transparent",children:"& Management Office"})]}),I.jsx("h2",{className:"text-xl md:text-3xl lg:text-4xl font-semibold text-blue-200 mb-6 md:mb-8",children:"Rosario, Batangas"}),I.jsx("p",{className:"text-lg md:text-xl lg:text-2xl text-blue-100 max-w-4xl mb-8 md:mb-12 leading-relaxed text-pretty",children:"Committed to protecting and serving our community through comprehensive disaster preparedness, rapid emergency response, and proactive public safety management."}),I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 md:gap-6",children:[I.jsx("a",{href:"#services",onClick:e=>{e.preventDefault();const t=document.getElementById("services");t&&t.scrollIntoView({behavior:"smooth"})},className:"bg-gradient-to-r from-yellow-500 to-yellow-400 hover:from-yellow-400 hover:to-yellow-300 text-blue-900 px-8 py-4 md:px-10 md:py-5 rounded-xl font-bold text-lg md:text-xl transition-all duration-300 shadow-2xl hover:shadow-yellow-500/25 hover:-translate-y-1 text-center",children:"Emergency Services"}),I.jsx("button",{onClick:()=>u(!0),className:"bg-gradient-to-r from-red-600 to-red-500 hover:from-red-500 hover:to-red-400 text-white px-8 py-4 md:px-10 md:py-5 rounded-xl font-bold text-lg md:text-xl transition-all duration-300 shadow-2xl hover:shadow-red-500/25 hover:-translate-y-1 text-center",children:"Emergency Hotline"})]})]})})})})]}),I.jsx("div",{id:"services",className:"bg-white py-20 md:py-28",children:I.jsxs("div",{className:"container mx-auto px-4 lg:px-8",children:[I.jsxs("div",{className:"text-center mb-16 md:mb-20",children:[I.jsx("h2",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 mb-4 md:mb-6 text-balance",children:t?`Welcome back, ${i?.firstName||"User"}!`:"Emergency Services"}),I.jsx("p",{className:"text-xl md:text-2xl text-gray-600 mb-12 md:mb-16 max-w-4xl mx-auto text-pretty",children:t?"Access your emergency management tools":"Comprehensive disaster risk reduction and emergency response services for Rosario, Batangas"})]}),I.jsx("div",{className:"max-w-7xl mx-auto",children:t?I.jsxs("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8 mb-16 md:mb-20",children:["staff"===i?.userType&&I.jsxs(r,{to:"/staff",className:"bg-white border-2 border-gray-100 rounded-2xl p-6 md:p-8 hover:shadow-2xl hover:border-purple-200 transition-all duration-300 cursor-pointer group hover:-translate-y-2 flex flex-col h-full",children:[I.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-purple-100 to-purple-200 rounded-2xl flex items-center justify-center mb-6 md:mb-8 group-hover:scale-110 transition-all duration-300",children:I.jsx("i",{className:"ri-dashboard-3-line text-3xl md:text-4xl text-purple-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-3 md:mb-4",children:"Staff Dashboard"}),I.jsx("p",{className:"text-gray-600 mb-6 md:mb-8 text-lg leading-relaxed flex-grow",children:"Access your staff dashboard with emergency management tools"}),I.jsxs("div",{className:"flex items-center text-purple-600 group-hover:text-purple-700 mt-auto",children:[I.jsx("span",{className:"font-semibold text-lg",children:"Go to Dashboard"}),I.jsx("i",{className:"ri-arrow-right-line ml-3 group-hover:translate-x-2 transition-transform duration-300"})]})]}),I.jsxs(r,{to:"/incident-report",className:"bg-white border-2 border-gray-100 rounded-2xl p-6 md:p-8 hover:shadow-2xl hover:border-red-200 transition-all duration-300 cursor-pointer group hover:-translate-y-2 flex flex-col h-full",children:[I.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-red-100 to-red-200 rounded-2xl flex items-center justify-center mb-6 md:mb-8 group-hover:scale-110 transition-all duration-300",children:I.jsx("i",{className:"ri-error-warning-line text-3xl md:text-4xl text-red-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-3 md:mb-4",children:"Report Incident"}),I.jsx("p",{className:"text-gray-600 mb-6 md:mb-8 text-lg leading-relaxed flex-grow",children:"Submit emergency incidents and safety concerns with real-time tracking"}),I.jsxs("div",{className:"flex items-center text-red-600 group-hover:text-red-700 mt-auto",children:[I.jsx("span",{className:"font-semibold text-lg",children:"Report Now"}),I.jsx("i",{className:"ri-arrow-right-line ml-3 group-hover:translate-x-2 transition-transform duration-300"})]})]}),I.jsxs(r,{to:"/evacuation-center",className:"bg-white border-2 border-gray-100 rounded-2xl p-6 md:p-8 hover:shadow-2xl hover:border-blue-200 transition-all duration-300 cursor-pointer group hover:-translate-y-2 flex flex-col h-full",children:[I.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-blue-100 to-blue-200 rounded-2xl flex items-center justify-center mb-6 md:mb-8 group-hover:scale-110 transition-all duration-300",children:I.jsx("i",{className:"ri-building-2-line text-3xl md:text-4xl text-blue-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-3 md:mb-4",children:"Evacuation Centers"}),I.jsx("p",{className:"text-gray-600 mb-6 md:mb-8 text-lg leading-relaxed flex-grow",children:"Find nearby evacuation centers with real-time capacity and status updates"}),I.jsxs("div",{className:"flex items-center text-blue-600 group-hover:text-blue-700 mt-auto",children:[I.jsx("span",{className:"font-semibold text-lg",children:"View Centers"}),I.jsx("i",{className:"ri-arrow-right-line ml-3 group-hover:translate-x-2 transition-transform duration-300"})]})]}),I.jsxs(r,{to:"/safety-protocols",className:"bg-white border-2 border-gray-100 rounded-2xl p-6 md:p-8 hover:shadow-2xl hover:border-green-200 transition-all duration-300 cursor-pointer group hover:-translate-y-2 flex flex-col h-full",children:[I.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-green-100 to-green-200 rounded-2xl flex items-center justify-center mb-6 md:mb-8 group-hover:scale-110 transition-all duration-300",children:I.jsx("i",{className:"ri-shield-check-line text-3xl md:text-4xl text-green-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-3 md:mb-4",children:"Safety Protocols"}),I.jsx("p",{className:"text-gray-600 mb-6 md:mb-8 text-lg leading-relaxed flex-grow",children:"Access comprehensive emergency procedures and safety guidelines"}),I.jsxs("div",{className:"flex items-center text-green-600 group-hover:text-green-700 mt-auto",children:[I.jsx("span",{className:"font-semibold text-lg",children:"View Protocols"}),I.jsx("i",{className:"ri-arrow-right-line ml-3 group-hover:translate-x-2 transition-transform duration-300"})]})]}),I.jsxs(r,{to:"/welfare-check",className:"bg-white border-2 border-gray-100 rounded-2xl p-6 md:p-8 hover:shadow-2xl hover:border-purple-200 transition-all duration-300 cursor-pointer group hover:-translate-y-2 flex flex-col h-full",children:[I.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-purple-100 to-purple-200 rounded-2xl flex items-center justify-center mb-6 md:mb-8 group-hover:scale-110 transition-all duration-300",children:I.jsx("i",{className:"ri-heart-pulse-line text-3xl md:text-4xl text-purple-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-3 md:mb-4",children:"Welfare Check"}),I.jsx("p",{className:"text-gray-600 mb-6 md:mb-8 text-lg leading-relaxed flex-grow",children:"Report your status and location during emergencies for safety tracking"}),I.jsxs("div",{className:"flex items-center text-purple-600 group-hover:text-purple-700 mt-auto",children:[I.jsx("span",{className:"font-semibold text-lg",children:"Check In"}),I.jsx("i",{className:"ri-arrow-right-line ml-3 group-hover:translate-x-2 transition-transform duration-300"})]})]})]}):I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8 mb-16 md:mb-20",children:[I.jsxs(r,{to:"/evacuation-center",className:"bg-white border-2 border-gray-100 rounded-2xl p-6 md:p-8 hover:shadow-2xl hover:border-blue-200 transition-all duration-300 cursor-pointer group hover:-translate-y-2 flex flex-col h-full",children:[I.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-blue-100 to-blue-200 rounded-2xl flex items-center justify-center mb-6 md:mb-8 group-hover:scale-110 transition-all duration-300",children:I.jsx("i",{className:"ri-building-2-line text-3xl md:text-4xl text-blue-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-3 md:mb-4",children:"Evacuation Centers"}),I.jsx("p",{className:"text-gray-600 mb-6 md:mb-8 text-lg leading-relaxed flex-grow",children:"View available evacuation centers in Rosario, Batangas with capacity and contact information"}),I.jsxs("div",{className:"flex items-center text-blue-600 group-hover:text-blue-700 mt-auto",children:[I.jsx("span",{className:"font-semibold text-lg",children:"View Centers"}),I.jsx("i",{className:"ri-arrow-right-line ml-3 group-hover:translate-x-2 transition-transform duration-300"})]})]}),I.jsxs(r,{to:"/safety-protocols",className:"bg-white border-2 border-gray-100 rounded-2xl p-6 md:p-8 hover:shadow-2xl hover:border-green-200 transition-all duration-300 cursor-pointer group hover:-translate-y-2 flex flex-col h-full",children:[I.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-green-100 to-green-200 rounded-2xl flex items-center justify-center mb-6 md:mb-8 group-hover:scale-110 transition-all duration-300",children:I.jsx("i",{className:"ri-shield-check-line text-3xl md:text-4xl text-green-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-3 md:mb-4",children:"Safety Protocols"}),I.jsx("p",{className:"text-gray-600 mb-6 md:mb-8 text-lg leading-relaxed flex-grow",children:"Access emergency procedures and safety guidelines for various disaster scenarios"}),I.jsxs("div",{className:"flex items-center text-green-600 group-hover:text-green-700 mt-auto",children:[I.jsx("span",{className:"font-semibold text-lg",children:"View Protocols"}),I.jsx("i",{className:"ri-arrow-right-line ml-3 group-hover:translate-x-2 transition-transform duration-300"})]})]}),I.jsxs(r,{to:"/incident-report",className:"bg-white border-2 border-gray-100 rounded-2xl p-6 md:p-8 hover:shadow-2xl hover:border-red-200 transition-all duration-300 cursor-pointer group hover:-translate-y-2 flex flex-col h-full",children:[I.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-red-100 to-red-200 rounded-2xl flex items-center justify-center mb-6 md:mb-8 group-hover:scale-110 transition-all duration-300",children:I.jsx("i",{className:"ri-error-warning-line text-3xl md:text-4xl text-red-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-3 md:mb-4",children:"Report Incident"}),I.jsx("p",{className:"text-gray-600 mb-6 md:mb-8 text-lg leading-relaxed flex-grow",children:"Report emergencies and safety concerns to MDRRMO Rosario"}),I.jsxs("div",{className:"flex items-center text-red-600 group-hover:text-red-700 mt-auto",children:[I.jsx("span",{className:"font-semibold text-lg",children:"Report Now"}),I.jsx("i",{className:"ri-arrow-right-line ml-3 group-hover:translate-x-2 transition-transform duration-300"})]})]}),I.jsxs(r,{to:"/welfare-check",className:"bg-white border-2 border-gray-100 rounded-2xl p-6 md:p-8 hover:shadow-2xl hover:border-purple-200 transition-all duration-300 cursor-pointer group hover:-translate-y-2 flex flex-col h-full",children:[I.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-purple-100 to-purple-200 rounded-2xl flex items-center justify-center mb-6 md:mb-8 group-hover:scale-110 transition-all duration-300",children:I.jsx("i",{className:"ri-heart-pulse-line text-3xl md:text-4xl text-purple-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-3 md:mb-4",children:"Welfare Check"}),I.jsx("p",{className:"text-gray-600 mb-6 md:mb-8 text-lg leading-relaxed flex-grow",children:"Report your status and location during emergencies for safety tracking"}),I.jsxs("div",{className:"flex items-center text-purple-600 group-hover:text-purple-700 mt-auto",children:[I.jsx("span",{className:"font-semibold text-lg",children:"Check In"}),I.jsx("i",{className:"ri-arrow-right-line ml-3 group-hover:translate-x-2 transition-transform duration-300"})]})]})]}),I.jsxs("div",{className:"text-center bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-10 md:p-12 shadow-xl",children:[I.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-100 to-blue-200 rounded-2xl flex items-center justify-center mx-auto mb-6",children:I.jsx("i",{className:"ri-user-add-line text-3xl text-blue-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-4 md:mb-6",children:"Join Our Emergency Response Network"}),I.jsx("p",{className:"text-lg text-gray-600 mb-8 md:mb-10 max-w-2xl mx-auto leading-relaxed",children:"Sign up to access advanced features, submit reports, and receive real-time emergency alerts for Rosario, Batangas"}),I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 md:gap-6 justify-center",children:[I.jsx(r,{to:"/auth/signup",className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-8 py-4 md:px-10 rounded-xl transition-all duration-300 font-semibold shadow-xl hover:shadow-blue-500/25 hover:-translate-y-1 text-lg",children:"Create Account"}),I.jsx(r,{to:"/auth/login",className:"border-2 border-blue-600 text-blue-600 hover:bg-blue-50 px-8 py-4 md:px-10 rounded-xl transition-all duration-300 font-semibold hover:-translate-y-1 text-lg",children:"Sign In"})]})]})]})})]})}),I.jsx("section",{className:"bg-gradient-to-b from-white to-slate-50 py-20 md:py-28",children:I.jsx("div",{className:"container mx-auto px-4 lg:px-8 max-w-7xl",children:I.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8",children:[{icon:"ri-timer-flash-line",title:"Rapid Response",desc:"Coordinated, time-critical incident handling",color:"from-orange-100 to-orange-200",iconColor:"text-orange-600"},{icon:"ri-hotel-line",title:"Evacuation Centers",desc:"Nearby designated safe shelters with capacity info",color:"from-blue-100 to-blue-200",iconColor:"text-blue-600"},{icon:"ri-shield-star-line",title:"Safety Protocols",desc:"Up-to-date, practical safety guidance",color:"from-green-100 to-green-200",iconColor:"text-green-600"},{icon:"ri-bar-chart-2-line",title:"Live Insights",desc:"Data-driven decisions and monitoring",color:"from-purple-100 to-purple-200",iconColor:"text-purple-600"}].map((e,t)=>I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border-2 border-gray-100 rounded-2xl p-8 md:p-10 hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 group",children:[I.jsx("div",{className:`w-16 h-16 md:w-20 md:h-20 rounded-2xl bg-gradient-to-br ${e.color} ${e.iconColor} flex items-center justify-center mb-6 md:mb-8 group-hover:scale-110 transition-all duration-300`,children:I.jsx("i",{className:`${e.icon} text-2xl md:text-3xl`})}),I.jsx("h4",{className:"font-bold text-xl md:text-2xl text-gray-900 mb-3 md:mb-4",children:e.title}),I.jsx("p",{className:"text-gray-600 text-lg leading-relaxed",children:e.desc})]},t))})})}),I.jsx("section",{ref:F,className:"bg-gradient-to-br from-slate-50 to-blue-50 py-20 md:py-28",children:I.jsx("div",{className:"container mx-auto px-4 lg:px-8 max-w-7xl",children:j?I.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8",children:[1,2,3,4].map(e=>I.jsx("div",{className:"bg-gray-50 rounded-xl p-6 md:p-8 animate-pulse",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:I.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded"})}),I.jsx("div",{className:"h-10 bg-gray-200 rounded w-20 mx-auto mb-2"}),I.jsx("div",{className:"h-5 bg-gray-200 rounded w-24 mx-auto"})]})},e))}):w?I.jsxs("div",{className:"text-center bg-white rounded-3xl shadow-xl border-2 border-gray-100 p-12 md:p-16",children:[I.jsx("div",{className:"w-20 h-20 bg-yellow-100 rounded-2xl flex items-center justify-center mx-auto mb-6",children:I.jsx("i",{className:"ri-information-line text-3xl text-yellow-500"})}),I.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Using Sample Data"}),I.jsx("p",{className:"text-gray-600 text-lg",children:w.includes("sample data")?"Displaying sample statistics while we connect to our database.":"We're experiencing technical difficulties. Please try again later."})]}):I.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8",children:[{label:"Responders",value:`${b.responders}+`,icon:"ri-user-star-line",color:"text-blue-600",bgColor:"bg-blue-50",iconBg:"bg-blue-100"},{label:"Evacuation Centers",value:b.evacuationCenters.toString(),icon:"ri-building-2-line",color:"text-green-600",bgColor:"bg-green-50",iconBg:"bg-green-100"},{label:"Residents Covered",value:`${b.residentsCovered}+`,icon:"ri-shield-user-line",color:"text-purple-600",bgColor:"bg-purple-50",iconBg:"bg-purple-100"},{label:"Total Incidents",value:b.totalIncidents.toString(),icon:"ri-alert-line",color:"text-red-600",bgColor:"bg-red-50",iconBg:"bg-red-100"}].map((e,t)=>I.jsx("div",{className:`${e.bgColor} rounded-xl p-6 md:p-8 hover:shadow-lg transition-all duration-300 group`,children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:`w-16 h-16 ${e.iconBg} rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform duration-300`,children:I.jsx("i",{className:`${e.icon} text-2xl ${e.color}`})}),I.jsx("div",{className:`text-3xl md:text-4xl font-bold ${e.color} mb-2`,children:I.jsx(ht,{value:parseInt(e.value.replace(/[^\d]/g,"")),isVisible:!0,duration:2e3,suffix:e.value.includes("+")?"+":"",className:"inline-block"})}),I.jsx("div",{className:"text-gray-700 font-medium text-lg",children:e.label})]})},t))})})}),I.jsx("section",{className:"bg-gradient-to-b from-blue-50 to-white py-20 md:py-28",children:I.jsxs("div",{className:"container mx-auto px-4 lg:px-8 max-w-7xl",children:[I.jsxs("div",{className:"text-center mb-12 md:mb-16",children:[I.jsx("h3",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900 mb-4",children:"Community Voices"}),I.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Real feedback from residents and responders"})]}),$?I.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8",children:[1,2,3].map(e=>I.jsxs("div",{className:"bg-white rounded-2xl border-2 border-gray-100 p-8 md:p-10 shadow-lg",children:[I.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded mb-4 animate-pulse"}),I.jsxs("div",{className:"space-y-3",children:[I.jsx("div",{className:"h-5 bg-gray-200 rounded animate-pulse"}),I.jsx("div",{className:"h-5 bg-gray-200 rounded w-3/4 animate-pulse"})]}),I.jsx("div",{className:"mt-6 h-5 bg-gray-200 rounded w-1/2 animate-pulse"})]},e))}):A?I.jsxs("div",{className:"text-center bg-white rounded-2xl border-2 border-gray-100 p-12 shadow-lg",children:[I.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-6",children:I.jsx("i",{className:"ri-error-warning-line text-red-500 text-2xl"})}),I.jsx("h4",{className:"text-xl font-semibold text-gray-900 mb-3",children:"Unable to Load Testimonials"}),I.jsx("p",{className:"text-gray-600",children:"We're experiencing technical difficulties. Please try again later."})]}):k.length>0?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8",children:k.map(e=>I.jsxs("div",{className:"bg-white rounded-2xl border-2 border-gray-100 p-8 md:p-10 shadow-lg hover:shadow-2xl hover:-translate-y-1 transition-all duration-300",children:[I.jsxs("div",{className:"flex items-center mb-4",children:[I.jsx("i",{className:"ri-double-quotes-l text-2xl md:text-3xl text-blue-600"}),I.jsx("div",{className:"ml-auto flex",children:[...Array(5)].map((t,s)=>I.jsx("i",{className:`ri-star-${s<e.rating?"fill":"line"} text-yellow-400 text-lg`},s))})]}),I.jsx("p",{className:"text-gray-700 text-lg mb-6 leading-relaxed italic",children:e.quote}),I.jsx("div",{className:"text-lg font-semibold text-gray-900",children:e.name}),I.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Staff"===e.type?e.department:e.type})]},e.id))}),k.length>0&&I.jsx("div",{className:"text-center mt-10",children:I.jsx("button",{onClick:()=>{E(T?3:1e3),O(!T)},className:"inline-flex items-center text-blue-600 px-8 py-4 font-semibold text-lg hover:bg-blue-50 rounded-xl transition-all duration-300",children:T?I.jsxs(I.Fragment,{children:["Back to Less",I.jsx("i",{className:"ri-arrow-up-s-line ml-2"})]}):I.jsxs(I.Fragment,{children:["See More",I.jsx("i",{className:"ri-arrow-down-s-line ml-2"})]})})})]}):I.jsxs("div",{className:"text-center bg-white rounded-2xl border-2 border-gray-100 p-12 shadow-lg",children:[I.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-6",children:I.jsx("i",{className:"ri-chat-voice-line text-blue-500 text-2xl"})}),I.jsx("h4",{className:"text-xl font-semibold text-gray-900 mb-3",children:"No Testimonials Yet"}),I.jsx("p",{className:"text-gray-600",children:"Testimonials will appear here once community members share their feedback."})]})]})}),I.jsx("section",{className:"bg-white py-16 md:py-20",children:I.jsxs("div",{className:"container mx-auto px-4 lg:px-8 max-w-7xl",children:[I.jsx("div",{className:"text-center text-gray-600 mb-8 md:mb-12 font-semibold text-lg",children:"In partnership with"}),I.jsx("div",{className:"hidden sm:block",children:I.jsx(mt,{items:[{name:"LGU",image:"/images/partners/lgu-pt.png",alt:"Local Government Unit"},{name:"MDRRMO",image:"/images/partners/MDRRMO.png",alt:"MDRRMO  "},{name:"BFP",image:"/images/partners/bfp.jpg",alt:"Bureau of Fire Protection"},{name:"PNP",image:"/images/partners/pnp.jpg",alt:"Philippine National Police"},{name:"SOTEROS",image:"/images/soterblue.png",alt:"Philippine National Police"},{name:"RedCross",image:"/images/partners/prc.png",alt:"Philippine Red Cross"},{name:"MHo",image:"/images/partners/mho.png",alt:"MHO"},{name:"MSWDO",image:"/images/partners/msdw.jpg",alt:"MSWDO"},{name:"MVM Hospital",image:"/images/partners/mvm.jpg",alt:"MVM Hospital"},{name:"BATELEC II - AREA II",image:"/images/partners/batelec.jpg",alt:"BATELEC II - AREA II"}],itemsPerView:6,autoPlay:!0,autoPlayInterval:3e3,showDots:!0,showArrows:!1,className:"opacity-90",itemClassName:"px-2",renderItem:(e,t)=>I.jsxs("div",{className:"h-32 w-32 md:h-40 md:w-40 lg:h-44 lg:w-44 bg-gray-50 rounded-2xl flex items-center justify-center mx-auto overflow-hidden border-2 border-gray-200 shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:[I.jsx("img",{src:e.image||"/placeholder.svg",alt:e.alt,className:"h-full w-full object-contain p-4",onError:e=>{const t=e.currentTarget;t.style.display="none";const s=t.nextElementSibling;s&&(s.style.display="flex")}}),I.jsx("div",{className:"hidden items-center justify-center text-gray-500 font-semibold text-center",children:e.name})]},t)})}),I.jsx("div",{className:"block sm:hidden",children:I.jsx(mt,{items:[{name:"LGU",image:"/images/partners/lgu-pt.png",alt:"Local Government Unit"},{name:"MDRRMO",image:"/images/partners/MDRRMO.png",alt:"MDRRMO  "},{name:"BFP",image:"/images/partners/bfp.jpg",alt:"Bureau of Fire Protection"},{name:"PNP",image:"/images/partners/pnp.jpg",alt:"Philippine National Police"},{name:"RedCross",image:"/images/partners/prc.png",alt:"Philippine Red Cross"},{name:"MHo",image:"/images/partners/mho.png",alt:"MHO"},{name:"MSWDO",image:"/images/partners/msdw.jpg",alt:"MSWDO"},{name:"MVM Hospital",image:"/images/partners/mvm.jpg",alt:"MVM Hospital"},{name:"BATELEC II - AREA II",image:"/images/partners/batelec.jpg",alt:"BATELEC II - AREA II"}],itemsPerView:2,autoPlay:!0,autoPlayInterval:3e3,showDots:!0,showArrows:!1,className:"opacity-90",itemClassName:"px-2",renderItem:(e,t)=>I.jsxs("div",{className:"h-32 w-32 bg-gray-50 rounded-2xl flex items-center justify-center mx-auto overflow-hidden border-2 border-gray-200 shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:[I.jsx("img",{src:e.image||"/placeholder.svg",alt:e.alt,className:"h-full w-full object-contain p-4",onError:e=>{const t=e.currentTarget;t.style.display="none";const s=t.nextElementSibling;s&&(s.style.display="flex")}}),I.jsx("div",{className:"hidden items-center justify-center text-gray-500 font-semibold text-center",children:e.name})]},t)})})]})}),I.jsx("section",{id:"faq-section",className:"bg-gradient-to-br from-slate-50 via-white to-blue-50 py-20 md:py-28",children:I.jsx("div",{className:"container mx-auto px-4 lg:px-8 max-w-7xl",children:I.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 md:gap-16 items-start",children:[I.jsx("div",{className:"space-y-8",children:I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute -top-4 -left-4 w-24 h-24 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full opacity-50"}),I.jsx("div",{className:"absolute -bottom-4 -right-4 w-16 h-16 bg-gradient-to-br from-green-100 to-blue-100 rounded-full opacity-50"}),I.jsxs("div",{className:"relative bg-white/80 backdrop-blur-sm rounded-3xl p-8 md:p-10 shadow-xl border border-white/20",children:[I.jsxs("div",{className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full mb-6",children:[I.jsx("i",{className:"ri-customer-service-2-line text-blue-600 mr-2"}),I.jsx("span",{className:"text-blue-700 font-semibold text-sm",children:"Support"})]}),I.jsxs("h3",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 mb-6 leading-tight",children:["Frequently Asked",I.jsx("span",{className:"block text-transparent bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text",children:"Questions"})]}),I.jsx("p",{className:"text-lg text-gray-600 leading-relaxed mb-8",children:"Everything you need to know about emergency services and disaster preparedness. Get instant answers to common questions about our emergency management platform."})]})]})}),I.jsx("div",{className:"space-y-4",children:[{q:"How do I report an emergency?",a:"Click Report Incident, describe the situation, and submit your location. Our team will respond immediately to your emergency report.",icon:"ri-error-warning-line",color:"from-red-500 to-pink-500"},{q:"Where can I find evacuation centers?",a:"Go to Evacuation Centers to see locations, capacity, and contact info. All centers are updated in real-time with current availability.",icon:"ri-building-2-line",color:"from-blue-500 to-cyan-500"},{q:"Do I need an account?",a:"Browsing is open; creating an account enables alerts and faster reporting. You can access most features without registration.",icon:"ri-user-line",color:"from-green-500 to-emerald-500"},{q:"What should I do during a typhoon?",a:"Stay indoors, avoid flooded areas, monitor weather updates, and follow evacuation orders if issued. Keep emergency supplies ready.",icon:"ri-typhoon-line",color:"from-orange-500 to-red-500"},{q:"How can I check if my family is safe?",a:"Use the Welfare Check feature to report your status and location during emergencies. This helps us track community safety.",icon:"ri-heart-pulse-line",color:"from-purple-500 to-pink-500"},{q:"What emergency numbers should I call?",a:"MDRRMO: (043) 311.2935, PNP: (043) 724.7026, BFP: (043) 312.1102. Click Emergency Hotline for full list of contacts.",icon:"ri-phone-line",color:"from-indigo-500 to-blue-500"},{q:"How do I prepare for disasters?",a:"Create an emergency kit, know evacuation routes, stay informed through our alerts, and follow safety protocols provided on our platform.",icon:"ri-shield-star-line",color:"from-teal-500 to-green-500"},{q:"Is this service available 24/7?",a:"Yes, our emergency reporting system is available 24/7. Emergency hotlines are also monitored around the clock for immediate response.",icon:"ri-time-line",color:"from-amber-500 to-orange-500"}].map((e,t)=>I.jsxs("div",{className:"group bg-white rounded-2xl border border-gray-100 hover:border-gray-200 hover:shadow-lg transition-all duration-300 overflow-hidden",children:[I.jsxs("button",{className:"w-full flex items-center justify-between p-6 text-left hover:bg-gray-50/50 transition-colors duration-200",onClick:()=>p(f===t?null:t),"aria-expanded":f===t,children:[I.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[I.jsx("div",{className:`w-12 h-12 bg-gradient-to-r ${e.color} rounded-xl flex items-center justify-center flex-shrink-0 group-hover:scale-110 transition-transform duration-200`,children:I.jsx("i",{className:`${e.icon} text-white text-lg`})}),I.jsx("span",{className:"font-semibold text-gray-900 text-lg pr-4 leading-tight",children:e.q})]}),I.jsx("div",{className:"w-10 h-10 bg-gray-100 hover:bg-gray-200 rounded-full flex items-center justify-center transition-all duration-200 flex-shrink-0 group-hover:scale-110",children:I.jsx("i",{className:`ri-${f===t?"subtract":"add"}-line text-gray-600 text-lg transition-transform duration-200`})})]}),f===t&&I.jsx("div",{className:"px-6 pb-6",children:I.jsx("div",{className:"ml-16 border-l-2 border-gray-100 pl-6",children:I.jsx("p",{className:"text-gray-600 text-base leading-relaxed",children:e.a})})})]},t))})]})})}),c&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:I.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md mx-4 shadow-2xl max-h-[90vh] flex flex-col",children:[I.jsx("div",{className:"bg-gradient-to-r from-red-600 to-red-700 text-white p-4 rounded-t-xl flex-shrink-0",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center mr-3",children:I.jsx("img",{src:"/images/partners/MDRRMO.png",alt:"MDRRMO Logo",className:"w-8 h-8 object-contain rounded-full"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-bold",children:"Emergency Hotlines"}),I.jsx("p",{className:"text-red-100 text-xs",children:"MDRRMO Rosario, Batangas"})]})]}),I.jsx("button",{onClick:()=>u(!1),className:"text-white hover:text-red-100 transition-colors p-2 hover:bg-white/20 rounded-lg",children:I.jsx("i",{className:"ri-close-line text-xl"})})]})}),I.jsx("div",{className:"flex-1 overflow-y-auto",children:I.jsxs("div",{className:"p-4",children:[I.jsxs("div",{className:"mb-6",children:[I.jsxs("h4",{className:"text-sm font-bold text-gray-800 mb-3 flex items-center",children:[I.jsx("i",{className:"ri-error-warning-line text-red-600 mr-2"}),"High Priority Contacts"]}),I.jsx("div",{className:"space-y-3",children:R.filter(e=>"high"===e.priority).map((e,t)=>I.jsx("div",{className:"border border-red-200 bg-red-50 rounded-lg p-3 transition-all hover:shadow-md hover:border-red-300",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[I.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0",children:I.jsx("img",{src:e.logo||"/placeholder.svg",alt:`${e.name} Logo`,className:"w-8 h-8 object-contain rounded-full"})}),I.jsxs("div",{className:"min-w-0 flex-1",children:[I.jsx("h5",{className:"font-semibold text-gray-900 text-sm mb-1 truncate",children:e.name}),I.jsx("p",{className:"text-xs text-gray-600 mb-2",children:e.description}),I.jsx("p",{className:"text-base font-bold text-red-600",children:e.number})]})]}),I.jsxs("a",{href:`tel:${e.number.replace(/\s/g,"")}`,className:"bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg font-semibold transition-all text-xs flex items-center ml-2 flex-shrink-0",children:[I.jsx("i",{className:"ri-phone-line mr-1"}),"Call"]})]})},t))})]}),I.jsxs("div",{className:"mb-6",children:[I.jsxs("h4",{className:"text-sm font-bold text-gray-800 mb-3 flex items-center",children:[I.jsx("i",{className:"ri-information-line text-blue-600 mr-2"}),"Support Contacts"]}),I.jsx("div",{className:"space-y-3",children:R.filter(e=>"medium"===e.priority).map((e,t)=>I.jsx("div",{className:"border border-blue-200 bg-blue-50 rounded-lg p-3 transition-all hover:shadow-md hover:border-blue-300",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0",children:I.jsx("img",{src:e.logo||"/placeholder.svg",alt:`${e.name} Logo`,className:"w-8 h-8 object-contain rounded-full"})}),I.jsxs("div",{className:"min-w-0 flex-1",children:[I.jsx("h5",{className:"font-semibold text-gray-900 text-sm mb-1 truncate",children:e.name}),I.jsx("p",{className:"text-xs text-gray-600 mb-2",children:e.description}),I.jsx("p",{className:"text-base font-bold text-blue-600",children:e.number})]})]}),I.jsxs("a",{href:`tel:${e.number.replace(/\s/g,"")}`,className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg font-semibold transition-all text-xs flex items-center ml-2 flex-shrink-0",children:[I.jsx("i",{className:"ri-phone-line mr-1"}),"Call"]})]})},t))})]}),I.jsx("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg p-4",children:I.jsxs("div",{className:"flex items-start",children:[I.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0",children:I.jsx("i",{className:"ri-information-line text-yellow-600 text-sm"})}),I.jsxs("div",{className:"flex-1",children:[I.jsx("h4",{className:"font-semibold text-yellow-800 text-sm mb-2",children:"Emergency Guidelines"}),I.jsxs("ul",{className:"text-xs text-yellow-700 space-y-1",children:[I.jsxs("li",{className:"flex items-start",children:[I.jsx("i",{className:"ri-check-line text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),"Stay calm and provide clear information"]}),I.jsxs("li",{className:"flex items-start",children:[I.jsx("i",{className:"ri-check-line text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),"Give your exact location and landmarks"]}),I.jsxs("li",{className:"flex items-start",children:[I.jsx("i",{className:"ri-check-line text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),"Follow emergency responder instructions"]})]})]})]})})]})}),I.jsx("div",{className:"bg-gray-50 p-4 rounded-b-xl border-t border-gray-200 flex-shrink-0",children:I.jsxs("div",{className:"flex justify-between items-center",children:[I.jsxs("div",{className:"flex items-center text-gray-600",children:[I.jsx("i",{className:"ri-time-line mr-2 text-blue-500 text-sm"}),I.jsx("span",{className:"text-xs font-medium",children:"24/7 Available"})]}),I.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors font-semibold text-sm shadow-md hover:shadow-lg",children:"Close"})]})})]})}),I.jsxs("footer",{className:"bg-gradient-to-br from-gray-900 to-gray-800 text-white",children:[I.jsx("div",{className:"py-16 md:py-20",children:I.jsx("div",{className:"container mx-auto px-4 lg:px-8 max-w-7xl",children:I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 md:gap-12",children:[I.jsxs("div",{className:"lg:col-span-2",children:[I.jsxs("div",{className:"flex items-center mb-6",children:[I.jsx("div",{className:"w-12 h-12  flex items-center justify-center mr-4",children:I.jsx("img",{src:"/images/partners/MDRRMO.png",alt:"Logo",className:"w-40 h-50 rounded-lg shadow-md object-contain"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-xl font-bold",children:"MDRRMO Rosario"}),I.jsx("p",{className:"text-gray-400 text-sm",children:"Batangas Province"})]})]}),I.jsx("p",{className:"text-gray-300 mb-6 leading-relaxed max-w-md",children:"Municipal Disaster Risk Reduction & Management Office committed to protecting and serving our community through comprehensive disaster preparedness and emergency response."}),I.jsxs("div",{className:"flex space-x-4",children:[I.jsx("a",{href:"https://www.facebook.com/RosarioMDRRMO",className:"w-10 h-10 bg-gray-700 hover:bg-blue-600 rounded-lg flex items-center justify-center transition-colors duration-300",children:I.jsx("i",{className:"ri-facebook-fill text-lg"})}),I.jsx("a",{href:"#",className:"w-10 h-10 bg-gray-700 hover:bg-blue-600 rounded-lg flex items-center justify-center transition-colors duration-300",children:I.jsx("i",{className:"ri-twitter-fill text-lg"})}),I.jsx("a",{href:"#",className:"w-10 h-10 bg-gray-700 hover:bg-blue-600 rounded-lg flex items-center justify-center transition-colors duration-300",children:I.jsx("i",{className:"ri-instagram-line text-lg"})})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-lg font-semibold mb-6",children:"Quick Links"}),I.jsxs("ul",{className:"space-y-3",children:[I.jsx("li",{children:I.jsx(r,{to:"/",onClick:()=>{setTimeout(()=>{window.scrollTo(0,0)},100)},className:"text-gray-300 hover:text-white transition-colors duration-300",children:"Home"})}),I.jsx("li",{children:I.jsx(r,{to:"/evacuation-center",className:"text-gray-300 hover:text-white transition-colors duration-300",children:"Evacuation Centers"})}),I.jsx("li",{children:I.jsx(r,{to:"/safety-protocols",className:"text-gray-300 hover:text-white transition-colors duration-300",children:"Safety Protocols"})}),I.jsx("li",{children:I.jsx(r,{to:"/incident-report",className:"text-gray-300 hover:text-white transition-colors duration-300",children:"Report Incident"})}),I.jsx("li",{children:I.jsx(r,{to:"/about",onClick:()=>{setTimeout(()=>{window.scrollTo(0,0)},100)},className:"text-gray-300 hover:text-white transition-colors duration-300",children:"About"})})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-lg font-semibold mb-6",children:"Contact Information"}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"flex items-start",children:[I.jsx("i",{className:"ri-map-pin-line text-blue-400 mt-1 mr-3"}),I.jsxs("div",{children:[I.jsx("p",{className:"text-gray-300 text-sm",children:"Municipal Hall, Rosario"}),I.jsx("p",{className:"text-gray-300 text-sm",children:"Batangas, Philippines"})]})]}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-phone-line text-blue-400 mr-3"}),I.jsx("p",{className:"text-gray-300 text-sm",children:"(043) 311.2935"})]}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-mail-line text-blue-400 mr-3"}),I.jsx("p",{className:"text-gray-300 text-sm",children:"mdrrmo@rosario.gov.ph"})]}),I.jsx("div",{className:"mt-6",children:I.jsx("button",{onClick:()=>u(!0),className:"bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg font-semibold transition-colors duration-300 text-sm",children:"Emergency Hotlines"})})]})]})]})})}),I.jsx("div",{className:"border-t border-gray-700 py-8",children:I.jsxs("div",{className:"container mx-auto px-4 lg:px-8 max-w-7xl",children:[I.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[I.jsx("div",{className:"text-gray-400 text-sm mb-4 md:mb-0",children:"© 2024 MDRRMO Rosario, Batangas. All rights reserved."}),I.jsxs("div",{className:"flex flex-wrap gap-6 text-sm",children:[I.jsx("button",{onClick:()=>h(!0),className:"text-gray-400 hover:text-white transition-colors duration-300",children:"Privacy Policy"}),I.jsx("button",{onClick:()=>g(!0),className:"text-gray-400 hover:text-white transition-colors duration-300",children:"Terms of Service"})]})]}),I.jsx("div",{className:"mt-4 text-center",children:I.jsxs("p",{className:"text-gray-500 text-sm",children:["Made with ",I.jsx("span",{className:"text-red-500",children:"❤️"})," in the Philippines"]})})]})})]}),I.jsx(xt,{isOpen:m,onClose:()=>h(!1)}),I.jsx(gt,{isOpen:x,onClose:()=>g(!1)})]})}function pt({label:e,type:t="text",placeholder:s,value:r,onChange:a,onBlur:i,error:l,required:o=!1,disabled:d=!1,name:c,id:u,autoComplete:m,icon:h}){const[x,g]=n.useState(!1),[f,p]=n.useState(!1),b="password"===t&&x?"text":t;return I.jsxs("div",{className:"w-full",children:[e&&I.jsxs("label",{htmlFor:u,className:"block text-sm font-medium text-gray-700 mb-1",children:[e," ",o&&I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsxs("div",{className:"relative",children:[h&&I.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:I.jsx("div",{className:"w-5 h-5 text-gray-400",children:h})}),I.jsx("input",{type:b,id:u,name:c,value:r,onChange:a,onFocus:()=>p(!0),onBlur:e=>{p(!1),i?.(e)},placeholder:s,required:o,disabled:d,autoComplete:m,className:`w-full px-3 py-2.5 text-sm border rounded-lg focus:ring-2 focus:outline-none transition-all duration-200 ${h?"pl-10":""} ${"password"===t?"pr-10":""} ${l?"border-red-300 focus:border-red-500 focus:ring-red-100":f?"border-blue-500 focus:ring-blue-100":"border-gray-300 hover:border-gray-400"} ${d?"bg-gray-50 cursor-not-allowed":"bg-white"}`}),"password"===t&&I.jsx("button",{type:"button",onClick:()=>g(!x),className:"absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer",children:I.jsx("div",{className:"w-5 h-5 text-gray-400 hover:text-gray-600",children:x?I.jsx("i",{className:"ri-eye-off-line"}):I.jsx("i",{className:"ri-eye-line"})})})]}),l&&I.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[I.jsx("i",{className:"ri-error-warning-line"}),l]})]})}function bt({label:e,checked:t,onChange:s,disabled:r=!1,name:a,id:n}){return I.jsxs("div",{className:"flex items-center",children:[I.jsx("input",{type:"checkbox",id:n,name:a,checked:t,onChange:e=>s(e.target.checked),disabled:r,className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 cursor-pointer disabled:cursor-not-allowed"}),I.jsx("label",{htmlFor:n,className:"ml-2 text-sm cursor-pointer "+(r?"text-gray-400 cursor-not-allowed":"text-gray-700"),children:e})]})}function yt(e,t={}){const[s,r]=n.useState(()=>{const t={};return Object.keys(e).forEach(s=>{t[s]={value:e[s],error:"",touched:!1}}),t}),[a,i]=n.useState(!1),l=n.useCallback((e,s)=>{const r=t[e];return r?r.required&&(!s||"string"==typeof s&&""===s.trim())?`${String(e)} is required`:r.minLength&&"string"==typeof s&&s.length<r.minLength?`${String(e)} must be at least ${r.minLength} characters`:r.maxLength&&"string"==typeof s&&s.length>r.maxLength?`${String(e)} must not exceed ${r.maxLength} characters`:r.pattern&&"string"==typeof s&&!r.pattern.test(s)?`${String(e)} format is invalid`:r.custom&&r.custom(s)||"":""},[t]),o=n.useCallback((e,t)=>{r(s=>({...s,[e]:{...s[e],value:t,error:l(e,t),touched:!0}}))},[l]),d=n.useCallback((e,t)=>{r(s=>({...s,[e]:{...s[e],error:t}}))},[]),c=n.useCallback(()=>{let e=!1;const t={...s};return Object.keys(s).forEach(r=>{const a=r,n=l(a,s[a].value);t[a]={...t[a],error:n,touched:!0},n&&(e=!0)}),r(t),!e},[s,l]),u=n.useCallback(()=>{const e={};return Object.keys(s).forEach(t=>{e[t]=s[t].value}),e},[s]),m=n.useCallback(()=>{const t={};Object.keys(e).forEach(s=>{t[s]={value:e[s],error:"",touched:!1}}),r(t),i(!1)},[e]);return{fields:s,setValue:o,setError:d,validateAll:c,getValues:u,reset:m,isSubmitting:a,setIsSubmitting:i}}function vt(){const e=a(),[t,s]=n.useState(!1),[i,l]=n.useState(!1),[o,d]=n.useState(""),{fields:c,setValue:u,validateAll:m,getValues:h,isSubmitting:x,setIsSubmitting:g}=yt({email:localStorage.getItem("rememberedEmail")||"",password:"",rememberMe:!!localStorage.getItem("rememberedEmail")},{email:{required:!0,pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/},password:{required:!0,minLength:6}});return I.jsxs(I.Fragment,{children:[I.jsx(ut,{}),I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center px-4 py-8 relative overflow-hidden",children:[I.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[I.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-blue-100 rounded-full opacity-20 animate-pulse"}),I.jsx("div",{className:"absolute -bottom-40 -left-40 w-96 h-96 bg-indigo-100 rounded-full opacity-20 animate-pulse delay-1000"}),I.jsx("div",{className:"absolute top-1/4 left-1/4 w-32 h-32 bg-purple-100 rounded-full opacity-10 animate-bounce delay-500"})]}),I.jsxs("div",{className:"w-full max-w-md relative z-10",children:[I.jsxs("div",{className:"text-center mb-8",children:[I.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-3xl flex items-center justify-center shadow-lg transform hover:scale-105 transition-transform duration-300",children:I.jsxs("div",{className:"relative",children:[I.jsx("i",{className:"ri-lock-line text-3xl text-white"}),I.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full animate-ping"}),I.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full"})]})}),I.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2 bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Welcome back"}),I.jsx("p",{className:"text-gray-600 text-lg",children:"Please sign in to your account"}),I.jsxs("div",{className:"mt-4 flex justify-center space-x-2",children:[I.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce"}),I.jsx("div",{className:"w-2 h-2 bg-indigo-400 rounded-full animate-bounce delay-100"}),I.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce delay-200"})]})]}),t&&I.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl shadow-sm animate-fadeIn",children:I.jsxs("div",{className:"flex items-center gap-3 text-green-800",children:[I.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-check-circle-line text-green-600"})}),I.jsx("span",{className:"text-sm font-medium",children:"Login successful! Redirecting to dashboard..."}),I.jsx("div",{className:"ml-auto",children:I.jsx("div",{className:"w-4 h-4 border-2 border-green-600 border-t-transparent rounded-full animate-spin"})})]})}),i&&I.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-xl shadow-sm animate-shake",children:I.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[I.jsx("div",{className:"w-6 h-6 bg-red-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-error-warning-line text-red-600"})}),I.jsx("span",{className:"text-sm font-medium",children:o})]})}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl p-8 border border-white/20",children:[I.jsxs("div",{className:"text-center mb-6",children:[I.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-2xl mb-3",children:I.jsx("i",{className:"ri-user-line text-blue-600 text-xl"})}),I.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Sign In"})]}),I.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),m()){g(!0),l(!1),s(!1);try{const t=h();let r=null,a=null,n=null;if(r=await V("/auth/login/user",{method:"POST",body:JSON.stringify({email:t.email,password:t.password})}),r&&r.success){const e="user",t="user";a={...r.user,role:e,userType:t,token:r.token},n=t}else r=await V("/auth/login/staff",{method:"POST",body:JSON.stringify({email:t.email,password:t.password})}),r&&r.success?(a={...r.staff,role:"staff",userType:"staff",token:r.token},n="staff"):(r=await V("/auth/login/admin",{method:"POST",body:JSON.stringify({email:t.email,password:t.password})}),r&&r.success&&(a={...r.admin,role:"admin",userType:"admin",token:r.token},n="admin"));if(a)return s(!0),sessionStorage.setItem("userInfo",JSON.stringify(a)),t.rememberMe?localStorage.setItem("rememberedEmail",t.email):localStorage.removeItem("rememberedEmail"),window.dispatchEvent(new Event("authStateChanged")),void setTimeout(()=>{"staff"===n?e("/staff"):"user"===n?e("/"):"admin"===a.role?e("/admin/dashboard"):e("/")},1500);d("Email or password is incorrect. Please try again."),l(!0)}catch(r){d("Login failed: "+(r instanceof Error?r.message:"Unknown error")),l(!0)}finally{g(!1),setTimeout(()=>l(!1),5e3)}}},className:"space-y-6",children:[I.jsx(pt,{label:"Email address",type:"email",name:"email",id:"email",value:c.email.value,onChange:e=>u("email",e.target.value),error:c.email.touched?c.email.error:"",placeholder:"Enter your email",required:!0,autoComplete:"email",icon:I.jsx("i",{className:"ri-mail-line"})}),I.jsx(pt,{label:"Password",type:"password",name:"password",id:"password",value:c.password.value,onChange:e=>u("password",e.target.value),error:c.password.touched?c.password.error:"",placeholder:"Enter your password",required:!0,autoComplete:"current-password",icon:I.jsx("i",{className:"ri-lock-line"})}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx(bt,{id:"rememberMe",name:"rememberMe",label:"Remember me",checked:c.rememberMe.value,onChange:e=>u("rememberMe",e)}),I.jsxs(r,{to:"/auth/forgot-password",className:"text-sm text-blue-600 hover:text-blue-500 cursor-pointer flex items-center gap-1 hover:gap-2 transition-all duration-200",children:[I.jsx("span",{children:"Forgot password?"}),I.jsx("i",{className:"ri-arrow-right-line text-xs"})]})]}),I.jsx(lt,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,disabled:x,children:x?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin"}),"Signing in..."]}):I.jsxs(I.Fragment,{children:[I.jsx("span",{children:"Sign in"}),I.jsx("i",{className:"ri-arrow-right-line ml-2 group-hover:translate-x-1 transition-transform duration-200"})]})})]}),I.jsxs("div",{className:"relative my-8",children:[I.jsx("div",{className:"absolute inset-0 flex items-center",children:I.jsx("div",{className:"w-full border-t border-gray-200"})}),I.jsx("div",{className:"relative flex justify-center text-sm",children:I.jsxs("span",{className:"px-4 bg-white text-gray-500 flex items-center gap-2",children:[I.jsx("div",{className:"w-1 h-1 bg-gray-300 rounded-full"}),I.jsx("span",{children:"or"}),I.jsx("div",{className:"w-1 h-1 bg-gray-300 rounded-full"})]})})]}),I.jsx("div",{className:"text-center",children:I.jsxs("p",{className:"text-sm text-gray-600 flex items-center justify-center gap-2",children:[I.jsx("i",{className:"ri-user-add-line text-gray-400"}),I.jsx("span",{children:"Don't have an account?"}),I.jsxs(r,{to:"/auth/signup",className:"font-medium text-blue-600 hover:text-blue-500 cursor-pointer flex items-center gap-1 hover:gap-2 transition-all duration-200",children:[I.jsx("span",{children:"Sign up"}),I.jsx("i",{className:"ri-arrow-right-line text-xs"})]})]})})]}),I.jsx("div",{className:"text-center mt-8",children:I.jsxs("div",{className:"flex justify-center items-center gap-4 text-gray-400",children:[I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("i",{className:"ri-shield-check-line"}),I.jsx("span",{className:"text-xs",children:"Secure"})]}),I.jsx("div",{className:"w-1 h-1 bg-gray-300 rounded-full"}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("i",{className:"ri-lock-line"}),I.jsx("span",{className:"text-xs",children:"Encrypted"})]}),I.jsx("div",{className:"w-1 h-1 bg-gray-300 rounded-full"}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("i",{className:"ri-verified-badge-line"}),I.jsx("span",{className:"text-xs",children:"Trusted"})]})]})})]})]})]})}function jt(){const[e,t]=n.useState(!1),[s,i]=n.useState(!1),[l,o]=n.useState(""),[d,c]=n.useState(!1),[u,m]=n.useState(!1),h=a(),{fields:x,setValue:g,validateAll:f,getValues:p,isSubmitting:b,setIsSubmitting:y,setError:v}=yt({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",userType:"CITIZEN",department:null,college:null,agreeToTerms:!1},{firstName:{required:!0,minLength:2},lastName:{required:!0,minLength:2},email:{required:!0,pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/},password:{required:!0,minLength:8,custom:e=>/(?=.*[a-z])/.test(e)?/(?=.*[A-Z])/.test(e)?/(?=.*\d)/.test(e)?null:"Password must contain at least one number":"Password must contain at least one uppercase letter":"Password must contain at least one lowercase letter"},department:{required:!1},college:{required:!1},confirmPassword:{required:!0,custom:e=>e!==x.password.value?"Passwords do not match":null},agreeToTerms:{custom:e=>e?null:"You must agree to the terms and conditions"}});return I.jsxs(I.Fragment,{children:[I.jsx(ut,{}),I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-emerald-50 flex items-center justify-center px-4 py-8 relative overflow-hidden",children:[I.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[I.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-green-200/30 to-emerald-300/20 rounded-full blur-3xl animate-pulse"}),I.jsx("div",{className:"absolute -bottom-40 -left-40 w-96 h-96 bg-gradient-to-tr from-emerald-200/20 to-green-300/30 rounded-full blur-3xl animate-pulse delay-1000"}),I.jsx("div",{className:"absolute top-1/4 left-1/4 w-32 h-32 bg-green-300/10 rounded-full blur-2xl animate-bounce delay-500"}),I.jsx("div",{className:"absolute bottom-1/3 right-1/3 w-24 h-24 bg-emerald-300/15 rounded-full blur-xl animate-bounce delay-700"}),I.jsx("div",{className:"absolute top-20 left-20 w-2 h-2 bg-green-400 rounded-full animate-ping delay-300"}),I.jsx("div",{className:"absolute top-40 right-32 w-1.5 h-1.5 bg-emerald-500 rounded-full animate-ping delay-700"}),I.jsx("div",{className:"absolute bottom-32 left-16 w-2.5 h-2.5 bg-green-300 rounded-full animate-ping delay-1000"}),I.jsx("div",{className:"absolute bottom-20 right-20 w-1 h-1 bg-emerald-400 rounded-full animate-ping delay-500"})]}),I.jsxs("div",{className:"w-full max-w-md relative z-10",children:[I.jsxs("div",{className:"text-center mb-8",children:[I.jsxs("div",{className:"w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-green-500 to-emerald-600 rounded-3xl flex items-center justify-center shadow-2xl shadow-green-500/25 transform hover:scale-105 transition-all duration-300 relative",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-green-400 to-emerald-500 rounded-3xl blur opacity-50 animate-pulse"}),I.jsx("i",{className:"ri-user-add-line text-3xl text-white relative z-10"}),I.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-yellow-400 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-star-fill text-xs text-yellow-800"})})]}),I.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-3 bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent",children:"Create your account"}),I.jsx("p",{className:"text-gray-600 text-lg",children:"Join our community and get started today"}),I.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 text-xs text-gray-500",children:[I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("i",{className:"ri-shield-check-line text-green-500"}),I.jsx("span",{children:"Secure"})]}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("i",{className:"ri-lock-line text-green-500"}),I.jsx("span",{children:"Encrypted"})]}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("i",{className:"ri-verified-badge-line text-green-500"}),I.jsx("span",{children:"Trusted"})]})]})]}),e&&I.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl shadow-lg backdrop-blur-sm",children:I.jsxs("div",{className:"flex items-center gap-3 text-green-800",children:[I.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-check-circle-line text-green-600"})}),I.jsxs("div",{children:[I.jsx("div",{className:"text-sm font-semibold",children:"Account created successfully!"}),I.jsx("div",{className:"text-xs mt-1 text-green-700",children:"Redirecting to login page... You can now login with your credentials."})]})]})}),s&&I.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-xl shadow-lg backdrop-blur-sm",children:I.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[I.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-error-warning-line text-red-600"})}),I.jsx("span",{className:"text-sm font-medium",children:l})]})}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl p-8 border border-white/20 relative overflow-hidden",children:[I.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-green-100/50 to-transparent rounded-full -translate-y-16 translate-x-16"}),I.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-emerald-100/50 to-transparent rounded-full translate-y-12 -translate-x-12"}),I.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),f()){y(!0),i(!1),t(!1);try{const e=p(),s=await V("/auth/register",{method:"POST",body:JSON.stringify({firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password,userType:e.userType,department:e.department,college:e.college})});if(s&&s.success)return t(!0),sessionStorage.setItem("lastRegisteredEmail",e.email),void setTimeout(()=>{h("/auth/login")},1500);{const e=s?.message||"Registration failed. Please try again.";e.toLowerCase().includes("email")&&e.toLowerCase().includes("exist")&&v("email","This email is already registered"),o(e),i(!0)}}catch(s){o("Login failed: "+(s instanceof Error?s.message:"Unknown error")),i(!0)}finally{y(!1),setTimeout(()=>i(!1),5e3)}}},className:"space-y-6 relative z-10",children:[I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsx(pt,{label:"First Name",type:"text",name:"firstName",id:"firstName",value:x.firstName.value,onChange:e=>g("firstName",e.target.value),error:x.firstName.touched?x.firstName.error:"",placeholder:"John",required:!0,autoComplete:"given-name",icon:I.jsx("i",{className:"ri-user-line"})}),I.jsx(pt,{label:"Last Name",type:"text",name:"lastName",id:"lastName",value:x.lastName.value,onChange:e=>g("lastName",e.target.value),error:x.lastName.touched?x.lastName.error:"",placeholder:"Doe",required:!0,autoComplete:"family-name",icon:I.jsx("i",{className:"ri-user-line"})})]}),I.jsx(pt,{label:"Email address",type:"email",name:"email",id:"email",value:x.email.value,onChange:e=>g("email",e.target.value),error:x.email.touched?x.email.error:"",placeholder:"john@example.com",required:!0,autoComplete:"email",icon:I.jsx("i",{className:"ri-mail-line"})}),I.jsxs("div",{className:"space-y-4",children:[I.jsx("div",{children:I.jsx("input",{type:"hidden",id:"userType",name:"userType",value:"CITIZEN"})}),"BARANGAY_STAFF"===x.userType.value&&I.jsx("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl shadow-sm",children:I.jsxs("p",{className:"text-sm text-blue-700 flex items-center gap-2",children:[I.jsx("i",{className:"ri-information-line text-blue-600"}),"Your account will need approval from an admin before you can access staff features."]})})]}),I.jsx(pt,{label:"Password",type:"password",name:"password",id:"password",value:x.password.value,onChange:e=>g("password",e.target.value),error:x.password.touched?x.password.error:"",placeholder:"Create a strong password",required:!0,autoComplete:"new-password",icon:I.jsx("i",{className:"ri-lock-line"})}),I.jsx(pt,{label:"Confirm Password",type:"password",name:"confirmPassword",id:"confirmPassword",value:x.confirmPassword.value,onChange:e=>g("confirmPassword",e.target.value),error:x.confirmPassword.touched?x.confirmPassword.error:"",placeholder:"Confirm your password",required:!0,autoComplete:"new-password",icon:I.jsx("i",{className:"ri-lock-line"})}),I.jsxs("div",{className:"space-y-3",children:[I.jsx(bt,{id:"agreeToTerms",name:"agreeToTerms",label:I.jsxs("span",{children:["I agree to the"," ",I.jsx("button",{type:"button",onClick:()=>c(!0),className:"text-green-600 hover:text-green-500 underline bg-transparent border-none p-0 font-medium transition-colors duration-200",children:"Terms of Service"})," ","and"," ",I.jsx("button",{type:"button",onClick:()=>m(!0),className:"text-green-600 hover:text-green-500 underline bg-transparent border-none p-0 font-medium transition-colors duration-200",children:"Privacy Policy"})]}),checked:x.agreeToTerms.value,onChange:e=>g("agreeToTerms",e)}),x.agreeToTerms.touched&&x.agreeToTerms.error&&I.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-2 bg-red-50 p-2 rounded-lg",children:[I.jsx("i",{className:"ri-error-warning-line"}),x.agreeToTerms.error]})]}),I.jsx(lt,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,disabled:b,className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 transform hover:scale-[1.02] transition-all duration-200 shadow-lg hover:shadow-xl",children:b?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin"}),"Creating account..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-user-add-line mr-2"}),"Create account"]})})]}),I.jsx("div",{className:"text-center mt-8",children:I.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",I.jsx(r,{to:"/auth/login",className:"font-semibold text-green-600 hover:text-green-500 cursor-pointer transition-colors duration-200 hover:underline",children:"Sign in"})]})})]})]}),I.jsx(gt,{isOpen:d,onClose:()=>c(!1)}),I.jsx(xt,{isOpen:u,onClose:()=>m(!1)})]})]})}function Nt(){const e=a(),[t,s]=n.useState(!1),[i,l]=n.useState(!1),{fields:o,setValue:d,validateAll:c,getValues:u,isSubmitting:m,setIsSubmitting:h}=yt({email:""},{email:{required:!0,pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/}});return I.jsxs(I.Fragment,{children:[I.jsx(ut,{}),I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-pink-50 flex items-center justify-center px-4 py-8 relative overflow-hidden",children:[I.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[I.jsx("div",{className:"absolute -top-40 -left-40 w-80 h-80 bg-gradient-to-br from-purple-200/30 to-pink-200/30 rounded-full blur-3xl animate-pulse"}),I.jsx("div",{className:"absolute -bottom-40 -right-40 w-80 h-80 bg-gradient-to-br from-blue-200/30 to-purple-200/30 rounded-full blur-3xl animate-pulse delay-1000"}),I.jsx("div",{className:"absolute top-1/4 right-1/4 w-32 h-32 bg-gradient-to-br from-pink-300/20 to-purple-300/20 rounded-full blur-2xl animate-bounce delay-500"}),I.jsx("div",{className:"absolute bottom-1/4 left-1/4 w-24 h-24 bg-gradient-to-br from-blue-300/20 to-pink-300/20 rounded-full blur-xl animate-bounce delay-700"}),I.jsx("div",{className:"absolute top-20 left-20 w-2 h-2 bg-purple-400/40 rounded-full animate-ping"}),I.jsx("div",{className:"absolute top-40 right-32 w-1 h-1 bg-pink-400/40 rounded-full animate-ping delay-300"}),I.jsx("div",{className:"absolute bottom-32 left-16 w-1.5 h-1.5 bg-blue-400/40 rounded-full animate-ping delay-700"}),I.jsx("div",{className:"absolute bottom-20 right-20 w-2 h-2 bg-purple-400/40 rounded-full animate-ping delay-1000"})]}),I.jsxs("div",{className:"w-full max-w-md relative z-10",children:[I.jsxs("div",{className:"text-center mb-8",children:[I.jsxs("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-purple-600 to-purple-700 rounded-2xl flex items-center justify-center shadow-lg shadow-purple-500/25 relative",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-400 to-purple-600 rounded-2xl blur opacity-50 animate-pulse"}),I.jsx("i",{className:"ri-key-line text-2xl text-white relative z-10"})]}),I.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:i?"Check your email":"Forgot your password?"}),I.jsx("p",{className:"text-gray-600",children:i?"We've sent a verification code to your email address":"Enter your email address and we'll send you a code to reset your password"})]}),t&&I.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg backdrop-blur-sm shadow-sm",children:I.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[I.jsx("i",{className:"ri-check-circle-line"}),I.jsx("span",{className:"text-sm font-medium",children:i?"Verification code sent again!":"Verification code sent to your email!"})]})}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-xl border border-white/20 p-8 relative",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent rounded-2xl"}),i?I.jsx(I.Fragment,{children:I.jsxs("div",{className:"text-center space-y-6 relative z-10",children:[I.jsxs("div",{className:"w-20 h-20 mx-auto bg-gradient-to-br from-green-100 to-emerald-100 rounded-full flex items-center justify-center shadow-lg shadow-green-500/10 relative",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-green-200/50 to-emerald-200/50 rounded-full blur animate-pulse"}),I.jsx("i",{className:"ri-mail-check-line text-3xl text-green-600 relative z-10"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("p",{className:"text-sm text-gray-600",children:"We sent a verification code to:"}),I.jsx("p",{className:"font-medium text-gray-900 bg-gray-50 px-3 py-2 rounded-lg inline-block",children:o.email.value})]}),I.jsxs("div",{className:"space-y-3",children:[I.jsx("p",{className:"text-sm text-gray-500",children:"Didn't receive the code? Check your spam folder or"}),I.jsx(lt,{variant:"outline",size:"md",fullWidth:!0,onClick:async()=>{h(!0);try{const e=u(),t=await fetch("/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email})}),r=await t.json();if(!t.ok||!r.success)throw new Error(r.message||"Failed to resend verification code");s(!0),setTimeout(()=>s(!1),3e3)}catch(e){alert("Failed to resend verification code. Please try again later.")}finally{h(!1)}},disabled:m,children:m?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin"}),"Resending..."]}):"Resend code"}),I.jsx(r,{to:"/auth/reset-password",children:I.jsx(lt,{variant:"primary",size:"md",fullWidth:!0,children:"Enter verification code"})})]})]})}):I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"absolute -top-2 -left-2 w-4 h-4 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full opacity-60"}),I.jsx("div",{className:"absolute -top-1 -right-3 w-2 h-2 bg-gradient-to-br from-blue-400 to-purple-400 rounded-full opacity-60"}),I.jsx("div",{className:"absolute -bottom-2 -right-2 w-3 h-3 bg-gradient-to-br from-pink-400 to-purple-400 rounded-full opacity-60"}),I.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),c()){h(!0);try{const t=u(),r=await fetch("/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t.email})}),a=await r.json();if(!r.ok||!a.success)throw new Error(a.message||"Failed to send verification code");l(!0),s(!0),setTimeout(()=>{e("/auth/verify-otp",{state:{email:t.email}})},2e3)}catch(r){alert("Failed to send verification code. Please try again later.")}finally{h(!1)}}},className:"space-y-6 relative z-10",children:[I.jsx(pt,{label:"Email address",type:"email",name:"email",id:"email",value:o.email.value,onChange:e=>d("email",e.target.value),error:o.email.touched?o.email.error:"",placeholder:"Enter your email address",required:!0,autoComplete:"email",icon:I.jsx("i",{className:"ri-mail-line"})}),I.jsx(lt,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,disabled:m,children:m?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin"}),"Sending verification code..."]}):"Send verification code"})]})]}),I.jsx("div",{className:"text-center mt-8 pt-6 border-t border-gray-100 relative z-10",children:I.jsxs(r,{to:"/auth/login",className:"inline-flex items-center gap-2 text-sm text-purple-600 hover:text-purple-500 cursor-pointer font-medium transition-colors duration-200 hover:bg-purple-50 px-3 py-2 rounded-lg",children:[I.jsx("i",{className:"ri-arrow-left-line"}),"Back to sign in"]})})]}),I.jsxs("div",{className:"flex justify-center items-center gap-6 mt-6 opacity-60",children:[I.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[I.jsx("i",{className:"ri-shield-check-line text-green-500"}),I.jsx("span",{children:"Secure"})]}),I.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[I.jsx("i",{className:"ri-lock-line text-blue-500"}),I.jsx("span",{children:"Encrypted"})]}),I.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[I.jsx("i",{className:"ri-verified-badge-line text-purple-500"}),I.jsx("span",{children:"Trusted"})]})]})]})]})]})}function wt(){const e=a(),t=i(),[s,l]=n.useState(!1),[o,d]=n.useState(""),c=t.state?.email||new URLSearchParams(t.search).get("email")||"",{fields:u,setValue:m,validateAll:h,getValues:x,isSubmitting:g,setIsSubmitting:f}=yt({otp:""},{otp:{required:!0,pattern:/^\d{6}$/}});return c?I.jsxs(I.Fragment,{children:[I.jsx(ut,{}),I.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center px-4 py-8",children:I.jsxs("div",{className:"w-full max-w-md",children:[I.jsxs("div",{className:"text-center mb-8",children:[I.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-600 rounded-2xl flex items-center justify-center",children:I.jsx("i",{className:"ri-shield-check-line text-2xl text-white"})}),I.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Verify your email"}),I.jsx("p",{className:"text-gray-600",children:"Enter the 6-digit code sent to your email"})]}),s&&I.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:I.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[I.jsx("i",{className:"ri-error-warning-line"}),I.jsx("span",{className:"text-sm font-medium",children:o})]})}),I.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[I.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!h())return;const s=x();f(!0),l(!1);try{const t=await fetch("/api/auth/verify-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c.toLowerCase(),otp:s.otp})}),r=await t.json();if(!t.ok||!r.success)throw new Error(r.message||"Invalid verification code");e("/auth/reset-password",{state:{email:c,otp:s.otp}})}catch(r){d(r instanceof Error?r.message:"Invalid verification code"),l(!0)}finally{f(!1),setTimeout(()=>l(!1),5e3)}},className:"space-y-6",children:[I.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[I.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Code sent to:"}),I.jsx("p",{className:"font-medium text-gray-900",children:c})]}),I.jsx(pt,{label:"Verification Code",type:"text",name:"otp",id:"otp",value:u.otp.value,onChange:e=>m("otp",e.target.value),error:u.otp.touched?u.otp.error:"",placeholder:"Enter 6-digit code",required:!0,icon:I.jsx("i",{className:"ri-lock-password-line"})}),I.jsx(lt,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,disabled:g,children:g?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin"}),"Verifying..."]}):"Verify code"})]}),I.jsxs("div",{className:"text-center mt-6",children:[I.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Didn't receive the code?"}),I.jsx(lt,{variant:"outline",size:"sm",onClick:async()=>{f(!0);try{const e=await fetch("/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c})}),t=await e.json();if(!e.ok||!t.success)throw new Error(t.message||"Failed to resend code");alert("Verification code sent again!")}catch(e){alert("Failed to resend verification code. Please try again later.")}finally{f(!1)}},disabled:g,children:"Resend code"})]}),I.jsx("div",{className:"text-center mt-8 pt-6 border-t border-gray-100",children:I.jsxs(r,{to:"/auth/forgot-password",className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-500 cursor-pointer font-medium",children:[I.jsx("i",{className:"ri-arrow-left-line"}),"Change email address"]})})]}),I.jsx("div",{className:"text-center mt-6",children:I.jsxs("p",{className:"text-xs text-gray-500",children:["Having trouble? Check your spam folder or contact"," ",I.jsx("a",{href:"mailto:support@example.com",className:"text-blue-600 hover:text-blue-500 cursor-pointer",children:"support"})]})})]})})]}):(e("/auth/forgot-password"),null)}function St(){const e=a(),t=i(),[s,l]=n.useState(!1),[o,d]=n.useState(!1),[c,u]=n.useState(""),m=t.state?.email||"",h=t.state?.otp||"",{fields:x,setValue:g,validateAll:f,getValues:p,isSubmitting:b,setIsSubmitting:y}=yt({password:"",confirmPassword:""},{password:{required:!0,minLength:6},confirmPassword:{required:!0}});if(!m||!h)return e("/auth/forgot-password"),null;return I.jsxs(I.Fragment,{children:[I.jsx(ut,{}),I.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-emerald-50 flex items-center justify-center px-4 py-8",children:I.jsxs("div",{className:"w-full max-w-md",children:[I.jsxs("div",{className:"text-center mb-8",children:[I.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-green-600 rounded-2xl flex items-center justify-center",children:I.jsx("i",{className:"ri-lock-password-line text-2xl text-white"})}),I.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Reset your password"}),I.jsx("p",{className:"text-gray-600",children:"Enter your new password below"}),I.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Email: ",I.jsx("span",{className:"font-medium",children:m})]})]}),s&&I.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:I.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[I.jsx("i",{className:"ri-check-circle-line"}),I.jsx("span",{className:"text-sm font-medium",children:"Password reset successful! Redirecting to login..."})]})}),o&&I.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:I.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[I.jsx("i",{className:"ri-error-warning-line"}),I.jsx("span",{className:"text-sm font-medium",children:c})]})}),I.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[I.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!f())return;const s=p();if(s.password!==s.confirmPassword)return u("Passwords do not match"),void d(!0);y(!0),d(!1),l(!1);try{const t=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:m.toLowerCase(),otp:h,newPassword:s.password})}),r=await t.json();if(!t.ok||!r.success)throw new Error(r.message||"Failed to reset password");l(!0),setTimeout(()=>{e("/auth/login")},2e3)}catch(r){u("Failed to reset password. Please try again."),d(!0)}finally{y(!1),setTimeout(()=>d(!1),5e3)}},className:"space-y-6",children:[I.jsx(pt,{label:"New Password",type:"password",name:"password",id:"password",value:x.password.value,onChange:e=>g("password",e.target.value),error:x.password.touched?x.password.error:"",placeholder:"Enter your new password",required:!0,autoComplete:"new-password",icon:I.jsx("i",{className:"ri-lock-line"})}),I.jsx(pt,{label:"Confirm New Password",type:"password",name:"confirmPassword",id:"confirmPassword",value:x.confirmPassword.value,onChange:e=>g("confirmPassword",e.target.value),error:x.confirmPassword.touched?x.confirmPassword.error:"",placeholder:"Confirm your new password",required:!0,autoComplete:"new-password",icon:I.jsx("i",{className:"ri-lock-line"})}),I.jsx(lt,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,disabled:b,children:b?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin"}),"Resetting password..."]}):"Reset password"})]}),I.jsx("div",{className:"text-center mt-8 pt-6 border-t border-gray-100",children:I.jsxs(r,{to:"/auth/login",className:"inline-flex items-center gap-2 text-sm text-green-600 hover:text-green-500 cursor-pointer font-medium",children:[I.jsx("i",{className:"ri-arrow-left-line"}),"Back to sign in"]})})]}),I.jsx("div",{className:"text-center mt-6",children:I.jsxs("p",{className:"text-xs text-gray-500",children:["Remember your password?"," ",I.jsx(r,{to:"/auth/login",className:"text-green-600 hover:text-green-500 cursor-pointer",children:"Sign in"})]})})]})})]})}const kt=(e={})=>{const[t,s]=n.useState({latitude:null,longitude:null,accuracy:null,error:null,loading:!1}),{enableHighAccuracy:r=!0,timeout:a=1e4,maximumAge:i=3e5}=e,l=()=>{navigator.geolocation?(s(e=>({...e,loading:!0,error:null})),navigator.geolocation.getCurrentPosition(e=>{s({latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy,error:null,loading:!1})},e=>{let t="An unknown error occurred.";switch(e.code){case e.PERMISSION_DENIED:t="Location access denied by user.";break;case e.POSITION_UNAVAILABLE:t="Location information is unavailable.";break;case e.TIMEOUT:t="Location request timed out."}s(e=>({...e,error:t,loading:!1}))},{enableHighAccuracy:r,timeout:a,maximumAge:i})):s(e=>({...e,error:"Geolocation is not supported by this browser.",loading:!1}))};return n.useEffect(()=>{navigator.geolocation&&l()},[]),{...t,getCurrentLocation:l,watchLocation:()=>{if(!navigator.geolocation)return s(e=>({...e,error:"Geolocation is not supported by this browser.",loading:!1})),null;s(e=>({...e,loading:!0,error:null}));return navigator.geolocation.watchPosition(e=>{s({latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy,error:null,loading:!1})},e=>{let t="An unknown error occurred.";switch(e.code){case e.PERMISSION_DENIED:t="Location access denied by user.";break;case e.POSITION_UNAVAILABLE:t="Location information is unavailable.";break;case e.TIMEOUT:t="Location request timed out."}s(e=>({...e,error:t,loading:!1}))},{enableHighAccuracy:r,timeout:a,maximumAge:i})},clearWatch:e=>{navigator.geolocation.clearWatch(e)},isSupported:!!navigator.geolocation}},Ct=n.createContext(void 0);function $t(){const e=n.useContext(Ct);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}function _t({children:e}){const[t,s]=n.useState([]),r=n.useRef(1),a=n.useCallback(e=>{s(t=>t.filter(t=>t.id!==e))},[]),i=n.useCallback(e=>{const t=r.current++,n={id:t,type:e.type??"info",title:e.title,message:e.message,durationMs:e.durationMs??3e3};s(e=>[...e,n]),n.durationMs>0&&window.setTimeout(()=>a(t),n.durationMs)},[a]),l=n.useMemo(()=>({showToast:i}),[i]);return I.jsxs(Ct.Provider,{value:l,children:[e,I.jsx(Pt,{toasts:t,onClose:a})]})}function At(e){switch(e){case"success":return"ri-checkbox-circle-fill";case"error":return"ri-error-warning-fill";case"warning":return"ri-alert-fill";default:return"ri-information-fill"}}function Pt({toasts:e,onClose:t}){return I.jsx("div",{className:"fixed top-6 right-6 z-[60] space-y-4",children:e.map((e,s)=>{const r=function(e){switch(e){case"success":return{bg:"bg-gradient-to-r from-emerald-50 to-green-50",text:"text-emerald-700",icon:"text-emerald-600",border:"border-emerald-200",accent:"bg-emerald-500"};case"error":return{bg:"bg-gradient-to-r from-red-50 to-rose-50",text:"text-red-700",icon:"text-red-600",border:"border-red-200",accent:"bg-red-500"};case"warning":return{bg:"bg-gradient-to-r from-amber-50 to-yellow-50",text:"text-amber-700",icon:"text-amber-600",border:"border-amber-200",accent:"bg-amber-500"};default:return{bg:"bg-gradient-to-r from-blue-50 to-indigo-50",text:"text-blue-700",icon:"text-blue-600",border:"border-blue-200",accent:"bg-blue-500"}}}(e.type);return I.jsxs("div",{className:`\n              relative flex items-start gap-4 p-5 rounded-xl shadow-xl backdrop-blur-sm\n              ${r.bg} ${r.border} border-2\n              min-w-[320px] max-w-md\n              transform transition-all duration-300 ease-out\n              animate-in slide-in-from-right-full fade-in\n              hover:shadow-2xl hover:scale-[1.02]\n            `,style:{animationDelay:100*s+"ms",animationFillMode:"both"},children:[I.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 rounded-l-xl ${r.accent}`}),I.jsx("div",{className:`flex-shrink-0 ${r.icon} mt-0.5`,children:I.jsx("i",{className:`${At(e.type)} text-2xl drop-shadow-sm`})}),I.jsxs("div",{className:"flex-1 min-w-0",children:[e.title&&I.jsx("div",{className:`font-semibold text-base ${r.text} mb-1 leading-tight`,children:e.title}),I.jsx("div",{className:`text-sm ${r.text} opacity-90 leading-relaxed`,children:e.message})]}),I.jsx("button",{className:`\n                flex-shrink-0 p-1.5 rounded-lg transition-all duration-200\n                ${r.text} opacity-60 hover:opacity-100 \n                hover:bg-white/20 hover:scale-110\n                focus:outline-none focus:ring-2 focus:ring-white/30\n              `,onClick:()=>t(e.id),"aria-label":"Close notification",children:I.jsx("i",{className:"ri-close-line text-lg"})})]},e.id)})})}async function Lt(e,t){try{const s=`/api/public/geocode?lat=${e}&lon=${t}`,r=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`Geocoding API error: ${r.status}`);const a=await r.json();if(!a.success||!a.display_name)return{success:!1,locationName:"Unknown Location",error:a.message||"No location data found"};const n=a.display_name;return{success:!0,locationName:n,detailedInfo:a.detailed_info?{barangay:a.detailed_info.barangay,municipality:a.detailed_info.municipality,province:a.detailed_info.province,region:a.detailed_info.region,coordinates:{latitude:a.detailed_info.coordinates.latitude,longitude:a.detailed_info.coordinates.longitude}}:void 0}}catch(s){return{success:!1,locationName:"Location Unavailable",error:s instanceof Error?s.message:"Unknown error occurred"}}}var Et=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function Tt(){return Tt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},Tt.apply(this,arguments)}function It(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ot(e,t){return(Ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Ft=function(e){var t,s;function r(){var t;return(t=e.call(this)||this).handleExpired=t.handleExpired.bind(It(t)),t.handleErrored=t.handleErrored.bind(It(t)),t.handleChange=t.handleChange.bind(It(t)),t.handleRecaptchaRef=t.handleRecaptchaRef.bind(It(t)),t}s=e,(t=r).prototype=Object.create(s.prototype),t.prototype.constructor=t,Ot(t,s);var a=r.prototype;return a.getCaptchaFunction=function(e){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[e]:this.props.grecaptcha[e]:null},a.getValue=function(){var e=this.getCaptchaFunction("getResponse");return e&&void 0!==this._widgetId?e(this._widgetId):null},a.getWidgetId=function(){return this.props.grecaptcha&&void 0!==this._widgetId?this._widgetId:null},a.execute=function(){var e=this.getCaptchaFunction("execute");if(e&&void 0!==this._widgetId)return e(this._widgetId);this._executeRequested=!0},a.executeAsync=function(){var e=this;return new Promise(function(t,s){e.executionResolve=t,e.executionReject=s,e.execute()})},a.reset=function(){var e=this.getCaptchaFunction("reset");e&&void 0!==this._widgetId&&e(this._widgetId)},a.forceReset=function(){var e=this.getCaptchaFunction("reset");e&&e()},a.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},a.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},a.handleChange=function(e){this.props.onChange&&this.props.onChange(e),this.executionResolve&&(this.executionResolve(e),delete this.executionReject,delete this.executionResolve)},a.explicitRender=function(){var e=this.getCaptchaFunction("render");if(e&&void 0===this._widgetId){var t=document.createElement("div");this._widgetId=e(t,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(t)}this._executeRequested&&this.props.grecaptcha&&void 0!==this._widgetId&&(this._executeRequested=!1,this.execute())},a.componentDidMount=function(){this.explicitRender()},a.componentDidUpdate=function(){this.explicitRender()},a.handleRecaptchaRef=function(e){this.captcha=e},a.render=function(){var e=this.props;e.sitekey,e.onChange,e.theme,e.type,e.tabindex,e.onExpired,e.onErrored,e.size,e.stoken,e.grecaptcha,e.badge,e.hl,e.isolated;var t=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,Et);return n.createElement("div",Tt({},t,{ref:this.handleRecaptchaRef}))},r}(n.Component);Ft.displayName="ReCAPTCHA",Ft.propTypes={sitekey:x.string.isRequired,onChange:x.func,grecaptcha:x.object,theme:x.oneOf(["dark","light"]),type:x.oneOf(["image","audio"]),tabindex:x.number,onExpired:x.func,onErrored:x.func,size:x.oneOf(["compact","normal","invisible"]),stoken:x.string,hl:x.string,badge:x.oneOf(["bottomright","bottomleft","inline"]),isolated:x.bool},Ft.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};var Rt,Dt,Mt,Bt,Ut={exports:{}},qt={};function zt(){return Dt||(Dt=1,Ut.exports=function(){if(Rt)return qt;Rt=1;var e="function"==typeof Symbol&&Symbol.for,t=e?Symbol.for("react.element"):60103,s=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,n=e?Symbol.for("react.profiler"):60114,i=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,o=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,c=e?Symbol.for("react.forward_ref"):60112,u=e?Symbol.for("react.suspense"):60113,m=e?Symbol.for("react.suspense_list"):60120,h=e?Symbol.for("react.memo"):60115,x=e?Symbol.for("react.lazy"):60116,g=e?Symbol.for("react.block"):60121,f=e?Symbol.for("react.fundamental"):60117,p=e?Symbol.for("react.responder"):60118,b=e?Symbol.for("react.scope"):60119;function y(e){if("object"==typeof e&&null!==e){var m=e.$$typeof;switch(m){case t:switch(e=e.type){case o:case d:case r:case n:case a:case u:return e;default:switch(e=e&&e.$$typeof){case l:case c:case x:case h:case i:return e;default:return m}}case s:return m}}}function v(e){return y(e)===d}return qt.AsyncMode=o,qt.ConcurrentMode=d,qt.ContextConsumer=l,qt.ContextProvider=i,qt.Element=t,qt.ForwardRef=c,qt.Fragment=r,qt.Lazy=x,qt.Memo=h,qt.Portal=s,qt.Profiler=n,qt.StrictMode=a,qt.Suspense=u,qt.isAsyncMode=function(e){return v(e)||y(e)===o},qt.isConcurrentMode=v,qt.isContextConsumer=function(e){return y(e)===l},qt.isContextProvider=function(e){return y(e)===i},qt.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},qt.isForwardRef=function(e){return y(e)===c},qt.isFragment=function(e){return y(e)===r},qt.isLazy=function(e){return y(e)===x},qt.isMemo=function(e){return y(e)===h},qt.isPortal=function(e){return y(e)===s},qt.isProfiler=function(e){return y(e)===n},qt.isStrictMode=function(e){return y(e)===a},qt.isSuspense=function(e){return y(e)===u},qt.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===d||e===n||e===a||e===u||e===m||"object"==typeof e&&null!==e&&(e.$$typeof===x||e.$$typeof===h||e.$$typeof===i||e.$$typeof===l||e.$$typeof===c||e.$$typeof===f||e.$$typeof===p||e.$$typeof===b||e.$$typeof===g)},qt.typeOf=y,qt}()),Ut.exports}const Wt=s(function(){if(Bt)return Mt;Bt=1;var e=zt(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function n(s){return e.isMemo(s)?r:a[s.$$typeof]||t}a[e.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[e.Memo]=r;var i=Object.defineProperty,l=Object.getOwnPropertyNames,o=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,c=Object.getPrototypeOf,u=Object.prototype;return Mt=function e(t,r,a){if("string"!=typeof r){if(u){var m=c(r);m&&m!==u&&e(t,m,a)}var h=l(r);o&&(h=h.concat(o(r)));for(var x=n(t),g=n(r),f=0;f<h.length;++f){var p=h[f];if(!(s[p]||a&&a[p]||g&&g[p]||x&&x[p])){var b=d(r,p);try{i(t,p,b)}catch(Nh){}}}}return t}}());function Vt(){return Vt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},Vt.apply(this,arguments)}var Ht={},Gt=0;var Jt="onloadcallback";function Kt(){return"undefined"!=typeof window&&window.recaptchaOptions||{}}const Yt=(Zt=function(){var e=Kt(),t=e.useRecaptchaNet?"recaptcha.net":"www.google.com";return e.enterprise?"https://"+t+"/recaptcha/enterprise.js?onload="+Jt+"&render=explicit":"https://"+t+"/recaptcha/api.js?onload="+Jt+"&render=explicit"},Xt=(Xt={callbackName:Jt,globalName:"grecaptcha",attributes:Kt().nonce?{nonce:Kt().nonce}:{}})||{},function(e){var t=e.displayName||e.name||"Component",s=function(t){var s,r;function a(e,s){var r;return(r=t.call(this,e,s)||this).state={},r.__scriptURL="",r}r=t,(s=a).prototype=Object.create(r.prototype),s.prototype.constructor=s,s.__proto__=r;var i=a.prototype;return i.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+Gt++),this.__scriptLoaderID},i.setupScriptURL=function(){return this.__scriptURL="function"==typeof Zt?Zt():Zt,this.__scriptURL},i.asyncScriptLoaderHandleLoad=function(e){var t=this;this.setState(e,function(){return t.props.asyncScriptOnLoad&&t.props.asyncScriptOnLoad(t.state)})},i.asyncScriptLoaderTriggerOnScriptLoaded=function(){var e=Ht[this.__scriptURL];if(!e||!e.loaded)throw new Error("Script is not loaded.");for(var t in e.observers)e.observers[t](e);delete window[Xt.callbackName]},i.componentDidMount=function(){var e=this,t=this.setupScriptURL(),s=this.asyncScriptLoaderGetScriptLoaderID(),r=Xt,a=r.globalName,n=r.callbackName,i=r.scriptId;if(a&&void 0!==window[a]&&(Ht[t]={loaded:!0,observers:{}}),Ht[t]){var l=Ht[t];return l&&(l.loaded||l.errored)?void this.asyncScriptLoaderHandleLoad(l):void(l.observers[s]=function(t){return e.asyncScriptLoaderHandleLoad(t)})}var o={};o[s]=function(t){return e.asyncScriptLoaderHandleLoad(t)},Ht[t]={loaded:!1,observers:o};var d=document.createElement("script");for(var c in d.src=t,d.async=!0,Xt.attributes)d.setAttribute(c,Xt.attributes[c]);i&&(d.id=i);var u=function(e){if(Ht[t]){var s=Ht[t].observers;for(var r in s)e(s[r])&&delete s[r]}};n&&"undefined"!=typeof window&&(window[n]=function(){return e.asyncScriptLoaderTriggerOnScriptLoaded()}),d.onload=function(){var e=Ht[t];e&&(e.loaded=!0,u(function(t){return!n&&(t(e),!0)}))},d.onerror=function(){var e=Ht[t];e&&(e.errored=!0,u(function(t){return t(e),!0}))},document.body.appendChild(d)},i.componentWillUnmount=function(){var e=this.__scriptURL;if(!0===Xt.removeOnUnmount)for(var t=document.getElementsByTagName("script"),s=0;s<t.length;s+=1)t[s].src.indexOf(e)>-1&&t[s].parentNode&&t[s].parentNode.removeChild(t[s]);var r=Ht[e];r&&(delete r.observers[this.asyncScriptLoaderGetScriptLoaderID()],!0===Xt.removeOnUnmount&&delete Ht[e])},i.render=function(){var t=Xt.globalName,s=this.props;s.asyncScriptOnLoad;var r=s.forwardedRef,a=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(s,["asyncScriptOnLoad","forwardedRef"]);return t&&"undefined"!=typeof window&&(a[t]=void 0!==window[t]?window[t]:void 0),a.ref=r,n.createElement(e,a)},a}(n.Component),r=n.forwardRef(function(e,t){return n.createElement(s,Vt({},e,{forwardedRef:t}))});return r.displayName="AsyncScriptLoader("+t+")",r.propTypes={asyncScriptOnLoad:x.func},Wt(r,e)})(Ft);var Zt,Xt;const Qt={version:4,country_calling_codes:{1:["US","AG","AI","AS","BB","BM","BS","CA","DM","DO","GD","GU","JM","KN","KY","LC","MP","MS","PR","SX","TC","TT","VC","VG","VI"],7:["RU","KZ"],20:["EG"],27:["ZA"],30:["GR"],31:["NL"],32:["BE"],33:["FR"],34:["ES"],36:["HU"],39:["IT","VA"],40:["RO"],41:["CH"],43:["AT"],44:["GB","GG","IM","JE"],45:["DK"],46:["SE"],47:["NO","SJ"],48:["PL"],49:["DE"],51:["PE"],52:["MX"],53:["CU"],54:["AR"],55:["BR"],56:["CL"],57:["CO"],58:["VE"],60:["MY"],61:["AU","CC","CX"],62:["ID"],63:["PH"],64:["NZ"],65:["SG"],66:["TH"],81:["JP"],82:["KR"],84:["VN"],86:["CN"],90:["TR"],91:["IN"],92:["PK"],93:["AF"],94:["LK"],95:["MM"],98:["IR"],211:["SS"],212:["MA","EH"],213:["DZ"],216:["TN"],218:["LY"],220:["GM"],221:["SN"],222:["MR"],223:["ML"],224:["GN"],225:["CI"],226:["BF"],227:["NE"],228:["TG"],229:["BJ"],230:["MU"],231:["LR"],232:["SL"],233:["GH"],234:["NG"],235:["TD"],236:["CF"],237:["CM"],238:["CV"],239:["ST"],240:["GQ"],241:["GA"],242:["CG"],243:["CD"],244:["AO"],245:["GW"],246:["IO"],247:["AC"],248:["SC"],249:["SD"],250:["RW"],251:["ET"],252:["SO"],253:["DJ"],254:["KE"],255:["TZ"],256:["UG"],257:["BI"],258:["MZ"],260:["ZM"],261:["MG"],262:["RE","YT"],263:["ZW"],264:["NA"],265:["MW"],266:["LS"],267:["BW"],268:["SZ"],269:["KM"],290:["SH","TA"],291:["ER"],297:["AW"],298:["FO"],299:["GL"],350:["GI"],351:["PT"],352:["LU"],353:["IE"],354:["IS"],355:["AL"],356:["MT"],357:["CY"],358:["FI","AX"],359:["BG"],370:["LT"],371:["LV"],372:["EE"],373:["MD"],374:["AM"],375:["BY"],376:["AD"],377:["MC"],378:["SM"],380:["UA"],381:["RS"],382:["ME"],383:["XK"],385:["HR"],386:["SI"],387:["BA"],389:["MK"],420:["CZ"],421:["SK"],423:["LI"],500:["FK"],501:["BZ"],502:["GT"],503:["SV"],504:["HN"],505:["NI"],506:["CR"],507:["PA"],508:["PM"],509:["HT"],590:["GP","BL","MF"],591:["BO"],592:["GY"],593:["EC"],594:["GF"],595:["PY"],596:["MQ"],597:["SR"],598:["UY"],599:["CW","BQ"],670:["TL"],672:["NF"],673:["BN"],674:["NR"],675:["PG"],676:["TO"],677:["SB"],678:["VU"],679:["FJ"],680:["PW"],681:["WF"],682:["CK"],683:["NU"],685:["WS"],686:["KI"],687:["NC"],688:["TV"],689:["PF"],690:["TK"],691:["FM"],692:["MH"],850:["KP"],852:["HK"],853:["MO"],855:["KH"],856:["LA"],880:["BD"],886:["TW"],960:["MV"],961:["LB"],962:["JO"],963:["SY"],964:["IQ"],965:["KW"],966:["SA"],967:["YE"],968:["OM"],970:["PS"],971:["AE"],972:["IL"],973:["BH"],974:["QA"],975:["BT"],976:["MN"],977:["NP"],992:["TJ"],993:["TM"],994:["AZ"],995:["GE"],996:["KG"],998:["UZ"]},countries:{AC:["247","00","(?:[01589]\\d|[46])\\d{4}",[5,6]],AD:["376","00","(?:1|6\\d)\\d{7}|[135-9]\\d{5}",[6,8,9],[["(\\d{3})(\\d{3})","$1 $2",["[135-9]"]],["(\\d{4})(\\d{4})","$1 $2",["1"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6"]]]],AE:["971","00","(?:[4-7]\\d|9[0-689])\\d{7}|800\\d{2,9}|[2-4679]\\d{7}",[5,6,7,8,9,10,11,12],[["(\\d{3})(\\d{2,9})","$1 $2",["60|8"]],["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[236]|[479][2-8]"],"0$1"],["(\\d{3})(\\d)(\\d{5})","$1 $2 $3",["[479]"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["5"],"0$1"]],"0"],AF:["93","00","[2-7]\\d{8}",[9],[["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[2-7]"],"0$1"]],"0"],AG:["1","011","(?:268|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([457]\\d{6})$|1","268$1",0,"268"],AI:["1","011","(?:264|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2457]\\d{6})$|1","264$1",0,"264"],AL:["355","00","(?:700\\d\\d|900)\\d{3}|8\\d{5,7}|(?:[2-5]|6\\d)\\d{7}",[6,7,8,9],[["(\\d{3})(\\d{3,4})","$1 $2",["80|9"],"0$1"],["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["4[2-6]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2358][2-5]|4"],"0$1"],["(\\d{3})(\\d{5})","$1 $2",["[23578]"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["6"],"0$1"]],"0"],AM:["374","00","(?:[1-489]\\d|55|60|77)\\d{6}",[8],[["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["[89]0"],"0 $1"],["(\\d{3})(\\d{5})","$1 $2",["2|3[12]"],"(0$1)"],["(\\d{2})(\\d{6})","$1 $2",["1|47"],"(0$1)"],["(\\d{2})(\\d{6})","$1 $2",["[3-9]"],"0$1"]],"0"],AO:["244","00","[29]\\d{8}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[29]"]]]],AR:["54","00","(?:11|[89]\\d\\d)\\d{8}|[2368]\\d{9}",[10,11],[["(\\d{4})(\\d{2})(\\d{4})","$1 $2-$3",["2(?:2[024-9]|3[0-59]|47|6[245]|9[02-8])|3(?:3[28]|4[03-9]|5[2-46-8]|7[1-578]|8[2-9])","2(?:[23]02|6(?:[25]|4[6-8])|9(?:[02356]|4[02568]|72|8[23]))|3(?:3[28]|4(?:[04679]|3[5-8]|5[4-68]|8[2379])|5(?:[2467]|3[237]|8[2-5])|7[1-578]|8(?:[2469]|3[2578]|5[4-8]|7[36-8]|8[5-8]))|2(?:2[24-9]|3[1-59]|47)","2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3[78]|5(?:4[46]|8)|8[2379])|5(?:[2467]|3[237]|8[23])|7[1-578]|8(?:[2469]|3[278]|5[56][46]|86[3-6]))|2(?:2[24-9]|3[1-59]|47)|38(?:[58][78]|7[378])|3(?:4[35][56]|58[45]|8(?:[38]5|54|76))[4-6]","2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3(?:5(?:4[0-25689]|[56])|[78])|58|8[2379])|5(?:[2467]|3[237]|8(?:[23]|4(?:[45]|60)|5(?:4[0-39]|5|64)))|7[1-578]|8(?:[2469]|3[278]|54(?:4|5[13-7]|6[89])|86[3-6]))|2(?:2[24-9]|3[1-59]|47)|38(?:[58][78]|7[378])|3(?:454|85[56])[46]|3(?:4(?:36|5[56])|8(?:[38]5|76))[4-6]"],"0$1",1],["(\\d{2})(\\d{4})(\\d{4})","$1 $2-$3",["1"],"0$1",1],["(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["[68]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2-$3",["[23]"],"0$1",1],["(\\d)(\\d{4})(\\d{2})(\\d{4})","$2 15-$3-$4",["9(?:2[2-469]|3[3-578])","9(?:2(?:2[024-9]|3[0-59]|47|6[245]|9[02-8])|3(?:3[28]|4[03-9]|5[2-46-8]|7[1-578]|8[2-9]))","9(?:2(?:[23]02|6(?:[25]|4[6-8])|9(?:[02356]|4[02568]|72|8[23]))|3(?:3[28]|4(?:[04679]|3[5-8]|5[4-68]|8[2379])|5(?:[2467]|3[237]|8[2-5])|7[1-578]|8(?:[2469]|3[2578]|5[4-8]|7[36-8]|8[5-8])))|92(?:2[24-9]|3[1-59]|47)","9(?:2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3[78]|5(?:4[46]|8)|8[2379])|5(?:[2467]|3[237]|8[23])|7[1-578]|8(?:[2469]|3[278]|5(?:[56][46]|[78])|7[378]|8(?:6[3-6]|[78]))))|92(?:2[24-9]|3[1-59]|47)|93(?:4[35][56]|58[45]|8(?:[38]5|54|76))[4-6]","9(?:2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3(?:5(?:4[0-25689]|[56])|[78])|5(?:4[46]|8)|8[2379])|5(?:[2467]|3[237]|8(?:[23]|4(?:[45]|60)|5(?:4[0-39]|5|64)))|7[1-578]|8(?:[2469]|3[278]|5(?:4(?:4|5[13-7]|6[89])|[56][46]|[78])|7[378]|8(?:6[3-6]|[78]))))|92(?:2[24-9]|3[1-59]|47)|93(?:4(?:36|5[56])|8(?:[38]5|76))[4-6]"],"0$1",0,"$1 $2 $3-$4"],["(\\d)(\\d{2})(\\d{4})(\\d{4})","$2 15-$3-$4",["91"],"0$1",0,"$1 $2 $3-$4"],["(\\d{3})(\\d{3})(\\d{5})","$1-$2-$3",["8"],"0$1"],["(\\d)(\\d{3})(\\d{3})(\\d{4})","$2 15-$3-$4",["9"],"0$1",0,"$1 $2 $3-$4"]],"0",0,"0?(?:(11|2(?:2(?:02?|[13]|2[13-79]|4[1-6]|5[2457]|6[124-8]|7[1-4]|8[13-6]|9[1267])|3(?:02?|1[467]|2[03-6]|3[13-8]|[49][2-6]|5[2-8]|[67])|4(?:7[3-578]|9)|6(?:[0136]|2[24-6]|4[6-8]?|5[15-8])|80|9(?:0[1-3]|[19]|2\\d|3[1-6]|4[02568]?|5[2-4]|6[2-46]|72?|8[23]?))|3(?:3(?:2[79]|6|8[2578])|4(?:0[0-24-9]|[12]|3[5-8]?|4[24-7]|5[4-68]?|6[02-9]|7[126]|8[2379]?|9[1-36-8])|5(?:1|2[1245]|3[237]?|4[1-46-9]|6[2-4]|7[1-6]|8[2-5]?)|6[24]|7(?:[069]|1[1568]|2[15]|3[145]|4[13]|5[14-8]|7[2-57]|8[126])|8(?:[01]|2[15-7]|3[2578]?|4[13-6]|5[4-8]?|6[1-357-9]|7[36-8]?|8[5-8]?|9[124])))15)?","9$1"],AS:["1","011","(?:[58]\\d\\d|684|900)\\d{7}",[10],0,"1",0,"([267]\\d{6})$|1","684$1",0,"684"],AT:["43","00","1\\d{3,12}|2\\d{6,12}|43(?:(?:0\\d|5[02-9])\\d{3,9}|2\\d{4,5}|[3467]\\d{4}|8\\d{4,6}|9\\d{4,7})|5\\d{4,12}|8\\d{7,12}|9\\d{8,12}|(?:[367]\\d|4[0-24-9])\\d{4,11}",[4,5,6,7,8,9,10,11,12,13],[["(\\d)(\\d{3,12})","$1 $2",["1(?:11|[2-9])"],"0$1"],["(\\d{3})(\\d{2})","$1 $2",["517"],"0$1"],["(\\d{2})(\\d{3,5})","$1 $2",["5[079]"],"0$1"],["(\\d{3})(\\d{3,10})","$1 $2",["(?:31|4)6|51|6(?:48|5[0-3579]|[6-9])|7(?:20|32|8)|[89]","(?:31|4)6|51|6(?:485|5[0-3579]|[6-9])|7(?:20|32|8)|[89]"],"0$1"],["(\\d{4})(\\d{3,9})","$1 $2",["[2-467]|5[2-6]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["5"],"0$1"],["(\\d{2})(\\d{4})(\\d{4,7})","$1 $2 $3",["5"],"0$1"]],"0"],AU:["61","001[14-689]|14(?:1[14]|34|4[17]|[56]6|7[47]|88)0011","1(?:[0-79]\\d{7}(?:\\d(?:\\d{2})?)?|8[0-24-9]\\d{7})|[2-478]\\d{8}|1\\d{4,7}",[5,6,7,8,9,10,12],[["(\\d{2})(\\d{3,4})","$1 $2",["16"],"0$1"],["(\\d{2})(\\d{3})(\\d{2,4})","$1 $2 $3",["16"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["14|4"],"0$1"],["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["[2378]"],"(0$1)"],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1(?:30|[89])"]]],"0",0,"(183[12])|0",0,0,0,[["(?:(?:2(?:(?:[0-26-9]\\d|3[0-8]|5[0135-9])\\d|4(?:[02-9]\\d|10))|3(?:(?:[0-3589]\\d|6[1-9]|7[0-35-9])\\d|4(?:[0-578]\\d|90))|7(?:[013-57-9]\\d|2[0-8])\\d)\\d\\d|8(?:51(?:0(?:0[03-9]|[12479]\\d|3[2-9]|5[0-8]|6[1-9]|8[0-7])|1(?:[0235689]\\d|1[0-69]|4[0-589]|7[0-47-9])|2(?:0[0-79]|[18][13579]|2[14-9]|3[0-46-9]|[4-6]\\d|7[89]|9[0-4])|[34]\\d\\d)|(?:6[0-8]|[78]\\d)\\d{3}|9(?:[02-9]\\d{3}|1(?:(?:[0-58]\\d|6[0135-9])\\d|7(?:0[0-24-9]|[1-9]\\d)|9(?:[0-46-9]\\d|5[0-79])))))\\d{3}",[9]],["4(?:79[01]|83[0-389]|94[0-478])\\d{5}|4(?:[0-36]\\d|4[047-9]|[58][0-24-9]|7[02-8]|9[0-37-9])\\d{6}",[9]],["180(?:0\\d{3}|2)\\d{3}",[7,10]],["190[0-26]\\d{6}",[10]],0,0,0,["163\\d{2,6}",[5,6,7,8,9]],["14(?:5(?:1[0458]|[23][458])|71\\d)\\d{4}",[9]],["13(?:00\\d{6}(?:\\d{2})?|45[0-4]\\d{3})|13\\d{4}",[6,8,10,12]]],"0011"],AW:["297","00","(?:[25-79]\\d\\d|800)\\d{4}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[25-9]"]]]],AX:["358","00|99(?:[01469]|5(?:[14]1|3[23]|5[59]|77|88|9[09]))","2\\d{4,9}|35\\d{4,5}|(?:60\\d\\d|800)\\d{4,6}|7\\d{5,11}|(?:[14]\\d|3[0-46-9]|50)\\d{4,8}",[5,6,7,8,9,10,11,12],0,"0",0,0,0,0,"18",0,"00"],AZ:["994","00","365\\d{6}|(?:[124579]\\d|60|88)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["90"],"0$1"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[28]|2|365|46","1[28]|2|365[45]|46","1[28]|2|365(?:4|5[02])|46"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[13-9]"],"0$1"]],"0"],BA:["387","00","6\\d{8}|(?:[35689]\\d|49|70)\\d{6}",[8,9],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["6[1-3]|[7-9]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2-$3",["[3-5]|6[56]"],"0$1"],["(\\d{2})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["6"],"0$1"]],"0"],BB:["1","011","(?:246|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","246$1",0,"246"],BD:["880","00","[1-469]\\d{9}|8[0-79]\\d{7,8}|[2-79]\\d{8}|[2-9]\\d{7}|[3-9]\\d{6}|[57-9]\\d{5}",[6,7,8,9,10],[["(\\d{2})(\\d{4,6})","$1-$2",["31[5-8]|[459]1"],"0$1"],["(\\d{3})(\\d{3,7})","$1-$2",["3(?:[67]|8[013-9])|4(?:6[168]|7|[89][18])|5(?:6[128]|9)|6(?:[15]|28|4[14])|7[2-589]|8(?:0[014-9]|[12])|9[358]|(?:3[2-5]|4[235]|5[2-578]|6[0389]|76|8[3-7]|9[24])1|(?:44|66)[01346-9]"],"0$1"],["(\\d{4})(\\d{3,6})","$1-$2",["[13-9]|2[23]"],"0$1"],["(\\d)(\\d{7,8})","$1-$2",["2"],"0$1"]],"0"],BE:["32","00","4\\d{8}|[1-9]\\d{7}",[8,9],[["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["(?:80|9)0"],"0$1"],["(\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[239]|4[23]"],"0$1"],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[15-8]"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["4"],"0$1"]],"0"],BF:["226","00","(?:[025-7]\\d|44)\\d{6}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[024-7]"]]]],BG:["359","00","00800\\d{7}|[2-7]\\d{6,7}|[89]\\d{6,8}|2\\d{5}",[6,7,8,9,12],[["(\\d)(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["2"],"0$1"],["(\\d{3})(\\d{4})","$1 $2",["43[1-6]|70[1-9]"],"0$1"],["(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["2"],"0$1"],["(\\d{2})(\\d{3})(\\d{2,3})","$1 $2 $3",["[356]|4[124-7]|7[1-9]|8[1-6]|9[1-7]"],"0$1"],["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["(?:70|8)0"],"0$1"],["(\\d{3})(\\d{3})(\\d{2})","$1 $2 $3",["43[1-7]|7"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[48]|9[08]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["9"],"0$1"]],"0"],BH:["973","00","[136-9]\\d{7}",[8],[["(\\d{4})(\\d{4})","$1 $2",["[13679]|8[02-4679]"]]]],BI:["257","00","(?:[267]\\d|31)\\d{6}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2367]"]]]],BJ:["229","00","(?:01\\d|[24-689])\\d{7}",[8,10],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[24-689]"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["0"]]]],BL:["590","00","(?:590\\d|7090)\\d{5}|(?:69|80|9\\d)\\d{7}",[9],0,"0",0,0,0,0,0,[["590(?:2[7-9]|3[3-7]|5[12]|87)\\d{4}"],["(?:69(?:0\\d\\d|1(?:2[2-9]|3[0-5])|4(?:0[89]|1[2-6]|9\\d)|6(?:1[016-9]|5[0-4]|[67]\\d))|7090[0-4])\\d{4}"],["80[0-5]\\d{6}"],0,0,0,0,0,["9(?:(?:39[5-7]|76[018])\\d|475[0-6])\\d{4}"]]],BM:["1","011","(?:441|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","441$1",0,"441"],BN:["673","00","[2-578]\\d{6}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[2-578]"]]]],BO:["591","00(?:1\\d)?","8001\\d{5}|(?:[2-467]\\d|50)\\d{6}",[8,9],[["(\\d)(\\d{7})","$1 $2",["[235]|4[46]"]],["(\\d{8})","$1",["[67]"]],["(\\d{3})(\\d{2})(\\d{4})","$1 $2 $3",["8"]]],"0",0,"0(1\\d)?"],BQ:["599","00","(?:[34]1|7\\d)\\d{5}",[7],0,0,0,0,0,0,"[347]"],BR:["55","00(?:1[245]|2[1-35]|31|4[13]|[56]5|99)","[1-467]\\d{9,10}|55[0-46-9]\\d{8}|[34]\\d{7}|55\\d{7,8}|(?:5[0-46-9]|[89]\\d)\\d{7,9}",[8,9,10,11],[["(\\d{4})(\\d{4})","$1-$2",["300|4(?:0[02]|37|86)","300|4(?:0(?:0|20)|370|864)"]],["(\\d{3})(\\d{2,3})(\\d{4})","$1 $2 $3",["(?:[358]|90)0"],"0$1"],["(\\d{2})(\\d{4})(\\d{4})","$1 $2-$3",["(?:[14689][1-9]|2[12478]|3[1-578]|5[13-5]|7[13-579])[2-57]"],"($1)"],["(\\d{2})(\\d{5})(\\d{4})","$1 $2-$3",["[16][1-9]|[2-57-9]"],"($1)"]],"0",0,"(?:0|90)(?:(1[245]|2[1-35]|31|4[13]|[56]5|99)(\\d{10,11}))?","$2"],BS:["1","011","(?:242|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([3-8]\\d{6})$|1","242$1",0,"242"],BT:["975","00","[178]\\d{7}|[2-8]\\d{6}",[7,8],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[2-6]|7[246]|8[2-4]"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[67]|[78]"]]]],BW:["267","00","(?:0800|(?:[37]|800)\\d)\\d{6}|(?:[2-6]\\d|90)\\d{5}",[7,8,10],[["(\\d{2})(\\d{5})","$1 $2",["90"]],["(\\d{3})(\\d{4})","$1 $2",["[24-6]|3[15-9]"]],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[37]"]],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["0"]],["(\\d{3})(\\d{4})(\\d{3})","$1 $2 $3",["8"]]]],BY:["375","810","(?:[12]\\d|33|44|902)\\d{7}|8(?:0[0-79]\\d{5,7}|[1-7]\\d{9})|8(?:1[0-489]|[5-79]\\d)\\d{7}|8[1-79]\\d{6,7}|8[0-79]\\d{5}|8\\d{5}",[6,7,8,9,10,11],[["(\\d{3})(\\d{3})","$1 $2",["800"],"8 $1"],["(\\d{3})(\\d{2})(\\d{2,4})","$1 $2 $3",["800"],"8 $1"],["(\\d{4})(\\d{2})(\\d{3})","$1 $2-$3",["1(?:5[169]|6[3-5]|7[179])|2(?:1[35]|2[34]|3[3-5])","1(?:5[169]|6(?:3[1-3]|4|5[125])|7(?:1[3-9]|7[0-24-6]|9[2-7]))|2(?:1[35]|2[34]|3[3-5])"],"8 0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2-$3-$4",["1(?:[56]|7[467])|2[1-3]"],"8 0$1"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2-$3-$4",["[1-4]"],"8 0$1"],["(\\d{3})(\\d{3,4})(\\d{4})","$1 $2 $3",["[89]"],"8 $1"]],"8",0,"0|80?",0,0,0,0,"8~10"],BZ:["501","00","(?:0800\\d|[2-8])\\d{6}",[7,11],[["(\\d{3})(\\d{4})","$1-$2",["[2-8]"]],["(\\d)(\\d{3})(\\d{4})(\\d{3})","$1-$2-$3-$4",["0"]]]],CA:["1","011","[2-9]\\d{9}|3\\d{6}",[7,10],0,"1",0,0,0,0,0,[["(?:2(?:04|[23]6|[48]9|5[07]|63)|3(?:06|43|54|6[578]|82)|4(?:03|1[68]|[26]8|3[178]|50|74)|5(?:06|1[49]|48|79|8[147])|6(?:04|[18]3|39|47|72)|7(?:0[59]|42|53|78|8[02])|8(?:[06]7|19|25|7[39])|9(?:0[25]|42))[2-9]\\d{6}",[10]],["",[10]],["8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",[10]],["900[2-9]\\d{6}",[10]],["52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|(?:5(?:2[125-9]|33|44|66|77|88)|6(?:22|33))[2-9]\\d{6}",[10]],0,["310\\d{4}",[7]],0,["600[2-9]\\d{6}",[10]]]],CC:["61","001[14-689]|14(?:1[14]|34|4[17]|[56]6|7[47]|88)0011","1(?:[0-79]\\d{8}(?:\\d{2})?|8[0-24-9]\\d{7})|[148]\\d{8}|1\\d{5,7}",[6,7,8,9,10,12],0,"0",0,"([59]\\d{7})$|0","8$1",0,0,[["8(?:51(?:0(?:02|31|60|89)|1(?:18|76)|223)|91(?:0(?:1[0-2]|29)|1(?:[28]2|50|79)|2(?:10|64)|3(?:[06]8|22)|4[29]8|62\\d|70[23]|959))\\d{3}",[9]],["4(?:79[01]|83[0-389]|94[0-478])\\d{5}|4(?:[0-36]\\d|4[047-9]|[58][0-24-9]|7[02-8]|9[0-37-9])\\d{6}",[9]],["180(?:0\\d{3}|2)\\d{3}",[7,10]],["190[0-26]\\d{6}",[10]],0,0,0,0,["14(?:5(?:1[0458]|[23][458])|71\\d)\\d{4}",[9]],["13(?:00\\d{6}(?:\\d{2})?|45[0-4]\\d{3})|13\\d{4}",[6,8,10,12]]],"0011"],CD:["243","00","(?:(?:[189]|5\\d)\\d|2)\\d{7}|[1-68]\\d{6}",[7,8,9,10],[["(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["88"],"0$1"],["(\\d{2})(\\d{5})","$1 $2",["[1-6]"],"0$1"],["(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["2"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[89]"],"0$1"],["(\\d{2})(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3 $4",["5"],"0$1"]],"0"],CF:["236","00","(?:[27]\\d{3}|8776)\\d{4}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[278]"]]]],CG:["242","00","222\\d{6}|(?:0\\d|80)\\d{7}",[9],[["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["8"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[02]"]]]],CH:["41","00","8\\d{11}|[2-9]\\d{8}",[9,12],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8[047]|90"],"0$1"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-79]|81"],"0$1"],["(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["8"],"0$1"]],"0"],CI:["225","00","[02]\\d{9}",[10],[["(\\d{2})(\\d{2})(\\d)(\\d{5})","$1 $2 $3 $4",["2"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3 $4",["0"]]]],CK:["682","00","[2-578]\\d{4}",[5],[["(\\d{2})(\\d{3})","$1 $2",["[2-578]"]]]],CL:["56","(?:0|1(?:1[0-69]|2[02-5]|5[13-58]|69|7[0167]|8[018]))0","12300\\d{6}|6\\d{9,10}|[2-9]\\d{8}",[9,10,11],[["(\\d{5})(\\d{4})","$1 $2",["219","2196"],"($1)"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["60|809"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["44"]],["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["2[1-36]"],"($1)"],["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["9(?:10|[2-9])"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["3[2-5]|[47]|5[1-3578]|6[13-57]|8(?:0[1-8]|[1-9])"],"($1)"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["60|8"]],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]],["(\\d{3})(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3 $4",["60"]]]],CM:["237","00","[26]\\d{8}|88\\d{6,7}",[8,9],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["88"]],["(\\d)(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["[26]|88"]]]],CN:["86","00|1(?:[12]\\d|79)\\d\\d00","(?:(?:1[03-689]|2\\d)\\d\\d|6)\\d{8}|1\\d{10}|[126]\\d{6}(?:\\d(?:\\d{2})?)?|86\\d{5,6}|(?:[3-579]\\d|8[0-57-9])\\d{5,9}",[7,8,9,10,11,12],[["(\\d{2})(\\d{5,6})","$1 $2",["(?:10|2[0-57-9])[19]|3(?:[157]|35|49|9[1-68])|4(?:1[124-9]|2[179]|6[47-9]|7|8[23])|5(?:[1357]|2[37]|4[36]|6[1-46]|80)|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:07|1[236-8]|2[5-7]|[37]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3|4[13]|5[1-5]|7[0-79]|9[0-35-9])|(?:4[35]|59|85)[1-9]","(?:10|2[0-57-9])(?:1[02]|9[56])|8078|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))1","10(?:1(?:0|23)|9[56])|2[0-57-9](?:1(?:00|23)|9[56])|80781|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))12","10(?:1(?:0|23)|9[56])|2[0-57-9](?:1(?:00|23)|9[56])|807812|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))123","10(?:1(?:0|23)|9[56])|2[0-57-9](?:1(?:00|23)|9[56])|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:078|1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))123"],"0$1"],["(\\d{3})(\\d{5,6})","$1 $2",["3(?:[157]|35|49|9[1-68])|4(?:[17]|2[179]|6[47-9]|8[23])|5(?:[1357]|2[37]|4[36]|6[1-46]|80)|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]|4[13]|5[1-5])|(?:4[35]|59|85)[1-9]","(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))[19]","85[23](?:10|95)|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))(?:10|9[56])","85[23](?:100|95)|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))(?:100|9[56])"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["(?:4|80)0"]],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["10|2(?:[02-57-9]|1[1-9])","10|2(?:[02-57-9]|1[1-9])","10[0-79]|2(?:[02-57-9]|1[1-79])|(?:10|21)8(?:0[1-9]|[1-9])"],"0$1",1],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["3(?:[3-59]|7[02-68])|4(?:[26-8]|3[3-9]|5[2-9])|5(?:3[03-9]|[468]|7[028]|9[2-46-9])|6|7(?:[0-247]|3[04-9]|5[0-4689]|6[2368])|8(?:[1-358]|9[1-7])|9(?:[013479]|5[1-5])|(?:[34]1|55|79|87)[02-9]"],"0$1",1],["(\\d{3})(\\d{7,8})","$1 $2",["9"]],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["80"],"0$1",1],["(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["[3-578]"],"0$1",1],["(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["1[3-9]"]],["(\\d{2})(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3 $4",["[12]"],"0$1",1]],"0",0,"(1(?:[12]\\d|79)\\d\\d)|0",0,0,0,0,"00"],CO:["57","00(?:4(?:[14]4|56)|[579])","(?:46|60\\d\\d)\\d{6}|(?:1\\d|[39])\\d{9}",[8,10,11],[["(\\d{4})(\\d{4})","$1 $2",["46"]],["(\\d{3})(\\d{7})","$1 $2",["6|90"],"($1)"],["(\\d{3})(\\d{7})","$1 $2",["3[0-357]|9[14]"]],["(\\d)(\\d{3})(\\d{7})","$1-$2-$3",["1"],"0$1",0,"$1 $2 $3"]],"0",0,"0([3579]|4(?:[14]4|56))?"],CR:["506","00","(?:8\\d|90)\\d{8}|(?:[24-8]\\d{3}|3005)\\d{4}",[8,10],[["(\\d{4})(\\d{4})","$1 $2",["[2-7]|8[3-9]"]],["(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["[89]"]]],0,0,"(19(?:0[0-2468]|1[09]|20|66|77|99))"],CU:["53","119","(?:[2-7]|8\\d\\d)\\d{7}|[2-47]\\d{6}|[34]\\d{5}",[6,7,8,10],[["(\\d{2})(\\d{4,6})","$1 $2",["2[1-4]|[34]"],"(0$1)"],["(\\d)(\\d{6,7})","$1 $2",["7"],"(0$1)"],["(\\d)(\\d{7})","$1 $2",["[56]"],"0$1"],["(\\d{3})(\\d{7})","$1 $2",["8"],"0$1"]],"0"],CV:["238","0","(?:[2-59]\\d\\d|800)\\d{4}",[7],[["(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["[2-589]"]]]],CW:["599","00","(?:[34]1|60|(?:7|9\\d)\\d)\\d{5}",[7,8],[["(\\d{3})(\\d{4})","$1 $2",["[3467]"]],["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["9[4-8]"]]],0,0,0,0,0,"[69]"],CX:["61","001[14-689]|14(?:1[14]|34|4[17]|[56]6|7[47]|88)0011","1(?:[0-79]\\d{8}(?:\\d{2})?|8[0-24-9]\\d{7})|[148]\\d{8}|1\\d{5,7}",[6,7,8,9,10,12],0,"0",0,"([59]\\d{7})$|0","8$1",0,0,[["8(?:51(?:0(?:01|30|59|88)|1(?:17|46|75)|2(?:22|35))|91(?:00[6-9]|1(?:[28]1|49|78)|2(?:09|63)|3(?:12|26|75)|4(?:56|97)|64\\d|7(?:0[01]|1[0-2])|958))\\d{3}",[9]],["4(?:79[01]|83[0-389]|94[0-478])\\d{5}|4(?:[0-36]\\d|4[047-9]|[58][0-24-9]|7[02-8]|9[0-37-9])\\d{6}",[9]],["180(?:0\\d{3}|2)\\d{3}",[7,10]],["190[0-26]\\d{6}",[10]],0,0,0,0,["14(?:5(?:1[0458]|[23][458])|71\\d)\\d{4}",[9]],["13(?:00\\d{6}(?:\\d{2})?|45[0-4]\\d{3})|13\\d{4}",[6,8,10,12]]],"0011"],CY:["357","00","(?:[279]\\d|[58]0)\\d{6}",[8],[["(\\d{2})(\\d{6})","$1 $2",["[257-9]"]]]],CZ:["420","00","(?:[2-578]\\d|60)\\d{7}|9\\d{8,11}",[9,10,11,12],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[2-8]|9[015-7]"]],["(\\d{2})(\\d{3})(\\d{3})(\\d{2})","$1 $2 $3 $4",["96"]],["(\\d{2})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["9"]],["(\\d{3})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["9"]]]],DE:["49","00","[2579]\\d{5,14}|49(?:[34]0|69|8\\d)\\d\\d?|49(?:37|49|60|7[089]|9\\d)\\d{1,3}|49(?:2[024-9]|3[2-689]|7[1-7])\\d{1,8}|(?:1|[368]\\d|4[0-8])\\d{3,13}|49(?:[015]\\d|2[13]|31|[46][1-8])\\d{1,9}",[4,5,6,7,8,9,10,11,12,13,14,15],[["(\\d{2})(\\d{3,13})","$1 $2",["3[02]|40|[68]9"],"0$1"],["(\\d{3})(\\d{3,12})","$1 $2",["2(?:0[1-389]|1[124]|2[18]|3[14])|3(?:[35-9][15]|4[015])|906|(?:2[4-9]|4[2-9]|[579][1-9]|[68][1-8])1","2(?:0[1-389]|12[0-8])|3(?:[35-9][15]|4[015])|906|2(?:[13][14]|2[18])|(?:2[4-9]|4[2-9]|[579][1-9]|[68][1-8])1"],"0$1"],["(\\d{4})(\\d{2,11})","$1 $2",["[24-6]|3(?:[3569][02-46-9]|4[2-4679]|7[2-467]|8[2-46-8])|70[2-8]|8(?:0[2-9]|[1-8])|90[7-9]|[79][1-9]","[24-6]|3(?:3(?:0[1-467]|2[127-9]|3[124578]|7[1257-9]|8[1256]|9[145])|4(?:2[135]|4[13578]|9[1346])|5(?:0[14]|2[1-3589]|6[1-4]|7[13468]|8[13568])|6(?:2[1-489]|3[124-6]|6[13]|7[12579]|8[1-356]|9[135])|7(?:2[1-7]|4[145]|6[1-5]|7[1-4])|8(?:21|3[1468]|6|7[1467]|8[136])|9(?:0[12479]|2[1358]|4[134679]|6[1-9]|7[136]|8[147]|9[1468]))|70[2-8]|8(?:0[2-9]|[1-8])|90[7-9]|[79][1-9]|3[68]4[1347]|3(?:47|60)[1356]|3(?:3[46]|46|5[49])[1246]|3[4579]3[1357]"],"0$1"],["(\\d{3})(\\d{4})","$1 $2",["138"],"0$1"],["(\\d{5})(\\d{2,10})","$1 $2",["3"],"0$1"],["(\\d{3})(\\d{5,11})","$1 $2",["181"],"0$1"],["(\\d{3})(\\d)(\\d{4,10})","$1 $2 $3",["1(?:3|80)|9"],"0$1"],["(\\d{3})(\\d{7,8})","$1 $2",["1[67]"],"0$1"],["(\\d{3})(\\d{7,12})","$1 $2",["8"],"0$1"],["(\\d{5})(\\d{6})","$1 $2",["185","1850","18500"],"0$1"],["(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["7"],"0$1"],["(\\d{4})(\\d{7})","$1 $2",["18[68]"],"0$1"],["(\\d{4})(\\d{7})","$1 $2",["15[1279]"],"0$1"],["(\\d{5})(\\d{6})","$1 $2",["15[03568]","15(?:[0568]|3[13])"],"0$1"],["(\\d{3})(\\d{8})","$1 $2",["18"],"0$1"],["(\\d{3})(\\d{2})(\\d{7,8})","$1 $2 $3",["1(?:6[023]|7)"],"0$1"],["(\\d{4})(\\d{2})(\\d{7})","$1 $2 $3",["15[279]"],"0$1"],["(\\d{3})(\\d{2})(\\d{8})","$1 $2 $3",["15"],"0$1"]],"0"],DJ:["253","00","(?:2\\d|77)\\d{6}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[27]"]]]],DK:["45","00","[2-9]\\d{7}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-9]"]]]],DM:["1","011","(?:[58]\\d\\d|767|900)\\d{7}",[10],0,"1",0,"([2-7]\\d{6})$|1","767$1",0,"767"],DO:["1","011","(?:[58]\\d\\d|900)\\d{7}",[10],0,"1",0,0,0,0,"8001|8[024]9"],DZ:["213","00","(?:[1-4]|[5-79]\\d|80)\\d{7}",[8,9],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[1-4]"],"0$1"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["9"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-8]"],"0$1"]],"0"],EC:["593","00","1\\d{9,10}|(?:[2-7]|9\\d)\\d{7}",[8,9,10,11],[["(\\d)(\\d{3})(\\d{4})","$1 $2-$3",["[2-7]"],"(0$1)",0,"$1-$2-$3"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["9"],"0$1"],["(\\d{4})(\\d{3})(\\d{3,4})","$1 $2 $3",["1"]]],"0"],EE:["372","00","8\\d{9}|[4578]\\d{7}|(?:[3-8]\\d|90)\\d{5}",[7,8,10],[["(\\d{3})(\\d{4})","$1 $2",["[369]|4[3-8]|5(?:[0-2]|5[0-478]|6[45])|7[1-9]|88","[369]|4[3-8]|5(?:[02]|1(?:[0-8]|95)|5[0-478]|6(?:4[0-4]|5[1-589]))|7[1-9]|88"]],["(\\d{4})(\\d{3,4})","$1 $2",["[45]|8(?:00|[1-49])","[45]|8(?:00[1-9]|[1-49])"]],["(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["7"]],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["8"]]]],EG:["20","00","[189]\\d{8,9}|[24-6]\\d{8}|[135]\\d{7}",[8,9,10],[["(\\d)(\\d{7,8})","$1 $2",["[23]"],"0$1"],["(\\d{2})(\\d{6,7})","$1 $2",["1[35]|[4-6]|8[2468]|9[235-7]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[89]"],"0$1"],["(\\d{2})(\\d{8})","$1 $2",["1"],"0$1"]],"0"],EH:["212","00","[5-8]\\d{8}",[9],0,"0",0,0,0,0,"528[89]"],ER:["291","00","[178]\\d{6}",[7],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[178]"],"0$1"]],"0"],ES:["34","00","[5-9]\\d{8}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[89]00"]],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-9]"]]]],ET:["251","00","(?:11|[2-579]\\d)\\d{7}",[9],[["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[1-579]"],"0$1"]],"0"],FI:["358","00|99(?:[01469]|5(?:[14]1|3[23]|5[59]|77|88|9[09]))","[1-35689]\\d{4}|7\\d{10,11}|(?:[124-7]\\d|3[0-46-9])\\d{8}|[1-9]\\d{5,8}",[5,6,7,8,9,10,11,12],[["(\\d{5})","$1",["20[2-59]"],"0$1"],["(\\d{3})(\\d{3,7})","$1 $2",["(?:[1-3]0|[68])0|70[07-9]"],"0$1"],["(\\d{2})(\\d{4,8})","$1 $2",["[14]|2[09]|50|7[135]"],"0$1"],["(\\d{2})(\\d{6,10})","$1 $2",["7"],"0$1"],["(\\d)(\\d{4,9})","$1 $2",["(?:19|[2568])[1-8]|3(?:0[1-9]|[1-9])|9"],"0$1"]],"0",0,0,0,0,"1[03-79]|[2-9]",0,"00"],FJ:["679","0(?:0|52)","45\\d{5}|(?:0800\\d|[235-9])\\d{6}",[7,11],[["(\\d{3})(\\d{4})","$1 $2",["[235-9]|45"]],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["0"]]],0,0,0,0,0,0,0,"00"],FK:["500","00","[2-7]\\d{4}",[5]],FM:["691","00","(?:[39]\\d\\d|820)\\d{4}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[389]"]]]],FO:["298","00","[2-9]\\d{5}",[6],[["(\\d{6})","$1",["[2-9]"]]],0,0,"(10(?:01|[12]0|88))"],FR:["33","00","[1-9]\\d{8}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0 $1"],["(\\d)(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["[1-79]"],"0$1"]],"0"],GA:["241","00","(?:[067]\\d|11)\\d{6}|[2-7]\\d{6}",[7,8],[["(\\d)(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-7]"],"0$1"],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["0"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["11|[67]"],"0$1"]],0,0,"0(11\\d{6}|60\\d{6}|61\\d{6}|6[256]\\d{6}|7[467]\\d{6})","$1"],GB:["44","00","[1-357-9]\\d{9}|[18]\\d{8}|8\\d{6}",[7,9,10],[["(\\d{3})(\\d{4})","$1 $2",["800","8001","80011","800111","8001111"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["845","8454","84546","845464"],"0$1"],["(\\d{3})(\\d{6})","$1 $2",["800"],"0$1"],["(\\d{5})(\\d{4,5})","$1 $2",["1(?:38|5[23]|69|76|94)","1(?:(?:38|69)7|5(?:24|39)|768|946)","1(?:3873|5(?:242|39[4-6])|(?:697|768)[347]|9467)"],"0$1"],["(\\d{4})(\\d{5,6})","$1 $2",["1(?:[2-69][02-9]|[78])"],"0$1"],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["[25]|7(?:0|6[02-9])","[25]|7(?:0|6(?:[03-9]|2[356]))"],"0$1"],["(\\d{4})(\\d{6})","$1 $2",["7"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[1389]"],"0$1"]],"0",0,"0|180020",0,0,0,[["(?:1(?:1(?:3(?:[0-58]\\d\\d|73[0-35])|4(?:(?:[0-5]\\d|70)\\d|69[7-9])|(?:(?:5[0-26-9]|[78][0-49])\\d|6(?:[0-4]\\d|50))\\d)|(?:2(?:(?:0[024-9]|2[3-9]|3[3-79]|4[1-689]|[58][02-9]|6[0-47-9]|7[013-9]|9\\d)\\d|1(?:[0-7]\\d|8[0-3]))|(?:3(?:0\\d|1[0-8]|[25][02-9]|3[02-579]|[468][0-46-9]|7[1-35-79]|9[2-578])|4(?:0[03-9]|[137]\\d|[28][02-57-9]|4[02-69]|5[0-8]|[69][0-79])|5(?:0[1-35-9]|[16]\\d|2[024-9]|3[015689]|4[02-9]|5[03-9]|7[0-35-9]|8[0-468]|9[0-57-9])|6(?:0[034689]|1\\d|2[0-35689]|[38][013-9]|4[1-467]|5[0-69]|6[13-9]|7[0-8]|9[0-24578])|7(?:0[0246-9]|2\\d|3[0236-8]|4[03-9]|5[0-46-9]|6[013-9]|7[0-35-9]|8[024-9]|9[02-9])|8(?:0[35-9]|2[1-57-9]|3[02-578]|4[0-578]|5[124-9]|6[2-69]|7\\d|8[02-9]|9[02569])|9(?:0[02-589]|[18]\\d|2[02-689]|3[1-57-9]|4[2-9]|5[0-579]|6[2-47-9]|7[0-24578]|9[2-57]))\\d)\\d)|2(?:0[013478]|3[0189]|4[017]|8[0-46-9]|9[0-2])\\d{3})\\d{4}|1(?:2(?:0(?:46[1-4]|87[2-9])|545[1-79]|76(?:2\\d|3[1-8]|6[1-6])|9(?:7(?:2[0-4]|3[2-5])|8(?:2[2-8]|7[0-47-9]|8[3-5])))|3(?:6(?:38[2-5]|47[23])|8(?:47[04-9]|64[0157-9]))|4(?:044[1-7]|20(?:2[23]|8\\d)|6(?:0(?:30|5[2-57]|6[1-8]|7[2-8])|140)|8(?:052|87[1-3]))|5(?:2(?:4(?:3[2-79]|6\\d)|76\\d)|6(?:26[06-9]|686))|6(?:06(?:4\\d|7[4-79])|295[5-7]|35[34]\\d|47(?:24|61)|59(?:5[08]|6[67]|74)|9(?:55[0-4]|77[23]))|7(?:26(?:6[13-9]|7[0-7])|(?:442|688)\\d|50(?:2[0-3]|[3-68]2|76))|8(?:27[56]\\d|37(?:5[2-5]|8[239])|843[2-58])|9(?:0(?:0(?:6[1-8]|85)|52\\d)|3583|4(?:66[1-8]|9(?:2[01]|81))|63(?:23|3[1-4])|9561))\\d{3}",[9,10]],["7(?:457[0-57-9]|700[01]|911[028])\\d{5}|7(?:[1-3]\\d\\d|4(?:[0-46-9]\\d|5[0-689])|5(?:0[0-8]|[13-9]\\d|2[0-35-9])|7(?:0[1-9]|[1-7]\\d|8[02-9]|9[0-689])|8(?:[014-9]\\d|[23][0-8])|9(?:[024-9]\\d|1[02-9]|3[0-689]))\\d{6}",[10]],["80[08]\\d{7}|800\\d{6}|8001111"],["(?:8(?:4[2-5]|7[0-3])|9(?:[01]\\d|8[2-49]))\\d{7}|845464\\d",[7,10]],["70\\d{8}",[10]],0,["(?:3[0347]|55)\\d{8}",[10]],["76(?:464|652)\\d{5}|76(?:0[0-28]|2[356]|34|4[01347]|5[49]|6[0-369]|77|8[14]|9[139])\\d{6}",[10]],["56\\d{8}",[10]]],0," x"],GD:["1","011","(?:473|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","473$1",0,"473"],GE:["995","00","(?:[3-57]\\d\\d|800)\\d{6}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["70"],"0$1"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["32"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[57]"]],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[348]"],"0$1"]],"0"],GF:["594","00","(?:[56]94\\d|7093)\\d{5}|(?:80|9\\d)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-7]|9[47]"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[89]"],"0$1"]],"0"],GG:["44","00","(?:1481|[357-9]\\d{3})\\d{6}|8\\d{6}(?:\\d{2})?",[7,9,10],0,"0",0,"([25-9]\\d{5})$|0|180020","1481$1",0,0,[["1481[25-9]\\d{5}",[10]],["7(?:(?:781|839)\\d|911[17])\\d{5}",[10]],["80[08]\\d{7}|800\\d{6}|8001111"],["(?:8(?:4[2-5]|7[0-3])|9(?:[01]\\d|8[0-3]))\\d{7}|845464\\d",[7,10]],["70\\d{8}",[10]],0,["(?:3[0347]|55)\\d{8}",[10]],["76(?:464|652)\\d{5}|76(?:0[0-28]|2[356]|34|4[01347]|5[49]|6[0-369]|77|8[14]|9[139])\\d{6}",[10]],["56\\d{8}",[10]]]],GH:["233","00","(?:[235]\\d{3}|800)\\d{5}",[8,9],[["(\\d{3})(\\d{5})","$1 $2",["8"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[235]"],"0$1"]],"0"],GI:["350","00","(?:[25]\\d|60)\\d{6}",[8],[["(\\d{3})(\\d{5})","$1 $2",["2"]]]],GL:["299","00","(?:19|[2-689]\\d|70)\\d{4}",[6],[["(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["19|[2-9]"]]]],GM:["220","00","[2-9]\\d{6}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[2-9]"]]]],GN:["224","00","722\\d{6}|(?:3|6\\d)\\d{7}",[8,9],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["3"]],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[67]"]]]],GP:["590","00","(?:590\\d|7090)\\d{5}|(?:69|80|9\\d)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-79]"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0$1"]],"0",0,0,0,0,0,[["590(?:0[1-68]|[14][0-24-9]|2[0-68]|3[1-9]|5[3-579]|[68][0-689]|7[08]|9\\d)\\d{4}"],["(?:69(?:0\\d\\d|1(?:2[2-9]|3[0-5])|4(?:0[89]|1[2-6]|9\\d)|6(?:1[016-9]|5[0-4]|[67]\\d))|7090[0-4])\\d{4}"],["80[0-5]\\d{6}"],0,0,0,0,0,["9(?:(?:39[5-7]|76[018])\\d|475[0-6])\\d{4}"]]],GQ:["240","00","222\\d{6}|(?:3\\d|55|[89]0)\\d{7}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[235]"]],["(\\d{3})(\\d{6})","$1 $2",["[89]"]]]],GR:["30","00","5005000\\d{3}|8\\d{9,11}|(?:[269]\\d|70)\\d{8}",[10,11,12],[["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["21|7"]],["(\\d{4})(\\d{6})","$1 $2",["2(?:2|3[2-57-9]|4[2-469]|5[2-59]|6[2-9]|7[2-69]|8[2-49])|5"]],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[2689]"]],["(\\d{3})(\\d{3,4})(\\d{5})","$1 $2 $3",["8"]]]],GT:["502","00","80\\d{6}|(?:1\\d{3}|[2-7])\\d{7}",[8,11],[["(\\d{4})(\\d{4})","$1 $2",["[2-8]"]],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]]]],GU:["1","011","(?:[58]\\d\\d|671|900)\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","671$1",0,"671"],GW:["245","00","[49]\\d{8}|4\\d{6}",[7,9],[["(\\d{3})(\\d{4})","$1 $2",["40"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[49]"]]]],GY:["592","001","(?:[2-8]\\d{3}|9008)\\d{3}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[2-9]"]]]],HK:["852","00(?:30|5[09]|[126-9]?)","8[0-46-9]\\d{6,7}|9\\d{4,7}|(?:[2-7]|9\\d{3})\\d{7}",[5,6,7,8,9,11],[["(\\d{3})(\\d{2,5})","$1 $2",["900","9003"]],["(\\d{4})(\\d{4})","$1 $2",["[2-7]|8[1-4]|9(?:0[1-9]|[1-8])"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8"]],["(\\d{3})(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3 $4",["9"]]],0,0,0,0,0,0,0,"00"],HN:["504","00","8\\d{10}|[237-9]\\d{7}",[8,11],[["(\\d{4})(\\d{4})","$1-$2",["[237-9]"]]]],HR:["385","00","[2-69]\\d{8}|80\\d{5,7}|[1-79]\\d{7}|6\\d{6}",[7,8,9],[["(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["6[01]"],"0$1"],["(\\d{3})(\\d{2})(\\d{2,3})","$1 $2 $3",["8"],"0$1"],["(\\d)(\\d{4})(\\d{3})","$1 $2 $3",["1"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["6|7[245]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["9"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-57]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8"],"0$1"]],"0"],HT:["509","00","[2-589]\\d{7}",[8],[["(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["[2-589]"]]]],HU:["36","00","[235-7]\\d{8}|[1-9]\\d{7}",[8,9],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["1"],"(06 $1)"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[27][2-9]|3[2-7]|4[24-9]|5[2-79]|6|8[2-57-9]|9[2-69]"],"(06 $1)"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-9]"],"06 $1"]],"06"],ID:["62","00[89]","00[1-9]\\d{9,14}|(?:[1-36]|8\\d{5})\\d{6}|00\\d{9}|[1-9]\\d{8,10}|[2-9]\\d{7}",[7,8,9,10,11,12,13,14,15,16,17],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["15"]],["(\\d{2})(\\d{5,9})","$1 $2",["2[124]|[36]1"],"(0$1)"],["(\\d{3})(\\d{5,7})","$1 $2",["800"],"0$1"],["(\\d{3})(\\d{5,8})","$1 $2",["[2-79]"],"(0$1)"],["(\\d{3})(\\d{3,4})(\\d{3})","$1-$2-$3",["8[1-35-9]"],"0$1"],["(\\d{3})(\\d{6,8})","$1 $2",["1"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["804"],"0$1"],["(\\d{3})(\\d)(\\d{3})(\\d{3})","$1 $2 $3 $4",["80"],"0$1"],["(\\d{3})(\\d{4})(\\d{4,5})","$1-$2-$3",["8"],"0$1"]],"0"],IE:["353","00","(?:1\\d|[2569])\\d{6,8}|4\\d{6,9}|7\\d{8}|8\\d{8,9}",[7,8,9,10],[["(\\d{2})(\\d{5})","$1 $2",["2[24-9]|47|58|6[237-9]|9[35-9]"],"(0$1)"],["(\\d{3})(\\d{5})","$1 $2",["[45]0"],"(0$1)"],["(\\d)(\\d{3,4})(\\d{4})","$1 $2 $3",["1"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2569]|4[1-69]|7[14]"],"(0$1)"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["70"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["81"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[78]"],"0$1"],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1"]],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["4"],"(0$1)"],["(\\d{2})(\\d)(\\d{3})(\\d{4})","$1 $2 $3 $4",["8"],"0$1"]],"0"],IL:["972","0(?:0|1[2-9])","1\\d{6}(?:\\d{3,5})?|[57]\\d{8}|[1-489]\\d{7}",[7,8,9,10,11,12],[["(\\d{4})(\\d{3})","$1-$2",["125"]],["(\\d{4})(\\d{2})(\\d{2})","$1-$2-$3",["121"]],["(\\d)(\\d{3})(\\d{4})","$1-$2-$3",["[2-489]"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["[57]"],"0$1"],["(\\d{4})(\\d{3})(\\d{3})","$1-$2-$3",["12"]],["(\\d{4})(\\d{6})","$1-$2",["159"]],["(\\d)(\\d{3})(\\d{3})(\\d{3})","$1-$2-$3-$4",["1[7-9]"]],["(\\d{3})(\\d{1,2})(\\d{3})(\\d{4})","$1-$2 $3-$4",["15"]]],"0"],IM:["44","00","1624\\d{6}|(?:[3578]\\d|90)\\d{8}",[10],0,"0",0,"([25-8]\\d{5})$|0|180020","1624$1",0,"74576|(?:16|7[56])24"],IN:["91","00","(?:000800|[2-9]\\d\\d)\\d{7}|1\\d{7,12}",[8,9,10,11,12,13],[["(\\d{8})","$1",["5(?:0|2[23]|3[03]|[67]1|88)","5(?:0|2(?:21|3)|3(?:0|3[23])|616|717|888)","5(?:0|2(?:21|3)|3(?:0|3[23])|616|717|8888)"],0,1],["(\\d{4})(\\d{4,5})","$1 $2",["180","1800"],0,1],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["140"],0,1],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["11|2[02]|33|4[04]|79[1-7]|80[2-46]","11|2[02]|33|4[04]|79(?:[1-6]|7[19])|80(?:[2-4]|6[0-589])","11|2[02]|33|4[04]|79(?:[124-6]|3(?:[02-9]|1[0-24-9])|7(?:1|9[1-6]))|80(?:[2-4]|6[0-589])"],"0$1",1],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["1(?:2[0-249]|3[0-25]|4[145]|[68]|7[1257])|2(?:1[257]|3[013]|4[01]|5[0137]|6[0158]|78|8[1568])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|5[12]|[78]1)|6(?:12|[2-4]1|5[17]|6[13]|80)|7(?:12|3[134]|4[47]|61|88)|8(?:16|2[014]|3[126]|6[136]|7[078]|8[34]|91)|(?:43|59|75)[15]|(?:1[59]|29|67|72)[14]","1(?:2[0-24]|3[0-25]|4[145]|[59][14]|6[1-9]|7[1257]|8[1-57-9])|2(?:1[257]|3[013]|4[01]|5[0137]|6[058]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|[578]1|9[15])|674|7(?:(?:2[14]|3[34]|5[15])[2-6]|61[346]|88[0-8])|8(?:70[2-6]|84[235-7]|91[3-7])|(?:1(?:29|60|8[06])|261|552|6(?:12|[2-47]1|5[17]|6[13]|80)|7(?:12|31|4[47])|8(?:16|2[014]|3[126]|6[136]|7[78]|83))[2-7]","1(?:2[0-24]|3[0-25]|4[145]|[59][14]|6[1-9]|7[1257]|8[1-57-9])|2(?:1[257]|3[013]|4[01]|5[0137]|6[058]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|[578]1|9[15])|6(?:12(?:[2-6]|7[0-8])|74[2-7])|7(?:(?:2[14]|5[15])[2-6]|3171|61[346]|88(?:[2-7]|82))|8(?:70[2-6]|84(?:[2356]|7[19])|91(?:[3-6]|7[19]))|73[134][2-6]|(?:74[47]|8(?:16|2[014]|3[126]|6[136]|7[78]|83))(?:[2-6]|7[19])|(?:1(?:29|60|8[06])|261|552|6(?:[2-4]1|5[17]|6[13]|7(?:1|4[0189])|80)|7(?:12|88[01]))[2-7]"],"0$1",1],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1(?:[2-479]|5[0235-9])|[2-5]|6(?:1[1358]|2[2457-9]|3[2-5]|4[235-7]|5[2-689]|6[24578]|7[235689]|8[1-6])|7(?:1[013-9]|28|3[129]|4[1-35689]|5[29]|6[02-5]|70)|807","1(?:[2-479]|5[0235-9])|[2-5]|6(?:1[1358]|2(?:[2457]|84|95)|3(?:[2-4]|55)|4[235-7]|5[2-689]|6[24578]|7[235689]|8[1-6])|7(?:1(?:[013-8]|9[6-9])|28[6-8]|3(?:17|2[0-49]|9[2-57])|4(?:1[2-4]|[29][0-7]|3[0-8]|[56]|8[0-24-7])|5(?:2[1-3]|9[0-6])|6(?:0[5689]|2[5-9]|3[02-8]|4|5[0-367])|70[13-7])|807[19]","1(?:[2-479]|5(?:[0236-9]|5[013-9]))|[2-5]|6(?:2(?:84|95)|355|83)|73179|807(?:1|9[1-3])|(?:1552|6(?:1[1358]|2[2457]|3[2-4]|4[235-7]|5[2-689]|6[24578]|7[235689]|8[124-6])\\d|7(?:1(?:[013-8]\\d|9[6-9])|28[6-8]|3(?:2[0-49]|9[2-57])|4(?:1[2-4]|[29][0-7]|3[0-8]|[56]\\d|8[0-24-7])|5(?:2[1-3]|9[0-6])|6(?:0[5689]|2[5-9]|3[02-8]|4\\d|5[0-367])|70[13-7]))[2-7]"],"0$1",1],["(\\d{5})(\\d{5})","$1 $2",["[6-9]"],"0$1",1],["(\\d{4})(\\d{2,4})(\\d{4})","$1 $2 $3",["1(?:6|8[06])","1(?:6|8[06]0)"],0,1],["(\\d{4})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["18"],0,1]],"0"],IO:["246","00","3\\d{6}",[7],[["(\\d{3})(\\d{4})","$1 $2",["3"]]]],IQ:["964","00","(?:1|7\\d\\d)\\d{7}|[2-6]\\d{7,8}",[8,9,10],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-6]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"0$1"]],"0"],IR:["98","00","[1-9]\\d{9}|(?:[1-8]\\d\\d|9)\\d{3,4}",[4,5,6,7,10],[["(\\d{4,5})","$1",["96"],"0$1"],["(\\d{2})(\\d{4,5})","$1 $2",["(?:1[137]|2[13-68]|3[1458]|4[145]|5[1468]|6[16]|7[1467]|8[13467])[12689]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["9"],"0$1"],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["[1-8]"],"0$1"]],"0"],IS:["354","00|1(?:0(?:01|[12]0)|100)","(?:38\\d|[4-9])\\d{6}",[7,9],[["(\\d{3})(\\d{4})","$1 $2",["[4-9]"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["3"]]],0,0,0,0,0,0,0,"00"],IT:["39","00","0\\d{5,11}|1\\d{8,10}|3(?:[0-8]\\d{7,10}|9\\d{7,8})|(?:43|55|70)\\d{8}|8\\d{5}(?:\\d{2,4})?",[6,7,8,9,10,11,12],[["(\\d{2})(\\d{4,6})","$1 $2",["0[26]"]],["(\\d{3})(\\d{3,6})","$1 $2",["0[13-57-9][0159]|8(?:03|4[17]|9[2-5])","0[13-57-9][0159]|8(?:03|4[17]|9(?:2|3[04]|[45][0-4]))"]],["(\\d{4})(\\d{2,6})","$1 $2",["0(?:[13-579][2-46-8]|8[236-8])"]],["(\\d{4})(\\d{4})","$1 $2",["894"]],["(\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["0[26]|5"]],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["1(?:44|[679])|[378]|43"]],["(\\d{3})(\\d{3,4})(\\d{4})","$1 $2 $3",["0[13-57-9][0159]|14"]],["(\\d{2})(\\d{4})(\\d{5})","$1 $2 $3",["0[26]"]],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["0"]],["(\\d{3})(\\d{4})(\\d{4,5})","$1 $2 $3",["[03]"]]],0,0,0,0,0,0,[["0(?:669[0-79]\\d{1,6}|831\\d{2,8})|0(?:1(?:[0159]\\d|[27][1-5]|31|4[1-4]|6[1356]|8[2-57])|2\\d\\d|3(?:[0159]\\d|2[1-4]|3[12]|[48][1-6]|6[2-59]|7[1-7])|4(?:[0159]\\d|[23][1-9]|4[245]|6[1-5]|7[1-4]|81)|5(?:[0159]\\d|2[1-5]|3[2-6]|4[1-79]|6[4-6]|7[1-578]|8[3-8])|6(?:[0-57-9]\\d|6[0-8])|7(?:[0159]\\d|2[12]|3[1-7]|4[2-46]|6[13569]|7[13-6]|8[1-59])|8(?:[0159]\\d|2[3-578]|3[2356]|[6-8][1-5])|9(?:[0159]\\d|[238][1-5]|4[12]|6[1-8]|7[1-6]))\\d{2,7}"],["3[2-9]\\d{7,8}|(?:31|43)\\d{8}",[9,10]],["80(?:0\\d{3}|3)\\d{3}",[6,9]],["(?:0878\\d{3}|89(?:2\\d|3[04]|4(?:[0-4]|[5-9]\\d\\d)|5[0-4]))\\d\\d|(?:1(?:44|6[346])|89(?:38|5[5-9]|9))\\d{6}",[6,8,9,10]],["1(?:78\\d|99)\\d{6}",[9,10]],["3[2-8]\\d{9,10}",[11,12]],0,0,["55\\d{8}",[10]],["84(?:[08]\\d{3}|[17])\\d{3}",[6,9]]]],JE:["44","00","1534\\d{6}|(?:[3578]\\d|90)\\d{8}",[10],0,"0",0,"([0-24-8]\\d{5})$|0|180020","1534$1",0,0,[["1534[0-24-8]\\d{5}"],["7(?:(?:(?:50|82)9|937)\\d|7(?:00[378]|97\\d))\\d{5}"],["80(?:07(?:35|81)|8901)\\d{4}"],["(?:8(?:4(?:4(?:4(?:05|42|69)|703)|5(?:041|800))|7(?:0002|1206))|90(?:066[59]|1810|71(?:07|55)))\\d{4}"],["701511\\d{4}"],0,["(?:3(?:0(?:07(?:35|81)|8901)|3\\d{4}|4(?:4(?:4(?:05|42|69)|703)|5(?:041|800))|7(?:0002|1206))|55\\d{4})\\d{4}"],["76(?:464|652)\\d{5}|76(?:0[0-28]|2[356]|34|4[01347]|5[49]|6[0-369]|77|8[14]|9[139])\\d{6}"],["56\\d{8}"]]],JM:["1","011","(?:[58]\\d\\d|658|900)\\d{7}",[10],0,"1",0,0,0,0,"658|876"],JO:["962","00","(?:(?:[2689]|7\\d)\\d|32|53)\\d{6}",[8,9],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[2356]|87"],"(0$1)"],["(\\d{3})(\\d{5,6})","$1 $2",["[89]"],"0$1"],["(\\d{2})(\\d{7})","$1 $2",["70"],"0$1"],["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["7"],"0$1"]],"0"],JP:["81","010","00[1-9]\\d{6,14}|[25-9]\\d{9}|(?:00|[1-9]\\d\\d)\\d{6}",[8,9,10,11,12,13,14,15,16,17],[["(\\d{3})(\\d{3})(\\d{3})","$1-$2-$3",["(?:12|57|99)0"],"0$1"],["(\\d{4})(\\d)(\\d{4})","$1-$2-$3",["1(?:26|3[79]|4[56]|5[4-68]|6[3-5])|499|5(?:76|97)|746|8(?:3[89]|47|51)|9(?:80|9[16])","1(?:267|3(?:7[247]|9[278])|466|5(?:47|58|64)|6(?:3[245]|48|5[4-68]))|499[2468]|5(?:76|97)9|7468|8(?:3(?:8[7-9]|96)|477|51[2-9])|9(?:802|9(?:1[23]|69))|1(?:45|58)[67]","1(?:267|3(?:7[247]|9[278])|466|5(?:47|58|64)|6(?:3[245]|48|5[4-68]))|499[2468]|5(?:769|979[2-69])|7468|8(?:3(?:8[7-9]|96[2457-9])|477|51[2-9])|9(?:802|9(?:1[23]|69))|1(?:45|58)[67]"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["60"],"0$1"],["(\\d)(\\d{4})(\\d{4})","$1-$2-$3",["3|4(?:2[09]|7[01])|6[1-9]","3|4(?:2(?:0|9[02-69])|7(?:0[019]|1))|6[1-9]"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["1(?:1|5[45]|77|88|9[69])|2(?:2[1-37]|3[0-269]|4[59]|5|6[24]|7[1-358]|8[1369]|9[0-38])|4(?:[28][1-9]|3[0-57]|[45]|6[248]|7[2-579]|9[29])|5(?:2|3[0459]|4[0-369]|5[29]|8[02389]|9[0-389])|7(?:2[02-46-9]|34|[58]|6[0249]|7[57]|9[2-6])|8(?:2[124589]|3[26-9]|49|51|6|7[0-468]|8[68]|9[019])|9(?:[23][1-9]|4[15]|5[138]|6[1-3]|7[156]|8[189]|9[1-489])","1(?:1|5(?:4[018]|5[017])|77|88|9[69])|2(?:2(?:[127]|3[014-9])|3[0-269]|4[59]|5(?:[1-3]|5[0-69]|9[19])|62|7(?:[1-35]|8[0189])|8(?:[16]|3[0134]|9[0-5])|9(?:[028]|17))|4(?:2(?:[13-79]|8[014-6])|3[0-57]|[45]|6[248]|7[2-47]|8[1-9]|9[29])|5(?:2|3(?:[045]|9[0-8])|4[0-369]|5[29]|8[02389]|9[0-3])|7(?:2[02-46-9]|34|[58]|6[0249]|7[57]|9(?:[23]|4[0-59]|5[01569]|6[0167]))|8(?:2(?:[1258]|4[0-39]|9[0-2469])|3(?:[29]|60)|49|51|6(?:[0-24]|36|5[0-3589]|7[23]|9[01459])|7[0-468]|8[68])|9(?:[23][1-9]|4[15]|5[138]|6[1-3]|7[156]|8[189]|9(?:[1289]|3[34]|4[0178]))|(?:264|837)[016-9]|2(?:57|93)[015-9]|(?:25[0468]|422|838)[01]|(?:47[59]|59[89]|8(?:6[68]|9))[019]","1(?:1|5(?:4[018]|5[017])|77|88|9[69])|2(?:2[127]|3[0-269]|4[59]|5(?:[1-3]|5[0-69]|9(?:17|99))|6(?:2|4[016-9])|7(?:[1-35]|8[0189])|8(?:[16]|3[0134]|9[0-5])|9(?:[028]|17))|4(?:2(?:[13-79]|8[014-6])|3[0-57]|[45]|6[248]|7[2-47]|9[29])|5(?:2|3(?:[045]|9(?:[0-58]|6[4-9]|7[0-35689]))|4[0-369]|5[29]|8[02389]|9[0-3])|7(?:2[02-46-9]|34|[58]|6[0249]|7[57]|9(?:[23]|4[0-59]|5[01569]|6[0167]))|8(?:2(?:[1258]|4[0-39]|9[0169])|3(?:[29]|60|7(?:[017-9]|6[6-8]))|49|51|6(?:[0-24]|36[2-57-9]|5(?:[0-389]|5[23])|6(?:[01]|9[178])|7(?:2[2-468]|3[78])|9[0145])|7[0-468]|8[68])|9(?:4[15]|5[138]|7[156]|8[189]|9(?:[1289]|3(?:31|4[357])|4[0178]))|(?:8294|96)[1-3]|2(?:57|93)[015-9]|(?:223|8699)[014-9]|(?:25[0468]|422|838)[01]|(?:48|8292|9[23])[1-9]|(?:47[59]|59[89]|8(?:68|9))[019]"],"0$1"],["(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3",["[14]|[289][2-9]|5[3-9]|7[2-4679]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["800"],"0$1"],["(\\d{2})(\\d{4})(\\d{4})","$1-$2-$3",["[25-9]"],"0$1"]],"0",0,"(000[2569]\\d{4,6})$|(?:(?:003768)0?)|0","$1"],KE:["254","000","(?:[17]\\d\\d|900)\\d{6}|(?:2|80)0\\d{6,7}|[4-6]\\d{6,8}",[7,8,9,10],[["(\\d{2})(\\d{5,7})","$1 $2",["[24-6]"],"0$1"],["(\\d{3})(\\d{6})","$1 $2",["[17]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["[89]"],"0$1"]],"0"],KG:["996","00","8\\d{9}|[235-9]\\d{8}",[9,10],[["(\\d{4})(\\d{5})","$1 $2",["3(?:1[346]|[24-79])"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[235-79]|88"],"0$1"],["(\\d{3})(\\d{3})(\\d)(\\d{2,3})","$1 $2 $3 $4",["8"],"0$1"]],"0"],KH:["855","00[14-9]","1\\d{9}|[1-9]\\d{7,8}",[8,9,10],[["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[1-9]"],"0$1"],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1"]]],"0"],KI:["686","00","(?:[37]\\d|6[0-79])\\d{6}|(?:[2-48]\\d|50)\\d{3}",[5,8],0,"0"],KM:["269","00","[3478]\\d{6}",[7],[["(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["[3478]"]]]],KN:["1","011","(?:[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-7]\\d{6})$|1","869$1",0,"869"],KP:["850","00|99","85\\d{6}|(?:19\\d|[2-7])\\d{7}",[8,10],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["8"],"0$1"],["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[2-7]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"]],"0"],KR:["82","00(?:[125689]|3(?:[46]5|91)|7(?:00|27|3|55|6[126]))","00[1-9]\\d{8,11}|(?:[12]|5\\d{3})\\d{7}|[13-6]\\d{9}|(?:[1-6]\\d|80)\\d{7}|[3-6]\\d{4,5}|(?:00|7)0\\d{8}",[5,6,8,9,10,11,12,13,14],[["(\\d{2})(\\d{3,4})","$1-$2",["(?:3[1-3]|[46][1-4]|5[1-5])1"],"0$1"],["(\\d{4})(\\d{4})","$1-$2",["1"]],["(\\d)(\\d{3,4})(\\d{4})","$1-$2-$3",["2"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["[36]0|8"],"0$1"],["(\\d{2})(\\d{3,4})(\\d{4})","$1-$2-$3",["[1346]|5[1-5]"],"0$1"],["(\\d{2})(\\d{4})(\\d{4})","$1-$2-$3",["[57]"],"0$1"],["(\\d{2})(\\d{5})(\\d{4})","$1-$2-$3",["5"],"0$1"]],"0",0,"0(8(?:[1-46-8]|5\\d\\d))?"],KW:["965","00","18\\d{5}|(?:[2569]\\d|41)\\d{6}",[7,8],[["(\\d{4})(\\d{3,4})","$1 $2",["[169]|2(?:[235]|4[1-35-9])|52"]],["(\\d{3})(\\d{5})","$1 $2",["[245]"]]]],KY:["1","011","(?:345|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","345$1",0,"345"],KZ:["7","810","(?:33622|8\\d{8})\\d{5}|[78]\\d{9}",[10,14],0,"8",0,0,0,0,"33622|7",0,"8~10"],LA:["856","00","[23]\\d{9}|3\\d{8}|(?:[235-8]\\d|41)\\d{6}",[8,9,10],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["2[13]|3[14]|[4-8]"],"0$1"],["(\\d{2})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["3"],"0$1"],["(\\d{2})(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3 $4",["[23]"],"0$1"]],"0"],LB:["961","00","[27-9]\\d{7}|[13-9]\\d{6}",[7,8],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[13-69]|7(?:[2-57]|62|8[0-6]|9[04-9])|8[02-9]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[27-9]"]]],"0"],LC:["1","011","(?:[58]\\d\\d|758|900)\\d{7}",[10],0,"1",0,"([2-8]\\d{6})$|1","758$1",0,"758"],LI:["423","00","[68]\\d{8}|(?:[2378]\\d|90)\\d{5}",[7,9],[["(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["[2379]|8(?:0[09]|7)","[2379]|8(?:0(?:02|9)|7)"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["69"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6"]]],"0",0,"(1001)|0"],LK:["94","00","[1-9]\\d{8}",[9],[["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[1-689]"],"0$1"]],"0"],LR:["231","00","(?:[2457]\\d|33|88)\\d{7}|(?:2\\d|[4-6])\\d{6}",[7,8,9],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["4[67]|[56]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["2"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[2-578]"],"0$1"]],"0"],LS:["266","00","(?:[256]\\d\\d|800)\\d{5}",[8],[["(\\d{4})(\\d{4})","$1 $2",["[2568]"]]]],LT:["370","00","(?:[3469]\\d|52|[78]0)\\d{6}",[8],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["52[0-7]"],"(0-$1)",1],["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["[7-9]"],"0 $1",1],["(\\d{2})(\\d{6})","$1 $2",["37|4(?:[15]|6[1-8])"],"(0-$1)",1],["(\\d{3})(\\d{5})","$1 $2",["[3-6]"],"(0-$1)",1]],"0",0,"[08]"],LU:["352","00","35[013-9]\\d{4,8}|6\\d{8}|35\\d{2,4}|(?:[2457-9]\\d|3[0-46-9])\\d{2,9}",[4,5,6,7,8,9,10,11],[["(\\d{2})(\\d{3})","$1 $2",["2(?:0[2-689]|[2-9])|[3-57]|8(?:0[2-9]|[13-9])|9(?:0[89]|[2-579])"]],["(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["2(?:0[2-689]|[2-9])|[3-57]|8(?:0[2-9]|[13-9])|9(?:0[89]|[2-579])"]],["(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["20[2-689]"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{1,2})","$1 $2 $3 $4",["2(?:[0367]|4[3-8])"]],["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["80[01]|90[015]"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["20"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{1,2})","$1 $2 $3 $4 $5",["2(?:[0367]|4[3-8])"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{1,5})","$1 $2 $3 $4",["[3-57]|8[13-9]|9(?:0[89]|[2-579])|(?:2|80)[2-9]"]]],0,0,"(15(?:0[06]|1[12]|[35]5|4[04]|6[26]|77|88|99)\\d)"],LV:["371","00","(?:[268]\\d|78|90)\\d{6}",[8],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2679]|8[01]"]]]],LY:["218","00","[2-9]\\d{8}",[9],[["(\\d{2})(\\d{7})","$1-$2",["[2-9]"],"0$1"]],"0"],MA:["212","00","[5-8]\\d{8}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["5[45]"],"0$1"],["(\\d{4})(\\d{5})","$1-$2",["5(?:2[2-46-9]|3[3-9]|9)|8(?:0[89]|92)"],"0$1"],["(\\d{2})(\\d{7})","$1-$2",["8"],"0$1"],["(\\d{3})(\\d{6})","$1-$2",["[5-7]"],"0$1"]],"0",0,0,0,0,0,[["5(?:2(?:[0-25-79]\\d|3[1-578]|4[02-46-8]|8[0235-7])|3(?:[0-47]\\d|5[02-9]|6[02-8]|8[014-9]|9[3-9])|(?:4[067]|5[03])\\d)\\d{5}"],["(?:6(?:[0-79]\\d|8[0-247-9])|7(?:[0167]\\d|2[0-8]|5[0-5]|8[0-7]))\\d{6}"],["80[0-7]\\d{6}"],["89\\d{7}"],0,0,0,0,["(?:592(?:4[0-2]|93)|80[89]\\d\\d)\\d{4}"]]],MC:["377","00","(?:[3489]|6\\d)\\d{7}",[8,9],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["4"],"0$1"],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[389]"]],["(\\d)(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["6"],"0$1"]],"0"],MD:["373","00","(?:[235-7]\\d|[89]0)\\d{6}",[8],[["(\\d{3})(\\d{5})","$1 $2",["[89]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["22|3"],"0$1"],["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["[25-7]"],"0$1"]],"0"],ME:["382","00","(?:20|[3-79]\\d)\\d{6}|80\\d{6,7}",[8,9],[["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-9]"],"0$1"]],"0"],MF:["590","00","(?:590\\d|7090)\\d{5}|(?:69|80|9\\d)\\d{7}",[9],0,"0",0,0,0,0,0,[["590(?:0[079]|[14]3|[27][79]|3[03-7]|5[0-268]|87)\\d{4}"],["(?:69(?:0\\d\\d|1(?:2[2-9]|3[0-5])|4(?:0[89]|1[2-6]|9\\d)|6(?:1[016-9]|5[0-4]|[67]\\d))|7090[0-4])\\d{4}"],["80[0-5]\\d{6}"],0,0,0,0,0,["9(?:(?:39[5-7]|76[018])\\d|475[0-6])\\d{4}"]]],MG:["261","00","[23]\\d{8}",[9],[["(\\d{2})(\\d{2})(\\d{3})(\\d{2})","$1 $2 $3 $4",["[23]"],"0$1"]],"0",0,"([24-9]\\d{6})$|0","20$1"],MH:["692","011","329\\d{4}|(?:[256]\\d|45)\\d{5}",[7],[["(\\d{3})(\\d{4})","$1-$2",["[2-6]"]]],"1"],MK:["389","00","[2-578]\\d{7}",[8],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["2|34[47]|4(?:[37]7|5[47]|64)"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[347]"],"0$1"],["(\\d{3})(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["[58]"],"0$1"]],"0"],ML:["223","00","[24-9]\\d{7}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[24-9]"]]]],MM:["95","00","1\\d{5,7}|95\\d{6}|(?:[4-7]|9[0-46-9])\\d{6,8}|(?:2|8\\d)\\d{5,8}",[6,7,8,9,10],[["(\\d)(\\d{2})(\\d{3})","$1 $2 $3",["16|2"],"0$1"],["(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["4(?:[2-46]|5[3-5])|5|6(?:[1-689]|7[235-7])|7(?:[0-4]|5[2-7])|8[1-5]|(?:60|86)[23]"],"0$1"],["(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["[12]|452|678|86","[12]|452|6788|86"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[4-7]|8[1-35]"],"0$1"],["(\\d)(\\d{3})(\\d{4,6})","$1 $2 $3",["9(?:2[0-4]|[35-9]|4[137-9])"],"0$1"],["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["2"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"],"0$1"],["(\\d)(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["92"],"0$1"],["(\\d)(\\d{5})(\\d{4})","$1 $2 $3",["9"],"0$1"]],"0"],MN:["976","001","[12]\\d{7,9}|[5-9]\\d{7}",[8,9,10],[["(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["[12]1"],"0$1"],["(\\d{4})(\\d{4})","$1 $2",["[5-9]"]],["(\\d{3})(\\d{5,6})","$1 $2",["[12]2[1-3]"],"0$1"],["(\\d{4})(\\d{5,6})","$1 $2",["[12](?:27|3[2-8]|4[2-68]|5[1-4689])","[12](?:27|3[2-8]|4[2-68]|5[1-4689])[0-3]"],"0$1"],["(\\d{5})(\\d{4,5})","$1 $2",["[12]"],"0$1"]],"0"],MO:["853","00","0800\\d{3}|(?:28|[68]\\d)\\d{6}",[7,8],[["(\\d{4})(\\d{3})","$1 $2",["0"]],["(\\d{4})(\\d{4})","$1 $2",["[268]"]]]],MP:["1","011","[58]\\d{9}|(?:67|90)0\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","670$1",0,"670"],MQ:["596","00","(?:596\\d|7091)\\d{5}|(?:69|[89]\\d)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-79]|8(?:0[6-9]|[36])"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0$1"]],"0"],MR:["222","00","(?:[2-4]\\d\\d|800)\\d{5}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-48]"]]]],MS:["1","011","(?:[58]\\d\\d|664|900)\\d{7}",[10],0,"1",0,"([34]\\d{6})$|1","664$1",0,"664"],MT:["356","00","3550\\d{4}|(?:[2579]\\d\\d|800)\\d{5}",[8],[["(\\d{4})(\\d{4})","$1 $2",["[2357-9]"]]]],MU:["230","0(?:0|[24-7]0|3[03])","(?:[57]|8\\d\\d)\\d{7}|[2-468]\\d{6}",[7,8,10],[["(\\d{3})(\\d{4})","$1 $2",["[2-46]|8[013]"]],["(\\d{4})(\\d{4})","$1 $2",["[57]"]],["(\\d{5})(\\d{5})","$1 $2",["8"]]],0,0,0,0,0,0,0,"020"],MV:["960","0(?:0|19)","(?:800|9[0-57-9]\\d)\\d{7}|[34679]\\d{6}",[7,10],[["(\\d{3})(\\d{4})","$1-$2",["[34679]"]],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[89]"]]],0,0,0,0,0,0,0,"00"],MW:["265","00","(?:[1289]\\d|31|77)\\d{7}|1\\d{6}",[7,9],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["1[2-9]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["2"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[137-9]"],"0$1"]],"0"],MX:["52","0[09]","[2-9]\\d{9}",[10],[["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["33|5[56]|81"]],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[2-9]"]]],0,0,0,0,0,0,0,"00"],MY:["60","00","1\\d{8,9}|(?:3\\d|[4-9])\\d{7}",[8,9,10],[["(\\d)(\\d{3})(\\d{4})","$1-$2 $3",["[4-79]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1-$2 $3",["1(?:[02469]|[378][1-9]|53)|8","1(?:[02469]|[37][1-9]|53|8(?:[1-46-9]|5[7-9]))|8"],"0$1"],["(\\d)(\\d{4})(\\d{4})","$1-$2 $3",["3"],"0$1"],["(\\d)(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3-$4",["1(?:[367]|80)"]],["(\\d{3})(\\d{3})(\\d{4})","$1-$2 $3",["15"],"0$1"],["(\\d{2})(\\d{4})(\\d{4})","$1-$2 $3",["1"],"0$1"]],"0"],MZ:["258","00","(?:2|8\\d)\\d{7}",[8,9],[["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["2|8[2-79]"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8"]]]],NA:["264","00","[68]\\d{7,8}",[8,9],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["88"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["6"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["87"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["8"],"0$1"]],"0"],NC:["687","00","(?:050|[2-57-9]\\d\\d)\\d{3}",[6],[["(\\d{2})(\\d{2})(\\d{2})","$1.$2.$3",["[02-57-9]"]]]],NE:["227","00","[027-9]\\d{7}",[8],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["08"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[089]|2[013]|7[0467]"]]]],NF:["672","00","[13]\\d{5}",[6],[["(\\d{2})(\\d{4})","$1 $2",["1[0-3]"]],["(\\d)(\\d{5})","$1 $2",["[13]"]]],0,0,"([0-258]\\d{4})$","3$1"],NG:["234","009","(?:20|9\\d)\\d{8}|[78]\\d{9,13}",[10,11,12,13,14],[["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["[7-9]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["20[129]"],"0$1"],["(\\d{4})(\\d{2})(\\d{4})","$1 $2 $3",["2"],"0$1"],["(\\d{3})(\\d{4})(\\d{4,5})","$1 $2 $3",["[78]"],"0$1"],["(\\d{3})(\\d{5})(\\d{5,6})","$1 $2 $3",["[78]"],"0$1"]],"0"],NI:["505","00","(?:1800|[25-8]\\d{3})\\d{4}",[8],[["(\\d{4})(\\d{4})","$1 $2",["[125-8]"]]]],NL:["31","00","(?:[124-7]\\d\\d|3(?:[02-9]\\d|1[0-8]))\\d{6}|8\\d{6,9}|9\\d{6,10}|1\\d{4,5}",[5,6,7,8,9,10,11],[["(\\d{3})(\\d{4,7})","$1 $2",["[89]0"],"0$1"],["(\\d{2})(\\d{7})","$1 $2",["66"],"0$1"],["(\\d)(\\d{8})","$1 $2",["6"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["1[16-8]|2[259]|3[124]|4[17-9]|5[124679]"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[1-578]|91"],"0$1"],["(\\d{3})(\\d{3})(\\d{5})","$1 $2 $3",["9"],"0$1"]],"0"],NO:["47","00","(?:0|[2-9]\\d{3})\\d{4}",[5,8],[["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["8"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-79]"]]],0,0,0,0,0,"[02-689]|7[0-8]"],NP:["977","00","(?:1\\d|9)\\d{9}|[1-9]\\d{7}",[8,10,11],[["(\\d)(\\d{7})","$1-$2",["1[2-6]"],"0$1"],["(\\d{2})(\\d{6})","$1-$2",["1[01]|[2-8]|9(?:[1-59]|[67][2-6])"],"0$1"],["(\\d{3})(\\d{7})","$1-$2",["9"]]],"0"],NR:["674","00","(?:222|444|(?:55|8\\d)\\d|666|777|999)\\d{4}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[24-9]"]]]],NU:["683","00","(?:[4-7]|888\\d)\\d{3}",[4,7],[["(\\d{3})(\\d{4})","$1 $2",["8"]]]],NZ:["64","0(?:0|161)","[1289]\\d{9}|50\\d{5}(?:\\d{2,3})?|[27-9]\\d{7,8}|(?:[34]\\d|6[0-35-9])\\d{6}|8\\d{4,6}",[5,6,7,8,9,10],[["(\\d{2})(\\d{3,8})","$1 $2",["8[1-79]"],"0$1"],["(\\d{3})(\\d{2})(\\d{2,3})","$1 $2 $3",["50[036-8]|8|90","50(?:[0367]|88)|8|90"],"0$1"],["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["24|[346]|7[2-57-9]|9[2-9]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["2(?:10|74)|[589]"],"0$1"],["(\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["1|2[028]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,5})","$1 $2 $3",["2(?:[169]|7[0-35-9])|7"],"0$1"]],"0",0,0,0,0,0,0,"00"],OM:["968","00","(?:1505|[279]\\d{3}|500)\\d{4}|800\\d{5,6}",[7,8,9],[["(\\d{3})(\\d{4,6})","$1 $2",["[58]"]],["(\\d{2})(\\d{6})","$1 $2",["2"]],["(\\d{4})(\\d{4})","$1 $2",["[179]"]]]],PA:["507","00","(?:00800|8\\d{3})\\d{6}|[68]\\d{7}|[1-57-9]\\d{6}",[7,8,10,11],[["(\\d{3})(\\d{4})","$1-$2",["[1-57-9]"]],["(\\d{4})(\\d{4})","$1-$2",["[68]"]],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"]]]],PE:["51","00|19(?:1[124]|77|90)00","(?:[14-8]|9\\d)\\d{7}",[8,9],[["(\\d{3})(\\d{5})","$1 $2",["80"],"(0$1)"],["(\\d)(\\d{7})","$1 $2",["1"],"(0$1)"],["(\\d{2})(\\d{6})","$1 $2",["[4-8]"],"(0$1)"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["9"]]],"0",0,0,0,0,0,0,"00"," Anexo "],PF:["689","00","4\\d{5}(?:\\d{2})?|8\\d{7,8}",[6,8,9],[["(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["44"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["4|8[7-9]"]],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"]]]],PG:["675","00|140[1-3]","(?:180|[78]\\d{3})\\d{4}|(?:[2-589]\\d|64)\\d{5}",[7,8],[["(\\d{3})(\\d{4})","$1 $2",["18|[2-69]|85"]],["(\\d{4})(\\d{4})","$1 $2",["[78]"]]],0,0,0,0,0,0,0,"00"],PH:["63","00","(?:[2-7]|9\\d)\\d{8}|2\\d{5}|(?:1800|8)\\d{7,9}",[6,8,9,10,11,12,13],[["(\\d)(\\d{5})","$1 $2",["2"],"(0$1)"],["(\\d{4})(\\d{4,6})","$1 $2",["3(?:23|39|46)|4(?:2[3-6]|[35]9|4[26]|76)|544|88[245]|(?:52|64|86)2","3(?:230|397|461)|4(?:2(?:35|[46]4|51)|396|4(?:22|63)|59[347]|76[15])|5(?:221|446)|642[23]|8(?:622|8(?:[24]2|5[13]))"],"(0$1)"],["(\\d{5})(\\d{4})","$1 $2",["346|4(?:27|9[35])|883","3469|4(?:279|9(?:30|56))|8834"],"(0$1)"],["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["2"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[3-7]|8[2-8]"],"(0$1)"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[89]"],"0$1"],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]],["(\\d{4})(\\d{1,2})(\\d{3})(\\d{4})","$1 $2 $3 $4",["1"]]],"0"],PK:["92","00","122\\d{6}|[24-8]\\d{10,11}|9(?:[013-9]\\d{8,10}|2(?:[01]\\d\\d|2(?:[06-8]\\d|1[01]))\\d{7})|(?:[2-8]\\d{3}|92(?:[0-7]\\d|8[1-9]))\\d{6}|[24-9]\\d{8}|[89]\\d{7}",[8,9,10,11,12],[["(\\d{3})(\\d{3})(\\d{2,7})","$1 $2 $3",["[89]0"],"0$1"],["(\\d{4})(\\d{5})","$1 $2",["1"]],["(\\d{3})(\\d{6,7})","$1 $2",["2(?:3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(?:2[2-689]|3[23578]|4[3478]|5[2356])|9(?:2[2-8]|3[27-9]|4[2-6]|6[3569]|9[25-8])","9(?:2[3-8]|98)|(?:2(?:3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(?:2[2-689]|3[23578]|4[3478]|5[2356])|9(?:22|3[27-9]|4[2-6]|6[3569]|9[25-7]))[2-9]"],"(0$1)"],["(\\d{2})(\\d{7,8})","$1 $2",["(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)[2-9]"],"(0$1)"],["(\\d{5})(\\d{5})","$1 $2",["58"],"(0$1)"],["(\\d{3})(\\d{7})","$1 $2",["3"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91"],"(0$1)"],["(\\d{3})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["[24-9]"],"(0$1)"]],"0"],PL:["48","00","(?:6|8\\d\\d)\\d{7}|[1-9]\\d{6}(?:\\d{2})?|[26]\\d{5}",[6,7,8,9,10],[["(\\d{5})","$1",["19"]],["(\\d{3})(\\d{3})","$1 $2",["11|20|64"]],["(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["(?:1[2-8]|2[2-69]|3[2-4]|4[1-468]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145])1","(?:1[2-8]|2[2-69]|3[2-4]|4[1-468]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145])19"]],["(\\d{3})(\\d{2})(\\d{2,3})","$1 $2 $3",["64"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["21|39|45|5[0137]|6[0469]|7[02389]|8(?:0[14]|8)"]],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[2-8]|[2-7]|8[1-79]|9[145]"]],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["8"]]]],PM:["508","00","[45]\\d{5}|(?:708|8\\d\\d)\\d{6}",[6,9],[["(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["[45]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["7"]],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0$1"]],"0"],PR:["1","011","(?:[589]\\d\\d|787)\\d{7}",[10],0,"1",0,0,0,0,"787|939"],PS:["970","00","[2489]2\\d{6}|(?:1\\d|5)\\d{8}",[8,9,10],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[2489]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["5"],"0$1"],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1"]]],"0"],PT:["351","00","1693\\d{5}|(?:[26-9]\\d|30)\\d{7}",[9],[["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["2[12]"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["16|[236-9]"]]]],PW:["680","01[12]","(?:[24-8]\\d\\d|345|900)\\d{4}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[2-9]"]]]],PY:["595","00","59\\d{4,6}|9\\d{5,10}|(?:[2-46-8]\\d|5[0-8])\\d{4,7}",[6,7,8,9,10,11],[["(\\d{3})(\\d{3,6})","$1 $2",["[2-9]0"],"0$1"],["(\\d{2})(\\d{5})","$1 $2",["[26]1|3[289]|4[1246-8]|7[1-3]|8[1-36]"],"(0$1)"],["(\\d{3})(\\d{4,5})","$1 $2",["2[279]|3[13-5]|4[359]|5|6(?:[34]|7[1-46-8])|7[46-8]|85"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["2[14-68]|3[26-9]|4[1246-8]|6(?:1|75)|7[1-35]|8[1-36]"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["87"]],["(\\d{3})(\\d{6})","$1 $2",["9(?:[5-79]|8[1-7])"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[2-8]"],"0$1"],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["9"]]],"0"],QA:["974","00","800\\d{4}|(?:2|800)\\d{6}|(?:0080|[3-7])\\d{7}",[7,8,9,11],[["(\\d{3})(\\d{4})","$1 $2",["2[136]|8"]],["(\\d{4})(\\d{4})","$1 $2",["[3-7]"]]]],RE:["262","00","709\\d{6}|(?:26|[689]\\d)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[26-9]"],"0$1"]],"0",0,0,0,0,0,[["26(?:2\\d\\d|3(?:0\\d|1[0-6]))\\d{4}"],["(?:69(?:2\\d\\d|3(?:[06][0-6]|1[0-3]|2[0-2]|3[0-39]|4\\d|5[0-5]|7[0-37]|8[0-8]|9[0-479]))|7092[0-3])\\d{4}"],["80\\d{7}"],["89[1-37-9]\\d{6}"],0,0,0,0,["9(?:399[0-3]|479[0-6]|76(?:2[278]|3[0-37]))\\d{4}"],["8(?:1[019]|2[0156]|84|90)\\d{6}"]]],RO:["40","00","(?:[236-8]\\d|90)\\d{7}|[23]\\d{5}",[6,9],[["(\\d{3})(\\d{3})","$1 $2",["2[3-6]","2[3-6]\\d9"],"0$1"],["(\\d{2})(\\d{4})","$1 $2",["219|31"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[23]1"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[236-9]"],"0$1"]],"0",0,0,0,0,0,0,0," int "],RS:["381","00","38[02-9]\\d{6,9}|6\\d{7,9}|90\\d{4,8}|38\\d{5,6}|(?:7\\d\\d|800)\\d{3,9}|(?:[12]\\d|3[0-79])\\d{5,10}",[6,7,8,9,10,11,12],[["(\\d{3})(\\d{3,9})","$1 $2",["(?:2[389]|39)0|[7-9]"],"0$1"],["(\\d{2})(\\d{5,10})","$1 $2",["[1-36]"],"0$1"]],"0"],RU:["7","810","8\\d{13}|[347-9]\\d{9}",[10,14],[["(\\d{4})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["7(?:1[0-8]|2[1-9])","7(?:1(?:[0-356]2|4[29]|7|8[27])|2(?:1[23]|[2-9]2))","7(?:1(?:[0-356]2|4[29]|7|8[27])|2(?:13[03-69]|62[013-9]))|72[1-57-9]2"],"8 ($1)",1],["(\\d{5})(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["7(?:1[0-68]|2[1-9])","7(?:1(?:[06][3-6]|[18]|2[35]|[3-5][3-5])|2(?:[13][3-5]|[24-689]|7[457]))","7(?:1(?:0(?:[356]|4[023])|[18]|2(?:3[013-9]|5)|3[45]|43[013-79]|5(?:3[1-8]|4[1-7]|5)|6(?:3[0-35-9]|[4-6]))|2(?:1(?:3[178]|[45])|[24-689]|3[35]|7[457]))|7(?:14|23)4[0-8]|71(?:33|45)[1-79]"],"8 ($1)",1],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"8 ($1)",1],["(\\d{3})(\\d{3})(\\d{2})(\\d{2})","$1 $2-$3-$4",["[349]|8(?:[02-7]|1[1-8])"],"8 ($1)",1],["(\\d{4})(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3 $4",["8"],"8 ($1)"]],"8",0,0,0,0,0,[["336(?:[013-9]\\d|2[013-9])\\d{5}|(?:3(?:0[12]|4[1-35-79]|5[1-3]|65|8[1-58]|9[0145])|4(?:01|1[1356]|2[13467]|7[1-5]|8[1-7]|9[1-689])|8(?:1[1-8]|2[01]|3[13-6]|4[0-8]|5[15-7]|6[0-35-79]|7[1-37-9]))\\d{7}",[10]],["9\\d{9}",[10]],["8(?:0[04]|108\\d{3})\\d{7}"],["80[39]\\d{7}",[10]],["808\\d{7}",[10]]],"8~10"],RW:["250","00","(?:06|[27]\\d\\d|[89]00)\\d{6}",[8,9],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["0"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["2"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[7-9]"],"0$1"]],"0"],SA:["966","00","(?:[15]\\d|800|92)\\d{7}",[9,10],[["(\\d{4})(\\d{5})","$1 $2",["9"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["5"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"]]],"0"],SB:["677","0[01]","[6-9]\\d{6}|[1-6]\\d{4}",[5,7],[["(\\d{2})(\\d{5})","$1 $2",["6[89]|7|8[4-9]|9(?:[1-8]|9[0-8])"]]]],SC:["248","010|0[0-2]","(?:[2489]\\d|64)\\d{5}",[7],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[246]|9[57]"]]],0,0,0,0,0,0,0,"00"],SD:["249","00","[19]\\d{8}",[9],[["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[19]"],"0$1"]],"0"],SE:["46","00","(?:[26]\\d\\d|9)\\d{9}|[1-9]\\d{8}|[1-689]\\d{7}|[1-4689]\\d{6}|2\\d{5}",[6,7,8,9,10,12],[["(\\d{2})(\\d{2,3})(\\d{2})","$1-$2 $3",["20"],"0$1",0,"$1 $2 $3"],["(\\d{3})(\\d{4})","$1-$2",["9(?:00|39|44|9)"],"0$1",0,"$1 $2"],["(\\d{2})(\\d{3})(\\d{2})","$1-$2 $3",["[12][136]|3[356]|4[0246]|6[03]|90[1-9]"],"0$1",0,"$1 $2 $3"],["(\\d)(\\d{2,3})(\\d{2})(\\d{2})","$1-$2 $3 $4",["8"],"0$1",0,"$1 $2 $3 $4"],["(\\d{3})(\\d{2,3})(\\d{2})","$1-$2 $3",["1[2457]|2(?:[247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6(?:[125689]|4[02-57]|7[0-2])|9(?:[125-8]|3[02-5]|4[0-3])"],"0$1",0,"$1 $2 $3"],["(\\d{3})(\\d{2,3})(\\d{3})","$1-$2 $3",["9(?:00|39|44)"],"0$1",0,"$1 $2 $3"],["(\\d{2})(\\d{2,3})(\\d{2})(\\d{2})","$1-$2 $3 $4",["1[13689]|2[0136]|3[1356]|4[0246]|54|6[03]|90[1-9]"],"0$1",0,"$1 $2 $3 $4"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1-$2 $3 $4",["10|7"],"0$1",0,"$1 $2 $3 $4"],["(\\d)(\\d{3})(\\d{3})(\\d{2})","$1-$2 $3 $4",["8"],"0$1",0,"$1 $2 $3 $4"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1-$2 $3 $4",["[13-5]|2(?:[247-9]|5[0138])|6(?:[124-689]|7[0-2])|9(?:[125-8]|3[02-5]|4[0-3])"],"0$1",0,"$1 $2 $3 $4"],["(\\d{3})(\\d{2})(\\d{2})(\\d{3})","$1-$2 $3 $4",["9"],"0$1",0,"$1 $2 $3 $4"],["(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1-$2 $3 $4 $5",["[26]"],"0$1",0,"$1 $2 $3 $4 $5"]],"0"],SG:["65","0[0-3]\\d","(?:(?:1\\d|8)\\d\\d|7000)\\d{7}|[3689]\\d{7}",[8,10,11],[["(\\d{4})(\\d{4})","$1 $2",["[369]|8(?:0[1-9]|[1-9])"]],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"]],["(\\d{4})(\\d{4})(\\d{3})","$1 $2 $3",["7"]],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]]]],SH:["290","00","(?:[256]\\d|8)\\d{3}",[4,5],0,0,0,0,0,0,"[256]"],SI:["386","00|10(?:22|66|88|99)","[1-7]\\d{7}|8\\d{4,7}|90\\d{4,6}",[5,6,7,8],[["(\\d{2})(\\d{3,6})","$1 $2",["8[09]|9"],"0$1"],["(\\d{3})(\\d{5})","$1 $2",["59|8"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[37][01]|4[0139]|51|6"],"0$1"],["(\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[1-57]"],"(0$1)"]],"0",0,0,0,0,0,0,"00"],SJ:["47","00","0\\d{4}|(?:[489]\\d|79)\\d{6}",[5,8],0,0,0,0,0,0,"79"],SK:["421","00","[2-689]\\d{8}|[2-59]\\d{6}|[2-5]\\d{5}",[6,7,9],[["(\\d)(\\d{2})(\\d{3,4})","$1 $2 $3",["21"],"0$1"],["(\\d{2})(\\d{2})(\\d{2,3})","$1 $2 $3",["[3-5][1-8]1","[3-5][1-8]1[67]"],"0$1"],["(\\d)(\\d{3})(\\d{3})(\\d{2})","$1/$2 $3 $4",["2"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[689]"],"0$1"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1/$2 $3 $4",["[3-5]"],"0$1"]],"0"],SL:["232","00","(?:[237-9]\\d|66)\\d{6}",[8],[["(\\d{2})(\\d{6})","$1 $2",["[236-9]"],"(0$1)"]],"0"],SM:["378","00","(?:0549|[5-7]\\d)\\d{6}",[8,10],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-7]"]],["(\\d{4})(\\d{6})","$1 $2",["0"]]],0,0,"([89]\\d{5})$","0549$1"],SN:["221","00","(?:[378]\\d|93)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"]],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[379]"]]]],SO:["252","00","[346-9]\\d{8}|[12679]\\d{7}|[1-5]\\d{6}|[1348]\\d{5}",[6,7,8,9],[["(\\d{2})(\\d{4})","$1 $2",["8[125]"]],["(\\d{6})","$1",["[134]"]],["(\\d)(\\d{6})","$1 $2",["[15]|2[0-79]|3[0-46-8]|4[0-7]"]],["(\\d)(\\d{7})","$1 $2",["(?:2|90)4|[67]"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[348]|64|79|90"]],["(\\d{2})(\\d{5,7})","$1 $2",["1|28|6[0-35-9]|7[67]|9[2-9]"]]],"0"],SR:["597","00","(?:[2-5]|[6-8]\\d|90)\\d{5}",[6,7],[["(\\d{2})(\\d{2})(\\d{2})","$1-$2-$3",["56"]],["(\\d{3})(\\d{3})","$1-$2",["[2-5]"]],["(\\d{3})(\\d{4})","$1-$2",["[6-9]"]]]],SS:["211","00","[19]\\d{8}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[19]"],"0$1"]],"0"],ST:["239","00","(?:22|9\\d)\\d{5}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[29]"]]]],SV:["503","00","[267]\\d{7}|(?:80\\d|900)\\d{4}(?:\\d{4})?",[7,8,11],[["(\\d{3})(\\d{4})","$1 $2",["[89]"]],["(\\d{4})(\\d{4})","$1 $2",["[267]"]],["(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["[89]"]]]],SX:["1","011","7215\\d{6}|(?:[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"(5\\d{6})$|1","721$1",0,"721"],SY:["963","00","[1-359]\\d{8}|[1-5]\\d{7}",[8,9],[["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[1-4]|5[1-3]"],"0$1",1],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[59]"],"0$1",1]],"0"],SZ:["268","00","0800\\d{4}|(?:[237]\\d|900)\\d{6}",[8,9],[["(\\d{4})(\\d{4})","$1 $2",["[0237]"]],["(\\d{5})(\\d{4})","$1 $2",["9"]]]],TA:["290","00","8\\d{3}",[4],0,0,0,0,0,0,"8"],TC:["1","011","(?:[58]\\d\\d|649|900)\\d{7}",[10],0,"1",0,"([2-479]\\d{6})$|1","649$1",0,"649"],TD:["235","00|16","(?:22|30|[689]\\d|77)\\d{6}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[236-9]"]]],0,0,0,0,0,0,0,"00"],TG:["228","00","[279]\\d{7}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[279]"]]]],TH:["66","00[1-9]","(?:001800|[2-57]|[689]\\d)\\d{7}|1\\d{7,9}",[8,9,10,13],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["2"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[13-9]"],"0$1"],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1"]]],"0"],TJ:["992","810","[0-57-9]\\d{8}",[9],[["(\\d{6})(\\d)(\\d{2})","$1 $2 $3",["331","3317"]],["(\\d{3})(\\d{2})(\\d{4})","$1 $2 $3",["44[02-479]|[34]7"]],["(\\d{4})(\\d)(\\d{4})","$1 $2 $3",["3(?:[1245]|3[12])"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[0-57-9]"]]],0,0,0,0,0,0,0,"8~10"],TK:["690","00","[2-47]\\d{3,6}",[4,5,6,7]],TL:["670","00","7\\d{7}|(?:[2-47]\\d|[89]0)\\d{5}",[7,8],[["(\\d{3})(\\d{4})","$1 $2",["[2-489]|70"]],["(\\d{4})(\\d{4})","$1 $2",["7"]]]],TM:["993","810","(?:[1-6]\\d|71)\\d{6}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2-$3-$4",["12"],"(8 $1)"],["(\\d{3})(\\d)(\\d{2})(\\d{2})","$1 $2-$3-$4",["[1-5]"],"(8 $1)"],["(\\d{2})(\\d{6})","$1 $2",["[67]"],"8 $1"]],"8",0,0,0,0,0,0,"8~10"],TN:["216","00","[2-57-9]\\d{7}",[8],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2-57-9]"]]]],TO:["676","00","(?:0800|(?:[5-8]\\d\\d|999)\\d)\\d{3}|[2-8]\\d{4}",[5,7],[["(\\d{2})(\\d{3})","$1-$2",["[2-4]|50|6[09]|7[0-24-69]|8[05]"]],["(\\d{4})(\\d{3})","$1 $2",["0"]],["(\\d{3})(\\d{4})","$1 $2",["[5-9]"]]]],TR:["90","00","4\\d{6}|8\\d{11,12}|(?:[2-58]\\d\\d|900)\\d{7}",[7,10,12,13],[["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["512|8[01589]|90"],"0$1",1],["(\\d{3})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["5(?:[0-59]|61)","5(?:[0-59]|61[06])","5(?:[0-59]|61[06]1)"],"0$1",1],["(\\d{3})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[24][1-8]|3[1-9]"],"(0$1)",1],["(\\d{3})(\\d{3})(\\d{6,7})","$1 $2 $3",["80"],"0$1",1]],"0"],TT:["1","011","(?:[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-46-8]\\d{6})$|1","868$1",0,"868"],TV:["688","00","(?:2|7\\d\\d|90)\\d{4}",[5,6,7],[["(\\d{2})(\\d{3})","$1 $2",["2"]],["(\\d{2})(\\d{4})","$1 $2",["90"]],["(\\d{2})(\\d{5})","$1 $2",["7"]]]],TW:["886","0(?:0[25-79]|19)","[2-689]\\d{8}|7\\d{9,10}|[2-8]\\d{7}|2\\d{6}",[7,8,9,10,11],[["(\\d{2})(\\d)(\\d{4})","$1 $2 $3",["202"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[258]0"],"0$1"],["(\\d)(\\d{3,4})(\\d{4})","$1 $2 $3",["[23568]|4(?:0[02-48]|[1-47-9])|7[1-9]","[23568]|4(?:0[2-48]|[1-47-9])|(?:400|7)[1-9]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[49]"],"0$1"],["(\\d{2})(\\d{4})(\\d{4,5})","$1 $2 $3",["7"],"0$1"]],"0",0,0,0,0,0,0,0,"#"],TZ:["255","00[056]","(?:[25-8]\\d|41|90)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{4})","$1 $2 $3",["[89]"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[24]"],"0$1"],["(\\d{2})(\\d{7})","$1 $2",["5"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[67]"],"0$1"]],"0"],UA:["380","00","[89]\\d{9}|[3-9]\\d{8}",[9,10],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6[12][29]|(?:3[1-8]|4[136-8]|5[12457]|6[49])2|(?:56|65)[24]","6[12][29]|(?:35|4[1378]|5[12457]|6[49])2|(?:56|65)[24]|(?:3[1-46-8]|46)2[013-9]"],"0$1"],["(\\d{4})(\\d{5})","$1 $2",["3[1-8]|4(?:[1367]|[45][6-9]|8[4-6])|5(?:[1-5]|6[0135689]|7[4-6])|6(?:[12][3-7]|[459])","3[1-8]|4(?:[1367]|[45][6-9]|8[4-6])|5(?:[1-5]|6(?:[015689]|3[02389])|7[4-6])|6(?:[12][3-7]|[459])"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[3-7]|89|9[1-9]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["[89]"],"0$1"]],"0",0,0,0,0,0,0,"0~0"],UG:["256","00[057]","800\\d{6}|(?:[29]0|[347]\\d)\\d{7}",[9],[["(\\d{4})(\\d{5})","$1 $2",["202","2024"],"0$1"],["(\\d{3})(\\d{6})","$1 $2",["[27-9]|4(?:6[45]|[7-9])"],"0$1"],["(\\d{2})(\\d{7})","$1 $2",["[34]"],"0$1"]],"0"],US:["1","011","[2-9]\\d{9}|3\\d{6}",[10],[["(\\d{3})(\\d{4})","$1-$2",["310"],0,1],["(\\d{3})(\\d{3})(\\d{4})","($1) $2-$3",["[2-9]"],0,1,"$1-$2-$3"]],"1",0,0,0,0,0,[["(?:3052(?:0[0-8]|[1-9]\\d)|5056(?:[0-35-9]\\d|4[0-68]))\\d{4}|(?:2742|305[3-9]|(?:472|983)[2-47-9]|505[2-57-9])\\d{6}|(?:2(?:0[1-35-9]|1[02-9]|2[03-57-9]|3[1459]|4[08]|5[1-46]|6[0279]|7[0269]|8[13])|3(?:0[1-47-9]|1[02-9]|2[0135-79]|3[0-24679]|4[167]|5[0-2]|6[01349]|8[056])|4(?:0[124-9]|1[02-579]|2[3-5]|3[0245]|4[023578]|58|6[349]|7[0589]|8[04])|5(?:0[1-47-9]|1[0235-8]|20|3[0149]|4[01]|5[179]|6[1-47]|7[0-5]|8[0256])|6(?:0[1-35-9]|1[024-9]|2[03689]|3[016]|4[0156]|5[01679]|6[0-279]|78|8[0-269])|7(?:0[1-46-8]|1[2-9]|2[04-8]|3[0-247]|4[0378]|5[47]|6[02359]|7[0-59]|8[156])|8(?:0[1-68]|1[02-8]|2[0168]|3[0-2589]|4[03578]|5[046-9]|6[02-5]|7[028])|9(?:0[1346-9]|1[02-9]|2[0589]|3[0146-8]|4[01357-9]|5[12469]|7[0-3589]|8[04-69]))[2-9]\\d{6}"],[""],["8(?:00|33|44|55|66|77|88)[2-9]\\d{6}"],["900[2-9]\\d{6}"],["52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}"],0,0,0,["305209\\d{4}"]]],UY:["598","0(?:0|1[3-9]\\d)","0004\\d{2,9}|[1249]\\d{7}|2\\d{3,4}|(?:[49]\\d|80)\\d{5}",[4,5,6,7,8,9,10,11,12,13],[["(\\d{4,5})","$1",["21"]],["(\\d{3})(\\d{3,4})","$1 $2",["0"]],["(\\d{3})(\\d{4})","$1 $2",["[49]0|8"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["9"],"0$1"],["(\\d{4})(\\d{4})","$1 $2",["[124]"]],["(\\d{3})(\\d{3})(\\d{2,4})","$1 $2 $3",["0"]],["(\\d{3})(\\d{3})(\\d{3})(\\d{2,4})","$1 $2 $3 $4",["0"]]],"0",0,0,0,0,0,0,"00"," int. "],UZ:["998","00","(?:20|33|[5-9]\\d)\\d{7}",[9],[["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[235-9]"]]]],VA:["39","00","0\\d{5,10}|3[0-8]\\d{7,10}|55\\d{8}|8\\d{5}(?:\\d{2,4})?|(?:1\\d|39)\\d{7,8}",[6,7,8,9,10,11,12],0,0,0,0,0,0,"06698"],VC:["1","011","(?:[58]\\d\\d|784|900)\\d{7}",[10],0,"1",0,"([2-7]\\d{6})$|1","784$1",0,"784"],VE:["58","00","[68]00\\d{7}|(?:[24]\\d|[59]0)\\d{8}",[10],[["(\\d{3})(\\d{7})","$1-$2",["[24-689]"],"0$1"]],"0"],VG:["1","011","(?:284|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-578]\\d{6})$|1","284$1",0,"284"],VI:["1","011","[58]\\d{9}|(?:34|90)0\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","340$1",0,"340"],VN:["84","00","[12]\\d{9}|[135-9]\\d{8}|[16]\\d{7}|[16-8]\\d{6}",[7,8,9,10],[["(\\d{2})(\\d{5})","$1 $2",["80"],"0$1",1],["(\\d{4})(\\d{4,6})","$1 $2",["1"],0,1],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["6"],"0$1",1],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[357-9]"],"0$1",1],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["2[48]"],"0$1",1],["(\\d{3})(\\d{4})(\\d{3})","$1 $2 $3",["2"],"0$1",1]],"0"],VU:["678","00","[57-9]\\d{6}|(?:[238]\\d|48)\\d{3}",[5,7],[["(\\d{3})(\\d{4})","$1 $2",["[57-9]"]]]],WF:["681","00","(?:40|72|8\\d{4})\\d{4}|[89]\\d{5}",[6,9],[["(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["[47-9]"]],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"]]]],WS:["685","0","(?:[2-6]|8\\d{5})\\d{4}|[78]\\d{6}|[68]\\d{5}",[5,6,7,10],[["(\\d{5})","$1",["[2-5]|6[1-9]"]],["(\\d{3})(\\d{3,7})","$1 $2",["[68]"]],["(\\d{2})(\\d{5})","$1 $2",["7"]]]],XK:["383","00","2\\d{7,8}|3\\d{7,11}|(?:4\\d\\d|[89]00)\\d{5}",[8,9,10,11,12],[["(\\d{3})(\\d{5})","$1 $2",["[89]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2-4]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["2|39"],"0$1"],["(\\d{2})(\\d{7,10})","$1 $2",["3"],"0$1"]],"0"],YE:["967","00","(?:1|7\\d)\\d{7}|[1-7]\\d{6}",[7,8,9],[["(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["[1-6]|7(?:[24-6]|8[0-7])"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["7"],"0$1"]],"0"],YT:["262","00","7093\\d{5}|(?:80|9\\d)\\d{7}|(?:26|63)9\\d{6}",[9],0,"0",0,0,0,0,0,[["269(?:0[0-467]|15|5[0-4]|6\\d|[78]0)\\d{4}"],["(?:639(?:0[0-79]|1[019]|[267]\\d|3[09]|40|5[05-9]|9[04-79])|7093[5-7])\\d{4}"],["80\\d{7}"],0,0,0,0,0,["9(?:(?:39|47)8[01]|769\\d)\\d{4}"]]],ZA:["27","00","[1-79]\\d{8}|8\\d{4,9}",[5,6,7,8,9,10],[["(\\d{2})(\\d{3,4})","$1 $2",["8[1-4]"],"0$1"],["(\\d{2})(\\d{3})(\\d{2,3})","$1 $2 $3",["8[1-4]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["860"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[1-9]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"],"0$1"]],"0"],ZM:["260","00","800\\d{6}|(?:21|[579]\\d|63)\\d{7}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[28]"],"0$1"],["(\\d{2})(\\d{7})","$1 $2",["[579]"],"0$1"]],"0"],ZW:["263","00","2(?:[0-57-9]\\d{6,8}|6[0-24-9]\\d{6,7})|[38]\\d{9}|[35-8]\\d{8}|[3-6]\\d{7}|[1-689]\\d{6}|[1-3569]\\d{5}|[1356]\\d{4}",[5,6,7,8,9,10],[["(\\d{3})(\\d{3,5})","$1 $2",["2(?:0[45]|2[278]|[49]8)|3(?:[09]8|17)|6(?:[29]8|37|75)|[23][78]|(?:33|5[15]|6[68])[78]"],"0$1"],["(\\d)(\\d{3})(\\d{2,4})","$1 $2 $3",["[49]"],"0$1"],["(\\d{3})(\\d{4})","$1 $2",["80"],"0$1"],["(\\d{2})(\\d{7})","$1 $2",["24|8[13-59]|(?:2[05-79]|39|5[45]|6[15-8])2","2(?:02[014]|4|[56]20|[79]2)|392|5(?:42|525)|6(?:[16-8]21|52[013])|8[13-59]"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"0$1"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["2(?:1[39]|2[0157]|[378]|[56][14])|3(?:12|29)","2(?:1[39]|2[0157]|[378]|[56][14])|3(?:123|29)"],"0$1"],["(\\d{4})(\\d{6})","$1 $2",["8"],"0$1"],["(\\d{2})(\\d{3,5})","$1 $2",["1|2(?:0[0-36-9]|12|29|[56])|3(?:1[0-689]|[24-6])|5(?:[0236-9]|1[2-4])|6(?:[013-59]|7[0-46-9])|(?:33|55|6[68])[0-69]|(?:29|3[09]|62)[0-79]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["29[013-9]|39|54"],"0$1"],["(\\d{4})(\\d{3,5})","$1 $2",["(?:25|54)8","258|5483"],"0$1"]],"0"]},nonGeographic:{800:["800",0,"(?:00|[1-9]\\d)\\d{6}",[8],[["(\\d{4})(\\d{4})","$1 $2",["\\d"]]],0,0,0,0,0,0,[0,0,["(?:00|[1-9]\\d)\\d{6}"]]],808:["808",0,"[1-9]\\d{7}",[8],[["(\\d{4})(\\d{4})","$1 $2",["[1-9]"]]],0,0,0,0,0,0,[0,0,0,0,0,0,0,0,0,["[1-9]\\d{7}"]]],870:["870",0,"7\\d{11}|[235-7]\\d{8}",[9,12],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[235-7]"]]],0,0,0,0,0,0,[0,["(?:[356]|774[45])\\d{8}|7[6-8]\\d{7}"],0,0,0,0,0,0,["2\\d{8}",[9]]]],878:["878",0,"10\\d{10}",[12],[["(\\d{2})(\\d{5})(\\d{5})","$1 $2 $3",["1"]]],0,0,0,0,0,0,[0,0,0,0,0,0,0,0,["10\\d{10}"]]],881:["881",0,"6\\d{9}|[0-36-9]\\d{8}",[9,10],[["(\\d)(\\d{3})(\\d{5})","$1 $2 $3",["[0-37-9]"]],["(\\d)(\\d{3})(\\d{5,6})","$1 $2 $3",["6"]]],0,0,0,0,0,0,[0,["6\\d{9}|[0-36-9]\\d{8}"]]],882:["882",0,"[13]\\d{6}(?:\\d{2,5})?|[19]\\d{7}|(?:[25]\\d\\d|4)\\d{7}(?:\\d{2})?",[7,8,9,10,11,12],[["(\\d{2})(\\d{5})","$1 $2",["16|342"]],["(\\d{2})(\\d{6})","$1 $2",["49"]],["(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["1[36]|9"]],["(\\d{2})(\\d{4})(\\d{3})","$1 $2 $3",["3[23]"]],["(\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["16"]],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["10|23|3(?:[15]|4[57])|4|51"]],["(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["34"]],["(\\d{2})(\\d{4,5})(\\d{5})","$1 $2 $3",["[1-35]"]]],0,0,0,0,0,0,[0,["342\\d{4}|(?:337|49)\\d{6}|(?:3(?:2|47|7\\d{3})|50\\d{3})\\d{7}",[7,8,9,10,12]],0,0,0,["348[57]\\d{7}",[11]],0,0,["1(?:3(?:0[0347]|[13][0139]|2[035]|4[013568]|6[0459]|7[06]|8[15-8]|9[0689])\\d{4}|6\\d{5,10})|(?:345\\d|9[89])\\d{6}|(?:10|2(?:3|85\\d)|3(?:[15]|[69]\\d\\d)|4[15-8]|51)\\d{8}"]]],883:["883",0,"(?:[1-4]\\d|51)\\d{6,10}",[8,9,10,11,12],[["(\\d{3})(\\d{3})(\\d{2,8})","$1 $2 $3",["[14]|2[24-689]|3[02-689]|51[24-9]"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["510"]],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["21"]],["(\\d{4})(\\d{4})(\\d{4})","$1 $2 $3",["51[13]"]],["(\\d{3})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["[235]"]]],0,0,0,0,0,0,[0,0,0,0,0,0,0,0,["(?:2(?:00\\d\\d|10)|(?:370[1-9]|51\\d0)\\d)\\d{7}|51(?:00\\d{5}|[24-9]0\\d{4,7})|(?:1[0-79]|2[24-689]|3[02-689]|4[0-4])0\\d{5,9}"]]],888:["888",0,"\\d{11}",[11],[["(\\d{3})(\\d{3})(\\d{5})","$1 $2 $3"]],0,0,0,0,0,0,[0,0,0,0,0,0,["\\d{11}"]]],979:["979",0,"[1359]\\d{8}",[9],[["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["[1359]"]]],0,0,0,0,0,0,[0,0,0,["[1359]\\d{8}"]]]}};var es,ts,ss={exports:{}};
/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/const rs=s((es||(es=1,ts=ss,function(){var e={}.hasOwnProperty;function t(){for(var e="",t=0;t<arguments.length;t++){var a=arguments[t];a&&(e=r(e,s(a)))}return e}function s(s){if("string"==typeof s||"number"==typeof s)return s;if("object"!=typeof s)return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var a="";for(var n in s)e.call(s,n)&&s[n]&&(a=r(a,n));return a}function r(e,t){return t?e?e+" "+t:e+t:e}ts.exports?(t.default=t,ts.exports=t):window.classNames=t}()),ss.exports));function as(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(!e)return;if("string"==typeof e)return ns(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return ns(e,t)}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ns(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=new Array(t);s<t;s++)r[s]=e[s];return r}function is(e,t){for(var s,r=0,a=as(t.split(""));!(s=a()).done;){s.value===e&&r++}return r}function ls(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(!e)return;if("string"==typeof e)return os(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return os(e,t)}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function os(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=new Array(t);s<t;s++)r[s]=e[s];return r}function ds(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x",s=arguments.length>2?arguments[2]:void 0;if(!e)return function(e){return{text:e}};var r=is(t,e);return function(a){if(!a)return{text:"",template:e};for(var n,i=0,l="",o=ls(e.split(""));!(n=o()).done;){var d=n.value;if(d===t){if(l+=a[i],++i===a.length&&a.length<r)break}else l+=d}return s&&(l=function(e,t){for(var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ",a=e.length,n=is("(",e)-is(")",e);n>0&&a<t.length;)e+=t[a].replace(s,r),")"===t[a]&&n--,a++;return e}(l,e)),{text:l,template:e}}}var cs=8,us=46;function ms(e,t){void 0!==t&&(!function(){if("undefined"!=typeof navigator)return hs.test(navigator.userAgent)}()?e.setSelectionRange(t,t):setTimeout(function(){return e.setSelectionRange(t,t)},0))}var hs=/Android/i;function xs(e,t,s,r,a){if(!t.hasAttribute("readonly")){var n=function(e){switch(e.keyCode){case cs:return"Backspace";case us:return"Delete"}}(e);switch(n){case"Delete":case"Backspace":e.preventDefault();var i=function(e){if(e.selectionStart!==e.selectionEnd)return{start:e.selectionStart,end:e.selectionEnd}}(t);return i?(function(e,t){var s=e.value;s=s.slice(0,t.start)+s.slice(t.end),e.value=s,ms(e,t.start)}(t,i),gs(t,s,r,void 0,a)):gs(t,s,r,n,a)}}}function gs(e,t,s,r,a){var n=function(e,t,s){for(var r={},a="",n=0,i=0;i<e.length;){var l=s(e[i],a,r);void 0!==l&&(a+=l,void 0!==t&&(t===i?n=a.length-1:t>i&&(n=a.length))),i++}return void 0===t&&(n=a.length),{value:a,caret:n}}(e.value,e.selectionStart,t),i=n.value,l=n.caret;if(r){var o=function(e,t,s){switch(s){case"Backspace":t>0&&(e=e.slice(0,t-1)+e.slice(t),t--);break;case"Delete":e=e.slice(0,t)+e.slice(t+1)}return{value:e,caret:t}}(i,l,r);i=o.value,l=o.caret}var d=function(e,t,s){"string"==typeof s&&(s=ds(s));var r=s(e)||{},a=r.text,n=r.template;if(void 0===a&&(a=e),n)if(void 0===t)t=a.length;else{for(var i=0,l=!1,o=-1;i<a.length&&i<n.length;){if(a[i]!==n[i]){if(0===t){l=!0,t=i;break}o=i,t--}i++}l||(t=o+1)}return{text:a,caret:t}}(i,l,s),c=d.text;l=d.caret,e.value=c,ms(e,l),a&&a(i)}var fs=["ref","parse","format","value","defaultValue","controlled","onChange","onKeyDown"];function ps(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function bs(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ps(Object(s),!0).forEach(function(t){ys(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ps(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function ys(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function vs(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function js(e){var t=e.ref,s=e.parse,r=e.format,a=e.value,i=e.defaultValue,l=e.controlled,o=void 0===l||l,d=e.onChange,c=e.onKeyDown,u=vs(e,fs),m=n.useRef(),h=n.useCallback(function(e){m.current=e,t&&("function"==typeof t?t(e):t.current=e)},[t]),x=n.useCallback(function(e){gs(m.current,s,r,void 0,d)},[m,s,r,d]),g=n.useCallback(function(e){if(c&&c(e),!e.defaultPrevented)return xs(e,m.current,s,r,d)},[m,s,r,d,c]),f=bs(bs({},u),{},{ref:h,onChange:x,onKeyDown:g});return bs(bs({},f),{},o?{value:r(Ns(a)?"":a).text}:{defaultValue:r(Ns(i)?"":i).text})}function Ns(e){return null==e}var ws=["inputComponent","parse","format","value","defaultValue","onChange","controlled","onKeyDown","type"];function Ss(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function ks(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Cs(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function $s(e,t){var s=e.inputComponent,r=void 0===s?"input":s,a=e.parse,n=e.format,i=e.value,o=e.defaultValue,d=e.onChange,c=e.controlled,u=e.onKeyDown,m=e.type,h=js(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ss(Object(s),!0).forEach(function(t){ks(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ss(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({ref:t,parse:a,format:n,value:i,defaultValue:o,onChange:d,controlled:c,onKeyDown:u,type:void 0===m?"text":m},Cs(e,ws)));return l.createElement(r,h)}function _s(e,t){e=e.split("-"),t=t.split("-");for(var s=e[0].split("."),r=t[0].split("."),a=0;a<3;a++){var n=Number(s[a]),i=Number(r[a]);if(n>i)return 1;if(i>n)return-1;if(!isNaN(n)&&isNaN(i))return 1;if(isNaN(n)&&!isNaN(i))return-1}return e[1]&&t[1]?e[1]>t[1]?1:e[1]<t[1]?-1:0:!e[1]&&t[1]?1:e[1]&&!t[1]?-1:0}($s=l.forwardRef($s)).propTypes={parse:x.func.isRequired,format:x.func.isRequired,inputComponent:x.elementType,type:x.string,value:x.string,defaultValue:x.string,onChange:x.func,controlled:x.bool,onKeyDown:x.func,onCut:x.func,onPaste:x.func};var As={}.constructor;function Ps(e){return null!=e&&e.constructor===As}function Ls(e){return(Ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Es(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ts(e,t,s){return t&&function(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Is(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Is(e){var t=function(e,t){if("object"!=Ls(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=Ls(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==Ls(t)?t:t+""}var Os=" ext. ",Fs=/^\d+$/,Rs=function(){return Ts(function e(t){Es(this,e),zs(t),this.metadata=t,Gs.call(this,t)},[{key:"getCountries",value:function(){return Object.keys(this.metadata.countries).filter(function(e){return"001"!==e})}},{key:"getCountryMetadata",value:function(e){return this.metadata.countries[e]}},{key:"nonGeographic",value:function(){if(!(this.v1||this.v2||this.v3))return this.metadata.nonGeographic||this.metadata.nonGeographical}},{key:"hasCountry",value:function(e){return void 0!==this.getCountryMetadata(e)}},{key:"hasCallingCode",value:function(e){if(this.getCountryCodesForCallingCode(e))return!0;if(this.nonGeographic()){if(this.nonGeographic()[e])return!0}else{var t=this.countryCallingCodes()[e];if(t&&1===t.length&&"001"===t[0])return!0}}},{key:"isNonGeographicCallingCode",value:function(e){return this.nonGeographic()?!!this.nonGeographic()[e]:!this.getCountryCodesForCallingCode(e)}},{key:"country",value:function(e){return this.selectNumberingPlan(e)}},{key:"selectNumberingPlan",value:function(e,t){if(e&&Fs.test(e)&&(t=e,e=null),e&&"001"!==e){if(!this.hasCountry(e))throw new Error("Unknown country: ".concat(e));this.numberingPlan=new Ds(this.getCountryMetadata(e),this)}else if(t){if(!this.hasCallingCode(t))throw new Error("Unknown calling code: ".concat(t));this.numberingPlan=new Ds(this.getNumberingPlanMetadata(t),this)}else this.numberingPlan=void 0;return this}},{key:"getCountryCodesForCallingCode",value:function(e){var t=this.countryCallingCodes()[e];if(t){if(1===t.length&&3===t[0].length)return;return t}}},{key:"getCountryCodeForCallingCode",value:function(e){var t=this.getCountryCodesForCallingCode(e);if(t)return t[0]}},{key:"getNumberingPlanMetadata",value:function(e){var t=this.getCountryCodeForCallingCode(e);if(t)return this.getCountryMetadata(t);if(this.nonGeographic()){var s=this.nonGeographic()[e];if(s)return s}else{var r=this.countryCallingCodes()[e];if(r&&1===r.length&&"001"===r[0])return this.metadata.countries["001"]}}},{key:"countryCallingCode",value:function(){return this.numberingPlan.callingCode()}},{key:"IDDPrefix",value:function(){return this.numberingPlan.IDDPrefix()}},{key:"defaultIDDPrefix",value:function(){return this.numberingPlan.defaultIDDPrefix()}},{key:"nationalNumberPattern",value:function(){return this.numberingPlan.nationalNumberPattern()}},{key:"possibleLengths",value:function(){return this.numberingPlan.possibleLengths()}},{key:"formats",value:function(){return this.numberingPlan.formats()}},{key:"nationalPrefixForParsing",value:function(){return this.numberingPlan.nationalPrefixForParsing()}},{key:"nationalPrefixTransformRule",value:function(){return this.numberingPlan.nationalPrefixTransformRule()}},{key:"leadingDigits",value:function(){return this.numberingPlan.leadingDigits()}},{key:"hasTypes",value:function(){return this.numberingPlan.hasTypes()}},{key:"type",value:function(e){return this.numberingPlan.type(e)}},{key:"ext",value:function(){return this.numberingPlan.ext()}},{key:"countryCallingCodes",value:function(){return this.v1?this.metadata.country_phone_code_to_countries:this.metadata.country_calling_codes}},{key:"chooseCountryByCountryCallingCode",value:function(e){return this.selectNumberingPlan(e)}},{key:"hasSelectedNumberingPlan",value:function(){return void 0!==this.numberingPlan}}])}(),Ds=function(){return Ts(function e(t,s){Es(this,e),this.globalMetadataObject=s,this.metadata=t,Gs.call(this,s.metadata)},[{key:"callingCode",value:function(){return this.metadata[0]}},{key:"getDefaultCountryMetadataForRegion",value:function(){return this.globalMetadataObject.getNumberingPlanMetadata(this.callingCode())}},{key:"IDDPrefix",value:function(){if(!this.v1&&!this.v2)return this.metadata[1]}},{key:"defaultIDDPrefix",value:function(){if(!this.v1&&!this.v2)return this.metadata[12]}},{key:"nationalNumberPattern",value:function(){return this.v1||this.v2?this.metadata[1]:this.metadata[2]}},{key:"possibleLengths",value:function(){if(!this.v1)return this.metadata[this.v2?2:3]}},{key:"_getFormats",value:function(e){return e[this.v1?2:this.v2?3:4]}},{key:"formats",value:function(){var e=this;return(this._getFormats(this.metadata)||this._getFormats(this.getDefaultCountryMetadataForRegion())||[]).map(function(t){return new Ms(t,e)})}},{key:"nationalPrefix",value:function(){return this.metadata[this.v1?3:this.v2?4:5]}},{key:"_getNationalPrefixFormattingRule",value:function(e){return e[this.v1?4:this.v2?5:6]}},{key:"nationalPrefixFormattingRule",value:function(){return this._getNationalPrefixFormattingRule(this.metadata)||this._getNationalPrefixFormattingRule(this.getDefaultCountryMetadataForRegion())}},{key:"_nationalPrefixForParsing",value:function(){return this.metadata[this.v1?5:this.v2?6:7]}},{key:"nationalPrefixForParsing",value:function(){return this._nationalPrefixForParsing()||this.nationalPrefix()}},{key:"nationalPrefixTransformRule",value:function(){return this.metadata[this.v1?6:this.v2?7:8]}},{key:"_getNationalPrefixIsOptionalWhenFormatting",value:function(){return!!this.metadata[this.v1?7:this.v2?8:9]}},{key:"nationalPrefixIsOptionalWhenFormattingInNationalFormat",value:function(){return this._getNationalPrefixIsOptionalWhenFormatting(this.metadata)||this._getNationalPrefixIsOptionalWhenFormatting(this.getDefaultCountryMetadataForRegion())}},{key:"leadingDigits",value:function(){return this.metadata[this.v1?8:this.v2?9:10]}},{key:"types",value:function(){return this.metadata[this.v1?9:this.v2?10:11]}},{key:"hasTypes",value:function(){return(!this.types()||0!==this.types().length)&&!!this.types()}},{key:"type",value:function(e){if(this.hasTypes()&&qs(this.types(),e))return new Us(qs(this.types(),e),this)}},{key:"ext",value:function(){return this.v1||this.v2?Os:this.metadata[13]||Os}}])}(),Ms=function(){return Ts(function e(t,s){Es(this,e),this._format=t,this.metadata=s},[{key:"pattern",value:function(){return this._format[0]}},{key:"format",value:function(){return this._format[1]}},{key:"leadingDigitsPatterns",value:function(){return this._format[2]||[]}},{key:"nationalPrefixFormattingRule",value:function(){return this._format[3]||this.metadata.nationalPrefixFormattingRule()}},{key:"nationalPrefixIsOptionalWhenFormattingInNationalFormat",value:function(){return!!this._format[4]||this.metadata.nationalPrefixIsOptionalWhenFormattingInNationalFormat()}},{key:"nationalPrefixIsMandatoryWhenFormattingInNationalFormat",value:function(){return this.usesNationalPrefix()&&!this.nationalPrefixIsOptionalWhenFormattingInNationalFormat()}},{key:"usesNationalPrefix",value:function(){return!(!this.nationalPrefixFormattingRule()||Bs.test(this.nationalPrefixFormattingRule()))}},{key:"internationalFormat",value:function(){return this._format[5]||this.format()}}])}(),Bs=/^\(?\$1\)?$/,Us=function(){return Ts(function e(t,s){Es(this,e),this.type=t,this.metadata=s},[{key:"pattern",value:function(){return this.metadata.v1?this.type:this.type[0]}},{key:"possibleLengths",value:function(){if(!this.metadata.v1)return this.type[1]||this.metadata.possibleLengths()}}])}();function qs(e,t){switch(t){case"FIXED_LINE":return e[0];case"MOBILE":return e[1];case"TOLL_FREE":return e[2];case"PREMIUM_RATE":return e[3];case"PERSONAL_NUMBER":return e[4];case"VOICEMAIL":return e[5];case"UAN":return e[6];case"PAGER":return e[7];case"VOIP":return e[8];case"SHARED_COST":return e[9]}}function zs(e){if(!e)throw new Error("[libphonenumber-js] `metadata` argument not passed. Check your arguments.");if(!Ps(e)||!Ps(e.countries))throw new Error("[libphonenumber-js] `metadata` argument was passed but it's not a valid metadata. Must be an object having `.countries` child object property. Got ".concat(Ps(e)?"an object of shape: { "+Object.keys(e).join(", ")+" }":"a "+Ws(e)+": "+e,"."))}var Ws=function(e){return Ls(e)};function Vs(e,t){if((t=new Rs(t)).hasCountry(e))return t.selectNumberingPlan(e).countryCallingCode();throw new Error("Unknown country: ".concat(e))}function Hs(e,t){return t.countries.hasOwnProperty(e)}function Gs(e){var t=e.version;"number"==typeof t?(this.v1=1===t,this.v2=2===t,this.v3=3===t,this.v4=4===t):t?-1===_s(t,"1.2.0")?this.v2=!0:-1===_s(t,"1.7.35")?this.v3=!0:this.v4=!0:this.v1=!0}function Js(e,t,s){return function(e,t,s,r){t&&(r=new Rs(r.metadata)).selectNumberingPlan(t);var a=r.type(s),n=a&&a.possibleLengths()||r.possibleLengths();if(!n)return"IS_POSSIBLE";var i=e.length,l=n[0];if(l===i)return"IS_POSSIBLE";if(l>i)return"TOO_SHORT";if(n[n.length-1]<i)return"TOO_LONG";return n.indexOf(i,1)>=0?"IS_POSSIBLE":"INVALID_LENGTH"}(e,t,void 0,s)}function Ks(e,t,s){return"IS_POSSIBLE"===Js(e,t,s)}function Ys(e,t){return e=e||"",new RegExp("^(?:"+t+")$").test(e)}function Zs(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(e){if("string"==typeof e)return Xs(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Xs(e,t):void 0}}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Xs(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}var Qs=["MOBILE","PREMIUM_RATE","TOLL_FREE","SHARED_COST","VOIP","PERSONAL_NUMBER","PAGER","UAN","VOICEMAIL"];function er(e,t,s){if(t=t||{},e.country||e.countryCallingCode){(s=new Rs(s)).selectNumberingPlan(e.country,e.countryCallingCode);var r=t.v2?e.nationalNumber:e.phone;if(Ys(r,s.nationalNumberPattern())){if(tr(r,"FIXED_LINE",s))return s.type("MOBILE")&&""===s.type("MOBILE").pattern()?"FIXED_LINE_OR_MOBILE":s.type("MOBILE")?tr(r,"MOBILE",s)?"FIXED_LINE_OR_MOBILE":"FIXED_LINE":"FIXED_LINE_OR_MOBILE";for(var a,n=Zs(Qs);!(a=n()).done;){var i=a.value;if(tr(r,i,s))return i}}}}function tr(e,t,s){return!(!(t=s.type(t))||!t.pattern())&&(!(t.possibleLengths()&&t.possibleLengths().indexOf(e.length)<0)&&Ys(e,t.pattern()))}function sr(e,t,s){var r=new Rs(s).getCountryCodesForCallingCode(e);return r?r.filter(function(e){return function(e,t,s){var r=new Rs(s);if(r.selectNumberingPlan(t),r.numberingPlan.possibleLengths().indexOf(e.length)>=0)return!0;return!1}(t,e,s)}):[]}var rr="0-9０-９٠-٩۰-۹",ar="".concat("-‐-―−ー－").concat("／/").concat("．.").concat("  ­​⁠　").concat("()（）［］\\[\\]").concat("~⁓∼～"),nr=new RegExp("(["+rr+"])");function ir(e,t,s,r){if(t){var a=new Rs(r);a.selectNumberingPlan(t,s);var n=new RegExp(a.IDDPrefix());if(0===e.search(n)){var i=(e=e.slice(e.match(n)[0].length)).match(nr);if(!(i&&null!=i[1]&&i[1].length>0&&"0"===i[1]))return e}}}function lr(e,t){if(e&&t.numberingPlan.nationalPrefixForParsing()){var s=new RegExp("^(?:"+t.numberingPlan.nationalPrefixForParsing()+")"),r=s.exec(e);if(r){var a,n,i,l=r.length-1,o=l>0&&r[l];if(t.nationalPrefixTransformRule()&&o)a=e.replace(s,t.nationalPrefixTransformRule()),l>1&&(n=r[1]);else{var d=r[0];a=e.slice(d.length),o&&(n=r[1])}if(o){var c=e.indexOf(r[1]);e.slice(0,c)===t.numberingPlan.nationalPrefix()&&(i=t.numberingPlan.nationalPrefix())}else i=r[0];return{nationalNumber:a,nationalPrefix:i,carrierCode:n}}}return{nationalNumber:e}}function or(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(e){if("string"==typeof e)return dr(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?dr(e,t):void 0}}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}function cr(e,t){var s=t.countries,r=t.metadata;r=new Rs(r);for(var a,n=or(s);!(a=n()).done;){var i=a.value;if(r.selectNumberingPlan(i),r.leadingDigits()){if(e&&0===e.search(r.leadingDigits()))return i}else if(er({phone:e,country:i},void 0,r.metadata))return i}}function ur(e,t){var s=t.nationalNumber,r=t.metadata,a=r.getCountryCodesForCallingCode(e);if(a)return 1===a.length?a[0]:cr(s,{countries:a,metadata:r.metadata})}function mr(e,t,s){var r=lr(e,s),a=r.carrierCode,n=r.nationalNumber;if(n!==e){if(!function(e,t,s){if(Ys(e,s.nationalNumberPattern())&&!Ys(t,s.nationalNumberPattern()))return!1;return!0}(e,n,s))return{nationalNumber:e};if(s.numberingPlan.possibleLengths()&&(t||(t=ur(s.numberingPlan.callingCode(),{nationalNumber:n,metadata:s})),!function(e,t,s){switch(Js(e,t,s)){case"TOO_SHORT":case"INVALID_LENGTH":return!1;default:return!0}}(n,t,s)))return{nationalNumber:e}}return{nationalNumber:n,carrierCode:a}}function hr(e,t,s,r,a){var n=t||s?Vs(t||s,a):r;if(0===e.indexOf(n)){(a=new Rs(a)).selectNumberingPlan(t||s,n);var i=e.slice(n.length),l=mr(i,t,a).nationalNumber,o=mr(e,t,a).nationalNumber;if(!Ys(o,a.nationalNumberPattern())&&Ys(l,a.nationalNumberPattern())||"TOO_LONG"===Js(o,t,a))return{countryCallingCode:n,number:i}}return{number:e}}function xr(e,t,s,r,a){if(!e)return{};var n;if("+"!==e[0]){var i=ir(e,t||s,r,a);if(!i||i===e){if(t||s||r){var l=hr(e,t,s,r,a),o=l.countryCallingCode,d=l.number;if(o)return{countryCallingCodeSource:"FROM_NUMBER_WITHOUT_PLUS_SIGN",countryCallingCode:o,number:d}}return{number:e}}n=!0,e="+"+i}if("0"===e[1])return{};a=new Rs(a);for(var c=2;c-1<=3&&c<=e.length;){var u=e.slice(1,c);if(a.hasCallingCode(u))return a.selectNumberingPlan(u),{countryCallingCodeSource:n?"FROM_NUMBER_WITH_IDD":"FROM_NUMBER_WITH_PLUS_SIGN",countryCallingCode:u,number:e.slice(c)};c++}return{}}function gr(e){return e.replace(new RegExp("[".concat(ar,"]+"),"g")," ").trim()}var fr=/(\$\d)/;function pr(e,t,s){var r=s.useInternationalFormat,a=s.withNationalPrefix;s.carrierCode,s.metadata;var n=e.replace(new RegExp(t.pattern()),r?t.internationalFormat():a&&t.nationalPrefixFormattingRule()?t.format().replace(fr,t.nationalPrefixFormattingRule()):t.format());return r?gr(n):n}var br=/^[\d]+(?:[~\u2053\u223C\uFF5E][\d]+)?$/;var yr=function(e){return"([".concat(rr,"]{1,").concat(e,"})")};function vr(e){var t="[  \\t,]*",s="[:\\.．]?[  \\t,-]*",r="#?",a="[  \\t]*";return";ext="+yr("20")+"|"+(t+"(?:e?xt(?:ensi(?:ó?|ó))?n?|ｅ?ｘｔｎ?|доб|anexo)"+s+yr("20")+r)+"|"+(t+"(?:[xｘ#＃~～]|int|ｉｎｔ)"+s+yr("9")+r)+"|"+("[- ]+"+yr("6")+"#")+"|"+(a+"(?:,{2}|;)"+s+yr("15")+r)+"|"+(a+"(?:,)+"+s+yr("9")+r)}var jr="["+rr+"]{2}",Nr="[+＋]{0,1}(?:["+ar+"]*["+rr+"]){3,}["+ar+rr+"]*",wr=new RegExp("^[+＋]{0,1}(?:["+ar+"]*["+rr+"]){1,2}$","i"),Sr=Nr+"(?:"+vr()+")?",kr=new RegExp("^"+jr+"$|^"+Sr+"$","i");function Cr(e){return(Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $r(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(e){if("string"==typeof e)return _r(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?_r(e,t):void 0}}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _r(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}function Ar(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function Pr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ar(Object(s),!0).forEach(function(t){Lr(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ar(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function Lr(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=Cr(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=Cr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Cr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Er={formatExtension:function(e,t,s){return"".concat(e).concat(s.ext()).concat(t)}};function Tr(e,t,s,r){if(s=s?Pr(Pr({},Er),s):Er,r=new Rs(r),e.country&&"001"!==e.country){if(!r.hasCountry(e.country))throw new Error("Unknown country: ".concat(e.country));r.selectNumberingPlan(e.country)}else{if(!e.countryCallingCode)return e.phone||"";r.selectNumberingPlan(e.countryCallingCode)}var a,n=r.countryCallingCode(),i=s.v2?e.nationalNumber:e.phone;switch(t){case"NATIONAL":return i?Or(a=Ir(i,e.carrierCode,"NATIONAL",r,s),e.ext,r,s.formatExtension):"";case"INTERNATIONAL":return i?(a=Ir(i,null,"INTERNATIONAL",r,s),Or(a="+".concat(n," ").concat(a),e.ext,r,s.formatExtension)):"+".concat(n);case"E.164":return"+".concat(n).concat(i);case"RFC3966":return function(e){var t=e.number,s=e.ext;if(!t)return"";if("+"!==t[0])throw new Error('"formatRFC3966()" expects "number" to be in E.164 format.');return"tel:".concat(t).concat(s?";ext="+s:"")}({number:"+".concat(n).concat(i),ext:e.ext});case"IDD":if(!s.fromCountry)return;var l=function(e,t,s,r,a){var n=Vs(r,a.metadata);if(n===s){var i=Ir(e,t,"NATIONAL",a);return"1"===s?s+" "+i:i}var l=function(e,t,s){var r=new Rs(s);return r.selectNumberingPlan(e,t),r.defaultIDDPrefix()?r.defaultIDDPrefix():br.test(r.IDDPrefix())?r.IDDPrefix():void 0}(r,void 0,a.metadata);if(l)return"".concat(l," ").concat(s," ").concat(Ir(e,null,"INTERNATIONAL",a))}(i,e.carrierCode,n,s.fromCountry,r);return Or(l,e.ext,r,s.formatExtension);default:throw new Error('Unknown "format" argument passed to "formatNumber()": "'.concat(t,'"'))}}function Ir(e,t,s,r,a){var n=function(e,t){for(var s,r=$r(e);!(s=r()).done;){var a=s.value;if(a.leadingDigitsPatterns().length>0){var n=a.leadingDigitsPatterns()[a.leadingDigitsPatterns().length-1];if(0!==t.search(n))continue}if(Ys(t,a.pattern()))return a}}(r.formats(),e);return n?pr(e,n,{useInternationalFormat:"INTERNATIONAL"===s,withNationalPrefix:!n.nationalPrefixIsOptionalWhenFormattingInNationalFormat()||!a||!1!==a.nationalPrefix,carrierCode:t,metadata:r}):e}function Or(e,t,s,r){return t?r(e,t,s):e}function Fr(e){return(Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function Dr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Rr(Object(s),!0).forEach(function(t){Mr(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Rr(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function Mr(e,t,s){return(t=Ur(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Br(e,t,s){return t&&function(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ur(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ur(e){var t=function(e,t){if("object"!=Fr(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=Fr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==Fr(t)?t:t+""}var qr=function(){return Br(function e(t,s,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw new TypeError("First argument is required");if("string"!=typeof t)throw new TypeError("First argument must be a string");if("+"===t[0]&&!s)throw new TypeError("`metadata` argument not passed");if(Ps(s)&&Ps(s.countries)){r=s;var a=t;if(!Wr.test(a))throw new Error('Invalid `number` argument passed: must consist of a "+" followed by digits');var n=xr(a,void 0,void 0,void 0,r);if(t=n.countryCallingCode,!(s=n.number))throw new Error("Invalid `number` argument passed: too short")}if(!s)throw new TypeError("`nationalNumber` argument is required");if("string"!=typeof s)throw new TypeError("`nationalNumber` argument must be a string");zs(r);var i=function(e,t){var s,r,a=new Rs(t);zr(e)?(s=e,a.selectNumberingPlan(s),r=a.countryCallingCode()):r=e;return{country:s,countryCallingCode:r}}(t,r),l=i.country,o=i.countryCallingCode;this.country=l,this.countryCallingCode=o,this.nationalNumber=s,this.number="+"+this.countryCallingCode+this.nationalNumber,this.getMetadata=function(){return r}},[{key:"setExt",value:function(e){this.ext=e}},{key:"getPossibleCountries",value:function(){return this.country?[this.country]:sr(this.countryCallingCode,this.nationalNumber,this.getMetadata())}},{key:"isPossible",value:function(){return function(e,t,s){if(void 0===t&&(t={}),s=new Rs(s),t.v2){if(!e.countryCallingCode)throw new Error("Invalid phone number object passed");s.selectNumberingPlan(e.countryCallingCode)}else{if(!e.phone)return!1;if(e.country){if(!s.hasCountry(e.country))throw new Error("Unknown country: ".concat(e.country));s.selectNumberingPlan(e.country)}else{if(!e.countryCallingCode)throw new Error("Invalid phone number object passed");s.selectNumberingPlan(e.countryCallingCode)}}if(s.possibleLengths())return Ks(e.phone||e.nationalNumber,e.country,s);if(e.countryCallingCode&&s.isNonGeographicCallingCode(e.countryCallingCode))return!0;throw new Error('Missing "possibleLengths" in metadata. Perhaps the metadata has been generated before v1.0.18.')}(this,{v2:!0},this.getMetadata())}},{key:"isValid",value:function(){return function(e,t,s){return t=t||{},(s=new Rs(s)).selectNumberingPlan(e.country,e.countryCallingCode),s.hasTypes()?void 0!==er(e,t,s.metadata):Ys(t.v2?e.nationalNumber:e.phone,s.nationalNumberPattern())}(this,{v2:!0},this.getMetadata())}},{key:"isNonGeographic",value:function(){return new Rs(this.getMetadata()).isNonGeographicCallingCode(this.countryCallingCode)}},{key:"isEqual",value:function(e){return this.number===e.number&&this.ext===e.ext}},{key:"getType",value:function(){return er(this,{v2:!0},this.getMetadata())}},{key:"format",value:function(e,t){return Tr(this,e,t?Dr(Dr({},t),{},{v2:!0}):{v2:!0},this.getMetadata())}},{key:"formatNational",value:function(e){return this.format("NATIONAL",e)}},{key:"formatInternational",value:function(e){return this.format("INTERNATIONAL",e)}},{key:"getURI",value:function(e){return this.format("RFC3966",e)}}])}(),zr=function(e){return/^[A-Z]{2}$/.test(e)};var Wr=/^\+\d+$/;function Vr(e){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hr(e,t,s){return t=Yr(t),function(e,t){if(t&&("object"==Vr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Jr()?Reflect.construct(t,s||[],Yr(e).constructor):t.apply(e,s))}function Gr(e){var t="function"==typeof Map?new Map:void 0;return Gr=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,s)}function s(){return function(e,t,s){if(Jr())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var a=new(e.bind.apply(e,r));return s&&Kr(a,s.prototype),a}(e,arguments,Yr(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),Kr(s,e)},Gr(e)}function Jr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Jr=function(){return!!e})()}function Kr(e,t){return(Kr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Yr(e){return(Yr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zr=function(){function e(t){var s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s=Hr(this,e,[t]),Object.setPrototypeOf(s,e.prototype),s.name=s.constructor.name,s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kr(e,t)}(e,Gr(Error)),t=e,Object.defineProperty(t,"prototype",{writable:!1}),t;var t}(),Xr=new RegExp("(?:"+vr()+")$","i");function Qr(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(e){if("string"==typeof e)return ea(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?ea(e,t):void 0}}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}var ta={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9","０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9"};function sa(e){return ta[e]}function ra(e){for(var t,s="",r=Qr(e.split(""));!(t=r()).done;){var a=sa(t.value);a&&(s+=a)}return s}function aa(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(e){if("string"==typeof e)return na(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?na(e,t):void 0}}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function na(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}function ia(e){for(var t,s="",r=aa(e.split(""));!(t=r()).done;){s+=la(t.value,s)||""}return s}function la(e,t,s){return"+"===e?t?void("function"==typeof s&&s("end")):"+":sa(e)}var oa="(["+rr+"]|[\\-\\.\\(\\)]?)",da=new RegExp("^\\+"+oa+"*["+rr+"]"+oa+"*$","g"),ca=new RegExp("^("+("["+rr+"]+((\\-)*["+rr+"])*")+"\\.)*"+("[a-zA-Z]+((\\-)*["+rr+"])*")+"\\.?$","g"),ua="tel:",ma=";phone-context=";function ha(e,t){var s,r=t.extractFormattedPhoneNumber,a=function(e){var t=e.indexOf(ma);if(t<0)return null;var s=t+15;if(s>=e.length)return"";var r=e.indexOf(";",s);return r>=0?e.substring(s,r):e.substring(s)}(e);if(!function(e){return null===e||0!==e.length&&(da.test(e)||ca.test(e))}(a))throw new Zr("NOT_A_NUMBER");if(null===a)s=r(e)||"";else{s="","+"===a.charAt(0)&&(s+=a);var n,i=e.indexOf(ua);n=i>=0?i+4:0;var l=e.indexOf(ma);s+=e.substring(n,l)}var o=s.indexOf(";isub=");if(o>0&&(s=s.substring(0,o)),""!==s)return s}var xa=new RegExp("[+＋"+rr+"]"),ga=new RegExp("[^"+rr+"#]+$");function fa(e,t,s){if(t=t||{},s=new Rs(s),t.defaultCountry&&!s.hasCountry(t.defaultCountry)){if(t.v2)throw new Zr("INVALID_COUNTRY");throw new Error("Unknown country: ".concat(t.defaultCountry))}var r=function(e,t,s){var r=ha(e,{extractFormattedPhoneNumber:function(e){return function(e,t,s){if(!e)return;if(e.length>250){if(s)throw new Zr("TOO_LONG");return}if(!1===t)return e;var r=e.search(xa);if(r<0)return;return e.slice(r).replace(ga,"")}(e,s,t)}});if(!r)return{};if(!function(e){return e.length>=2&&kr.test(e)}(r))return function(e){return wr.test(e)}(r)?{error:"TOO_SHORT"}:{};var a=function(e){var t=e.search(Xr);if(t<0)return{};for(var s=e.slice(0,t),r=e.match(Xr),a=1;a<r.length;){if(r[a])return{number:s,ext:r[a]};a++}}(r);if(a.ext)return a;return{number:r}}(e,t.v2,t.extract),a=r.number,n=r.ext,i=r.error;if(!a){if(t.v2){if("TOO_SHORT"===i)throw new Zr("TOO_SHORT");throw new Zr("NOT_A_NUMBER")}return{}}var l=function(e,t,s,r){var a,n=xr(ia(e),void 0,t,s,r.metadata),i=n.countryCallingCodeSource,l=n.countryCallingCode,o=n.number;if(l)r.selectNumberingPlan(l);else{if(!o||!t&&!s)return{};r.selectNumberingPlan(t,s),t&&(a=t),l=s||Vs(t,r.metadata)}if(!o)return{countryCallingCodeSource:i,countryCallingCode:l};var d=mr(ia(o),a,r),c=d.nationalNumber,u=d.carrierCode,m=ur(l,{nationalNumber:c,metadata:r});m&&(a=m,"001"===m||r.selectNumberingPlan(a));return{country:a,countryCallingCode:l,countryCallingCodeSource:i,nationalNumber:c,carrierCode:u}}(a,t.defaultCountry,t.defaultCallingCode,s),o=l.country,d=l.nationalNumber,c=l.countryCallingCode,u=l.countryCallingCodeSource,m=l.carrierCode;if(!s.hasSelectedNumberingPlan()){if(t.v2)throw new Zr("INVALID_COUNTRY");return{}}if(!d||d.length<2){if(t.v2)throw new Zr("TOO_SHORT");return{}}if(d.length>17){if(t.v2)throw new Zr("TOO_LONG");return{}}if(t.v2){var h=new qr(c,d,s.metadata);return o&&(h.country=o),m&&(h.carrierCode=m),n&&(h.ext=n),h.__countryCallingCodeSource=u,h}var x=!!(t.extended?s.hasSelectedNumberingPlan():o)&&Ys(d,s.nationalNumberPattern());return t.extended?{country:o,countryCallingCode:c,carrierCode:m,valid:x,possible:!!x||!(!0!==t.extended||!s.possibleLengths()||!Ks(d,o,s)),phone:d,ext:n}:x?function(e,t,s){var r={country:e,phone:t};s&&(r.ext=s);return r}(o,d,n):{}}function pa(e){return(pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ba(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function ya(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ba(Object(s),!0).forEach(function(t){va(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ba(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function va(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=pa(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=pa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pa(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function ja(e){return(ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Na(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function wa(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=ja(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=ja(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ja(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Sa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var s=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=s){var r,a,n,i,l=[],o=!0,d=!1;try{if(n=(s=s.call(e)).next,0===t);else for(;!(o=(r=n.call(s)).done)&&(l.push(r.value),l.length!==t);o=!0);}catch(c){d=!0,a=c}finally{try{if(!o&&null!=s.return&&(i=s.return(),Object(i)!==i))return}finally{if(d)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ka(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?ka(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ka(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}function Ca(e){var t,s,r,a=Sa(Array.prototype.slice.call(e),4),n=a[0],i=a[1],l=a[2],o=a[3];if("string"!=typeof n)throw new TypeError("A text for parsing must be a string.");if(t=n,i&&"string"!=typeof i){if(!Ps(i))throw new Error("Invalid second argument: ".concat(i));l?(s=i,r=l):r=i}else o?(s=l,r=o):(s=void 0,r=l),i&&(s=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Na(Object(s),!0).forEach(function(t){wa(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Na(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({defaultCountry:i},s));return{text:t,options:s,metadata:r}}function $a(e){return($a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function Aa(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?_a(Object(s),!0).forEach(function(t){Pa(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):_a(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function Pa(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=$a(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=$a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$a(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function La(e,t,s){t&&t.defaultCountry&&!Hs(t.defaultCountry,s)&&(t=Aa(Aa({},t),{},{defaultCountry:void 0}));try{return function(e,t,s){return fa(e,ya(ya({},t),{},{v2:!0}),s)}(e,t,s)}catch(r){if(!(r instanceof Zr))throw r}}function Ea(){var e=Ca(arguments);return La(e.text,e.options,e.metadata)}function Ta(e){return(Ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ia(e,t,s){return t&&function(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Oa(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oa(e){var t=function(e,t){if("object"!=Ta(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=Ta(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==Ta(t)?t:t+""}var Fa=function(){return Ia(function e(t){var s=t.onCountryChange,r=t.onCallingCodeChange;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onCountryChange=s,this.onCallingCodeChange=r},[{key:"reset",value:function(e){var t=e.country,s=e.callingCode;this.international=!1,this.missingPlus=!1,this.IDDPrefix=void 0,this.callingCode=void 0,this.digits="",this.resetNationalSignificantNumber(),this.initCountryAndCallingCode(t,s)}},{key:"resetNationalSignificantNumber",value:function(){this.nationalSignificantNumber=this.getNationalDigits(),this.nationalSignificantNumberIsModified=!1,this.nationalPrefix=void 0,this.carrierCode=void 0,this.prefixBeforeNationalSignificantNumberThatIsNotNationalPrefix=void 0}},{key:"update",value:function(e){for(var t=0,s=Object.keys(e);t<s.length;t++){var r=s[t];this[r]=e[r]}}},{key:"initCountryAndCallingCode",value:function(e,t){this.setCountry(e),this.setCallingCode(t)}},{key:"setCountry",value:function(e){this.country=e,this.onCountryChange(e)}},{key:"setCallingCode",value:function(e){this.callingCode=e,this.onCallingCodeChange(e,this.country)}},{key:"startInternationalNumber",value:function(e,t){this.international=!0,this.initCountryAndCallingCode(e,t)}},{key:"appendDigits",value:function(e){this.digits+=e}},{key:"appendNationalSignificantNumberDigits",value:function(e){this.nationalSignificantNumber+=e}},{key:"getNationalDigits",value:function(){return this.international?this.digits.slice((this.IDDPrefix?this.IDDPrefix.length:0)+(this.callingCode?this.callingCode.length:0)):this.digits}},{key:"getDigitsWithoutInternationalPrefix",value:function(){return this.international&&this.IDDPrefix?this.digits.slice(this.IDDPrefix.length):this.digits}}])}();function Ra(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(e){if("string"==typeof e)return Da(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Da(e,t):void 0}}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Da(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}var Ma="x",Ba=new RegExp(Ma);function Ua(e,t){if(t<1)return"";for(var s="";t>1;)1&t&&(s+=e),t>>=1,e+=e;return s+e}function qa(e,t){return")"===e[t]&&t++,function(e){var t=[],s=0;for(;s<e.length;)"("===e[s]?t.push(s):")"===e[s]&&t.pop(),s++;var r=0,a="";t.push(e.length);for(var n=0,i=t;n<i.length;n++){var l=i[n];a+=e.slice(r,l),r=l+1}return a}(e.slice(0,t))}function za(e,t,s){var r=s.metadata,a=s.shouldTryNationalPrefixFormattingRule,n=s.getSeparatorAfterNationalPrefix;if(new RegExp("^(?:".concat(t.pattern(),")$")).test(e.nationalSignificantNumber))return function(e,t,s){var r=s.metadata,a=s.shouldTryNationalPrefixFormattingRule,n=s.getSeparatorAfterNationalPrefix;if(e.nationalSignificantNumber,e.international,e.nationalPrefix,e.carrierCode,a(t)){var i=Wa(e,t,{useNationalPrefixFormattingRule:!0,getSeparatorAfterNationalPrefix:n,metadata:r});if(i)return i}return Wa(e,t,{useNationalPrefixFormattingRule:!1,getSeparatorAfterNationalPrefix:n,metadata:r})}(e,t,{metadata:r,shouldTryNationalPrefixFormattingRule:a,getSeparatorAfterNationalPrefix:n})}function Wa(e,t,s){var r=s.metadata,a=s.useNationalPrefixFormattingRule,n=s.getSeparatorAfterNationalPrefix,i=pr(e.nationalSignificantNumber,t,{carrierCode:e.carrierCode,useInternationalFormat:e.international,withNationalPrefix:a,metadata:r});if(a||(e.nationalPrefix?i=e.nationalPrefix+n(t)+i:e.prefixBeforeNationalSignificantNumberThatIsNotNationalPrefix&&(i=e.prefixBeforeNationalSignificantNumberThatIsNotNationalPrefix+" "+i)),function(e,t){return ra(e)===t.getNationalDigits()}(i,e))return i}function Va(e){return(Va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ha(e,t,s){return t&&function(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ga(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ga(e){var t=function(e,t){if("object"!=Va(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=Va(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==Va(t)?t:t+""}var Ja=function(){return Ha(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},[{key:"parse",value:function(e){if(this.context=[{or:!0,instructions:[]}],this.parsePattern(e),1!==this.context.length)throw new Error("Non-finalized contexts left when pattern parse ended");var t=this.context[0],s=t.branches,r=t.instructions;if(s)return{op:"|",args:s.concat([Xa(r)])};if(0===r.length)throw new Error("Pattern is required");return 1===r.length?r[0]:r}},{key:"startContext",value:function(e){this.context.push(e)}},{key:"endContext",value:function(){this.context.pop()}},{key:"getContext",value:function(){return this.context[this.context.length-1]}},{key:"parsePattern",value:function(e){if(!e)throw new Error("Pattern is required");var t=e.match(Za);if(t){var s=t[1],r=e.slice(0,t.index),a=e.slice(t.index+s.length);switch(s){case"(?:":r&&this.parsePattern(r),this.startContext({or:!0,instructions:[],branches:[]});break;case")":if(!this.getContext().or)throw new Error('")" operator must be preceded by "(?:" operator');if(r&&this.parsePattern(r),0===this.getContext().instructions.length)throw new Error('No instructions found after "|" operator in an "or" group');var n=this.getContext().branches;n.push(Xa(this.getContext().instructions)),this.endContext(),this.getContext().instructions.push({op:"|",args:n});break;case"|":if(!this.getContext().or)throw new Error('"|" operator can only be used inside "or" groups');if(r&&this.parsePattern(r),!this.getContext().branches){if(1!==this.context.length)throw new Error('"branches" not found in an "or" group context');this.getContext().branches=[]}this.getContext().branches.push(Xa(this.getContext().instructions)),this.getContext().instructions=[];break;case"[":r&&this.parsePattern(r),this.startContext({oneOfSet:!0});break;case"]":if(!this.getContext().oneOfSet)throw new Error('"]" operator must be preceded by "[" operator');this.endContext(),this.getContext().instructions.push({op:"[]",args:Ka(r)});break;default:throw new Error("Unknown operator: ".concat(s))}a&&this.parsePattern(a)}else{if(Ya.test(e))throw new Error("Illegal characters found in a pattern: ".concat(e));this.getContext().instructions=this.getContext().instructions.concat(e.split(""))}}}])}();function Ka(e){for(var t=[],s=0;s<e.length;){if("-"===e[s]){if(0===s||s===e.length-1)throw new Error("Couldn't parse a one-of set pattern: ".concat(e));for(var r=e[s-1].charCodeAt(0)+1,a=e[s+1].charCodeAt(0)-1,n=r;n<=a;)t.push(String.fromCharCode(n)),n++}else t.push(e[s]);s++}return t}var Ya=/[\(\)\[\]\?\:\|]/,Za=new RegExp("(\\||\\(\\?\\:|\\)|\\[|\\])");function Xa(e){return 1===e.length?e[0]:e}function Qa(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(e){if("string"==typeof e)return en(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?en(e,t):void 0}}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function en(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}function tn(e){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sn(e,t,s){return t&&function(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rn(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function rn(e){var t=function(e,t){if("object"!=tn(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=tn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==tn(t)?t:t+""}var an=function(){return sn(function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.matchTree=(new Ja).parse(t)},[{key:"match",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowOverflow;if(!e)throw new Error("String is required");var s=nn(e.split(""),this.matchTree,!0);if(s&&s.match&&delete s.matchedChars,!s||!s.overflow||t)return s}}])}();function nn(e,t,s){if("string"==typeof t){var r=e.join("");return 0===t.indexOf(r)?e.length===t.length?{match:!0,matchedChars:e}:{partialMatch:!0}:0===r.indexOf(t)?s&&e.length>t.length?{overflow:!0}:{match:!0,matchedChars:e.slice(0,t.length)}:void 0}if(Array.isArray(t)){for(var a=e.slice(),n=0;n<t.length;){var i=nn(a,t[n],s&&n===t.length-1);if(!i)return;if(i.overflow)return i;if(!i.match){if(i.partialMatch)return{partialMatch:!0};throw new Error("Unsupported match result:\n".concat(JSON.stringify(i,null,2)))}if(0===(a=a.slice(i.matchedChars.length)).length)return n===t.length-1?{match:!0,matchedChars:e}:{partialMatch:!0};n++}return s?{overflow:!0}:{match:!0,matchedChars:e.slice(0,e.length-a.length)}}switch(t.op){case"|":for(var l,o,d=Qa(t.args);!(o=d()).done;){var c=nn(e,o.value,s);if(c){if(c.overflow)return c;if(c.match)return{match:!0,matchedChars:c.matchedChars};if(!c.partialMatch)throw new Error("Unsupported match result:\n".concat(JSON.stringify(c,null,2)));l=!0}}return l?{partialMatch:!0}:void 0;case"[]":for(var u,m=Qa(t.args);!(u=m()).done;){var h=u.value;if(e[0]===h)return 1===e.length?{match:!0,matchedChars:e}:s?{overflow:!0}:{match:!0,matchedChars:[h]}}return;default:throw new Error("Unsupported instruction tree: ".concat(t))}}function ln(e){return(ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function on(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(e){if("string"==typeof e)return dn(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?dn(e,t):void 0}}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}function cn(e,t,s){return t&&function(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,un(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function un(e){var t=function(e,t){if("object"!=ln(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=ln(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==ln(t)?t:t+""}var mn=Ua("9",15),hn=/[- ]/,xn=new RegExp("["+ar+"]*\\$1["+ar+"]*(\\$\\d["+ar+"]*)*$"),gn=function(){return cn(function e(t){t.state;var s=t.metadata;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metadata=s,this.resetFormat()},[{key:"resetFormat",value:function(){this.chosenFormat=void 0,this.template=void 0,this.nationalNumberTemplate=void 0,this.populatedNationalNumberTemplate=void 0,this.populatedNationalNumberTemplatePosition=-1}},{key:"reset",value:function(e,t){this.resetFormat(),e?(this.isNANP="1"===e.callingCode(),this.matchingFormats=e.formats(),t.nationalSignificantNumber&&this.narrowDownMatchingFormats(t)):(this.isNANP=void 0,this.matchingFormats=[])}},{key:"format",value:function(e,t){var s,r,a,n=this;if(s=t.nationalSignificantNumber,r=t.country,a=this.metadata,"IS_POSSIBLE"===Js(s,r,a))for(var i,l=on(this.matchingFormats);!(i=l()).done;){var o=i.value,d=za(t,o,{metadata:this.metadata,shouldTryNationalPrefixFormattingRule:function(e){return n.shouldTryNationalPrefixFormattingRule(e,{international:t.international,nationalPrefix:t.nationalPrefix})},getSeparatorAfterNationalPrefix:function(e){return n.getSeparatorAfterNationalPrefix(e)}});if(d)return this.resetFormat(),this.chosenFormat=o,this.setNationalNumberTemplate(d.replace(/\d/g,Ma),t),this.populatedNationalNumberTemplate=d,this.populatedNationalNumberTemplatePosition=this.template.lastIndexOf(Ma),d}return this.formatNationalNumberWithNextDigits(e,t)}},{key:"formatNationalNumberWithNextDigits",value:function(e,t){var s=this.chosenFormat,r=this.chooseFormat(t);if(r)return r===s?this.formatNextNationalNumberDigits(e):this.formatNextNationalNumberDigits(t.getNationalDigits())}},{key:"narrowDownMatchingFormats",value:function(e){var t=this,s=e.nationalSignificantNumber,r=e.nationalPrefix,a=e.international,n=s,i=n.length-3;i<0&&(i=0),this.matchingFormats=this.matchingFormats.filter(function(e){return t.formatSuits(e,a,r)&&t.formatMatches(e,n,i)}),this.chosenFormat&&-1===this.matchingFormats.indexOf(this.chosenFormat)&&this.resetFormat()}},{key:"formatSuits",value:function(e,t,s){return!(s&&!e.usesNationalPrefix()&&!e.nationalPrefixIsOptionalWhenFormattingInNationalFormat())&&!(!t&&!s&&e.nationalPrefixIsMandatoryWhenFormattingInNationalFormat())}},{key:"formatMatches",value:function(e,t,s){var r=e.leadingDigitsPatterns().length;if(0===r)return!0;s=Math.min(s,r-1);var a=e.leadingDigitsPatterns()[s];if(t.length<3)try{return void 0!==new an(a).match(t,{allowOverflow:!0})}catch(n){return!0}return new RegExp("^(".concat(a,")")).test(t)}},{key:"getFormatFormat",value:function(e,t){return t?e.internationalFormat():e.format()}},{key:"chooseFormat",value:function(e){for(var t,s=this,r=function(){var r=t.value;return s.chosenFormat===r?0:xn.test(s.getFormatFormat(r,e.international))?s.createTemplateForFormat(r,e)?(s.chosenFormat=r,0):(s.matchingFormats=s.matchingFormats.filter(function(e){return e!==r}),1):1},a=on(this.matchingFormats.slice());!(t=a()).done&&0!==r(););return this.chosenFormat||this.resetFormat(),this.chosenFormat}},{key:"createTemplateForFormat",value:function(e,t){if(!(e.pattern().indexOf("|")>=0)){var s=this.getTemplateForFormat(e,t);return s?(this.setNationalNumberTemplate(s,t),!0):void 0}}},{key:"getSeparatorAfterNationalPrefix",value:function(e){return this.isNANP||e&&e.nationalPrefixFormattingRule()&&hn.test(e.nationalPrefixFormattingRule())?" ":""}},{key:"getInternationalPrefixBeforeCountryCallingCode",value:function(e,t){var s=e.IDDPrefix,r=e.missingPlus;return s?t&&!1===t.spacing?s:s+" ":r?"":"+"}},{key:"getTemplate",value:function(e){if(this.template){for(var t=-1,s=0,r=e.international?this.getInternationalPrefixBeforeCountryCallingCode(e,{spacing:!1}):"";s<r.length+e.getDigitsWithoutInternationalPrefix().length;)t=this.template.indexOf(Ma,t+1),s++;return qa(this.template,t+1)}}},{key:"setNationalNumberTemplate",value:function(e,t){this.nationalNumberTemplate=e,this.populatedNationalNumberTemplate=e,this.populatedNationalNumberTemplatePosition=-1,t.international?this.template=this.getInternationalPrefixBeforeCountryCallingCode(t).replace(/[\d\+]/g,Ma)+Ua(Ma,t.callingCode.length)+" "+e:this.template=e}},{key:"getTemplateForFormat",value:function(e,t){var s=t.nationalSignificantNumber,r=t.international,a=t.nationalPrefix,n=t.prefixBeforeNationalSignificantNumberThatIsNotNationalPrefix,i=e.pattern();i=i.replace(/\[([^\[\]])*\]/g,"\\d").replace(/\d(?=[^,}][^,}])/g,"\\d");var l=mn.match(i)[0];if(!(s.length>l.length)){var o=new RegExp("^"+i+"$"),d=s.replace(/\d/g,"9");o.test(d)&&(l=d);var c,u=this.getFormatFormat(e,r);if(this.shouldTryNationalPrefixFormattingRule(e,{international:r,nationalPrefix:a})){var m=u.replace(fr,e.nationalPrefixFormattingRule());if(ra(e.nationalPrefixFormattingRule())===(a||"")+ra("$1")&&(u=m,c=!0,a))for(var h=a.length;h>0;)u=u.replace(/\d/,Ma),h--}var x=l.replace(new RegExp(i),u).replace(new RegExp("9","g"),Ma);return c||(n?x=Ua(Ma,n.length)+" "+x:a&&(x=Ua(Ma,a.length)+this.getSeparatorAfterNationalPrefix(e)+x)),r&&(x=gr(x)),x}}},{key:"formatNextNationalNumberDigits",value:function(e){var t=function(e,t,s){for(var r,a=Ra(s.split(""));!(r=a()).done;){var n=r.value;if(e.slice(t+1).search(Ba)<0)return;t=e.search(Ba),e=e.replace(Ba,n)}return[e,t]}(this.populatedNationalNumberTemplate,this.populatedNationalNumberTemplatePosition,e);if(t)return this.populatedNationalNumberTemplate=t[0],this.populatedNationalNumberTemplatePosition=t[1],qa(this.populatedNationalNumberTemplate,this.populatedNationalNumberTemplatePosition+1);this.resetFormat()}},{key:"shouldTryNationalPrefixFormattingRule",value:function(e,t){var s=t.international,r=t.nationalPrefix;if(e.nationalPrefixFormattingRule()){var a=e.usesNationalPrefix();if(a&&r||!a&&!s)return!0}}}])}();function fn(e){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var s=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=s){var r,a,n,i,l=[],o=!0,d=!1;try{if(n=(s=s.call(e)).next,0===t);else for(;!(o=(r=n.call(s)).done)&&(l.push(r.value),l.length!==t);o=!0);}catch(c){d=!0,a=c}finally{try{if(!o&&null!=s.return&&(i=s.return(),Object(i)!==i))return}finally{if(d)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return bn(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?bn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}function yn(e,t,s){return t&&function(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,vn(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vn(e){var t=function(e,t){if("object"!=fn(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=fn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==fn(t)?t:t+""}var jn=new RegExp("^"+("["+ar+rr+"]+")+"$","i"),Nn="(?:[+＋]["+ar+rr+"]*|["+ar+rr+"]+)",wn=new RegExp("[^"+ar+rr+"]+.*$"),Sn=/[^\d\[\]]/,kn=function(){return yn(function e(t){var s=t.defaultCountry,r=t.defaultCallingCode,a=t.metadata,n=t.onNationalSignificantNumberChange;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultCountry=s,this.defaultCallingCode=r,this.metadata=a,this.onNationalSignificantNumberChange=n},[{key:"input",value:function(e,t){var s,r=function(e){var t=function(e){var t=function(e){var t,s=e.search(Nn);if(s<0)return;e=e.slice(s),"+"===e[0]&&(t=!0,e=e.slice(1));e=e.replace(wn,""),t&&(e="+"+e);return e}(e)||"";if("+"===t[0])return[t.slice(1),!0];return[t]}(e),s=pn(t,2),r=s[0],a=s[1];jn.test(r)||(r="");return[r,a]}(e),a=pn(r,2),n=a[0],i=a[1],l=ra(n);return i&&(t.digits||(t.startInternationalNumber(void 0,void 0),l||(s=!0))),l&&this.inputDigits(l,t),{digits:l,justLeadingPlus:s}}},{key:"inputDigits",value:function(e,t){var s=t.digits,r=s.length<3&&s.length+e.length>=3;if(t.appendDigits(e),r&&this.extractIddPrefix(t),this.isWaitingForCountryCallingCode(t)){if(!this.extractCountryCallingCode(t))return}else t.appendNationalSignificantNumberDigits(e);t.international||this.hasExtractedNationalSignificantNumber||this.extractNationalSignificantNumber(t.getNationalDigits(),function(e){return t.update(e)})}},{key:"isWaitingForCountryCallingCode",value:function(e){var t=e.international,s=e.callingCode;return t&&!s}},{key:"extractCountryCallingCode",value:function(e){var t=xr("+"+e.getDigitsWithoutInternationalPrefix(),e.country,this.defaultCountry,this.defaultCallingCode,this.metadata.metadata),s=t.countryCallingCode,r=t.number;if(s)return e.setCallingCode(s),e.update({nationalSignificantNumber:r}),!0}},{key:"reset",value:function(e){if(e){this.hasSelectedNumberingPlan=!0;var t=e._nationalPrefixForParsing();this.couldPossiblyExtractAnotherNationalSignificantNumber=t&&Sn.test(t)}else this.hasSelectedNumberingPlan=void 0,this.couldPossiblyExtractAnotherNationalSignificantNumber=void 0}},{key:"extractNationalSignificantNumber",value:function(e,t){if(this.hasSelectedNumberingPlan){var s=lr(e,this.metadata),r=s.nationalPrefix,a=s.nationalNumber,n=s.carrierCode;if(a!==e)return this.onExtractedNationalNumber(r,n,a,e,t),!0}}},{key:"extractAnotherNationalSignificantNumber",value:function(e,t,s){if(!this.hasExtractedNationalSignificantNumber)return this.extractNationalSignificantNumber(e,s);if(this.couldPossiblyExtractAnotherNationalSignificantNumber){var r=lr(e,this.metadata),a=r.nationalPrefix,n=r.nationalNumber,i=r.carrierCode;if(n!==t)return this.onExtractedNationalNumber(a,i,n,e,s),!0}}},{key:"onExtractedNationalNumber",value:function(e,t,s,r,a){var n,i=!1,l=r.lastIndexOf(s);if(l<0||l!==r.length-s.length)i=!0;else{var o=r.slice(0,l);o&&o!==e&&(n=o)}a({nationalPrefix:e,carrierCode:t,nationalSignificantNumber:s,nationalSignificantNumberIsModified:i,prefixBeforeNationalSignificantNumberThatIsNotNationalPrefix:n}),this.hasExtractedNationalSignificantNumber=!0,this.onNationalSignificantNumberChange()}},{key:"reExtractNationalSignificantNumber",value:function(e){return!!this.extractAnotherNationalSignificantNumber(e.getNationalDigits(),e.nationalSignificantNumber,function(t){return e.update(t)})||(this.extractIddPrefix(e)||this.fixMissingPlus(e)?(this.extractCallingCodeAndNationalSignificantNumber(e),!0):void 0)}},{key:"extractIddPrefix",value:function(e){var t=e.international,s=e.IDDPrefix,r=e.digits;if(e.nationalSignificantNumber,!t&&!s){var a=ir(r,this.defaultCountry,this.defaultCallingCode,this.metadata.metadata);return void 0!==a&&a!==r?(e.update({IDDPrefix:r.slice(0,r.length-a.length)}),this.startInternationalNumber(e,{country:void 0,callingCode:void 0}),!0):void 0}}},{key:"fixMissingPlus",value:function(e){if(!e.international){var t=hr(e.digits,e.country,this.defaultCountry,this.defaultCallingCode,this.metadata.metadata).countryCallingCode;if(t)return e.update({missingPlus:!0}),this.startInternationalNumber(e,{country:e.country,callingCode:t}),!0}}},{key:"startInternationalNumber",value:function(e,t){var s=t.country,r=t.callingCode;e.startInternationalNumber(s,r),e.nationalSignificantNumber&&(e.resetNationalSignificantNumber(),this.onNationalSignificantNumberChange(),this.hasExtractedNationalSignificantNumber=void 0)}},{key:"extractCallingCodeAndNationalSignificantNumber",value:function(e){this.extractCountryCallingCode(e)&&this.extractNationalSignificantNumber(e.getNationalDigits(),function(t){return e.update(t)})}}])}();function Cn(e){return(Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var s=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=s){var r,a,n,i,l=[],o=!0,d=!1;try{if(n=(s=s.call(e)).next,0===t);else for(;!(o=(r=n.call(s)).done)&&(l.push(r.value),l.length!==t);o=!0);}catch(c){d=!0,a=c}finally{try{if(!o&&null!=s.return&&(i=s.return(),Object(i)!==i))return}finally{if(d)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _n(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?_n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _n(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}function An(e,t,s){return t&&function(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pn(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pn(e){var t=function(e,t){if("object"!=Cn(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=Cn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==Cn(t)?t:t+""}var Ln=function(){return An(function e(t,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metadata=new Rs(s);var r=$n(this.getCountryAndCallingCode(t),2),a=r[0],n=r[1];this.defaultCountry=a,this.defaultCallingCode=n,this.reset()},[{key:"getCountryAndCallingCode",value:function(e){var t,s;return e&&(Ps(e)?(t=e.defaultCountry,s=e.defaultCallingCode):t=e),t&&!this.metadata.hasCountry(t)&&(t=void 0),[t,s]}},{key:"input",value:function(e){var t=this.parser.input(e,this.state),s=t.digits;if(t.justLeadingPlus)this.formattedOutput="+";else if(s){var r;if(this.determineTheCountryIfNeeded(),this.state.nationalSignificantNumber&&this.formatter.narrowDownMatchingFormats(this.state),this.metadata.hasSelectedNumberingPlan()&&(r=this.formatter.format(s,this.state)),void 0===r&&this.parser.reExtractNationalSignificantNumber(this.state)){this.determineTheCountryIfNeeded();var a=this.state.getNationalDigits();a&&(r=this.formatter.format(a,this.state))}this.formattedOutput=r?this.getFullNumber(r):this.getNonFormattedNumber()}return this.formattedOutput}},{key:"reset",value:function(){var e=this;return this.state=new Fa({onCountryChange:function(t){e.country=t},onCallingCodeChange:function(t,s){e.metadata.selectNumberingPlan(s,t),e.formatter.reset(e.metadata.numberingPlan,e.state),e.parser.reset(e.metadata.numberingPlan)}}),this.formatter=new gn({state:this.state,metadata:this.metadata}),this.parser=new kn({defaultCountry:this.defaultCountry,defaultCallingCode:this.defaultCallingCode,metadata:this.metadata,state:this.state,onNationalSignificantNumberChange:function(){e.determineTheCountryIfNeeded(),e.formatter.reset(e.metadata.numberingPlan,e.state)}}),this.state.reset({country:this.defaultCountry,callingCode:this.defaultCallingCode}),this.formattedOutput="",this}},{key:"isInternational",value:function(){return this.state.international}},{key:"getCallingCode",value:function(){if(this.isInternational())return this.state.callingCode}},{key:"getCountryCallingCode",value:function(){return this.getCallingCode()}},{key:"getCountry",value:function(){if(this.state.digits)return this._getCountry()}},{key:"_getCountry",value:function(){return this.state.country}},{key:"determineTheCountryIfNeeded",value:function(){this.state.country&&!this.isCountryCallingCodeAmbiguous()||this.determineTheCountry()}},{key:"getFullNumber",value:function(e){var t=this;if(this.isInternational()){var s=function(e){return t.formatter.getInternationalPrefixBeforeCountryCallingCode(t.state,{spacing:!!e})+e},r=this.state.callingCode;return s(r?e?"".concat(r," ").concat(e):r:"".concat(this.state.getDigitsWithoutInternationalPrefix()))}return e}},{key:"getNonFormattedNationalNumberWithPrefix",value:function(){var e=this.state,t=e.nationalSignificantNumber,s=e.prefixBeforeNationalSignificantNumberThatIsNotNationalPrefix,r=e.nationalPrefix,a=t,n=s||r;return n&&(a=n+a),a}},{key:"getNonFormattedNumber",value:function(){var e=this.state.nationalSignificantNumberIsModified;return this.getFullNumber(e?this.state.getNationalDigits():this.getNonFormattedNationalNumberWithPrefix())}},{key:"getNonFormattedTemplate",value:function(){var e=this.getNonFormattedNumber();if(e)return e.replace(/[\+\d]/g,Ma)}},{key:"isCountryCallingCodeAmbiguous",value:function(){var e=this.state.callingCode,t=this.metadata.getCountryCodesForCallingCode(e);return t&&t.length>1}},{key:"determineTheCountry",value:function(){this.state.setCountry(ur(this.isInternational()?this.state.callingCode:this.defaultCallingCode,{nationalNumber:this.state.nationalSignificantNumber,metadata:this.metadata}))}},{key:"getNumberValue",value:function(){var e=this.state,t=e.digits,s=e.callingCode,r=e.country,a=e.nationalSignificantNumber;if(t)return this.isInternational()?s?"+"+s+a:"+"+t:r||s?"+"+(r?this.metadata.countryCallingCode():s)+a:void 0}},{key:"getNumber",value:function(){var e=this.state,t=e.nationalSignificantNumber,s=e.carrierCode,r=e.callingCode,a=this._getCountry();if(t&&(a||r)){if(a&&a===this.defaultCountry){var n=new Rs(this.metadata.metadata);n.selectNumberingPlan(a);var i=n.numberingPlan.callingCode(),l=this.metadata.getCountryCodesForCallingCode(i);if(l.length>1){var o=cr(t,{countries:l,metadata:this.metadata.metadata});o&&(a=o)}}var d=new qr(a||r,t,this.metadata.metadata);return s&&(d.carrierCode=s),d}}},{key:"isPossible",value:function(){var e=this.getNumber();return!!e&&e.isPossible()}},{key:"isValid",value:function(){var e=this.getNumber();return!!e&&e.isValid()}},{key:"getNationalNumber",value:function(){return this.state.nationalSignificantNumber}},{key:"getChars",value:function(){return(this.state.international?"+":"")+this.state.digits}},{key:"getTemplate",value:function(){return this.formatter.getTemplate(this.state)||this.getNonFormattedTemplate()||""}}])}();function En(e){return new Rs(e).getCountries()}function Tn(e){var t=e.inputFormat,s=e.country,r=e.metadata;return"NATIONAL_PART_OF_INTERNATIONAL"===t?"+".concat(Vs(s,r)):""}function In(e,t){return t&&" "===(e=e.slice(t.length))[0]&&(e=e.slice(1)),e}function On(e,t,s){if(!s||!s.ignoreRest){return la(e,t,function(e){if(s&&"end"===e)s.ignoreRest=!0})}}function Fn(e){var t=e.onKeyDown,s=e.inputFormat;return n.useCallback(function(e){e.keyCode===Rn&&"INTERNATIONAL"===s&&e.target instanceof HTMLInputElement&&e.target.selectionStart===Dn.length?e.preventDefault():t&&t(e)},[t,s])}var Rn=8,Dn="+",Mn=["onKeyDown","country","inputFormat","metadata","international","withCountryCallingCode"];function Bn(){return Bn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},Bn.apply(this,arguments)}function Un(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}const qn=function(e){function t(t,s){var r=t.onKeyDown,a=t.country,i=t.inputFormat,o=t.metadata,d=void 0===o?e:o;t.international,t.withCountryCallingCode;var c=Un(t,Mn),u=n.useCallback(function(e){var t=new Ln(a,d),s=Tn({inputFormat:i,country:a,metadata:d}),r=t.input(s+e),n=t.getTemplate();return s&&(r=In(r,s),n&&(n=In(n,s))),{text:r,template:n}},[a,d]),m=Fn({onKeyDown:r,inputFormat:i});return l.createElement($s,Bn({},c,{ref:s,parse:On,format:u,onKeyDown:m}))}return(t=l.forwardRef(t)).propTypes={value:x.string.isRequired,onChange:x.func.isRequired,onKeyDown:x.func,country:x.string,inputFormat:x.oneOf(["INTERNATIONAL","NATIONAL_PART_OF_INTERNATIONAL","NATIONAL","INTERNATIONAL_OR_NATIONAL"]).isRequired,metadata:x.object},t}();var zn=["value","onChange","onKeyDown","country","inputFormat","metadata","inputComponent","international","withCountryCallingCode"];function Wn(){return Wn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},Wn.apply(this,arguments)}function Vn(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}const Hn=function(e){function t(t,s){var r=t.value,a=t.onChange,i=t.onKeyDown,o=t.country,d=t.inputFormat,c=t.metadata,u=void 0===c?e:c,m=t.inputComponent,h=void 0===m?"input":m;t.international,t.withCountryCallingCode;var x=Vn(t,zn),g=Tn({inputFormat:d,country:o,metadata:u}),f=n.useCallback(function(e){var t=ia(e.target.value);t===r&&(0===Gn(g,t,o,u).indexOf(e.target.value)&&(t=t.slice(0,-1)));a(t)},[g,r,a,o,u]),p=Fn({onKeyDown:i,inputFormat:d});return l.createElement(h,Wn({},x,{ref:s,value:Gn(g,r,o,u),onChange:f,onKeyDown:p}))}return(t=l.forwardRef(t)).propTypes={value:x.string.isRequired,onChange:x.func.isRequired,onKeyDown:x.func,country:x.string,inputFormat:x.oneOf(["INTERNATIONAL","NATIONAL_PART_OF_INTERNATIONAL","NATIONAL","INTERNATIONAL_OR_NATIONAL"]).isRequired,metadata:x.object,inputComponent:x.elementType},t}();function Gn(e,t,s,r){return In(function(e,t,s){return s||(s=t,t=void 0),new Ln(t,s).input(e)}(e+t,s,r),e)}function Jn(e){return String.fromCodePoint(127397+e.toUpperCase().charCodeAt(0))}var Kn=["value","onChange","options","disabled","readOnly"],Yn=["value","options","className","iconComponent","getIconAspectRatio","arrowComponent","unicodeFlags"];function Zn(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(!e)return;if("string"==typeof e)return Xn(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Xn(e,t)}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Xn(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=new Array(t);s<t;s++)r[s]=e[s];return r}function Qn(){return Qn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},Qn.apply(this,arguments)}function ei(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function ti(e){var t=e.value,s=e.onChange,r=e.options,a=e.disabled,i=e.readOnly,o=ei(e,Kn),d=n.useCallback(function(e){var t=e.target.value;s("ZZ"===t?void 0:t)},[s]);return n.useMemo(function(){return ni(r,t)},[r,t]),l.createElement("select",Qn({},o,{disabled:a||i,readOnly:i,value:t||"ZZ",onChange:d}),r.map(function(e){var t=e.value,s=e.label,r=e.divider;return l.createElement("option",{key:r?"|":t||"ZZ",value:r?"|":t||"ZZ",disabled:!!r,style:r?si:void 0},s)}))}ti.propTypes={value:x.string,onChange:x.func.isRequired,options:x.arrayOf(x.shape({value:x.string,label:x.string,divider:x.bool})).isRequired,disabled:x.bool,readOnly:x.bool};var si={fontSize:"1px",backgroundColor:"currentColor",color:"inherit"};function ri(e){var t=e.value,s=e.options,r=e.className,a=e.iconComponent;e.getIconAspectRatio;var i,o=e.arrowComponent,d=void 0===o?ai:o,c=e.unicodeFlags,u=ei(e,Yn),m=n.useMemo(function(){return ni(s,t)},[s,t]);return l.createElement("div",{className:"PhoneInputCountry"},l.createElement(ti,Qn({},u,{value:t,options:s,className:rs("PhoneInputCountrySelect",r)})),m&&(c&&t?l.createElement("div",{className:"PhoneInputCountryIconUnicode"},Jn((i=t)[0])+Jn(i[1])):l.createElement(a,{"aria-hidden":!0,country:t,label:m.label,aspectRatio:c?1:void 0})),l.createElement(d,null))}function ai(){return l.createElement("div",{className:"PhoneInputCountrySelectArrow"})}function ni(e,t){for(var s,r=Zn(e);!(s=r()).done;){var a=s.value;if(!a.divider&&ii(a.value,t))return a}}function ii(e,t){return null==e?null==t:e===t}ri.propTypes={iconComponent:x.elementType,arrowComponent:x.elementType,unicodeFlags:x.bool};var li=["country","countryName","flags","flagUrl"];function oi(){return oi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},oi.apply(this,arguments)}function di(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function ci(e){var t=e.country,s=e.countryName,r=e.flags,a=e.flagUrl,n=di(e,li);return r&&r[t]?r[t]({title:s}):l.createElement("img",oi({},n,{alt:s,role:s?void 0:"presentation",src:a.replace("{XX}",t).replace("{xx}",t.toLowerCase())}))}ci.propTypes={country:x.string.isRequired,countryName:x.string.isRequired,flags:x.objectOf(x.elementType),flagUrl:x.string.isRequired};var ui=["aspectRatio"],mi=["title"],hi=["title"];function xi(){return xi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},xi.apply(this,arguments)}function gi(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function fi(e){var t=e.aspectRatio,s=gi(e,ui);return 1===t?l.createElement(bi,s):l.createElement(pi,s)}function pi(e){var t=e.title,s=gi(e,mi);return l.createElement("svg",xi({},s,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 75 50"}),l.createElement("title",null,t),l.createElement("g",{className:"PhoneInputInternationalIconGlobe",stroke:"currentColor",fill:"none",strokeWidth:"2",strokeMiterlimit:"10"},l.createElement("path",{strokeLinecap:"round",d:"M47.2,36.1C48.1,36,49,36,50,36c7.4,0,14,1.7,18.5,4.3"}),l.createElement("path",{d:"M68.6,9.6C64.2,12.3,57.5,14,50,14c-7.4,0-14-1.7-18.5-4.3"}),l.createElement("line",{x1:"26",y1:"25",x2:"74",y2:"25"}),l.createElement("line",{x1:"50",y1:"1",x2:"50",y2:"49"}),l.createElement("path",{strokeLinecap:"round",d:"M46.3,48.7c1.2,0.2,2.5,0.3,3.7,0.3c13.3,0,24-10.7,24-24S63.3,1,50,1S26,11.7,26,25c0,2,0.3,3.9,0.7,5.8"}),l.createElement("path",{strokeLinecap:"round",d:"M46.8,48.2c1,0.6,2.1,0.8,3.2,0.8c6.6,0,12-10.7,12-24S56.6,1,50,1S38,11.7,38,25c0,1.4,0.1,2.7,0.2,4c0,0.1,0,0.2,0,0.2"})),l.createElement("path",{className:"PhoneInputInternationalIconPhone",stroke:"none",fill:"currentColor",d:"M12.4,17.9c2.9-2.9,5.4-4.8,0.3-11.2S4.1,5.2,1.3,8.1C-2,11.4,1.1,23.5,13.1,35.6s24.3,15.2,27.5,11.9c2.8-2.8,7.8-6.3,1.4-11.5s-8.3-2.6-11.2,0.3c-2,2-7.2-2.2-11.7-6.7S10.4,19.9,12.4,17.9z"}))}function bi(e){var t=e.title,s=gi(e,hi);return l.createElement("svg",xi({},s,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50"}),l.createElement("title",null,t),l.createElement("g",{className:"PhoneInputInternationalIconGlobe",stroke:"currentColor",fill:"none",strokeWidth:"2",strokeLinecap:"round"},l.createElement("path",{d:"M8.45,13A21.44,21.44,0,1,1,37.08,41.56"}),l.createElement("path",{d:"M19.36,35.47a36.9,36.9,0,0,1-2.28-13.24C17.08,10.39,21.88.85,27.8.85s10.72,9.54,10.72,21.38c0,6.48-1.44,12.28-3.71,16.21"}),l.createElement("path",{d:"M17.41,33.4A39,39,0,0,1,27.8,32.06c6.62,0,12.55,1.5,16.48,3.86"}),l.createElement("path",{d:"M44.29,8.53c-3.93,2.37-9.86,3.88-16.49,3.88S15.25,10.9,11.31,8.54"}),l.createElement("line",{x1:"27.8",y1:"0.85",x2:"27.8",y2:"34.61"}),l.createElement("line",{x1:"15.2",y1:"22.23",x2:"49.15",y2:"22.23"})),l.createElement("path",{className:"PhoneInputInternationalIconPhone",stroke:"transparent",fill:"currentColor",d:"M9.42,26.64c2.22-2.22,4.15-3.59.22-8.49S3.08,17,.93,19.17c-2.49,2.48-.13,11.74,9,20.89s18.41,11.5,20.89,9c2.15-2.15,5.91-4.77,1-8.71s-6.27-2-8.49.22c-1.55,1.55-5.48-1.69-8.86-5.08S7.87,28.19,9.42,26.64Z"}))}function yi(e){!function(e){if(e.length<2)return!1;if("+"!==e[0])return!1;for(var t=1;t<e.length;){var s=e.charCodeAt(t);if(!(s>=48&&s<=57))return!1;t++}}(e)}function vi(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(!e)return;if("string"==typeof e)return ji(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return ji(e,t)}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ji(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=new Array(t);s<t;s++)r[s]=e[s];return r}function Ni(e,t){return!!Hs(e,t)}function wi(e,t){return e&&0===(e=e.filter(function(e){return Ni(e,t)})).length&&(e=void 0),e}fi.propTypes={title:x.string.isRequired,aspectRatio:x.number},pi.propTypes={title:x.string.isRequired},bi.propTypes={title:x.string.isRequired};var Si=["country","label","aspectRatio"];function ki(){return ki=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},ki.apply(this,arguments)}function Ci(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function $i(e){var t=e.flags,s=e.flagUrl,r=e.flagComponent,a=e.internationalIcon;function n(e){var n=e.country,i=e.label,o=e.aspectRatio,d=Ci(e,Si),c=a===fi?o:void 0;return l.createElement("div",ki({},d,{className:rs("PhoneInputCountryIcon",{"PhoneInputCountryIcon--square":1===c,"PhoneInputCountryIcon--border":n})}),n?l.createElement(r,{country:n,countryName:i,flags:t,flagUrl:s,className:"PhoneInputCountryIconImg"}):l.createElement(a,{title:i,aspectRatio:c,className:"PhoneInputCountryIconImg"}))}return n.propTypes={country:x.string,label:x.string.isRequired,aspectRatio:x.number},n}function _i(e,t){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return(s=s.call(e)).next.bind(s);if(Array.isArray(e)||(s=function(e,t){if(!e)return;if("string"==typeof e)return Ai(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Ai(e,t)}(e))||t){s&&(e=s);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ai(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=new Array(t);s<t;s++)r[s]=e[s];return r}function Pi(e,t){"function"==typeof e?e(t):e.current=t}$i({flagUrl:"https://purecatamphetamine.github.io/country-flag-icons/3x2/{XX}.svg",flagComponent:ci,internationalIcon:fi});var Li=x.shape({country_calling_codes:x.object.isRequired,countries:x.object.isRequired}),Ei=x.objectOf(x.string);function Ti(e,t){return"+"+Vs(e,t)}function Ii(e,t){return Ea(e||"",t)}function Oi(e,t){var s=t.prevCountry,r=t.newCountry,a=t.metadata,n=t.useNationalFormat;if(s===r)return e;if(!e)return n?"":r?Ti(r,a):"";if(r){if("+"===e[0]){if(n)return 0===e.indexOf("+"+Vs(r,a))?function(e,t,s){if(t){var r="+"+Vs(t,s);if(e.length<r.length){if(0===r.indexOf(e))return""}else if(0===e.indexOf(r))return e.slice(r.length)}for(var a=0,n=Object.keys(s.country_calling_codes);a<n.length;a++){var i=n[a];if(1===e.indexOf(i))return e.slice(1+i.length)}return""}(e,r,a):"";if(s){var i=Ti(r,a);return 0===e.indexOf(i)?e:i}var l=Ti(r,a);return 0===e.indexOf(l)?e:l}}else if("+"!==e[0])return Fi(e,s,a)||"";return e}function Fi(e,t,s){if(e){if("+"===e[0]){if("+"===e)return;var r=new Ln(t,s);return r.input(e),r.getNumberValue()}if(t){var a=Ui(e,t,s);return"+".concat(Vs(t,s)).concat(a||"")}}}function Ri(e,t,s){var r=Ui(e,t,s);if(r){var a=r.length-function(e,t){return t=new Rs(t),t.selectNumberingPlan(e),t.numberingPlan.possibleLengths()[t.numberingPlan.possibleLengths().length-1]}(t,s);if(a>0)return e.slice(0,e.length-a)}return e}function Di(e,t){var s=t.country,r=t.countries,a=t.defaultCountry,n=t.latestCountrySelectedByUser,i=t.required,l=t.metadata;if("+"===e)return s;var o=function(e,t){var s=new Ln(null,t);return s.input(e),s.getCountry()}(e,l);if(o)return!r||r.indexOf(o)>=0?o:void 0;if(s)if(qi(e,s,l)){if(n&&qi(e,n,l))return n;if(a&&qi(e,a,l))return a;if(!i)return}else if(!i)return;return s}function Mi(e,t,s){if(0===e.indexOf(Ti(t,s))){var r=new Ln(t,s);r.input(e);var a=r.getNumber();return a?a.formatNational().replace(/\D/g,""):""}return e.replace(/\D/g,"")}function Bi(e,t,s){return String.prototype.localeCompare?e.localeCompare(t,s):e<t?-1:e>t?1:0}function Ui(e,t,s){var r=new Ln(t,s);r.input(e);var a=r.getNumber();return a&&a.nationalNumber}function qi(e,t,s){for(var r=Ti(t,s),a=0;a<e.length&&a<r.length;){if(e[a]!==r[a])return!1;a++}return!0}function zi(e){var t=e.value,s=e.phoneNumber,r=e.defaultCountry,a=e.international,n=e.useNationalFormat,i=e.metadata;return(!1===a||n)&&s&&s.country?function(e){return e.formatNational().replace(/\D/g,"")}(s):!t&&a&&r?Ti(r,i):t}function Wi(e){return(Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vi(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function Hi(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Vi(Object(s),!0).forEach(function(t){Gi(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Vi(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function Gi(e,t,s){var r;return r=function(e,t){if("object"!=Wi(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=Wi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==Wi(r)?r:r+"")in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Ji(e,t){return null===e&&(e=void 0),null===t&&(t=void 0),e===t}var Ki=["name","disabled","readOnly","autoComplete","style","className","inputRef","inputComponent","numberInputProps","smartCaret","countrySelectComponent","countrySelectProps","containerComponent","containerComponentProps","defaultCountry","countries","countryOptionsOrder","labels","flags","flagComponent","flagUrl","addInternationalOption","internationalIcon","displayInitialValueAsLocalNumber","initialValueFormat","onCountryChange","limitMaxLength","countryCallingCodeEditable","focusInputOnCountrySelection","reset","metadata","international","locales"];function Yi(e){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zi(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function Xi(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Zi(Object(s),!0).forEach(function(t){il(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Zi(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function Qi(){return Qi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},Qi.apply(this,arguments)}function el(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function tl(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ll(r.key),r)}}function sl(e,t,s){return t=al(t),function(e,t){if(t&&("object"===Yi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,rl()?Reflect.construct(t,s||[],al(e).constructor):t.apply(e,s))}function rl(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(rl=function(){return!!e})()}function al(e){return(al=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nl(e,t){return(nl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function il(e,t,s){return(t=ll(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function ll(e){var t=function(e,t){if("object"!=Yi(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=Yi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Yi(t)?t:t+""}var ol=function(){function e(t){var s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),il(s=sl(this,e,[t]),"setInputRef",function(e){!function(e,t){for(var s,r=_i(e);!(s=r()).done;){var a=s.value;a&&Pi(a,t)}}([s.props.inputRef,s.inputRef],e)}),il(s,"isCountrySupportedWithError",function(e){return Ni(e,s.props.metadata)}),il(s,"onCountryChange",function(e){var t=s.props,r=t.international,a=t.metadata,n=t.onChange,i=t.focusInputOnCountrySelection,l=s.state,o=Oi(l.phoneDigits,{prevCountry:l.country,newCountry:e,metadata:a,useNationalFormat:!r}),d=Fi(o,e,a);i&&s.inputRef.current.focus(),s.setState({country:e,latestCountrySelectedByUser:e,hasUserSelectedACountry:!0,phoneDigits:o,value:d},function(){n(d)})}),il(s,"onChange",function(e){var t=s.props,r=t.defaultCountry,a=t.onChange,n=t.addInternationalOption,i=t.international,l=t.limitMaxLength,o=t.countryCallingCodeEditable,d=t.metadata,c=s.state,u=c.countries,m=c.phoneDigits,h=c.country,x=c.latestCountrySelectedByUser,g=function(e,t){var s,r=t.prevPhoneDigits,a=t.country,n=t.defaultCountry,i=t.latestCountrySelectedByUser,l=t.countryRequired,o=t.getAnyCountry,d=t.countries,c=t.international,u=t.limitMaxLength,m=t.countryCallingCodeEditable,h=t.metadata;if(c&&!1===m&&a){var x,g=Ti(a,h);if(0!==e.indexOf(g))return e&&"+"!==e[0]?x=Fi(e=g+e,a,h):e=g,{phoneDigits:e,value:x,country:a}}return!1===c&&a&&e&&"+"===e[0]&&(e=Mi(e,a,h)),e&&a&&u&&(e=Ri(e,a,h)),!e||"+"===e[0]||a&&!c||(e="+"+e),!e&&r&&"+"===r[0]&&(a=c?void 0:n),"+"===e&&r&&"+"===r[0]&&r.length>1&&(a=void 0),e&&(s="+"===e[0]&&("+"===e||a&&0===Ti(a,h).indexOf(e))?void 0:Fi(e,a,h)),s&&(a=Di(s,{country:a,countries:d,defaultCountry:n,latestCountrySelectedByUser:i,required:!1,metadata:h}),!1===c&&a&&e&&"+"===e[0]&&(s=Fi(e=Mi(e,a,h),a,h))),!a&&l&&(a=n||o()),{phoneDigits:e,country:a,value:s}}(e,{prevPhoneDigits:m,country:h,countryRequired:!n,defaultCountry:r,latestCountrySelectedByUser:x,getAnyCountry:function(){return s.getFirstSupportedCountry({countries:u})},countries:u,international:i,limitMaxLength:l,countryCallingCodeEditable:o,metadata:d}),f=g.phoneDigits,p=g.country,b=g.value,y={phoneDigits:f,value:b,country:p};x&&b&&!qi(b,x,d)&&(y.latestCountrySelectedByUser=void 0),!1===o&&(b||f!==s.state.phoneDigits||(y.forceRerender={})),s.setState(y,function(){return a(b)})}),il(s,"_onFocus",function(){return s.setState({isFocused:!0})}),il(s,"_onBlur",function(){return s.setState({isFocused:!1})}),il(s,"onFocus",function(e){s._onFocus();var t=s.props.onFocus;t&&t(e)}),il(s,"onBlur",function(e){var t=s.props.onBlur;s._onBlur(),t&&t(e)}),il(s,"onCountryFocus",function(e){s._onFocus();var t=s.props.countrySelectProps;if(t){var r=t.onFocus;r&&r(e)}}),il(s,"onCountryBlur",function(e){s._onBlur();var t=s.props.countrySelectProps;if(t){var r=t.onBlur;r&&r(e)}}),s.inputRef=l.createRef();var r=s.props,a=r.value;r.labels;var n=r.international,i=r.addInternationalOption,o=r.displayInitialValueAsLocalNumber,d=r.initialValueFormat,c=r.metadata,u=s.props,m=u.defaultCountry,h=u.countries;m&&(s.isCountrySupportedWithError(m)||(m=void 0)),a&&yi(a),h=wi(h,c);var x=Ii(a,c);s.CountryIcon=$i(s.props);var g=function(e){var t,s=e.value,r=e.phoneNumber,a=e.defaultCountry,n=e.getAnyCountry,i=e.countries,l=e.required,o=e.metadata;return r&&r.country?t=r.country:a&&(s&&!qi(s,a,o)||(t=a)),i&&i.indexOf(t)<0&&(t=void 0),!t&&l&&i&&i.length>0&&(t=n()),t}({value:a,phoneNumber:x,defaultCountry:m,required:!i,countries:h||En(c),getAnyCountry:function(){return s.getFirstSupportedCountry({countries:h})},metadata:c});return s.state={props:s.props,country:g,countries:h,phoneDigits:zi({value:a,phoneNumber:x,defaultCountry:m,international:n,useNationalFormat:o||"national"===d,metadata:c}),value:a},s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nl(e,t)}(e,l.PureComponent),t=e,s=[{key:"componentDidMount",value:function(){var e=this.props.onCountryChange,t=this.props.defaultCountry,s=this.state.country;e&&(t&&(this.isCountrySupportedWithError(t)||(t=void 0)),s!==t&&e(s))}},{key:"componentDidUpdate",value:function(e,t){var s=this.props.onCountryChange,r=this.state.country;s&&r!==t.country&&s(r)}},{key:"getCountrySelectOptions",value:function(e){var t=e.countries,s=this.props,r=s.international,a=s.countryCallingCodeEditable,n=s.countryOptionsOrder,i=s.addInternationalOption,l=s.labels,o=s.locales,d=s.metadata;return this.useMemoCountrySelectOptions(function(){return function(e,t){if(!t)return e;for(var s,r=[],a=[],n=r,i=function(){var t=s.value;if("|"===t)n.push({divider:!0});else if("..."===t||"…"===t)n=a;else{var r;r="🌐"===t?void 0:t;var i=e.indexOf(e.filter(function(e){return e.value===r})[0]),l=e[i];e.splice(i,1),n.push(l)}},l=vi(t);!(s=l()).done;)i();return r.concat(e).concat(a)}(function(e){var t=e.countries,s=e.countryNames,r=e.addInternationalOption,a=e.compareStringsLocales,n=e.compareStrings;n||(n=Bi);var i=t.map(function(e){return{value:e,label:s[e]||e}});return i.sort(function(e,t){return n(e.label,t.label,a)}),r&&i.unshift({label:s.ZZ}),i}({countries:t||En(d),countryNames:l,addInternationalOption:(!r||!1!==a)&&i,compareStringsLocales:o}),function(e,t){if(e&&(e=e.filter(function(e){switch(e){case"🌐":case"|":case"...":case"…":return!0;default:return Ni(e,t)}})).length>0)return e}(n,d))},[t,n,i,l,d])}},{key:"useMemoCountrySelectOptions",value:function(e,t){return this.countrySelectOptionsMemoDependencies&&function(e,t){if(e.length!==t.length)return!1;for(var s=0;s<e.length;){if(e[s]!==t[s])return!1;s++}return!0}(t,this.countrySelectOptionsMemoDependencies)||(this.countrySelectOptionsMemo=e(),this.countrySelectOptionsMemoDependencies=t),this.countrySelectOptionsMemo}},{key:"getFirstSupportedCountry",value:function(e){var t=e.countries;return this.getCountrySelectOptions({countries:t})[0].value}},{key:"render",value:function(){var e=this.props,t=e.name,s=e.disabled,r=e.readOnly,a=e.autoComplete,n=e.style,i=e.className;e.inputRef;var o=e.inputComponent,d=e.numberInputProps,c=e.smartCaret,u=e.countrySelectComponent,m=e.countrySelectProps,h=e.containerComponent,x=e.containerComponentProps;e.defaultCountry,e.countries,e.countryOptionsOrder;var g=e.labels;e.flags,e.flagComponent,e.flagUrl,e.addInternationalOption,e.internationalIcon,e.displayInitialValueAsLocalNumber,e.initialValueFormat,e.onCountryChange,e.limitMaxLength,e.countryCallingCodeEditable,e.focusInputOnCountrySelection,e.reset;var f=e.metadata,p=e.international;e.locales;var b=el(e,Ki),y=this.state,v=y.country,j=y.countries,N=y.phoneDigits,w=y.isFocused,S=c?qn:Hn,k=this.getCountrySelectOptions({countries:j});return l.createElement(h,Qi({style:n,className:rs(i,"PhoneInput",{"PhoneInput--focus":w,"PhoneInput--disabled":s,"PhoneInput--readOnly":r})},x),l.createElement(u,Qi({name:t?"".concat(t,"Country"):void 0,"aria-label":g.country},m,{value:v,options:k,onChange:this.onCountryChange,onFocus:this.onCountryFocus,onBlur:this.onCountryBlur,disabled:s||m&&m.disabled,readOnly:r||m&&m.readOnly,iconComponent:this.CountryIcon})),l.createElement(S,Qi({ref:this.setInputRef,type:"tel",autoComplete:a},d,b,{inputFormat:!0===p?"INTERNATIONAL":!1===p?"NATIONAL":"INTERNATIONAL_OR_NATIONAL",international:!!p||void 0,withCountryCallingCode:!!p||void 0,name:t,metadata:f,country:v,value:N||"",onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,disabled:s,readOnly:r,inputComponent:o,className:rs("PhoneInputInput",d&&d.className,b.className)})))}}],r=[{key:"getDerivedStateFromProps",value:function(e,t){return Xi({props:e},function(e,t,s){var r=e.metadata,a=e.countries,n=e.defaultCountry,i=e.value,l=e.reset,o=e.international,d=e.displayInitialValueAsLocalNumber,c=e.initialValueFormat,u=t.defaultCountry,m=t.value,h=t.reset;s.country;var x=s.value,g=s.hasUserSelectedACountry,f=s.latestCountrySelectedByUser,p=function(e){return zi(Hi(Hi({},e),{},{international:o,useNationalFormat:d||"national"===c,metadata:r}))};if(l!==h)return{phoneDigits:p({value:void 0,defaultCountry:n}),value:void 0,country:n,latestCountrySelectedByUser:void 0,hasUserSelectedACountry:void 0};if(n!==u){var b=!n||Ni(n,r),y=!x||o&&x===p({value:void 0,defaultCountry:u});if(!g&&b&&!i&&y)return{country:n,phoneDigits:p({value:void 0,defaultCountry:n}),value:void 0}}if(!Ji(i,m)&&!Ji(i,x)){var v,j,N;if(i){i&&yi(i),v=Ii(i,r);var w=wi(a,r);v&&v.country?(!w||w.indexOf(v.country)>=0)&&(j=v.country):(j=Di(i,{country:void 0,countries:w,metadata:r}))||n&&0===i.indexOf(Ti(n,r))&&(j=n)}return i?f&&((j?f===j:qi(i,f,r))?j||(j=f):N={latestCountrySelectedByUser:void 0}):N={latestCountrySelectedByUser:void 0,hasUserSelectedACountry:void 0},Hi(Hi({},N),{},{phoneDigits:p({phoneNumber:v,value:i,defaultCountry:n}),value:i,country:i?j:n})}}(e,t.props,t))}}],s&&tl(t.prototype,s),r&&tl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,s,r}(),dl=l.forwardRef(function(e,t){return l.createElement(ol,Qi({},function(e){for(var t in e=Xi({},e),cl)void 0===e[t]&&(e[t]=cl[t]);return e}(e),{inputRef:t}))});dl.propTypes={value:x.string,onChange:x.func.isRequired,onFocus:x.func,onBlur:x.func,disabled:x.bool,readOnly:x.bool,autoComplete:x.string,initialValueFormat:x.oneOf(["national"]),displayInitialValueAsLocalNumber:x.bool,defaultCountry:x.string,countries:x.arrayOf(x.string),labels:Ei,locales:x.oneOfType([x.string,x.arrayOf(x.string)]),flagUrl:x.string,flags:x.objectOf(x.elementType),flagComponent:x.elementType,addInternationalOption:x.bool,internationalIcon:x.elementType,countryOptionsOrder:x.arrayOf(x.string),style:x.object,className:x.string,countrySelectComponent:x.elementType,countrySelectProps:x.object,inputComponent:x.elementType,numberInputProps:x.object,containerComponent:x.elementType,containerComponentProps:x.object,smartCaret:x.bool,international:x.bool,limitMaxLength:x.bool,countryCallingCodeEditable:x.bool,metadata:Li,onCountryChange:x.func,focusInputOnCountrySelection:x.bool};var cl={autoComplete:"tel",countrySelectComponent:ri,flagComponent:ci,flagUrl:"https://purecatamphetamine.github.io/country-flag-icons/3x2/{XX}.svg",internationalIcon:fi,inputComponent:"input",containerComponent:"div",reset:x.any,smartCaret:!0,addInternationalOption:!0,countryCallingCodeEditable:!0,focusInputOnCountrySelection:!0};function ul(e){return(ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ml(e,t,s){if(s||"object"===ul(t)&&(s=t,t="NATIONAL"),!e)return"";var r=Ea(e,s);if(!r)return"";switch(t){case"National":t="NATIONAL";break;case"International":t="INTERNATIONAL"}return r.format(t)}const hl={ext:"ext.",country:"Phone number country",phone:"Phone",AB:"Abkhazia",AC:"Ascension Island",AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",AI:"Anguilla",AL:"Albania",AM:"Armenia",AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AW:"Aruba",AX:"Åland Islands",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BL:"Saint Barthélemy",BM:"Bermuda",BN:"Brunei Darussalam",BO:"Bolivia",BQ:"Bonaire, Sint Eustatius and Saba",BR:"Brazil",BS:"Bahamas",BT:"Bhutan",BV:"Bouvet Island",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CC:"Cocos (Keeling) Islands",CD:"Congo, Democratic Republic of the",CF:"Central African Republic",CG:"Congo",CH:"Switzerland",CI:"Cote d'Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CV:"Cape Verde",CW:"Curaçao",CX:"Christmas Island",CY:"Cyprus",CZ:"Czech Republic",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",EH:"Western Sahara",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands",FM:"Federated States of Micronesia",FO:"Faroe Islands",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GF:"French Guiana",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GU:"Guam",GW:"Guinea-Bissau",GY:"Guyana",HK:"Hong Kong",HM:"Heard Island and McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran",IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",KM:"Comoros",KN:"Saint Kitts and Nevis",KP:"North Korea",KR:"South Korea",KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Laos",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova",ME:"Montenegro",MF:"Saint Martin (French Part)",MG:"Madagascar",MH:"Marshall Islands",MK:"North Macedonia",ML:"Mali",MM:"Myanmar",MN:"Mongolia",MO:"Macao",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"Mauritania",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NF:"Norfolk Island",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"Oman",OS:"South Ossetia",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",PN:"Pitcairn",PR:"Puerto Rico",PS:"Palestine",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"Qatar",RE:"Reunion",RO:"Romania",RS:"Serbia",RU:"Russia",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"Saint Helena",SI:"Slovenia",SJ:"Svalbard and Jan Mayen",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",SS:"South Sudan",ST:"Sao Tome and Principe",SV:"El Salvador",SX:"Sint Maarten",SY:"Syria",SZ:"Swaziland",TA:"Tristan da Cunha",TC:"Turks and Caicos Islands",TD:"Chad",TF:"French Southern Territories",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"Timor-Leste",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TW:"Taiwan",TZ:"Tanzania",UA:"Ukraine",UG:"Uganda",UM:"United States Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Holy See (Vatican City State)",VC:"Saint Vincent and the Grenadines",VE:"Venezuela",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",VN:"Vietnam",VU:"Vanuatu",WF:"Wallis and Futuna",WS:"Samoa",XK:"Kosovo",YE:"Yemen",YT:"Mayotte",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe",ZZ:"International"};var xl=["metadata","labels"];function gl(){return gl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},gl.apply(this,arguments)}function fl(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function pl(e){var t=l.forwardRef(function(t,s){var r=t.metadata,a=void 0===r?e:r,n=t.labels,i=void 0===n?hl:n,o=fl(t,xl);return l.createElement(dl,gl({},o,{ref:s,metadata:a,labels:i}))});return t.propTypes={metadata:Li,labels:Ei},t}pl();const bl=pl(Qt);function yl(){return function(e,t){var s=Array.prototype.slice.call(t);return s.push(Qt),e.apply(this,s)}(ml,arguments)}function vl(){const e=a(),{showToast:t}=$t(),[s,i]=n.useState(!1),[l,o]=n.useState(null),[d,c]=n.useState("manual"),[u,m]=n.useState(!1),[h,x]=n.useState([]),[g,f]=n.useState(!1),[p,b]=n.useState(!1),[y]=n.useState(!1),v=n.useRef(null),[j,N]=n.useState(null),[w,S]=n.useState(!1),[k,C]=n.useState(""),[$,_]=n.useState(""),[A,P]=n.useState(!1),[L,E]=n.useState(!1),[T,O]=n.useState([]),[F,R]=n.useState(""),{latitude:M,longitude:B,error:U,loading:q,getCurrentLocation:z}=kt();n.useEffect(()=>{const e=D();i(e.isAuthenticated),o(e.userData);const t=()=>{const e=D();i(e.isAuthenticated),o(e.userData)};return window.addEventListener("storage",t),window.addEventListener("authStateChanged",t),()=>{window.removeEventListener("storage",t),window.removeEventListener("authStateChanged",t)}},[]);const W=e=>{N(e),e&&_("")},V=e=>{const t=Array.from(e.target.files||[]),s=["image/jpeg","image/png","image/gif","image/webp"];if(t.length+T.length>5)return void R("You can only upload up to 5 files.");const r=[],a=[];t.forEach(e=>{s.includes(e.type)?e.size>10485760?a.push(`${e.name}: File size exceeds 10MB limit.`):r.push(e):a.push(`${e.name}: Invalid file type. Only images are allowed.`)}),a.length>0?R(a.join(" ")):(R(""),O(e=>[...e,...r]),J("attachments",[...T,...r]))};n.useEffect(()=>{(async()=>{try{(await Lt(13.8043,121.2855)).success}catch(e){}})()},[]);const H=n.useMemo(()=>({incidentType:{required:!0},description:{},location:{required:!0},priorityLevel:{required:!0},safetyStatus:{required:!0},guestName:{required:!s},guestContact:{required:!s,custom:e=>s||(e=>{if(!e)return!1;if(e.startsWith("+63")){const t=e.replace(/\D/g,"");return/^639\d{9}$/.test(t)}if(e.startsWith("09")){const t=e.replace(/\D/g,"");return/^09\d{9}$/.test(t)}const t=e.replace(/\D/g,"");return t.startsWith("639")&&12===t.length?/^639\d{9}$/.test(t):!(!t.startsWith("9")||10!==t.length)&&/^9\d{9}$/.test(t)})(e)?"":"Please enter a valid Philippine mobile number (e.g., 09123456789 or +639123456789)"}}),[s]),{fields:G,setValue:J,validateAll:K,getValues:Y,isSubmitting:Z,setIsSubmitting:X}=yt({incidentType:"",description:"",location:"",latitude:null,longitude:null,priorityLevel:"",safetyStatus:"",guestName:"",guestContact:"",attachments:[]},H),Q=[{name:"Alupay",lat:13.8404,lng:121.2922},{name:"Antipolo",lat:13.708,lng:121.3096},{name:"Bagong Pook",lat:13.8402,lng:121.2216},{name:"Balibago",lat:13.8512,lng:121.2855},{name:"Barangay A",lat:13.8457,lng:121.2104},{name:"Barangay B",lat:13.8461,lng:121.2065},{name:"Barangay C",lat:13.8467,lng:121.2032},{name:"Barangay D",lat:13.844,lng:121.2035},{name:"Barangay E",lat:13.8415,lng:121.2047},{name:"Bayawang",lat:13.7944,lng:121.2798},{name:"Baybayin",lat:13.8277,lng:121.2589},{name:"Bulihan",lat:13.7967,lng:121.2351},{name:"Cahigam",lat:13.8021,lng:121.2501},{name:"Calantas",lat:13.734,lng:121.3129},{name:"Colongan",lat:13.8114,lng:121.1762},{name:"Itlugan",lat:13.819,lng:121.2036},{name:"Leviste",lat:13.7694,lng:121.2868},{name:"Lumbangan",lat:13.8122,lng:121.2649},{name:"Maalas-as",lat:13.8112,lng:121.2122},{name:"Mabato",lat:13.8144,lng:121.2913},{name:"Mabunga",lat:13.781,lng:121.2924},{name:"Macalamcam A",lat:13.8551,lng:121.3046},{name:"Macalamcam B",lat:13.8606,lng:121.3265},{name:"Malaya",lat:13.8535,lng:121.172},{name:"Maligaya",lat:13.8182,lng:121.2742},{name:"Marilag",lat:13.8562,lng:121.1764},{name:"Masaya",lat:13.8383,lng:121.1852},{name:"Matamis",lat:13.7216,lng:121.3305},{name:"Mavalor",lat:13.8177,lng:121.2315},{name:"Mayuro",lat:13.7944,lng:121.2623},{name:"Namuco",lat:13.8382,lng:121.2036},{name:"Namunga",lat:13.8431,lng:121.1978},{name:"Nasi",lat:13.7699,lng:121.3127},{name:"Natu",lat:13.842,lng:121.2683},{name:"Palakpak",lat:13.7079,lng:121.332},{name:"Pinagsibaan",lat:13.8438,lng:121.3141},{name:"Putingkahoy",lat:13.8349,lng:121.3227},{name:"Quilib",lat:13.8603,lng:121.2002},{name:"Salao",lat:13.8578,lng:121.3455},{name:"San Carlos",lat:13.8478,lng:121.2475},{name:"San Ignacio",lat:13.8335,lng:121.1764},{name:"San Isidro",lat:13.8074,lng:121.3152},{name:"San Jose",lat:13.8419,lng:121.2329},{name:"San Roque",lat:13.8518,lng:121.2039},{name:"Santa Cruz",lat:13.8599,lng:121.1853},{name:"Timbugan",lat:13.8095,lng:121.1869},{name:"Tiquiwan",lat:13.8284,lng:121.2399},{name:"Tulos",lat:13.7231,lng:121.2971}];n.useEffect(()=>{if(M&&B&&"auto"===d){J("latitude",M),J("longitude",B);(async()=>{try{const e=await Lt(M,B);"object"==typeof e&&"success"in e&&e.success?J("location",e.locationName):J("location",`GPS: ${M.toFixed(6)}, ${B.toFixed(6)}`)}catch(e){J("location",`GPS: ${M.toFixed(6)}, ${B.toFixed(6)}`)}})()}},[M,B,d,J]);const ee=async()=>{c("auto"),m(!0);try{await z()}catch(e){}finally{m(!1)}};n.useEffect(()=>{const e=setTimeout(()=>{G.location.value&&"manual"===d&&(async e=>{if(e.length<2)return x([]),void f(!1);b(!0);const t=[...Q.map(e=>({display_name:`Barangay ${e.name}, Rosario, Batangas`,lat:e.lat.toString(),lon:e.lng.toString(),address:{city:"Rosario",province:"Batangas"},category:"Barangay"}))];setTimeout(()=>{const s=e.toLowerCase().split(" "),r=t.filter(e=>{const t=e.display_name.toLowerCase();return s.some(s=>t.includes(s)||e.category.toLowerCase().includes(s))}).sort((t,s)=>{const r=t.display_name.toLowerCase().includes(e.toLowerCase()),a=s.display_name.toLowerCase().includes(e.toLowerCase());return r&&!a?-1:!r&&a?1:0}).slice(0,6);x(r),f(r.length>0),b(!1)},200)})(G.location.value)},500);return()=>clearTimeout(e)},[G.location.value,d]);const te=async r=>{if(r.preventDefault(),!s&&(S(!0),!j))return void _("Please complete the reCAPTCHA.");if(!K()){const e=Object.entries(G).filter(([e,t])=>t.error).map(([e,t])=>`${e}: ${t.error}`).join("; ");return void t({type:"error",title:"Validation Error",message:e||"Please fill in all required fields correctly.",durationMs:5e3})}const a=s?"/api/incidents/report":"/api/incidents/report-guest";X(!0);try{const r=Y(),n=new FormData;n.append("incidentType",(r.incidentType||"").trim()),n.append("description",(r.description||"").trim()),n.append("location",(r.location||"").trim()),n.append("latitude",String("number"==typeof r.latitude?r.latitude:r.latitude?parseFloat(String(r.latitude)):null)),n.append("longitude",String("number"==typeof r.longitude?r.longitude:r.longitude?parseFloat(String(r.longitude)):null)),n.append("priorityLevel",(r.priorityLevel||"").trim()),n.append("safetyStatus",(r.safetyStatus||"").trim()),n.append("recaptchaToken",j||""),s||(n.append("guestName",(r.guestName||"").trim()),n.append("guestContact",(r.guestContact||"").trim())),T.forEach(e=>{n.append("attachments",e)});!(r.location||"").trim()&&r.latitude&&r.longitude&&n.set("location",`GPS Location: ${Number(r.latitude).toFixed(6)}, ${Number(r.longitude).toFixed(6)} (Rosario, Batangas)`);for(const[e,t]of n.entries())File;const i=await fetch(`${a}`,{method:"POST",...s&&l?.token?{headers:{Authorization:`Bearer ${l.token}`}}:{},body:n});if(i.ok){await i.json();t({type:"success",title:"Report Submitted Successfully!",message:"Emergency responders have been notified and will respond as soon as possible.",durationMs:5e3}),setTimeout(()=>{e("/")},3e3)}else{const e=await i.json(),s=e.message||(e.missingFields?.length?`Missing: ${e.missingFields.join(", ")}`:"Failed to submit incident report. Please try again.");t({type:"error",title:"Submission Failed",message:s,durationMs:5e3})}}catch(n){t({type:"error",title:"Network Error",message:"Network error. Please check your connection and try again.",durationMs:5e3})}finally{X(!1),v.current&&v.current.reset(),N(null)}},se=()=>I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[I.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[I.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-alert-line text-red-600"})}),"Incident Information"]}),I.jsx("p",{className:"text-gray-600 mt-2",children:"Please provide details about the incident"})]}),I.jsxs("div",{children:[I.jsxs("label",{htmlFor:"incidentType",className:"block text-sm font-semibold text-gray-700 mb-3",children:[I.jsx("i",{className:"ri-error-warning-line mr-2 text-red-600"}),"Incident Type ",I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-alert-line text-gray-400"})}),I.jsxs("select",{id:"incidentType",name:"incidentType",value:G.incidentType.value,onChange:e=>J("incidentType",e.target.value),className:"w-full pl-10 pr-4 py-4 border rounded-xl focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-all appearance-none bg-white "+(G.incidentType.error?"border-red-300":"border-gray-300"),children:[I.jsx("option",{value:"",children:"Select incident type..."}),I.jsx("option",{value:"fire",children:"🔥 Fire Emergency"}),I.jsx("option",{value:"medical",children:"🚑 Medical Emergency"}),I.jsx("option",{value:"security",children:"🛡 Security Incident"}),I.jsx("option",{value:"accident",children:"💥 Transport Accident"}),I.jsx("option",{value:"natural",children:"🌧 Natural Disaster"}),I.jsx("option",{value:"other",children:"⚠ Other Emergency"})]}),I.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-arrow-down-s-line text-gray-400"})})]}),G.incidentType.touched&&G.incidentType.error&&I.jsx("p",{className:"text-red-600 text-sm mt-2",children:G.incidentType.error})]})]}),I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[I.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-map-pin-line text-blue-600"})}),"Location Information"]}),I.jsx("p",{className:"text-gray-600 mt-2",children:"Specify where the incident occurred"})]}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[I.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Location Method:"}),I.jsxs("div",{className:"flex space-x-2",children:[I.jsxs("button",{type:"button",onClick:()=>c("manual"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all "+("manual"===d?"bg-blue-600 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[I.jsx("i",{className:"ri-edit-line mr-2"}),"Manual Entry"]}),I.jsx("button",{type:"button",onClick:ee,disabled:u||q,className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${"auto"===d?"bg-green-600 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"} ${u||q?"opacity-50 cursor-not-allowed":""}`,children:u||q?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Getting Location..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-gps-line mr-2"}),"Auto-Detect"]})})]})]}),I.jsxs("div",{className:"relative",children:[I.jsxs("div",{className:"mt-2 mb-4",children:[I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:[I.jsx("i",{className:"ri-map-pin-line mr-2 text-blue-600"}),"Select Barangay (Rosario, Batangas)"]}),I.jsxs("select",{className:"w-full px-3 py-3 border border-blue-200 rounded-lg text-sm text-blue-800 font-medium bg-blue-50 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all mb-1",value:Q.find(e=>`Barangay ${e.name}, Rosario, Batangas`===G.location.value)?G.location.value:"",onChange:e=>{const t=Q.find(t=>`Barangay ${t.name}, Rosario, Batangas`===e.target.value);t?(J("location",`Barangay ${t.name}, Rosario, Batangas`),J("latitude",t.lat),J("longitude",t.lng),f(!1),c("manual")):(J("location",""),J("latitude",null),J("longitude",null))},children:[I.jsx("option",{value:"",children:"-- Select Barangay --"}),Q.map(e=>I.jsx("option",{value:`Barangay ${e.name}, Rosario, Batangas`,children:e.name},e.name))]}),I.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Choose a barangay to quickly fill location and coordinates."})]}),I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:[I.jsx("i",{className:"ri-map-pin-line mr-2 text-blue-600"}),"Location Description ",I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-map-pin-line text-gray-400"})}),I.jsx("input",{type:"text",name:"location",id:"location",value:G.location.value,onChange:e=>{J("location",e.target.value),"auto"===d&&c("manual")},onFocus:()=>{h.length>0&&f(!0)},onBlur:()=>{setTimeout(()=>f(!1),200)},className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"auto"===d?"Auto-detected location will appear here...":"Search for location",required:!0}),(p||y)&&I.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:I.jsx("i",{className:"ri-loader-4-line animate-spin text-blue-600"})})]}),g&&h.length>0&&I.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:h.map((e,t)=>I.jsx("button",{type:"button",onClick:()=>(e=>{J("location",e.display_name),J("latitude",parseFloat(e.lat)),J("longitude",parseFloat(e.lon)),f(!1),c("manual")})(e),className:"w-full px-4 py-3 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none border-b border-gray-100 last:border-b-0 transition-colors",children:I.jsxs("div",{className:"flex items-start space-x-3",children:[I.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:I.jsx("i",{className:"ri-map-pin-line text-blue-600 text-sm"})}),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.display_name}),e.address&&I.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.address.city||e.address.town||e.address.municipality,", ",e.address.province||e.address.state]})]})]})},t))}),G.location.touched&&G.location.error&&I.jsxs("p",{className:"text-red-600 text-sm mt-2",children:[I.jsx("i",{className:"ri-error-warning-line mr-1"}),G.location.error]}),U&&I.jsxs("p",{className:"text-red-600 text-sm mt-2",children:[I.jsx("i",{className:"ri-error-warning-line mr-1"}),U]}),M&&B&&I.jsx("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-gps-line text-green-600 text-sm"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-green-800 font-medium text-sm",children:"GPS Location Detected"}),I.jsxs("p",{className:"text-green-600 text-xs",children:["Coordinates: ",M.toFixed(6),", ",B.toFixed(6)]})]})]})})]})]})]}),I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[I.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[I.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-alarm-warning-line text-orange-600"})}),"Priority Level"]}),I.jsx("p",{className:"text-gray-600 mt-2",children:"How urgent is this incident?"})]}),I.jsxs("div",{children:[I.jsxs("label",{htmlFor:"priorityLevel",className:"block text-sm font-semibold text-gray-700 mb-3",children:[I.jsx("i",{className:"ri-alarm-warning-line mr-2 text-orange-600"}),"Priority Level ",I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-alarm-warning-line text-gray-400"})}),I.jsxs("select",{id:"priorityLevel",name:"priorityLevel",value:G.priorityLevel.value,onChange:e=>J("priorityLevel",e.target.value),className:"w-full pl-10 pr-4 py-4 border rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all appearance-none bg-white "+(G.priorityLevel.error?"border-red-300":"border-gray-300"),children:[I.jsx("option",{value:"",children:"Select priority level..."}),I.jsx("option",{value:"low",children:"🟢 Low Priority - Non-urgent, can wait"}),I.jsx("option",{value:"medium",children:"🟡 Medium Priority - Moderate urgency"}),I.jsx("option",{value:"high",children:"🔴 High Priority - Urgent attention needed"}),I.jsx("option",{value:"critical",children:"🚫 Critical - Immediate response required"})]}),I.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-arrow-down-s-line text-gray-400"})})]}),G.priorityLevel.touched&&G.priorityLevel.error&&I.jsx("p",{className:"text-red-600 text-sm mt-2",children:G.priorityLevel.error})]})]}),I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[I.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[I.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-shield-check-line text-green-600"})}),"Your Safety Status"]}),I.jsx("p",{className:"text-gray-600 mt-2",children:"Are you currently safe?"})]}),I.jsxs("div",{children:[I.jsxs("label",{htmlFor:"safetyStatus",className:"block text-sm font-semibold text-gray-700 mb-3",children:[I.jsx("i",{className:"ri-shield-check-line mr-2 text-green-600"}),"Your Safety Status ",I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-shield-check-line text-gray-400"})}),I.jsxs("select",{id:"safetyStatus",name:"safetyStatus",value:G.safetyStatus.value,onChange:e=>J("safetyStatus",e.target.value),className:"w-full pl-10 pr-4 py-4 border rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all appearance-none bg-white "+(G.safetyStatus.error?"border-red-300":"border-gray-300"),children:[I.jsx("option",{value:"",children:"Select your safety status..."}),I.jsx("option",{value:"safe",children:"🟢 I am safe - Not in immediate danger"}),I.jsx("option",{value:"injured",children:"🟡 I am injured - Need medical attention"}),I.jsx("option",{value:"danger",children:"🔴 I am in danger - Need immediate help"})]}),I.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-arrow-down-s-line text-gray-400"})})]}),G.safetyStatus.touched&&G.safetyStatus.error&&I.jsx("p",{className:"text-red-600 text-sm mt-2",children:G.safetyStatus.error})]})]}),I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[I.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[I.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-file-text-line text-purple-600"})}),"Incident Description"]}),I.jsx("p",{className:"text-gray-600 mt-2",children:"Provide detailed information about what happened"})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:[I.jsx("i",{className:"ri-file-text-line mr-2 text-purple-600"}),"Detailed Description ",I.jsx("span",{className:"text-gray-500",children:"(optional)"})]}),I.jsx("textarea",{value:G.description.value,onChange:e=>J("description",e.target.value),className:"w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all resize-none",rows:6,placeholder:"Please provide a detailed description of the incident including:\n• What happened?\n• When did it occur?\n• Who was involved?\n• Any injuries or damages?\n• Current situation status...",required:!0}),G.description.touched&&G.description.error&&I.jsx("p",{className:"text-red-600 text-sm mt-2",children:G.description.error})]})]}),I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[I.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[I.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-image-line text-green-600"})}),"Attachments"]}),I.jsx("p",{className:"text-gray-600 mt-2",children:"Upload photos related to the incident (optional)"})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:[I.jsx("i",{className:"ri-image-line mr-2 text-green-600"}),"Upload Images"]}),I.jsxs("div",{className:"relative",children:[I.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:V,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),I.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-green-400 transition-colors",children:[I.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:I.jsx("i",{className:"ri-camera-line text-2xl text-green-600"})}),I.jsx("p",{className:"text-gray-600 font-medium",children:"Click to upload images"}),I.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"PNG, JPG, GIF, WebP up to 10MB each (max 5 files)"})]})]}),T.length>0&&I.jsxs("div",{className:"mt-4 space-y-2",children:[I.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Selected files:"}),I.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:T.map((e,t)=>I.jsxs("div",{className:"flex items-center justify-between bg-gray-50 border border-gray-200 rounded-lg p-3",children:[I.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:I.jsx("i",{className:"ri-image-line text-green-600"})}),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),I.jsxs("p",{className:"text-xs text-gray-500",children:[(e.size/1024/1024).toFixed(2)," MB"]})]})]}),I.jsx("button",{type:"button",onClick:()=>(e=>{const t=T.filter((t,s)=>s!==e);O(t),J("attachments",t),R("")})(t),className:"text-red-500 hover:text-red-700 p-1",children:I.jsx("i",{className:"ri-close-line text-lg"})})]},t))})]}),F&&I.jsxs("p",{className:"text-red-600 text-sm mt-2",children:[I.jsx("i",{className:"ri-error-warning-line mr-1"}),F]}),I.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Attachments help emergency responders better understand the situation. Only image files are accepted."})]})]})]});return s?I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-red-50 to-orange-100",children:[I.jsx(ut,{isAuthenticated:s,userData:l||void 0}),I.jsxs("div",{className:"relative overflow-hidden",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/5 to-orange-600/5"}),I.jsx("div",{className:"absolute inset-0 opacity-40",children:I.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(239, 68, 68, 0.05) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),I.jsx("div",{className:"relative container mx-auto px-4 py-16",children:I.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[I.jsxs("div",{className:"relative inline-flex items-center justify-center mb-8",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600 to-orange-600 rounded-2xl blur-lg opacity-30 scale-110"}),I.jsx("div",{className:"relative w-20 h-20 bg-gradient-to-r from-red-600 to-orange-600 rounded-2xl flex items-center justify-center shadow-xl",children:I.jsx("i",{className:"ri-error-warning-line text-3xl text-white"})})]}),I.jsx("h1",{className:"text-5xl md:text-6xl font-bold bg-gradient-to-r from-gray-900 via-red-900 to-orange-900 bg-clip-text text-transparent mb-6 leading-tight",children:"Report an Incident"}),I.jsxs("p",{className:"text-xl md:text-2xl text-gray-600 mb-8 leading-relaxed",children:["Emergency Incident Reporting System",I.jsx("span",{className:"block text-lg text-gray-500 mt-2",children:"Please provide detailed information about the incident"})]}),I.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 border border-red-200/50 rounded-2xl p-6 max-w-3xl mx-auto shadow-lg backdrop-blur-sm",children:[I.jsxs("div",{className:"flex items-center justify-center text-red-800",children:[I.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-information-line text-red-600"})}),I.jsx("p",{className:"font-semibold text-lg",children:"Your report helps us respond quickly to emergencies"})]}),I.jsx("p",{className:"text-red-600 text-sm mt-2 opacity-80",children:"All reports are treated with urgency and confidentiality"})]})]})})]}),I.jsx("div",{className:"container mx-auto px-4 pb-8",children:I.jsx("div",{className:"max-w-4xl mx-auto",children:I.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8",children:I.jsxs("form",{onSubmit:te,className:"space-y-8",children:[se(),I.jsx("div",{className:"border-t border-gray-200 pt-8",children:I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[I.jsx(lt,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,disabled:Z,className:"bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 text-white font-semibold py-4 px-8 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300",children:Z?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Submitting Emergency Report..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-send-plane-line mr-2"}),"Submit Emergency Report"]})}),I.jsxs(r,{to:"/",className:"px-8 py-4 border-2 border-gray-300 text-gray-700 rounded-xl hover:border-gray-400 hover:bg-gray-50 transition-all duration-300 font-semibold text-center shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[I.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Cancel"]})]})})]})})})}),I.jsx(gt,{isOpen:A,onClose:()=>P(!1)}),I.jsx(xt,{isOpen:L,onClose:()=>E(!1)})]}):I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-red-50 to-orange-100",children:[I.jsx(ut,{isAuthenticated:s,userData:l||void 0}),I.jsxs("div",{className:"relative overflow-hidden",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/5 to-orange-600/5"}),I.jsx("div",{className:"absolute inset-0 opacity-40",children:I.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(239, 68, 68, 0.05) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),I.jsx("div",{className:"relative container mx-auto px-4 py-16",children:I.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[I.jsxs("div",{className:"relative inline-flex items-center justify-center mb-8",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600 to-orange-600 rounded-2xl blur-lg opacity-30 scale-110"}),I.jsx("div",{className:"relative w-20 h-20 bg-gradient-to-r from-red-600 to-orange-600 rounded-2xl flex items-center justify-center shadow-xl",children:I.jsx("i",{className:"ri-error-warning-line text-3xl text-white"})})]}),I.jsx("h1",{className:"text-5xl md:text-6xl font-bold bg-gradient-to-r from-gray-900 via-red-900 to-orange-900 bg-clip-text text-transparent mb-6 leading-tight",children:"Report an Incident"}),I.jsxs("p",{className:"text-xl md:text-2xl text-gray-600 mb-8 leading-relaxed",children:["Emergency Incident Reporting System",I.jsx("span",{className:"block text-lg text-gray-500 mt-2",children:"Submit incident reports as a guest or create an account for better tracking"})]}),I.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200/50 rounded-2xl p-6 max-w-3xl mx-auto shadow-lg backdrop-blur-sm mb-8",children:[I.jsxs("div",{className:"flex items-center justify-center text-blue-800",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-information-line text-blue-600"})}),I.jsx("p",{className:"font-semibold text-lg",children:"Guest reporting available - No account required"})]}),I.jsx("p",{className:"text-blue-600 text-sm mt-2 opacity-80",children:"You can submit incident reports without creating an account. Creating an account helps us track your reports better."})]}),I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8",children:[I.jsxs(r,{to:"/auth/login",className:"px-8 py-4 bg-gradient-to-r from-red-600 to-orange-600 text-white rounded-xl hover:from-red-700 hover:to-orange-700 transition-all duration-300 font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[I.jsx("i",{className:"ri-login-box-line mr-2"}),"Sign In"]}),I.jsxs(r,{to:"/auth/signup",className:"px-8 py-4 border-2 border-red-600 text-red-600 rounded-xl hover:bg-red-50 transition-all duration-300 font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[I.jsx("i",{className:"ri-user-add-line mr-2"}),"Create Account"]})]})]})})]}),I.jsx("div",{className:"container mx-auto px-4 pb-8",children:I.jsx("div",{className:"max-w-4xl mx-auto",children:I.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8",children:I.jsxs("form",{onSubmit:te,className:"space-y-8",children:[I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[I.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-user-line text-blue-600"})}),"Your Information"]}),I.jsx("p",{className:"text-gray-600 mt-2",children:"Please provide your contact details"})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[I.jsxs("div",{children:[I.jsxs("label",{htmlFor:"guestName",className:"block text-sm font-semibold text-gray-700 mb-3",children:[I.jsx("i",{className:"ri-user-line mr-2 text-blue-600"}),"Full Name ",I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-user-line text-gray-400"})}),I.jsx("input",{type:"text",id:"guestName",name:"guestName",value:G.guestName.value,onChange:e=>J("guestName",e.target.value),className:"w-full pl-10 pr-4 py-4 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all "+(G.guestName.error?"border-red-300":"border-gray-300"),placeholder:"Enter your full name",required:!0})]}),G.guestName.touched&&G.guestName.error&&I.jsx("p",{className:"text-red-600 text-sm mt-2",children:G.guestName.error})]}),I.jsxs("div",{children:[I.jsxs("label",{htmlFor:"guestContact",className:"block text-sm font-semibold text-gray-700 mb-3",children:[I.jsx("i",{className:"ri-phone-line mr-2 text-blue-600"}),"Contact Number ",I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-phone-line text-gray-400"})}),I.jsx(bl,{international:!0,defaultCountry:"PH",value:G.guestContact.value,onChange:e=>{J("guestContact",e||"")},className:"w-full pl-10 pr-4 py-4 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all "+(G.guestContact.error?"border-red-300":"border-gray-300"),placeholder:"Enter phone number"})]}),I.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"Enter a valid Philippine mobile number (e.g., +63 912 345 6789 or 0912 345 6789)"}),G.guestContact.touched&&G.guestContact.error&&I.jsx("p",{className:"text-red-600 text-sm mt-2",children:G.guestContact.error})]})]})]}),se(),I.jsxs("div",{className:"mt-6",children:[I.jsxs("p",{className:"text-gray-700 text-sm",children:["By submitting, you agree to our"," ",I.jsx("button",{type:"button",onClick:()=>P(!0),className:"text-red-600 underline hover:text-red-500 bg-transparent border-none p-0 font-medium transition-colors duration-200",children:"terms of service"})," ","and"," ",I.jsx("button",{type:"button",onClick:()=>E(!0),className:"text-red-600 underline hover:text-red-500 bg-transparent border-none p-0 font-medium transition-colors duration-200",children:"privacy policy"}),I.jsx("span",{className:"text-red-600",children:"*"})]}),k&&I.jsx("p",{className:"text-red-600 text-sm mt-1",children:k})]}),I.jsxs("div",{className:"mt-6",children:[I.jsx(Yt,{sitekey:"6LfVgHUqAAAAAJtQJXShsLo2QbyGby2jquueTZYV",onChange:W,ref:v}),$&&I.jsx("p",{className:"text-red-600 text-sm mt-1",children:$})]}),I.jsx("div",{className:"border-t border-gray-200 pt-8",children:I.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:I.jsx(lt,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,disabled:Z,className:"bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 text-white font-semibold py-4 px-8 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300",children:Z?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Submitting Emergency Report..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-send-plane-line mr-2"}),"Submit Emergency Report"]})})})})]})})})}),I.jsx(gt,{isOpen:A,onClose:()=>P(!1)}),I.jsx(xt,{isOpen:L,onClose:()=>E(!1)})]})}function jl({label:e,name:t,id:s,value:r,onChange:a,options:n,error:i,required:l=!1,disabled:o=!1,icon:d}){return I.jsxs("div",{className:"w-full",children:[e&&I.jsxs("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700 mb-2",children:[e," ",l&&I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsxs("div",{className:"relative",children:[d&&I.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:I.jsx("i",{className:`${d} text-gray-400`})}),I.jsxs("select",{id:s,name:t,value:r,onChange:a,disabled:o,required:l,className:`w-full ${d?"pl-10 pr-4 py-4":"px-3 py-2.5"} text-sm border rounded-xl focus:ring-2 focus:outline-none transition-all duration-200 ${i?"border-red-300 focus:border-red-500 focus:ring-red-100":"border-gray-300 hover:border-gray-400 focus:border-blue-500 focus:ring-blue-100"} ${o?"bg-gray-50 text-gray-700 cursor-not-allowed":"bg-white"}`,children:[I.jsx("option",{value:"",disabled:!0,children:"Select an option"}),n.map(e=>I.jsx("option",{value:e.value,children:e.label},e.value))]})]}),i&&I.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[I.jsx("i",{className:"ri-error-warning-line"}),i]})]})}function Nl({isOpen:e,onClose:t,title:s,children:r,size:a="md",showCloseButton:i=!0}){return n.useEffect(()=>{const s=s=>{"Escape"===s.key&&e&&t()};return e&&(document.addEventListener("keydown",s),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",s),document.body.style.overflow="unset"}},[e,t]),e?I.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-300",onClick:t}),I.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:I.jsxs("div",{className:`relative bg-white rounded-2xl shadow-2xl w-full ${{sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl"}[a]} transform transition-all duration-300 scale-100`,onClick:e=>e.stopPropagation(),children:[I.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[I.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:s}),i&&I.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center rounded-full text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors duration-200",children:I.jsx("i",{className:"ri-close-line text-xl"})})]}),I.jsx("div",{className:"p-6",children:r})]})})]}):null}function wl({isOpen:e,onClose:t,onConfirm:s,title:r,message:a,confirmText:n="Confirm",cancelText:i="Cancel",confirmVariant:l="primary",icon:o="ri-question-line",iconColor:d="text-blue-600",isLoading:c=!1}){return I.jsx(Nl,{isOpen:e,onClose:t,title:r,size:"sm",showCloseButton:!1,children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:`${o} text-2xl ${d}`})}),I.jsx("p",{className:"text-gray-600 mb-6 leading-relaxed",children:a}),I.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[I.jsx(lt,{variant:"outline",size:"md",onClick:t,disabled:c,fullWidth:!0,children:i}),I.jsx(lt,{variant:l,size:"md",onClick:s,disabled:c,fullWidth:!0,children:c?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Processing..."]}):n})]})]})})}const Sl=[{name:"Alupay",lat:13.8404,lng:121.2922},{name:"Antipolo",lat:13.708,lng:121.3096},{name:"Bagong Pook",lat:13.8402,lng:121.2216},{name:"Balibago",lat:13.8512,lng:121.2855},{name:"Barangay A",lat:13.8457,lng:121.2104},{name:"Barangay B",lat:13.8461,lng:121.2065},{name:"Barangay C",lat:13.8467,lng:121.2032},{name:"Barangay D",lat:13.844,lng:121.2035},{name:"Barangay E",lat:13.8415,lng:121.2047},{name:"Bayawang",lat:13.7944,lng:121.2798},{name:"Baybayin",lat:13.8277,lng:121.2589},{name:"Bulihan",lat:13.7967,lng:121.2351},{name:"Cahigam",lat:13.8021,lng:121.2501},{name:"Calantas",lat:13.734,lng:121.3129},{name:"Colongan",lat:13.8114,lng:121.1762},{name:"Itlugan",lat:13.819,lng:121.2036},{name:"Leviste",lat:13.7694,lng:121.2868},{name:"Lumbangan",lat:13.8122,lng:121.2649},{name:"Maalas-as",lat:13.8112,lng:121.2122},{name:"Mabato",lat:13.8144,lng:121.2913},{name:"Mabunga",lat:13.781,lng:121.2924},{name:"Macalamcam A",lat:13.8551,lng:121.3046},{name:"Macalamcam B",lat:13.8606,lng:121.3265},{name:"Malaya",lat:13.8535,lng:121.172},{name:"Maligaya",lat:13.8182,lng:121.2742},{name:"Marilag",lat:13.8562,lng:121.1764},{name:"Masaya",lat:13.8383,lng:121.1852},{name:"Matamis",lat:13.7216,lng:121.3305},{name:"Mavalor",lat:13.8177,lng:121.2315},{name:"Mayuro",lat:13.7944,lng:121.2623},{name:"Namuco",lat:13.8382,lng:121.2036},{name:"Namunga",lat:13.8431,lng:121.1978},{name:"Nasi",lat:13.7699,lng:121.3127},{name:"Natu",lat:13.842,lng:121.2683},{name:"Palakpak",lat:13.7079,lng:121.332},{name:"Pinagsibaan",lat:13.8438,lng:121.3141},{name:"Putingkahoy",lat:13.8349,lng:121.3227},{name:"Quilib",lat:13.8603,lng:121.2002},{name:"Salao",lat:13.8578,lng:121.3455},{name:"San Carlos",lat:13.8478,lng:121.2475},{name:"San Ignacio",lat:13.8335,lng:121.1764},{name:"San Isidro",lat:13.8074,lng:121.3152},{name:"San Jose",lat:13.8419,lng:121.2329},{name:"San Roque",lat:13.8518,lng:121.2039},{name:"Santa Cruz",lat:13.8599,lng:121.1853},{name:"Timbugan",lat:13.8095,lng:121.1869},{name:"Tiquiwan",lat:13.8284,lng:121.2399},{name:"Tulos",lat:13.7231,lng:121.2971}];function kl(){const e=a(),[t,s]=n.useState({}),[r,i]=n.useState(!1),[l,o]=n.useState(!1),[d,c]=n.useState(!1),[u,m]=n.useState(""),[h,x]=n.useState(!1),[g,f]=n.useState(!1),[p,b]=n.useState(!1),[y,v]=n.useState(!0),[j,N]=n.useState(!1),[w,S]=n.useState(!1),[k,C]=n.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[$,_]=n.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[A,P]=n.useState(!1),[L,E]=n.useState(!1),[T,O]=n.useState(!1),[F,R]=n.useState(null),[U,q]=n.useState(null);n.useEffect(()=>{const t=D();if(!t.isAuthenticated)return void e("/auth/login");if("user"!==t.userType){if("admin"===t.userType)return void e("/admin");if("staff"===t.userType)return void e("/staff")}s(t.userData||{}),x(!0);(async()=>{try{v(!0);const e=await ze();e.success&&e.user&&(s(t=>({...t,...e.user})),B({...t.userData,...e.user}))}catch(e){}finally{v(!1)}})();const r=()=>{const t=D();t.isAuthenticated?(x(t.isAuthenticated),s(t.userData||{})):e("/auth/login")},a=e=>{j&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("storage",r),window.addEventListener("authStateChanged",r),window.addEventListener("beforeunload",a),()=>{window.removeEventListener("storage",r),window.removeEventListener("authStateChanged",r),window.removeEventListener("beforeunload",a)}},[e]);const z=(e,t)=>{C(s=>({...s,[e]:t})),$[e]&&_(t=>({...t,[e]:""}))},W=()=>{A||(S(!1),C({currentPassword:"",newPassword:"",confirmPassword:""}),_({currentPassword:"",newPassword:"",confirmPassword:""}))},V=()=>{O(!0),R(null),q(null)},H=()=>{L||(O(!1),R(null),q(null))},{fields:G,setValue:J,validateAll:K,getValues:Y,isSubmitting:Z,setIsSubmitting:X}=yt({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",state:"",zipCode:""},{firstName:{required:!0},lastName:{required:!0},email:{required:!0,pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/},phone:{required:!1,custom:e=>e?(e=>{if(!e)return!1;if(e.startsWith("+63")){const t=e.replace(/\D/g,"");return/^639\d{9}$/.test(t)}if(e.startsWith("09")){const t=e.replace(/\D/g,"");return/^09\d{9}$/.test(t)}const t=e.replace(/\D/g,"");return t.startsWith("639")&&12===t.length?/^639\d{9}$/.test(t):!(!t.startsWith("9")||10!==t.length)&&/^9\d{9}$/.test(t)})(e)?null:"Please enter a valid Philippine mobile number (e.g., 09123456789 or +639123456789)":null},address:{required:!1},city:{required:!1},state:{required:!1},zipCode:{required:!1,pattern:/^\d{4,10}$/}});n.useEffect(()=>{if(t&&Object.keys(t).length>0&&!r){const e={firstName:t.firstName||t.first_name||"",lastName:t.lastName||t.last_name||"",email:t.email||"",phone:t.phone||"",address:t.address||"",city:t.city||"",state:t.state||"",zipCode:t.zipCode||""};Object.entries(e).some(([e,t])=>{const s=G[e]?.value;return s!==t})&&(Object.entries(e).forEach(([e,t])=>{J(e,t)}),N(!1))}},[t,r]);const Q=(e,t)=>{J(e,t||""),N(!0)},ee=()=>{i(!0),N(!1)};return!h||y?I.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50",children:I.jsxs("div",{className:"animate-pulse",children:[I.jsx("div",{className:"h-16 bg-white shadow-sm border-b border-gray-200",children:I.jsxs("div",{className:"container mx-auto px-4 h-full flex items-center justify-between",children:[I.jsx("div",{className:"h-8 w-32 bg-gray-200 rounded"}),I.jsx("div",{className:"h-8 w-24 bg-gray-200 rounded"})]})}),I.jsx("div",{className:"container mx-auto px-4 py-8",children:I.jsxs("div",{className:"max-w-5xl mx-auto grid lg:grid-cols-3 gap-8",children:[I.jsx("div",{className:"lg:col-span-1",children:I.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-full mx-auto mb-4"}),I.jsx("div",{className:"h-6 w-32 bg-gray-200 rounded mx-auto mb-2"}),I.jsx("div",{className:"h-4 w-48 bg-gray-200 rounded mx-auto mb-4"}),I.jsx("div",{className:"h-10 w-full bg-gray-200 rounded"})]})})}),I.jsx("div",{className:"lg:col-span-2",children:I.jsxs("div",{className:"bg-white rounded-2xl shadow-xl",children:[I.jsx("div",{className:"h-24 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-t-2xl"}),I.jsx("div",{className:"p-8 space-y-6",children:[...Array(6)].map((e,t)=>I.jsxs("div",{className:"space-y-2",children:[I.jsx("div",{className:"h-4 w-24 bg-gray-200 rounded"}),I.jsx("div",{className:"h-12 w-full bg-gray-200 rounded"})]},t))})]})})]})})]})}):I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50",children:[I.jsx(ut,{isAuthenticated:h,userData:t}),I.jsx("div",{className:"container mx-auto px-4 py-8",children:I.jsxs("div",{className:"max-w-5xl mx-auto",children:[l&&I.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-xl shadow-sm animate-in slide-in-from-top-2 duration-300",children:I.jsxs("div",{className:"flex items-center gap-3 text-green-800",children:[I.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-check-circle-line text-green-600"})}),I.jsx("span",{className:"font-medium",children:"Profile updated successfully!"})]})}),d&&I.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl shadow-sm animate-in slide-in-from-top-2 duration-300",children:I.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[I.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-error-warning-line text-red-600"})}),I.jsx("span",{className:"font-medium",children:u})]})}),I.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[I.jsx("div",{className:"lg:col-span-1",children:I.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 sticky top-8",children:[I.jsxs("div",{className:"text-center mb-6",children:[I.jsx("div",{className:"mb-4",children:I.jsx(ct,{name:t?.firstName&&t?.lastName?`${t.firstName} ${t.lastName}`:void 0,email:t?.email,profilePicture:t?.profile_picture,size:"xl",className:"mx-auto",onClick:V})}),I.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:t?.firstName&&t?.lastName?`${t.firstName} ${t.lastName}`:"User Profile"}),I.jsx("p",{className:"text-gray-600 mb-4",children:t?.email||"No email provided"}),!r&&I.jsxs(lt,{variant:"primary",size:"md",onClick:ee,fullWidth:!0,children:[I.jsx("i",{className:"ri-edit-line mr-2"}),"Edit Profile"]}),r&&j&&I.jsx("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:I.jsxs("div",{className:"flex items-center gap-2 text-amber-800",children:[I.jsx("i",{className:"ri-information-line text-amber-600"}),I.jsx("span",{className:"text-sm font-medium",children:"Unsaved changes"})]})})]}),I.jsxs("div",{className:"mb-6",children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Profile Completion"}),I.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round(Object.values({firstName:t?.firstName,lastName:t?.lastName,email:t?.email,phone:t?.phone,address:t?.address,city:t?.city,state:t?.state,zipCode:t?.zipCode}).filter(Boolean).length/8*100),"%"]})]}),I.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:I.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.round(Object.values({firstName:t?.firstName,lastName:t?.lastName,email:t?.email,phone:t?.phone,address:t?.address,city:t?.city,state:t?.state,zipCode:t?.zipCode}).filter(Boolean).length/8*100)}%`}})})]}),I.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:I.jsxs(lt,{variant:"outline",size:"md",onClick:()=>{j&&!window.confirm("You have unsaved changes. Are you sure you want to sign out?")||f(!0)},fullWidth:!0,children:[I.jsx("i",{className:"ri-logout-box-line mr-2"}),"Sign Out"]})})]})}),I.jsx("div",{className:"lg:col-span-2",children:I.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[I.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 px-8 py-6",children:I.jsxs("div",{className:"flex justify-between items-center",children:[I.jsxs("div",{children:[I.jsx("h2",{className:"text-2xl font-bold text-white",children:"Personal Information"}),I.jsx("p",{className:"text-blue-100 mt-1",children:"Keep your information up to date"})]}),r&&I.jsxs("div",{className:"flex items-center gap-2 text-blue-100",children:[I.jsx("i",{className:"ri-edit-line"}),I.jsx("span",{className:"text-sm font-medium",children:"Editing Mode"})]})]})}),I.jsx("div",{className:"p-8",children:I.jsxs("form",{onSubmit:async r=>{if(r.preventDefault(),K()){X(!0),c(!1),o(!1);try{const e=Y();e.state="Batangas",e.city="Rosario",e.zipCode="4225";const r=await We(e);if(r.success){const e={...t,...r.user};s(e),B(e),o(!0),setTimeout(()=>o(!1),5e3),i(!1),N(!1)}else m(r.message||"Failed to update profile. Please try again."),c(!0),setTimeout(()=>c(!1),5e3)}catch(a){a instanceof Error&&(a.message.includes("Authentication")||a.message.includes("token")||a.message.includes("401")||a.message.includes("403"))?(m("Your session has expired. Please log in again to save changes."),c(!0),setTimeout(()=>{M(),e("/auth/login")},3e3)):(m(a instanceof Error?a.message:"Network error. Please try again."),c(!0)),setTimeout(()=>c(!1),5e3)}finally{X(!1)}}},className:"space-y-8",children:[I.jsxs("div",{children:[I.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-blue-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Basic Information"})]}),I.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[I.jsx(pt,{label:"First Name",type:"text",name:"firstName",id:"firstName",value:G.firstName.value,onChange:e=>Q("firstName",e.target.value),error:G.firstName.touched?G.firstName.error:"",placeholder:"Enter your first name",required:!0,disabled:!r,icon:I.jsx("i",{className:"ri-user-line"})}),I.jsx(pt,{label:"Last Name",type:"text",name:"lastName",id:"lastName",value:G.lastName.value,onChange:e=>Q("lastName",e.target.value),error:G.lastName.touched?G.lastName.error:"",placeholder:"Enter your last name",required:!0,disabled:!r,icon:I.jsx("i",{className:"ri-user-line"})})]})]}),I.jsxs("div",{className:"border-t border-gray-100 pt-8",children:[I.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[I.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-phone-line text-green-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Contact Information"})]}),I.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[I.jsx(pt,{label:"Email Address",type:"email",name:"email",id:"email",value:G.email.value,onChange:e=>Q("email",e.target.value),error:G.email.touched?G.email.error:"",placeholder:"Enter your email",required:!0,disabled:!r,icon:I.jsx("i",{className:"ri-mail-line"})}),I.jsxs("div",{children:[I.jsxs("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-phone-line mr-2 text-green-600"}),"Phone Number"]}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-phone-line text-gray-400"})}),I.jsx(bl,{id:"phone",international:!0,defaultCountry:"PH",value:G.phone.value,onChange:e=>Q("phone",e||""),className:"w-full pl-10 pr-4 py-4 border rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all "+(G.phone.error?"border-red-300":"border-gray-300"),placeholder:"Enter your phone number",disabled:!r})]}),G.phone.touched&&G.phone.error&&I.jsx("p",{className:"text-red-600 text-sm mt-2",children:G.phone.error})]})]})]}),I.jsxs("div",{className:"border-t border-gray-100 pt-8",children:[I.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[I.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-map-pin-line text-purple-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Address Information"})]}),r?I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Province *"}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-map-line text-gray-400"})}),I.jsx("input",{type:"text",id:"province",name:"province",value:"Batangas",className:"w-full pl-10 pr-4 py-4 border border-gray-300 rounded-xl bg-gray-50 text-gray-700 cursor-not-allowed",disabled:!0})]})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City / Municipality *"}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-building-line text-gray-400"})}),I.jsx("input",{type:"text",id:"city",name:"city",value:"Rosario",className:"w-full pl-10 pr-4 py-4 border border-gray-300 rounded-xl bg-gray-50 text-gray-700 cursor-not-allowed",disabled:!0})]})]}),I.jsx(jl,{label:"Barangay *",name:"address",id:"address",value:G.address.value,onChange:e=>Q("address",e.target.value),error:G.address.touched?G.address.error:"",required:!0,disabled:!r,icon:"ri-building-line",options:Sl.map(e=>({value:e.name,label:e.name}))}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ZIP Code *"}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-mail-line text-gray-400"})}),I.jsx("input",{type:"text",id:"zipCode",name:"zipCode",value:"4225",className:"w-full pl-10 pr-4 py-4 border border-gray-300 rounded-xl bg-gray-50 text-gray-700 cursor-not-allowed",disabled:!0})]})]})]}):I.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),I.jsx("p",{className:"text-gray-900",children:[G.state.value,G.city.value,G.address.value,G.zipCode.value].filter(Boolean).join(", ")||"Not provided"})]})]}),I.jsxs("div",{className:"border-t border-gray-100 pt-8",children:[I.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[I.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-image-line text-purple-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Profile Picture"})]}),I.jsx("div",{className:"bg-gray-50 rounded-lg p-6",children:I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-gray-900",children:"Update Profile Picture"}),I.jsx("p",{className:"text-sm text-gray-600",children:"Upload a new profile picture or remove the current one"})]}),I.jsxs("div",{className:"flex gap-2",children:[I.jsxs(lt,{type:"button",variant:"outline",size:"md",onClick:V,className:"border-purple-200 text-purple-600 hover:bg-purple-50",children:[I.jsx("i",{className:"ri-upload-line mr-2"}),t?.profile_picture?"Change Picture":"Upload Picture"]}),t?.profile_picture&&I.jsxs(lt,{type:"button",variant:"outline",size:"md",onClick:async()=>{if(t.profile_picture&&window.confirm("Are you sure you want to delete your profile picture?")){E(!0),c(!1),o(!1);try{const e=await Ge();if(e.success){const r={...t,...e.user};s(r),B(r),o(!0),setTimeout(()=>o(!1),5e3)}else m(e.message||"Failed to delete profile picture"),c(!0),setTimeout(()=>c(!1),5e3)}catch(e){m(e instanceof Error?e.message:"Failed to delete profile picture. Please try again."),c(!0),setTimeout(()=>c(!1),5e3)}finally{E(!1)}}},disabled:L,className:"border-red-200 text-red-600 hover:bg-red-50",children:[I.jsx("i",{className:"ri-delete-bin-line mr-2"}),"Remove"]})]})]})})]}),I.jsxs("div",{className:"border-t border-gray-100 pt-8",children:[I.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[I.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-lock-line text-red-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Security"})]}),I.jsx("div",{className:"bg-gray-50 rounded-lg p-6",children:I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-gray-900",children:"Change Password"}),I.jsx("p",{className:"text-sm text-gray-600",children:"Update your password to keep your account secure"})]}),I.jsxs(lt,{type:"button",variant:"outline",size:"md",onClick:()=>S(!0),className:"border-red-200 text-red-600 hover:bg-red-50",children:[I.jsx("i",{className:"ri-key-line mr-2"}),"Change Password"]})]})})]}),r&&I.jsx("div",{className:"border-t border-gray-100 pt-8",children:I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[I.jsx(lt,{type:"submit",variant:"primary",size:"lg",disabled:Z,children:Z?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Saving Changes..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-save-line mr-2"}),"Save Changes"]})}),I.jsxs(lt,{type:"button",variant:"outline",size:"lg",onClick:()=>{j&&!window.confirm("You have unsaved changes. Are you sure you want to cancel?")||(i(!1),N(!1))},disabled:Z,children:[I.jsx("i",{className:"ri-close-line mr-2"}),"Cancel"]})]})})]})})]})})]}),!r&&I.jsx("div",{className:"fixed bottom-6 right-6 lg:hidden",children:I.jsx(lt,{variant:"primary",size:"lg",onClick:ee,className:"rounded-full w-14 h-14 shadow-2xl hover:shadow-3xl",children:I.jsx("i",{className:"ri-edit-line text-xl"})})})]})}),I.jsx(Nl,{isOpen:w,onClose:W,title:"Change Password",size:"md",children:I.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={currentPassword:"",newPassword:"",confirmPassword:""};return k.currentPassword||(e.currentPassword="Current password is required"),k.newPassword?k.newPassword.length<8?e.newPassword="Password must be at least 8 characters long":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(k.newPassword)||(e.newPassword="Password must contain at least one uppercase letter, one lowercase letter, and one number"):e.newPassword="New password is required",k.confirmPassword?k.newPassword!==k.confirmPassword&&(e.confirmPassword="Passwords do not match"):e.confirmPassword="Please confirm your new password",k.currentPassword&&k.newPassword&&k.currentPassword===k.newPassword&&(e.newPassword="New password must be different from current password"),_(e),!Object.values(e).some(e=>""!==e)})()){P(!0);try{const e=await Ve(k.currentPassword,k.newPassword);e.success?(C({currentPassword:"",newPassword:"",confirmPassword:""}),S(!1),o(!0),setTimeout(()=>o(!1),5e3)):_(t=>({...t,currentPassword:e.message||"Failed to change password"}))}catch(t){_(e=>({...e,currentPassword:t instanceof Error?t.message:"Failed to change password. Please try again."}))}finally{P(!1)}}},className:"space-y-6",children:[I.jsx("div",{children:I.jsx(pt,{label:"Current Password",type:"password",name:"currentPassword",id:"currentPassword",value:k.currentPassword,onChange:e=>z("currentPassword",e.target.value),error:$.currentPassword,placeholder:"Enter your current password",required:!0,icon:I.jsx("i",{className:"ri-lock-line"})})}),I.jsxs("div",{children:[I.jsx(pt,{label:"New Password",type:"password",name:"newPassword",id:"newPassword",value:k.newPassword,onChange:e=>z("newPassword",e.target.value),error:$.newPassword,placeholder:"Enter your new password",required:!0,icon:I.jsx("i",{className:"ri-key-line"})}),I.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long and contain uppercase, lowercase, and number."})]}),I.jsx("div",{children:I.jsx(pt,{label:"Confirm New Password",type:"password",name:"confirmPassword",id:"confirmPassword",value:k.confirmPassword,onChange:e=>z("confirmPassword",e.target.value),error:$.confirmPassword,placeholder:"Confirm your new password",required:!0,icon:I.jsx("i",{className:"ri-key-line"})})}),I.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[I.jsx(lt,{type:"button",variant:"outline",size:"md",onClick:W,disabled:A,children:"Cancel"}),I.jsx(lt,{type:"submit",variant:"primary",size:"md",disabled:A,children:A?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Changing..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-key-line mr-2"}),"Change Password"]})})]})]})}),I.jsx(Nl,{isOpen:T,onClose:H,title:"Update Profile Picture",size:"md",children:I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Image"}),I.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:e=>{const t=e.target.files?.[0];if(t){if(!["image/jpeg","image/png","image/gif","image/webp"].includes(t.type))return m("Please select a valid image file (JPEG, PNG, GIF, or WebP)"),c(!0),void setTimeout(()=>c(!1),5e3);if(t.size>5242880)return m("File size must be less than 5MB"),c(!0),void setTimeout(()=>c(!1),5e3);q(t);const e=new FileReader;e.onload=e=>{R(e.target?.result)},e.readAsDataURL(t)}},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",disabled:L}),I.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supported formats: JPEG, PNG, GIF, WebP. Max size: 5MB"})]}),F&&I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preview"}),I.jsx("div",{className:"flex justify-center",children:I.jsx("img",{src:F,alt:"Preview",className:"w-32 h-32 object-cover rounded-full border-4 border-gray-200"})})]}),t?.profile_picture&&!F&&I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Picture"}),I.jsx("div",{className:"flex justify-center",children:I.jsx("img",{src:t.profile_picture.startsWith("http")?t.profile_picture:`http://localhost:5000${t.profile_picture}`,alt:"Current profile",className:"w-32 h-32 object-cover rounded-full border-4 border-gray-200",onError:e=>{e.currentTarget.style.display="none"}})})]}),I.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[I.jsx(lt,{type:"button",variant:"outline",size:"md",onClick:H,disabled:L,children:"Cancel"}),I.jsx(lt,{type:"button",variant:"primary",size:"md",onClick:async()=>{if(U){E(!0),c(!1),o(!1);try{const e=await He(U);if(e.success){const r={...t,...e.user};s(r),B(r),o(!0),setTimeout(()=>o(!1),5e3),H()}else m(e.message||"Failed to upload profile picture"),c(!0),setTimeout(()=>c(!1),5e3)}catch(e){m(e instanceof Error?e.message:"Failed to upload profile picture. Please try again."),c(!0),setTimeout(()=>c(!1),5e3)}finally{E(!1)}}},disabled:!U||L,children:L?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Uploading..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-upload-line mr-2"}),"Upload Picture"]})})]})]})}),I.jsx(ot,{isOpen:g,onClose:()=>{f(!1)},onConfirm:async()=>{b(!0);try{await new Promise(e=>setTimeout(e,1e3)),M(),e("/")}catch(t){}finally{b(!1),f(!1)}},isLoading:p})]})}function Cl(e,t){const s=n.useRef(t);n.useEffect(function(){t!==s.current&&null!=e.attributionControl&&(null!=s.current&&e.attributionControl.removeAttribution(s.current),null!=t&&e.attributionControl.addAttribution(t)),s.current=t},[e,t])}function $l(e,t){return Object.freeze({...e,...t})}const _l=n.createContext(null),Al=_l.Provider;function Pl(){const e=n.useContext(_l);if(null==e)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function Ll(e){function t(t,s){const{instance:r,context:a}=e(t).current;return n.useImperativeHandle(s,()=>r),null==t.children?null:l.createElement(Al,{value:a},t.children)}return n.forwardRef(t)}function El(e){function t(t,s){const{instance:r}=e(t).current;return n.useImperativeHandle(s,()=>r),null}return n.forwardRef(t)}function Tl(e,t){const s=n.useRef();n.useEffect(function(){return null!=t&&e.instance.on(t),s.current=t,function(){null!=s.current&&e.instance.off(s.current),s.current=null}},[e,t])}function Il(e,t){const s=e.pane??t.pane;return s?{...e,pane:s}:e}var Ol=g();const Fl=s(Ol);function Rl(e,t,s){return Object.freeze({instance:e,context:t,container:s})}function Dl(e,t){return null==t?function(t,s){const r=n.useRef();return r.current||(r.current=e(t,s)),r}:function(s,r){const a=n.useRef();a.current||(a.current=e(s,r));const i=n.useRef(s),{instance:l}=a.current;return n.useEffect(function(){i.current!==s&&(t(l,s,i.current),i.current=s)},[l,s,r]),a}}function Ml(e,t){n.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){t.layerContainer?.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Bl(e){return function(t){const s=Pl(),r=e(Il(t,s),s);return Cl(s.map,t.attribution),Tl(r.current,t.eventHandlers),Ml(r.current,s),r}}function Ul(e){return function(t){const s=Pl(),r=e(Il(t,s),s);return Tl(r.current,t.eventHandlers),Ml(r.current,s),function(e,t){const s=n.useRef();n.useEffect(function(){if(t.pathOptions!==s.current){const r=t.pathOptions??{};e.instance.setStyle(r),s.current=r}},[e,t])}(r.current,t),r}}function ql(e,t){return Ll(Ul(Dl(e,t)))}function zl(){return Pl().map}function Wl(e){const t=zl();return n.useEffect(function(){return t.on(e),function(){t.off(e)}},[t,e]),t}const Vl=ql(function({center:e,children:t,...s},r){const a=new Ol.Circle(e,s);return Rl(a,$l(r,{overlayContainer:a}))},function(e,t,s){t.center!==s.center&&e.setLatLng(t.center),null!=t.radius&&t.radius!==s.radius&&e.setRadius(t.radius)});function Hl(){return Hl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},Hl.apply(this,arguments)}function Gl({bounds:e,boundsOptions:t,center:s,children:r,className:a,id:i,placeholder:o,style:d,whenReady:c,zoom:u,...m},h){const[x]=n.useState({className:a,id:i,style:d}),[g,f]=n.useState(null);n.useImperativeHandle(h,()=>g?.map??null,[g]);const p=n.useCallback(r=>{if(null!==r&&null===g){const a=new Ol.Map(r,m);null!=s&&null!=u?a.setView(s,u):null!=e&&a.fitBounds(e,t),null!=c&&a.whenReady(c),f(function(e){return Object.freeze({__version:1,map:e})}(a))}},[]);n.useEffect(()=>()=>{g?.map.remove()},[g]);const b=g?l.createElement(Al,{value:g},r):o??null;return l.createElement("div",Hl({},x,{ref:p}),b)}const Jl=n.forwardRef(Gl),Kl=(Yl=function({position:e,...t},s){const r=new Ol.Marker(e,t);return Rl(r,$l(s,{overlayContainer:r}))},Ll(Bl(Dl(Yl,function(e,t,s){t.position!==s.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==s.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==s.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==s.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==s.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())}))));var Yl;const Zl=ql(function({positions:e,...t},s){const r=new Ol.Polyline(e,t);return Rl(r,$l(s,{overlayContainer:r}))},function(e,t,s){t.positions!==s.positions&&e.setLatLngs(t.positions)}),Xl=function(e,t){const s=function(e,t){return function(s,r){const a=Pl(),n=e(Il(s,a),a);return Cl(a.map,s.attribution),Tl(n.current,s.eventHandlers),t(n.current,a,s,r),n}}(Dl(e),t);return function(e){function t(t,s){const[r,a]=n.useState(!1),{instance:i}=e(t,a).current;n.useImperativeHandle(s,()=>i),n.useEffect(function(){r&&i.update()},[i,r,t.children]);const l=i._contentNode;return l?o.createPortal(t.children,l):null}return n.forwardRef(t)}(s)}(function(e,t){return Rl(new Ol.Popup(e,t.overlayContainer),t)},function(e,t,{position:s},r){n.useEffect(function(){const{instance:a}=e;function n(e){e.popup===a&&(a.update(),r(!0))}function i(e){e.popup===a&&r(!1)}return t.map.on({popupopen:n,popupclose:i}),null==t.overlayContainer?(null!=s&&a.setLatLng(s),a.openOn(t.map)):t.overlayContainer.bindPopup(a),function(){t.map.off({popupopen:n,popupclose:i}),t.overlayContainer?.unbindPopup(),t.map.removeLayer(a)}},[e,t,r,s])}),Ql=function(e,t){return El(Bl(Dl(e,t)))}(function({url:e,...t},s){return Rl(new Ol.TileLayer(e,Il(t,s)),s)},function(e,t,s){!function(e,t,s){const{opacity:r,zIndex:a}=t;null!=r&&r!==s.opacity&&e.setOpacity(r),null!=a&&a!==s.zIndex&&e.setZIndex(a)}(e,t,s);const{url:r}=t;null!=r&&r!==s.url&&e.setUrl(r)}),eo=(so=function(e){return new Ol.Control.Zoom(e)},El((to=Dl(function(e,t){return Rl(so(e),t)}),function(e){const t=Pl(),s=to(e,t),{instance:r}=s.current,a=n.useRef(e.position),{position:i}=e;return n.useEffect(function(){return r.addTo(t.map),function(){r.remove()}},[t.map,r]),n.useEffect(function(){null!=i&&i!==a.current&&(r.setPosition(i),a.current=i)},[r,i]),s})));var to,so;delete Fl.Icon.Default.prototype._getIconUrl,Fl.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const ro=e=>{const t="open"===e?"#10b981":"full"===e?"#ef4444":"#6b7280";return Fl.divIcon({html:`\n      <div style="\n        background-color: ${t};\n        width: 24px;\n        height: 24px;\n        border-radius: 50%;\n        border: 3px solid white;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      ">\n        <i class="ri-building-2-line" style="color: white; font-size: 12px;"></i>\n      </div>\n    `,className:"custom-evacuation-marker",iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-12]})},ao=Fl.divIcon({html:'\n    <div style="\n      background-color: #3b82f6;\n      width: 16px;\n      height: 16px;\n      border-radius: 50%;\n      border: 3px solid white;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n      animation: pulse 2s infinite;\n    "></div>\n    <style>\n      @keyframes pulse {\n        0% { transform: scale(1); opacity: 1; }\n        50% { transform: scale(1.2); opacity: 0.7; }\n        100% { transform: scale(1); opacity: 1; }\n      }\n    </style>\n  ',className:"user-location-marker",iconSize:[16,16],iconAnchor:[8,8]}),no=({center:e,zoom:t})=>{const s=zl();return n.useEffect(()=>{s.setView(e,t)},[s,e,t]),null},io=(e,t,s,r)=>{const a=(s-e)*Math.PI/180,n=(r-t)*Math.PI/180,i=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e*Math.PI/180)*Math.cos(s*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2);return 6371*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))},lo=({evacuationCenters:e,userLocation:t,onCenterClick:s,height:r="24rem"})=>{const[a,i]=n.useState([16.456789,120.5678901]),[l,o]=n.useState(13),[d,c]=n.useState(!0),[u,m]=n.useState(!1),[h,x]=n.useState(!0);n.useEffect(()=>{if(t)i([t.latitude,t.longitude]),o(14);else if(e.length>0){const t=e[0];i([t.latitude,t.longitude])}},[t,e]),n.useEffect(()=>{(()=>{if(!document.querySelector('link[href*="leaflet"]')){const e=document.createElement("link");e.rel="stylesheet",e.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",e.integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=",e.crossOrigin="",document.head.appendChild(e)}})()},[]),n.useEffect(()=>{const e=setTimeout(()=>{d&&(m(!0),c(!1))},1e4);return()=>clearTimeout(e)},[d]);const g=t?e.filter(e=>io(t.latitude,t.longitude,e.latitude,e.longitude)<=20):[];return I.jsxs("div",{className:"relative",children:[I.jsxs("div",{className:"absolute top-4 right-4 z-10 space-y-3",children:[t&&I.jsx("button",{onClick:()=>{i([t.latitude,t.longitude]),o(15)},className:"group bg-white/90 backdrop-blur-sm hover:bg-white border border-white/20 rounded-xl p-3 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105",title:"Center on my location",children:I.jsx("i",{className:"ri-focus-3-line text-blue-600 text-lg group-hover:text-blue-700"})}),I.jsx("button",{onClick:()=>{e.length>0&&Fl.latLngBounds(e.map(e=>[e.latitude,e.longitude]))},className:"group bg-white/90 backdrop-blur-sm hover:bg-white border border-white/20 rounded-xl p-3 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105",title:"Show all centers",children:I.jsx("i",{className:"ri-fullscreen-line text-blue-600 text-lg group-hover:text-blue-700"})}),I.jsx("div",{className:"bg-white/90 backdrop-blur-sm border border-white/20 rounded-xl p-3 shadow-xl",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"text-lg font-bold text-blue-600",children:e.length}),I.jsx("div",{className:"text-xs text-gray-600",children:"Centers"})]})})]}),I.jsxs("div",{className:"w-full rounded-2xl overflow-hidden shadow-2xl border border-white/20 relative",style:{height:r,minHeight:"300px",position:"relative"},children:[d&&I.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-20",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),I.jsx("p",{className:"text-gray-600",children:"Loading map..."})]})}),u&&I.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-20",children:I.jsxs("div",{className:"text-center",children:[I.jsx("i",{className:"ri-error-warning-line text-4xl text-red-400 mb-4"}),I.jsx("p",{className:"text-gray-600 mb-2",children:"Failed to load interactive map"}),I.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Showing static map instead"}),I.jsx("button",{onClick:()=>{m(!1),c(!0),window.location.reload()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Retry Interactive Map"})]})}),u&&I.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center z-10",children:I.jsxs("div",{className:"text-center p-4",children:[I.jsx("i",{className:"ri-map-2-line text-6xl text-gray-400 mb-4"}),I.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Evacuation Centers Map"}),I.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:[e.length," centers available"]}),I.jsxs("div",{className:"space-y-2 text-left max-w-md mx-auto",children:[e.slice(0,5).map(e=>I.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-gray-900",children:e.name}),I.jsxs("p",{className:"text-sm text-gray-600",children:["Capacity: ",e.current_occupancy,"/",e.capacity]})]}),I.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("open"===e.status?"bg-green-100 text-green-800":"full"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:e.status})]})},e.center_id)),e.length>5&&I.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["+",e.length-5," more centers"]})]})]})}),I.jsxs(Jl,{center:a,zoom:l,style:{height:"100%",width:"100%"},className:"z-0",zoomControl:!1,whenReady:()=>{c(!1)},children:[I.jsx(no,{center:a,zoom:l}),I.jsx(eo,{position:"bottomright"}),I.jsx(Ql,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",maxZoom:19,errorTileUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",eventHandlers:{loading:()=>{},load:()=>{},tileerror:e=>{m(!0)}}}),t&&I.jsx(Kl,{position:[t.latitude,t.longitude],icon:ao,children:I.jsx(Xl,{children:I.jsxs("div",{className:"text-center",children:[I.jsx("strong",{children:"Your Location"}),I.jsx("br",{}),I.jsxs("small",{className:"text-gray-600",children:["Lat: ",t.latitude.toFixed(6),I.jsx("br",{}),"Lng: ",t.longitude.toFixed(6)]})]})})}),e.map(e=>{const r=g.some(t=>t.center_id===e.center_id);return I.jsx(Kl,{position:[e.latitude,e.longitude],icon:ro(e.status),eventHandlers:{click:()=>s?.(e)},children:I.jsx(Xl,{maxWidth:300,className:"evacuation-center-popup",children:I.jsxs("div",{className:"p-2",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsx("h3",{className:"font-bold text-lg text-gray-900",children:e.name}),I.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("open"===e.status?"bg-green-100 text-green-800":"full"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),I.jsxs("div",{className:"space-y-2 mb-4",children:[I.jsxs("p",{className:"text-sm text-gray-600",children:[I.jsx("span",{className:"font-medium",children:"Capacity:"})," ",e.current_occupancy,"/",e.capacity]}),I.jsxs("p",{className:"text-sm text-gray-600",children:[I.jsx("span",{className:"font-medium",children:"Contact:"})," ",e.contact_person]}),I.jsxs("p",{className:"text-sm text-gray-600",children:[I.jsx("span",{className:"font-medium",children:"Phone:"})," ",e.contact_number]}),r&&I.jsxs("p",{className:"text-sm text-blue-600 font-medium",children:[I.jsx("i",{className:"ri-car-line mr-1"}),"Drive-in Nearby (",io(t.latitude,t.longitude,e.latitude,e.longitude).toFixed(1)," km)"]})]}),I.jsxs("div",{className:"flex gap-2",children:[I.jsx("button",{onClick:()=>(e=>{const t=encodeURIComponent(`${e.name}, San Juan, Batangas`);window.open(`https://maps.google.com/?q=${t}`,"_blank")})(e),className:"flex-1 bg-blue-600 text-white py-1 px-3 rounded text-sm hover:bg-blue-700 transition-colors",children:"Directions"}),I.jsx("button",{onClick:()=>{return t=e.contact_number,void window.open(`tel:${t}`,"_self");var t},className:"flex-1 border border-blue-600 text-blue-600 py-1 px-3 rounded text-sm hover:bg-blue-50 transition-colors",children:"Call"})]}),I.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Updated: ",(a=e.last_updated,new Date(a).toLocaleString())]})]})})},e.center_id);var a})]})]}),I.jsxs("div",{className:"absolute bottom-4 left-4 z-10",children:[I.jsx("button",{onClick:()=>x(!h),className:"mb-2 bg-white/90 backdrop-blur-sm hover:bg-white border border-white/20 rounded-xl p-3 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105",title:h?"Hide Legend":"Show Legend",children:I.jsx("i",{className:`ri-${h?"arrow-down-s":"arrow-up-s"}-line text-blue-600 text-lg transition-transform duration-300`})}),I.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-4 transition-all duration-300 "+(h?"opacity-100 translate-y-0 max-h-96":"opacity-0 -translate-y-4 max-h-0 overflow-hidden"),children:[I.jsxs("h4",{className:"text-sm font-bold text-gray-900 mb-3 flex items-center",children:[I.jsx("i",{className:"ri-information-line mr-2 text-blue-600"}),"Legend"]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex items-center text-sm",children:[I.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full mr-3 shadow-sm"}),I.jsx("span",{className:"text-gray-700 font-medium",children:"Open Centers"})]}),I.jsxs("div",{className:"flex items-center text-sm",children:[I.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-red-500 to-rose-500 rounded-full mr-3 shadow-sm"}),I.jsx("span",{className:"text-gray-700 font-medium",children:"Full Centers"})]}),I.jsxs("div",{className:"flex items-center text-sm",children:[I.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-gray-500 to-slate-500 rounded-full mr-3 shadow-sm"}),I.jsx("span",{className:"text-gray-700 font-medium",children:"Closed Centers"})]}),t&&I.jsxs("div",{className:"flex items-center text-sm border-t border-gray-200 pt-2 mt-2",children:[I.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-full mr-3 shadow-sm animate-pulse"}),I.jsx("span",{className:"text-gray-700 font-medium",children:"Your Location"})]})]})]})]})]})};class oo extends n.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){}render(){return this.state.hasError?I.jsx("div",{className:"h-full w-full bg-gray-100 rounded-lg flex items-center justify-center",children:I.jsxs("div",{className:"text-center",children:[I.jsx("i",{className:"ri-error-warning-line text-4xl text-red-400 mb-4"}),I.jsx("p",{className:"text-gray-600",children:"Map failed to load"}),I.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Please refresh the page to try again"}),I.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Retry"})]})}):this.props.children}}const co=e=>I.jsx(oo,{children:I.jsx(lo,{...e})}),uo=()=>{const[e,t]=n.useState([]),[s,r]=n.useState({}),[a,i]=n.useState(!0),[l,o]=n.useState({}),[d,c]=n.useState(null),[u,m]=n.useState(!1),[h,x]=n.useState("list"),[g]=n.useState(3),[f,p]=n.useState(null),[b,y]=n.useState(""),[v,j]=n.useState("all"),[N,w]=n.useState(null),[S,k]=n.useState(null),[C,$]=n.useState(null),[_,A]=n.useState(null),[P,L]=n.useState(!1),[E,T]=n.useState([]),{latitude:O,longitude:F,error:R,loading:M,getCurrentLocation:B}=kt(),U=async e=>{try{o(t=>({...t,[e]:!0}));const t=await _e(e);t.success&&r(s=>({...s,[e]:t.data||[]}))}catch(t){r(t=>({...t,[e]:[]}))}finally{o(t=>({...t,[e]:!1}))}};n.useEffect(()=>{const e=D();if(e.isAuthenticated&&"user"!==e.userType){if("admin"===e.userType)return void(window.location.href="/admin");if("staff"===e.userType)return void(window.location.href="/staff")}const s=e.isAuthenticated&&"user"===e.userType;m(s),c(s?e.userData:null);const r=()=>{const e=D();if(e.isAuthenticated&&"user"!==e.userType){if("admin"===e.userType)return void(window.location.href="/admin");if("staff"===e.userType)return void(window.location.href="/staff")}const t=e.isAuthenticated&&"user"===e.userType;m(t),c(t?e.userData:null)};return window.addEventListener("storage",r),window.addEventListener("authStateChanged",r),Se().then(e=>{Array.isArray(e)?(t(e),e.forEach(e=>{U(e.center_id)})):t([]),i(!1)}).catch(e=>{t([]),i(!1)}),()=>{window.removeEventListener("storage",r),window.removeEventListener("authStateChanged",r)}},[]);const q=(e,t,s,r)=>{const a=(s-e)*Math.PI/180,n=(r-t)*Math.PI/180,i=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e*Math.PI/180)*Math.cos(s*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2);return 6371*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))};n.useEffect(()=>{if(O&&F&&e.length>0){(async()=>{const t=await Promise.all(e.map(async e=>{const t=await(async(e,t,s,r)=>{try{const a=q(e,t,s,r);let n,i;return n=a<5?1.2*a:a<15?1.4*a:1.6*a,i=n<5?25:n<15?35:45,{distance:n,duration:n/i*60}}catch(a){const n=q(e,t,s,r);return{distance:n,duration:n/30*60}}})(O,F,e.latitude,e.longitude);return{...e,distance:t.distance,duration:t.duration}}));T(t)})()}else T([])},[O,F,e]);const z=E.sort((e,t)=>e.distance-t.distance).slice(0,g),W=e=>s[e]||[],V=e=>{if(!e)return"";if(e.startsWith("http"))return e;let t=e;t.startsWith("/")&&(t=t.slice(1)),t.startsWith("uploads/")&&(t=t.slice(8));return`/uploads/${t}`},H=O&&F?{latitude:O,longitude:F}:null;n.useEffect(()=>{},[s]);const G=e.filter(e=>{const t=""===b||e.name?.toLowerCase().includes(b.toLowerCase())||e.contact_person?.toLowerCase().includes(b.toLowerCase()),s="all"===v||e.status===v;return t&&s}),J=P?G:G.slice(0,8);return a?I.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:I.jsxs("div",{className:"text-center max-w-md mx-auto px-6",children:[I.jsxs("div",{className:"relative mb-8",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-3xl blur-lg opacity-30 scale-110 animate-pulse"}),I.jsx("div",{className:"relative w-24 h-24 mx-auto bg-gradient-to-r from-blue-600 to-indigo-600 rounded-3xl flex items-center justify-center shadow-2xl",children:I.jsx("i",{className:"ri-building-2-line text-3xl text-white animate-bounce"})})]}),I.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Loading Evacuation Centers"}),I.jsx("p",{className:"text-gray-600 mb-6",children:"Fetching real-time information..."}),I.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:I.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 h-2 rounded-full animate-pulse",style:{width:"60%"}})}),I.jsxs("div",{className:"space-y-2 text-sm text-gray-500",children:[I.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[I.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse"}),I.jsx("span",{children:"Connecting to emergency services..."})]}),I.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[I.jsx("div",{className:"w-2 h-2 bg-gray-300 rounded-full"}),I.jsx("span",{children:"Retrieving center data..."})]}),I.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[I.jsx("div",{className:"w-2 h-2 bg-gray-300 rounded-full"}),I.jsx("span",{children:"Preparing map view..."})]})]})]})}):I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:[I.jsx(ut,{isAuthenticated:u,userData:d||void 0}),I.jsxs("div",{className:"relative overflow-hidden",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/5 to-indigo-600/5"}),I.jsx("div",{className:"absolute inset-0 opacity-40",children:I.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(156, 146, 172, 0.05) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),I.jsx("div",{className:"relative container mx-auto px-4 py-16",children:I.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[I.jsxs("div",{className:"relative inline-flex items-center justify-center mb-8",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl blur-lg opacity-30 scale-110"}),I.jsx("div",{className:"relative w-20 h-20 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center shadow-xl",children:I.jsx("i",{className:"ri-building-2-line text-3xl text-white"})})]}),I.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold bg-gradient-to-r from-gray-900 via-blue-900 to-indigo-900 bg-clip-text text-transparent mb-6 leading-tight",children:"Evacuation Centers"}),I.jsxs("p",{className:"text-lg sm:text-xl md:text-2xl text-gray-600 mb-8 leading-relaxed",children:["Rosario, Batangas",I.jsx("span",{className:"block text-base sm:text-lg text-gray-500 mt-2",children:"Emergency Evacuation Facilities"})]}),I.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-8 max-w-4xl mx-auto",children:[I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-white/20 rounded-xl p-3 md:p-4 shadow-lg",children:[I.jsx("div",{className:"text-xl md:text-2xl font-bold text-blue-600",children:e.length}),I.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:"Total Centers"})]}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-white/20 rounded-xl p-3 md:p-4 shadow-lg",children:[I.jsx("div",{className:"text-xl md:text-2xl font-bold text-green-600",children:e.filter(e=>"open"===e.status).length}),I.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:"Available"})]}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-white/20 rounded-xl p-3 md:p-4 shadow-lg",children:[I.jsx("div",{className:"text-xl md:text-2xl font-bold text-blue-600",children:z.length}),I.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:"Closest"})]}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-white/20 rounded-xl p-3 md:p-4 shadow-lg",children:[I.jsx("div",{className:"text-xl md:text-2xl font-bold text-yellow-600",children:e.filter(e=>"open"===e.status).length}),I.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:"Open Now"})]})]}),I.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200/50 rounded-2xl p-4 md:p-6 max-w-3xl mx-auto shadow-lg backdrop-blur-sm",children:[I.jsxs("div",{className:"flex items-center justify-center text-blue-800",children:[I.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 bg-blue-100 rounded-full flex items-center justify-center mr-2 md:mr-3",children:I.jsx("i",{className:"ri-information-line text-blue-600 text-sm md:text-base"})}),I.jsx("p",{className:"font-semibold text-sm md:text-lg",children:"Real-time information for all evacuation centers"})]}),I.jsxs("p",{className:"text-blue-600 text-xs md:text-sm mt-2 opacity-80",children:["Updated every 5 minutes • Last update: ",(new Date).toLocaleTimeString()]})]})]})})]}),I.jsxs("div",{className:"container mx-auto px-4 pb-8",children:[I.jsx("div",{className:"flex justify-center mb-8",children:I.jsxs("div",{className:"relative bg-white/90 backdrop-blur-sm rounded-2xl p-1.5 shadow-xl border border-white/20",children:[I.jsx("div",{className:"absolute top-1.5 bottom-1.5 w-1/2 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl shadow-lg transition-transform duration-300 ease-out "+("map"===h?"translate-x-full":"translate-x-0")}),I.jsxs("div",{className:"relative flex",children:[I.jsxs("button",{onClick:()=>x("list"),className:"relative px-6 py-3 rounded-xl font-semibold transition-all duration-300 flex items-center space-x-2 min-w-[120px] justify-center "+("list"===h?"text-white":"text-gray-600 hover:text-gray-900"),children:[I.jsx("i",{className:"ri-list-unordered text-lg transition-transform duration-300 "+("list"===h?"scale-110":"")}),I.jsx("span",{children:"List"})]}),I.jsxs("button",{onClick:()=>x("map"),className:"relative px-6 py-3 rounded-xl font-semibold transition-all duration-300 flex items-center space-x-2 min-w-[120px] justify-center "+("map"===h?"text-white":"text-gray-600 hover:text-gray-900"),children:[I.jsx("i",{className:"ri-map-2-line text-lg transition-transform duration-300 "+("map"===h?"scale-110":"")}),I.jsx("span",{children:"Map"})]})]})]})}),I.jsx("div",{className:"max-w-4xl mx-auto mb-8",children:I.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-4 md:p-6",children:[I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[I.jsxs("div",{className:"md:col-span-2",children:[I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-search-line mr-2"}),"Search Centers"]}),I.jsxs("div",{className:"relative",children:[I.jsx("input",{type:"text",placeholder:"Search by name or contact person...",value:b,onChange:e=>y(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"}),I.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),b&&I.jsx("button",{onClick:()=>y(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:I.jsx("i",{className:"ri-close-line"})})]})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-filter-line mr-2"}),"Filter by Status"]}),I.jsxs("select",{value:v,onChange:e=>j(e.target.value),className:"w-full py-3 px-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",children:[I.jsx("option",{value:"all",children:"All Centers"}),I.jsx("option",{value:"open",children:"Open Only"}),I.jsx("option",{value:"full",children:"Full Only"}),I.jsx("option",{value:"closed",children:"Closed Only"})]})]})]}),I.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 text-sm",children:[I.jsxs("div",{className:"text-gray-600",children:["Showing ",I.jsx("span",{className:"font-semibold text-blue-600",children:J.length})," of"," ",I.jsx("span",{className:"font-semibold",children:e.length})," centers",b&&I.jsxs("span",{className:"block sm:inline sm:ml-2 text-blue-600 mt-1 sm:mt-0",children:['for "',b,'"']})]}),(b||"all"!==v)&&I.jsxs("button",{onClick:()=>{y(""),j("all")},className:"text-blue-600 hover:text-blue-700 font-medium flex items-center justify-center sm:justify-start space-x-1 bg-blue-50 hover:bg-blue-100 px-3 py-2 rounded-lg transition-colors self-start sm:self-auto",children:[I.jsx("i",{className:"ri-refresh-line"}),I.jsx("span",{children:"Clear Filters"})]})]})]})}),"map"===h&&I.jsx("div",{className:"flex justify-center mb-6",children:I.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl p-4 shadow-xl border border-white/20 max-w-md w-full mx-4",children:M?I.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-loader-4-line animate-spin text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-gray-700 font-medium",children:"Getting your location..."}),I.jsx("p",{className:"text-gray-500 text-sm",children:"This may take a few seconds"})]})]}):R?I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3",children:I.jsx("i",{className:"ri-error-warning-line text-red-600 text-xl"})}),I.jsx("p",{className:"text-red-700 font-medium mb-2",children:"Location Access Denied"}),I.jsx("p",{className:"text-red-600 text-sm mb-3",children:R}),I.jsxs("button",{onClick:B,className:"bg-red-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-red-700 transition-colors font-medium",children:[I.jsx("i",{className:"ri-refresh-line mr-2"}),"Try Again"]})]}):H?I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-map-pin-line text-green-600 text-lg"})}),I.jsxs("div",{className:"flex-1",children:[I.jsx("p",{className:"text-green-700 font-medium",children:"Location Found"}),I.jsxs("p",{className:"text-green-600 text-sm",children:[z.length," closest centers found"]})]}),I.jsxs("div",{className:"text-right",children:[I.jsx("div",{className:"text-lg font-bold text-green-600",children:z.length}),I.jsx("div",{className:"text-xs text-green-500",children:"closest"})]})]}):I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-map-pin-line text-gray-500 text-lg"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-gray-700 font-medium",children:"Location not available"}),I.jsx("p",{className:"text-gray-500 text-sm",children:"Enable location for nearby centers"})]})]})})})]}),0===e.length?I.jsxs("div",{className:"text-center py-16",children:[I.jsxs("div",{className:"relative mb-8",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-400 to-gray-500 rounded-3xl blur-lg opacity-20 scale-110"}),I.jsx("div",{className:"relative w-24 h-24 mx-auto bg-gradient-to-r from-gray-400 to-gray-500 rounded-3xl flex items-center justify-center shadow-xl",children:I.jsx("i",{className:"ri-building-2-line text-3xl text-white"})})]}),I.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No Evacuation Centers Found"}),I.jsx("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:"We couldn't find any evacuation centers in your area. Please check back later or contact emergency services."}),I.jsxs("div",{className:"flex justify-center space-x-4",children:[I.jsxs("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[I.jsx("i",{className:"ri-refresh-line"}),I.jsx("span",{children:"Refresh"})]}),I.jsxs("button",{onClick:()=>window.open("tel:911","_self"),className:"border-2 border-red-600 text-red-600 px-6 py-3 rounded-xl font-semibold hover:bg-red-600 hover:text-white transition-colors flex items-center space-x-2",children:[I.jsx("i",{className:"ri-phone-line"}),I.jsx("span",{children:"Emergency Call"})]})]})]}):0===G.length?I.jsxs("div",{className:"text-center py-16",children:[I.jsxs("div",{className:"relative mb-8",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400 to-indigo-400 rounded-3xl blur-lg opacity-20 scale-110"}),I.jsx("div",{className:"relative w-24 h-24 mx-auto bg-gradient-to-r from-blue-400 to-indigo-400 rounded-3xl flex items-center justify-center shadow-xl",children:I.jsx("i",{className:"ri-search-line text-3xl text-white"})})]}),I.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No Centers Found"}),I.jsx("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:"No evacuation centers match your current search criteria. Try adjusting your filters or search terms."}),I.jsxs("button",{onClick:()=>{y(""),j("all")},className:"bg-blue-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors flex items-center space-x-2 mx-auto",children:[I.jsx("i",{className:"ri-refresh-line"}),I.jsx("span",{children:"Clear All Filters"})]})]}):I.jsx(I.Fragment,{children:"map"===h?I.jsxs("div",{className:"space-y-6",children:[I.jsx("div",{className:"flex justify-center mb-6",children:I.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl p-4 shadow-xl border border-white/20",children:I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-map-pin-line text-blue-600"})}),I.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Closest Centers:"})]}),I.jsxs("div",{className:"text-sm text-gray-600",children:[g," nearest by route"]}),H&&I.jsxs("button",{onClick:B,className:"bg-blue-600 text-white px-4 py-2 rounded-xl text-sm font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[I.jsx("i",{className:"ri-refresh-line"}),I.jsx("span",{children:"Refresh Location"})]})]})})}),I.jsx(co,{evacuationCenters:G,userLocation:H,onCenterClick:e=>{p(e)},height:"32rem"}),z.length>0&&I.jsxs("div",{className:"bg-gradient-to-br from-white via-blue-50/30 to-indigo-50/30 backdrop-blur-sm rounded-3xl shadow-2xl border border-blue-200/50 p-8 mb-8",children:[I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl blur-lg opacity-30 scale-110"}),I.jsx("div",{className:"relative w-12 h-12 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center shadow-xl",children:I.jsx("i",{className:"ri-map-pin-line text-white text-xl"})})]}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-gray-900 to-blue-900 bg-clip-text text-transparent",children:"Closest Centers"}),I.jsxs("p",{className:"text-gray-600 text-sm mt-1",children:[g," nearest evacuation centers by driving route"]})]})]}),I.jsx("div",{className:"flex items-center space-x-3",children:I.jsxs("div",{className:"bg-gradient-to-r from-blue-100 to-indigo-100 text-blue-800 px-4 py-2 rounded-full text-sm font-semibold shadow-md border border-blue-200",children:[I.jsx("i",{className:"ri-building-2-line mr-1"}),z.length," found"]})})]}),I.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:z.map((e,t)=>I.jsxs("div",{className:"group relative bg-white/90 backdrop-blur-sm border border-blue-200/50 rounded-2xl p-4 hover:shadow-2xl hover:border-blue-400/60 transition-all duration-500 hover:-translate-y-2 hover:scale-105",style:{animationDelay:150*t+"ms"},children:[I.jsxs("div",{className:"absolute -top-2 -right-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white px-3 py-1 rounded-full text-xs font-bold shadow-lg",children:["#",t+1]}),I.jsxs("div",{className:"flex items-start justify-between mb-4",children:[I.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[I.jsx("div",{className:"w-4 h-4 rounded-full shadow-md "+("open"===e.status?"bg-gradient-to-r from-green-400 to-green-600":"full"===e.status?"bg-gradient-to-r from-red-400 to-red-600":"bg-gradient-to-r from-gray-400 to-gray-600")}),I.jsx("h4",{className:"font-bold text-gray-900 text-base group-hover:text-blue-600 transition-colors truncate",children:e.name})]}),I.jsx("span",{className:"px-3 py-1.5 rounded-xl text-xs font-semibold shadow-sm border "+("open"===e.status?"bg-gradient-to-r from-green-50 to-green-100 text-green-800 border-green-200":"full"===e.status?"bg-gradient-to-r from-red-50 to-red-100 text-red-800 border-red-200":"bg-gradient-to-r from-gray-50 to-gray-100 text-gray-800 border-gray-200"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-map-pin-2-line text-blue-500 text-sm"}),I.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[e.distance.toFixed(1)," km away"]})]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-group-line text-gray-500 text-sm"}),I.jsxs("span",{className:"text-sm text-gray-600",children:[e.current_occupancy,"/",e.capacity," capacity"]})]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-phone-line text-gray-500 text-sm"}),I.jsx("span",{className:"text-sm text-gray-600",children:e.contact_number})]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-tools-line text-purple-500 text-sm"}),I.jsx("span",{className:"text-sm text-gray-600",children:(()=>{const t=W(e.center_id);return 0===t.length?I.jsx("button",{onClick:()=>U(e.center_id),className:"text-purple-600 hover:text-purple-700 text-xs",children:"Load Resources"}):`${t.length} resources available`})()})]})]}),I.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 flex space-x-2",children:[I.jsxs("button",{onClick:()=>window.open(`https://maps.google.com/?q=${encodeURIComponent(e.name+" Rosario, Batangas")}`,"_blank"),className:"flex-1 bg-blue-600 text-white py-1.5 px-3 rounded-lg text-xs font-medium hover:bg-blue-700 transition-colors",children:[I.jsx("i",{className:"ri-direction-line mr-1"}),"Directions"]}),I.jsxs("button",{onClick:()=>window.open(`tel:${e.contact_number}`,"_self"),className:"flex-1 border border-blue-600 text-blue-600 py-1.5 px-3 rounded-lg text-xs font-medium hover:bg-blue-50 transition-colors",children:[I.jsx("i",{className:"ri-phone-line mr-1"}),"Call"]})]})]},e.center_id))})]})]}):I.jsxs("div",{children:[I.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 px-4 md:px-6 lg:px-8 max-w-6xl mx-auto",children:J.map((e,t)=>{const s=E.find(t=>t.center_id===e.center_id),r=s?.distance||null,a=s?.duration||null,n=z.some(t=>t.center_id===e.center_id),i=e.current_occupancy/e.capacity*100;return I.jsxs("div",{className:"group relative bg-white/90 backdrop-blur-sm border rounded-xl shadow-lg px-3 py-4 md:px-1 md:py-3 hover:shadow-xl transition-all duration-300 hover:-translate-y-1 "+(n?"border-blue-300 ring-1 ring-blue-100 bg-gradient-to-br from-blue-50/50 to-white":"border-white/20 hover:border-blue-200"),style:{animationDelay:100*t+"ms",animation:"fadeInUp 0.4s ease-out forwards"},children:[n&&r&&I.jsxs("div",{className:"absolute -top-1 -right-1 bg-blue-600 text-white px-2 py-0.5 rounded-full text-xs font-medium shadow-md",children:[I.jsx("i",{className:"ri-route-line mr-0.5 text-xs"}),r.toFixed(1),"km",a&&I.jsxs("span",{className:"ml-1",children:["• ",Math.round(a),"min"]})]}),I.jsxs("div",{className:"flex items-start justify-between mb-4",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center shadow-md "+("open"===e.status?"bg-gradient-to-r from-green-500 to-emerald-500":"full"===e.status?"bg-gradient-to-r from-red-500 to-rose-500":"bg-gradient-to-r from-gray-500 to-slate-500"),children:I.jsx("i",{className:"ri-building-2-line text-lg text-white"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-base font-bold text-gray-900 group-hover:text-blue-600 transition-colors truncate",children:e.name}),I.jsx("p",{className:"text-gray-500 text-sm",children:"Emergency Facility"})]})]}),I.jsx("div",{className:"text-right",children:I.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium "+("open"===e.status?"bg-green-100 text-green-700":"full"===e.status?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:[I.jsx("div",{className:"w-1.5 h-1.5 rounded-full mr-1.5 "+("open"===e.status?"bg-green-500":"full"===e.status?"bg-red-500":"bg-gray-500")}),e.status.charAt(0).toUpperCase()+e.status.slice(1)]})})]}),I.jsxs("div",{className:"mb-4",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Capacity"}),I.jsxs("span",{className:"text-sm text-gray-600",children:[e.current_occupancy,"/",e.capacity]})]}),I.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:I.jsx("div",{className:"h-2.5 rounded-full transition-all duration-1000 "+(i>=90?"bg-gradient-to-r from-red-500 to-red-600":i>=70?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-green-500 to-emerald-500"),style:{width:`${Math.min(i,100)}%`}})}),I.jsxs("div",{className:"flex items-center justify-between mt-2",children:[I.jsxs("p",{className:"text-xs text-gray-500",children:[i.toFixed(0),"% occupied"]}),I.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium "+("open"===e.status?"bg-green-100 text-green-700":"full"===e.status?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]})]}),I.jsx("div",{className:"mb-4",children:I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-blue-600 text-xs"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.contact_person}),I.jsx("p",{className:"text-xs text-gray-500",children:"Contact Person"})]})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-phone-line text-green-600 text-xs"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.contact_number}),I.jsx("p",{className:"text-xs text-gray-500",children:"Phone Number"})]})]})]})}),I.jsxs("div",{className:"mb-4",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-tools-line text-purple-600 text-sm"}),I.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Resources"})]}),I.jsx("button",{onClick:()=>U(e.center_id),className:"text-xs text-purple-600 hover:text-purple-700 font-medium",children:l[e.center_id]?"Loading...":"Refresh"})]}),l[e.center_id]?I.jsxs("div",{className:"flex items-center justify-center py-3",children:[I.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-purple-600"}),I.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Loading..."})]}):I.jsx("div",{children:(()=>{const t=W(e.center_id);if(!(t.length>0))return I.jsxs("div",{className:"text-center py-3 bg-gray-50 rounded-lg",children:[I.jsx("p",{className:"text-sm text-gray-500",children:"No resources available"}),I.jsx("button",{onClick:()=>U(e.center_id),className:"text-xs text-purple-600 hover:text-purple-700 mt-1",children:"Load Resources"})]});const s=t.length,r=t.filter(e=>e.picture).length;return I.jsx("div",{onClick:()=>k({center:e,resources:t}),className:"bg-purple-50 rounded-lg p-3 border border-purple-200 cursor-pointer hover:bg-purple-100 transition-colors",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-tools-line text-purple-600"}),I.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[s," resources available"]})]}),I.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[r>0&&I.jsxs("span",{className:"flex items-center",children:[I.jsx("i",{className:"ri-image-line mr-1"}),r," with images"]}),I.jsx("i",{className:"ri-arrow-right-line"})]})]})})})()})]}),I.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[I.jsxs("button",{onClick:()=>window.open(`https://maps.google.com/?q=${encodeURIComponent(e.name+" Rosario, Batangas")}`,"_blank"),className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm flex items-center justify-center space-x-2",children:[I.jsx("i",{className:"ri-direction-line text-sm"}),I.jsx("span",{children:"Directions"})]}),I.jsxs("button",{onClick:()=>window.open(`tel:${e.contact_number}`,"_self"),className:"flex-1 border border-blue-600 text-blue-600 py-3 px-4 rounded-lg hover:bg-blue-600 hover:text-white transition-colors font-medium text-sm flex items-center justify-center space-x-2",children:[I.jsx("i",{className:"ri-phone-line text-sm"}),I.jsx("span",{children:"Call"})]})]})]},e.center_id)})}),G.length>8&&I.jsx("div",{className:"flex justify-center mt-6",children:I.jsxs("button",{onClick:()=>L(!P),className:"px-6 py-3 rounded-xl font-semibold  transition-colors flex items-center space-x-2",children:[I.jsx("i",{className:`x-${P?"up":"down"}-line`}),I.jsx("span",{children:P?"Show Less":"Show More"})]})})]})}),N&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:I.jsxs("div",{className:"relative max-w-4xl max-h-full",children:[I.jsx("button",{onClick:()=>w(null),className:"absolute -top-12 right-0 text-white hover:text-gray-300 text-2xl font-bold z-10",children:"×"}),I.jsx("img",{src:N?.src,alt:N?.alt,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl"}),I.jsx("div",{className:"absolute bottom-4 left-4 right-4 bg-black bg-opacity-50 text-white p-3 rounded-lg",children:I.jsx("p",{className:"text-center font-medium",children:N?.alt})})]})}),S&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:I.jsxs("div",{className:"relative bg-white rounded-2xl max-w-7xl max-h-[95vh] overflow-hidden",children:[I.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h2",{className:"text-2xl font-bold",children:S.center.name}),I.jsxs("p",{className:"text-purple-100 mt-1",children:["All Available Resources (",S.resources.length," items)"]})]}),I.jsx("button",{onClick:()=>k(null),className:"text-white hover:text-gray-200 text-3xl font-bold transition-colors",children:"×"})]})}),I.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(95vh-140px)]",children:[I.jsx("div",{className:"mb-6 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-4 border border-purple-200/50",children:I.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:(()=>{const e=(e=>{const t={facility:[],feature:[],water:[],supply:[]};return e.forEach(e=>{t[e.type]&&t[e.type].push(e)}),t})(S.resources),t={facility:{bg:"bg-blue-100",text:"text-blue-700",icon:"ri-building-line"},feature:{bg:"bg-green-100",text:"text-green-700",icon:"ri-star-line"},water:{bg:"bg-cyan-100",text:"text-cyan-700",icon:"ri-water-flash-line"},supply:{bg:"bg-orange-100",text:"text-orange-700",icon:"ri-box-line"}};return Object.entries(e).map(([e,s])=>{if(0===s.length)return null;const r=t[e];return I.jsxs("div",{className:`${r.bg} rounded-lg p-3 text-center`,children:[I.jsx("i",{className:`${r.icon} ${r.text} text-2xl mb-2`}),I.jsx("div",{className:`text-lg font-bold ${r.text}`,children:s.length}),I.jsx("div",{className:"text-xs text-gray-600 capitalize",children:e})]},e)})})()})}),I.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.resources.map(e=>I.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-lg transition-all duration-300 hover:-translate-y-1",children:[I.jsx("div",{className:"text-center mb-4",children:I.jsxs("div",{className:"relative inline-block",children:[e.picture?I.jsx("img",{src:V(e.picture),alt:e.name,className:"w-48 h-48 object-cover rounded-lg shadow-md cursor-pointer hover:scale-105 transition-transform",onClick:()=>w({src:V(e.picture),alt:e.name})}):I.jsx("div",{className:"w-48 h-48 bg-gray-100 rounded-lg shadow-md flex items-center justify-center",children:I.jsx("i",{className:"ri-image-line text-gray-400 text-4xl"})}),e.picture&&I.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-20 rounded-lg transition-all duration-200 flex items-center justify-center",children:I.jsx("i",{className:"ri-zoom-in-line text-white opacity-0 hover:opacity-100 transition-opacity text-2xl"})})]})}),I.jsxs("div",{className:"text-center",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.name}),I.jsx("div",{className:"mb-3",children:I.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium "+("facility"===e.type?"bg-blue-100 text-blue-700":"feature"===e.type?"bg-green-100 text-green-700":"water"===e.type?"bg-cyan-100 text-cyan-700":"bg-orange-100 text-orange-700"),children:[I.jsx("i",{className:"mr-1 "+("facility"===e.type?"ri-building-line":"feature"===e.type?"ri-star-line":"water"===e.type?"ri-water-flash-line":"ri-box-line")}),e.type.charAt(0).toUpperCase()+e.type.slice(1)]})}),I.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[I.jsx("div",{className:"flex items-center justify-center space-x-4",children:I.jsxs("span",{className:"flex items-center",children:[I.jsx("i",{className:"ri-number-line mr-1"}),"Quantity: ",e.quantity]})}),e.picture&&I.jsxs("div",{className:"flex items-center justify-center",children:[I.jsx("i",{className:"ri-image-line mr-1 text-blue-500"}),I.jsx("span",{className:"text-blue-600",children:"Has image"})]})]})]})]},e.resource_id))})]}),I.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:I.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsx("span",{children:"Click on any image to view full size"}),I.jsx("span",{children:"•"}),I.jsxs("span",{children:[S.resources.filter(e=>e.picture).length," resources with images"]})]}),I.jsxs("span",{children:[S.resources.length," total resources"]})]})})]})}),"      ",C&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:I.jsxs("div",{className:"relative bg-white rounded-2xl max-w-2xl w-full overflow-hidden",children:[I.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 text-white p-6",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h2",{className:"text-2xl font-bold",children:C.name}),I.jsx("p",{className:"text-blue-100 mt-1",children:"Contact Information"})]}),I.jsx("button",{onClick:()=>$(null),className:"text-white hover:text-gray-200 text-3xl font-bold transition-colors",children:"×"})]})}),I.jsx("div",{className:"p-6",children:I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-6 border border-blue-200/50",children:[I.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[I.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-600 to-cyan-600 rounded-xl flex items-center justify-center shadow-lg",children:I.jsx("i",{className:"ri-user-line text-white text-xl"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Contact Person"}),I.jsx("p",{className:"text-gray-600",children:"Primary contact for this center"})]})]}),I.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[I.jsx("p",{className:"text-xl font-bold text-gray-900",children:C.contact_person}),I.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Emergency Contact"})]})]}),I.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200/50",children:[I.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[I.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-600 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg",children:I.jsx("i",{className:"ri-phone-line text-white text-xl"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Phone Number"}),I.jsx("p",{className:"text-gray-600",children:"Direct contact line"})]})]}),I.jsx("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("p",{className:"text-xl font-bold text-gray-900",children:C.contact_number}),I.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Available 24/7"})]}),I.jsxs("button",{onClick:()=>window.open(`tel:${C.contact_number}`,"_self"),className:"bg-green-600 text-white px-6 py-3 rounded-xl hover:bg-green-700 transition-colors font-semibold flex items-center space-x-2",children:[I.jsx("i",{className:"ri-phone-line"}),I.jsx("span",{children:"Call Now"})]})]})})]}),I.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("button",{onClick:()=>window.open(`https://maps.google.com/?q=${encodeURIComponent(C.name+" Rosario, Batangas")}`,"_blank"),className:"bg-blue-600 text-white py-3 px-4 rounded-xl hover:bg-blue-700 transition-colors font-semibold flex items-center justify-center space-x-2",children:[I.jsx("i",{className:"ri-direction-line"}),I.jsx("span",{children:"Get Directions"})]}),I.jsxs("button",{onClick:()=>window.open(`tel:${C.contact_number}`,"_self"),className:"bg-green-600 text-white py-3 px-4 rounded-xl hover:bg-green-700 transition-colors font-semibold flex items-center justify-center space-x-2",children:[I.jsx("i",{className:"ri-phone-line"}),I.jsx("span",{children:"Emergency Call"})]})]})]})]})})]})}),_&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:I.jsxs("div",{className:"relative bg-white rounded-2xl max-w-4xl w-full overflow-hidden",children:[I.jsx("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 text-white p-6",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h2",{className:"text-2xl font-bold",children:_.name}),I.jsx("p",{className:"text-green-100 mt-1",children:"Center Information & Status"})]}),I.jsx("button",{onClick:()=>A(null),className:"text-white hover:text-gray-200 text-3xl font-bold transition-colors",children:"×"})]})}),I.jsxs("div",{className:"p-6",children:[I.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[I.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200/50",children:[I.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[I.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-600 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg",children:I.jsx("i",{className:"ri-group-line text-white text-xl"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Capacity Details"}),I.jsx("p",{className:"text-gray-600",children:"Current occupancy status"})]})]}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Capacity"}),I.jsx("span",{className:"text-lg font-bold text-green-600",children:_.capacity})]}),I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Current Occupancy"}),I.jsx("span",{className:"text-lg font-bold text-blue-600",children:_.current_occupancy})]}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Available Space"}),I.jsx("span",{className:"text-lg font-bold text-purple-600",children:_.capacity-_.current_occupancy})]})]}),I.jsxs("div",{children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Occupancy Rate"}),I.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round(_.current_occupancy/_.capacity*100),"%"]})]}),I.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:I.jsx("div",{className:"h-3 rounded-full transition-all duration-1000 "+(_.current_occupancy/_.capacity>=.9?"bg-gradient-to-r from-red-500 to-red-600":_.current_occupancy/_.capacity>=.7?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-green-500 to-emerald-500"),style:{width:`${Math.min(_.current_occupancy/_.capacity*100,100)}%`}})})]})]})]}),I.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200/50",children:[I.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[I.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:I.jsx("i",{className:"ri-information-line text-white text-xl"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Center Status"}),I.jsx("p",{className:"text-gray-600",children:"Current operational status"})]})]}),I.jsx("div",{className:"space-y-4",children:I.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status"}),I.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded-xl text-sm font-semibold shadow-sm "+("open"===_.status?"bg-green-100 text-green-800 border border-green-200":"full"===_.status?"bg-red-100 text-red-800 border border-red-200":"bg-gray-100 text-gray-800 border border-gray-200"),children:[I.jsx("div",{className:"w-2 h-2 rounded-full mr-2 "+("open"===_.status?"bg-green-500":"full"===_.status?"bg-red-500":"bg-gray-500")}),_.status.charAt(0).toUpperCase()+_.status.slice(1)]})]}),I.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-time-line text-gray-500"}),I.jsxs("span",{children:["Last Updated: ",new Date(_.last_updated).toLocaleString()]})]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-map-pin-line text-gray-500"}),I.jsxs("span",{children:["Coordinates: ",_.latitude.toFixed(4),", ",_.longitude.toFixed(4)]})]})]})]})})]})]}),I.jsxs("div",{className:"mt-6 bg-gray-50 rounded-xl p-6",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[I.jsxs("button",{onClick:()=>window.open(`https://maps.google.com/?q=${encodeURIComponent(_.name+" Rosario, Batangas")}`,"_blank"),className:"bg-blue-600 text-white py-3 px-4 rounded-xl hover:bg-blue-700 transition-colors font-semibold flex items-center justify-center space-x-2",children:[I.jsx("i",{className:"ri-direction-line"}),I.jsx("span",{children:"Get Directions"})]}),I.jsxs("button",{onClick:()=>window.open(`tel:${_.contact_number}`,"_self"),className:"bg-green-600 text-white py-3 px-4 rounded-xl hover:bg-green-700 transition-colors font-semibold flex items-center justify-center space-x-2",children:[I.jsx("i",{className:"ri-phone-line"}),I.jsx("span",{children:"Call Center"})]}),I.jsxs("button",{onClick:()=>k({center:_,resources:W(_.center_id)}),className:"bg-purple-600 text-white py-3 px-4 rounded-xl hover:bg-purple-700 transition-colors font-semibold flex items-center justify-center space-x-2",children:[I.jsx("i",{className:"ri-tools-line"}),I.jsx("span",{children:"View Resources"})]})]})]})]})]})}),"  "]})},mo=()=>{const[e,t]=n.useState([]),[s,r]=n.useState(!0),[a,i]=n.useState(null),[l,o]=n.useState(!1),[d,c]=n.useState("all"),[u,m]=n.useState(""),[h,x]=n.useState("grid"),[g,f]=n.useState(null),[p,b]=n.useState(!1);n.useEffect(()=>{const e=D();if(e.isAuthenticated&&"user"!==e.userType){if("admin"===e.userType)return void(window.location.href="/admin");if("staff"===e.userType)return void(window.location.href="/staff")}const s=e.isAuthenticated&&"user"===e.userType;o(s),i(s?e.userData:null);const a=()=>{const e=D();if(e.isAuthenticated&&"user"!==e.userType){if("admin"===e.userType)return void(window.location.href="/admin");if("staff"===e.userType)return void(window.location.href="/staff")}const t=e.isAuthenticated&&"user"===e.userType;o(t),i(t?e.userData:null)};return window.addEventListener("storage",a),window.addEventListener("authStateChanged",a),Xe().then(e=>{Array.isArray(e)?t(e):t([]),r(!1)}).catch(e=>{t([]),r(!1)}),()=>{window.removeEventListener("storage",a),window.removeEventListener("authStateChanged",a)}},[]);const y=e.filter(e=>{const t="all"===d||e.type===d,s=""===u||e.title.toLowerCase().includes(u.toLowerCase())||e.description.toLowerCase().includes(u.toLowerCase())||e.type.toLowerCase().includes(u.toLowerCase());return t&&s}),v={total:e.length,fire:e.filter(e=>"fire"===e.type).length,earthquake:e.filter(e=>"earthquake"===e.type).length,medical:e.filter(e=>"medical"===e.type).length,intrusion:e.filter(e=>"intrusion"===e.type).length,general:e.filter(e=>"general"===e.type).length};return s?I.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-green-50 to-emerald-100 flex items-center justify-center",children:I.jsxs("div",{className:"text-center",children:[I.jsxs("div",{className:"relative inline-flex items-center justify-center mb-6",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl blur-lg opacity-30 scale-110"}),I.jsx("div",{className:"relative w-20 h-20 bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl flex items-center justify-center shadow-xl",children:I.jsx("i",{className:"ri-loader-4-line text-3xl text-white animate-spin"})})]}),I.jsx("p",{className:"text-xl text-gray-600 font-medium",children:"Loading safety protocols..."}),I.jsx("p",{className:"text-gray-500 mt-2",children:"Please wait while we fetch the latest information"})]})}):I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-green-50 to-emerald-100 relative",children:[I.jsx(ut,{isAuthenticated:l,userData:a||void 0}),I.jsxs("div",{className:"relative overflow-hidden",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-600/5 to-emerald-600/5"}),I.jsx("div",{className:"absolute inset-0 opacity-40",children:I.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(34, 197, 94, 0.05) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),I.jsx("div",{className:"relative container mx-auto px-4 py-16",children:I.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[I.jsxs("div",{className:"relative inline-flex items-center justify-center mb-8",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl blur-lg opacity-30 scale-110"}),I.jsx("div",{className:"relative w-20 h-20 bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl flex items-center justify-center shadow-xl",children:I.jsx("i",{className:"ri-shield-check-line text-3xl text-white"})})]}),I.jsx("h1",{className:"text-5xl md:text-6xl font-bold bg-gradient-to-r from-gray-900 via-green-900 to-emerald-900 bg-clip-text text-transparent mb-6 leading-tight",children:"Safety Protocols"}),I.jsxs("p",{className:"text-xl md:text-2xl text-gray-600 mb-8 leading-relaxed",children:["Rosario, Batangas",I.jsx("span",{className:"block text-lg text-gray-500 mt-2",children:"Emergency Procedures & Safety Guidelines"})]}),I.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 max-w-4xl mx-auto",children:[I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-white/20 rounded-xl p-4 shadow-lg",children:[I.jsx("div",{className:"text-2xl font-bold text-green-600",children:v.total}),I.jsx("div",{className:"text-sm text-gray-600",children:"Total Protocols"})]}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-white/20 rounded-xl p-4 shadow-lg",children:[I.jsx("div",{className:"text-2xl font-bold text-red-600",children:v.fire}),I.jsx("div",{className:"text-sm text-gray-600",children:"Fire Safety"})]}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-white/20 rounded-xl p-4 shadow-lg",children:[I.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:v.earthquake}),I.jsx("div",{className:"text-sm text-gray-600",children:"Earthquake"})]}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-white/20 rounded-xl p-4 shadow-lg",children:[I.jsx("div",{className:"text-2xl font-bold text-blue-600",children:v.medical}),I.jsx("div",{className:"text-sm text-gray-600",children:"Medical"})]})]}),I.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200/50 rounded-2xl p-6 max-w-3xl mx-auto shadow-lg backdrop-blur-sm",children:[I.jsxs("div",{className:"flex items-center justify-center text-green-800",children:[I.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-information-line text-green-600"})}),I.jsx("p",{className:"font-semibold text-lg",children:"Comprehensive safety protocols for all emergency situations"})]}),I.jsxs("p",{className:"text-green-600 text-sm mt-2 opacity-80",children:["Updated regularly • Last update: ",(new Date).toLocaleTimeString()]})]})]})})]}),I.jsxs("div",{className:"container mx-auto px-4 pb-8",children:[I.jsx("div",{className:"flex justify-center mb-8",children:I.jsxs("div",{className:"relative bg-white/90 backdrop-blur-sm rounded-2xl p-1.5 shadow-xl border border-white/20",children:[I.jsx("div",{className:"absolute top-1.5 bottom-1.5 w-1/2 bg-gradient-to-r from-green-600 to-emerald-600 rounded-xl shadow-lg transition-transform duration-300 ease-out "+("list"===h?"translate-x-full":"translate-x-0")}),I.jsxs("div",{className:"relative flex",children:[I.jsxs("button",{onClick:()=>x("grid"),className:"relative px-6 py-3 rounded-xl font-semibold transition-all duration-300 flex items-center space-x-2 min-w-[120px] justify-center "+("grid"===h?"text-white":"text-gray-600 hover:text-gray-900"),children:[I.jsx("i",{className:"ri-grid-line text-lg transition-transform duration-300 "+("grid"===h?"scale-110":"")}),I.jsx("span",{children:"Grid"})]}),I.jsxs("button",{onClick:()=>x("list"),className:"relative px-6 py-3 rounded-xl font-semibold transition-all duration-300 flex items-center space-x-2 min-w-[120px] justify-center "+("list"===h?"text-white":"text-gray-600 hover:text-gray-900"),children:[I.jsx("i",{className:"ri-list-unordered text-lg transition-transform duration-300 "+("list"===h?"scale-110":"")}),I.jsx("span",{children:"List"})]})]})]})}),I.jsx("div",{className:"max-w-4xl mx-auto mb-8",children:I.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-6",children:[I.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[I.jsxs("div",{className:"md:col-span-2",children:[I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-search-line mr-2"}),"Search Protocols"]}),I.jsxs("div",{className:"relative",children:[I.jsx("input",{type:"text",placeholder:"Search by title, description, or type...",value:u,onChange:e=>m(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all"}),I.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),u&&I.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:I.jsx("i",{className:"ri-close-line"})})]})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-filter-line mr-2"}),"Filter by Type"]}),I.jsx("select",{value:d,onChange:e=>c(e.target.value),className:"w-full py-3 px-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all",children:["all","fire","earthquake","medical","intrusion","general"].map(e=>I.jsxs("option",{value:e,children:[e.charAt(0).toUpperCase()+e.slice(1)," ","all"===e?"Protocols":""]},e))})]})]}),I.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm",children:[I.jsxs("div",{className:"text-gray-600",children:["Showing ",I.jsx("span",{className:"font-semibold text-green-600",children:y.length})," of"," ",I.jsx("span",{className:"font-semibold",children:e.length})," protocols",u&&I.jsxs("span",{className:"ml-2 text-green-600",children:['for "',u,'"']})]}),(u||"all"!==d)&&I.jsxs("button",{onClick:()=>{m(""),c("all")},className:"text-green-600 hover:text-green-700 font-medium flex items-center space-x-1",children:[I.jsx("i",{className:"ri-refresh-line"}),I.jsx("span",{children:"Clear Filters"})]})]})]})}),0===y.length?I.jsxs("div",{className:"text-center py-16",children:[I.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gray-100 rounded-2xl flex items-center justify-center",children:I.jsx("i",{className:"ri-search-line text-3xl text-gray-400"})}),I.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No protocols found"}),I.jsx("p",{className:"text-gray-600 mb-6",children:u||"all"!==d?"Try adjusting your search or filter criteria":"No safety protocols are currently available"}),(u||"all"!==d)&&I.jsxs("button",{onClick:()=>{m(""),c("all")},className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[I.jsx("i",{className:"ri-refresh-line mr-2"}),"Clear Filters"]})]}):I.jsx("div",{className:""+("grid"===h?"grid md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4"),children:y.map(e=>I.jsxs("div",{className:"bg-white/90 backdrop-blur-sm border border-white/20 rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 hover:-translate-y-1 "+("grid"===h?"p-6":"p-6 flex items-center space-x-6"),children:[I.jsxs("div",{className:""+("list"===h?"flex-shrink-0":"flex items-center justify-between mb-4"),children:[I.jsx("div",{className:`relative ${"list"===h?"w-16 h-16":"w-14 h-14"} rounded-2xl flex items-center justify-center ${"fire"===e.type?"bg-gradient-to-r from-red-500 to-red-600":"earthquake"===e.type?"bg-gradient-to-r from-yellow-500 to-orange-600":"medical"===e.type?"bg-gradient-to-r from-blue-500 to-blue-600":"intrusion"===e.type?"bg-gradient-to-r from-purple-500 to-purple-600":"bg-gradient-to-r from-green-500 to-green-600"} shadow-lg`,children:I.jsx("i",{className:`${"list"===h?"text-2xl":"text-xl"} text-white ${"fire"===e.type?"ri-fire-line":"earthquake"===e.type?"ri-earthquake-line":"medical"===e.type?"ri-heart-pulse-line":"intrusion"===e.type?"ri-shield-keyhole-line":"ri-alert-line"}`})}),"grid"===h&&I.jsx("span",{className:"px-3 py-1.5 rounded-full text-xs font-semibold "+("fire"===e.type?"bg-red-100 text-red-800":"earthquake"===e.type?"bg-yellow-100 text-yellow-800":"medical"===e.type?"bg-blue-100 text-blue-800":"intrusion"===e.type?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"),children:e.type.charAt(0).toUpperCase()+e.type.slice(1)})]}),I.jsxs("div",{className:""+("list"===h?"flex-1":""),children:[I.jsxs("div",{className:""+("list"===h?"flex items-start justify-between":""),children:[I.jsxs("div",{className:""+("list"===h?"flex-1 pr-4":""),children:[I.jsx("h3",{className:"font-bold text-gray-900 mb-2 "+("list"===h?"text-xl":"text-lg"),children:e.title}),I.jsxs("div",{className:"relative",children:[I.jsx("p",{className:`text-gray-600 mb-1 ${"list"===h?"text-base":"text-sm"} ${e.description.length>150?"line-clamp-3":""}`,children:e.description}),e.description.length>150&&I.jsxs("button",{onClick:e=>{e.preventDefault(),e.stopPropagation();const t=e.currentTarget.previousElementSibling;t.classList.contains("line-clamp-3")?(t.classList.remove("line-clamp-3"),e.currentTarget.innerHTML='<i class="ri-arrow-up-s-line mr-1"></i>See Less'):(t.classList.add("line-clamp-3"),e.currentTarget.innerHTML='<i class="ri-arrow-down-s-line mr-1"></i>See More')},className:"text-green-600 hover:text-green-700 text-sm font-medium flex items-center mb-4",children:[I.jsx("i",{className:"ri-arrow-down-s-line mr-1"}),"See More"]})]})]}),"list"===h&&I.jsx("div",{className:"flex-shrink-0 flex flex-col items-end space-y-2",children:I.jsx("span",{className:"px-3 py-1.5 rounded-full text-xs font-semibold "+("fire"===e.type?"bg-red-100 text-red-800":"earthquake"===e.type?"bg-yellow-100 text-yellow-800":"medical"===e.type?"bg-blue-100 text-blue-800":"intrusion"===e.type?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"),children:e.type.charAt(0).toUpperCase()+e.type.slice(1)})})]}),e.file_attachment&&I.jsx("div",{className:"mb-4",children:"grid"===h?I.jsxs("div",{className:"relative",children:[e.file_attachment.toLowerCase().match(/\.(jpg|jpeg|png|gif|webp)$/)?I.jsx("div",{className:"relative aspect-video rounded-xl overflow-hidden border border-gray-200",children:I.jsx("img",{src:`/uploads/${e.file_attachment}`,alt:e.title,className:"w-full h-full object-cover"})}):e.file_attachment.toLowerCase().endsWith(".pdf")?I.jsxs("div",{className:"relative aspect-[4/3] rounded-xl overflow-hidden bg-white border border-gray-200 shadow-sm group",children:[I.jsxs("div",{className:"absolute top-0 left-0 right-0 h-12 bg-gradient-to-r from-red-600 to-red-700 flex items-center px-4 z-10",children:[I.jsx("i",{className:"ri-file-pdf-line text-xl text-white mr-2"}),I.jsx("span",{className:"text-white font-medium truncate",children:e.file_attachment.split("/").pop()})]}),I.jsx("div",{className:"absolute inset-0 pt-12",children:I.jsx("iframe",{src:`/uploads/${e.file_attachment}#toolbar=0&view=FitH`,className:"w-full h-full",title:e.title})}),I.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/50 transition-all duration-300 flex items-center justify-center opacity-0 group-hover:opacity-100",children:I.jsx("div",{className:"transform translate-y-4 group-hover:translate-y-0 transition-transform",children:I.jsxs("div",{className:"bg-white/90 backdrop-blur-sm px-4 py-2 rounded-lg text-gray-900 font-medium flex items-center space-x-2",children:[I.jsx("i",{className:"ri-fullscreen-line"}),I.jsx("span",{children:"Open Full View"})]})})})]}):I.jsx("div",{className:"relative aspect-[4/3] rounded-xl overflow-hidden bg-gray-100 border border-gray-200 flex items-center justify-center",children:I.jsxs("div",{className:"text-center",children:[I.jsx("i",{className:"ri-file-text-line text-4xl text-gray-400"}),I.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Document"})]})}),I.jsx("a",{href:`/uploads/${e.file_attachment}`,target:"_blank",rel:"noopener noreferrer",className:"absolute inset-0 bg-black/50 opacity-0 hover:opacity-100 transition-opacity flex items-center justify-center rounded-xl group",children:I.jsxs("span",{className:"bg-white/90 backdrop-blur-sm px-4 py-2 rounded-lg text-gray-900 font-medium flex items-center space-x-2 transform translate-y-2 group-hover:translate-y-0 transition-transform",children:[I.jsx("i",{className:"ri-eye-line"}),I.jsx("span",{children:"View File"})]})})]}):I.jsxs("a",{href:`/uploads/${e.file_attachment}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-green-600 hover:text-green-700 font-semibold transition-colors group",children:[I.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-2 group-hover:bg-green-200 transition-colors",children:I.jsx("i",{className:"ri-file-text-line text-sm"})}),I.jsx("span",{className:"text-sm",children:"View Attachment"}),I.jsx("i",{className:"ri-external-link-line ml-1 text-xs"})]})}),I.jsxs("div",{className:"pt-4 mt-4 border-t border-gray-200 "+("list"===h?"flex items-center justify-between":""),children:[I.jsxs("p",{className:"text-xs text-gray-500",children:[I.jsx("i",{className:"ri-time-line mr-1"}),"Updated: ",new Date(e.updated_at).toLocaleDateString()]}),I.jsxs("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),f(e),b(!0)},className:"text-green-600 hover:text-green-700 text-sm font-medium flex items-center space-x-1 transition-colors "+("grid"===h?"mt-2":""),children:[I.jsx("span",{children:"View Details"}),I.jsx("i",{className:"ri-arrow-right-line"})]})]})]})]},e.protocol_id))}),p&&g&&I.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:I.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-hidden",children:[I.jsx("div",{className:"p-6 border-b border-gray-200",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center "+("fire"===g.type?"bg-gradient-to-r from-red-500 to-red-600":"earthquake"===g.type?"bg-gradient-to-r from-yellow-500 to-orange-600":"medical"===g.type?"bg-gradient-to-r from-blue-500 to-blue-600":"intrusion"===g.type?"bg-gradient-to-r from-purple-500 to-purple-600":"bg-gradient-to-r from-green-500 to-green-600"),children:I.jsx("i",{className:"text-2xl text-white "+("fire"===g.type?"ri-fire-line":"earthquake"===g.type?"ri-earthquake-line":"medical"===g.type?"ri-heart-pulse-line":"intrusion"===g.type?"ri-shield-keyhole-line":"ri-alert-line")})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-xl font-bold text-gray-900",children:g.title}),I.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-xs font-semibold mt-1 "+("fire"===g.type?"bg-red-100 text-red-800":"earthquake"===g.type?"bg-yellow-100 text-yellow-800":"medical"===g.type?"bg-blue-100 text-blue-800":"intrusion"===g.type?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"),children:g.type.charAt(0).toUpperCase()+g.type.slice(1)})]})]}),I.jsx("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:I.jsx("i",{className:"ri-close-line text-2xl"})})]})}),I.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:[I.jsx("div",{className:"prose prose-green max-w-none",children:I.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:g.description})}),g.file_attachment&&I.jsxs("div",{className:"mt-8",children:[I.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Attached Document"}),g.file_attachment.toLowerCase().endsWith(".pdf")?I.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[I.jsxs("div",{className:"bg-gray-50 border-b border-gray-200 p-4 flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-file-pdf-line text-red-500"}),I.jsx("span",{className:"font-medium text-gray-900",children:g.file_attachment.split("/").pop()})]}),I.jsxs("a",{href:`/uploads/${g.file_attachment}`,target:"_blank",rel:"noopener noreferrer",className:"bg-red-50 text-red-600 hover:bg-red-100 px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center space-x-1",children:[I.jsx("i",{className:"ri-download-line"}),I.jsx("span",{children:"Download PDF"})]})]}),I.jsx("div",{className:"h-[500px] bg-gray-50",children:I.jsx("iframe",{src:`/uploads/${g.file_attachment}#toolbar=0`,className:"w-full h-full",title:g.title})})]}):g.file_attachment.toLowerCase().match(/\.(jpg|jpeg|png|gif|webp)$/)?I.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[I.jsxs("div",{className:"bg-gray-50 border-b border-gray-200 p-4 flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-image-line text-blue-500"}),I.jsx("span",{className:"font-medium text-gray-900",children:g.file_attachment.split("/").pop()})]}),I.jsxs("a",{href:`/uploads/${g.file_attachment}`,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-50 text-blue-600 hover:bg-blue-100 px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center space-x-1",children:[I.jsx("i",{className:"ri-download-line"}),I.jsx("span",{children:"Download Image"})]})]}),I.jsx("div",{className:"relative aspect-video",children:I.jsx("img",{src:`/uploads/${g.file_attachment}`,alt:g.title,className:"w-full h-full object-contain bg-gray-50"})})]}):I.jsx("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:I.jsxs("div",{className:"bg-gray-50 p-4 flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-file-text-line text-gray-500"}),I.jsx("span",{className:"font-medium text-gray-900",children:g.file_attachment.split("/").pop()})]}),I.jsxs("a",{href:`/uploads/${g.file_attachment}`,target:"_blank",rel:"noopener noreferrer",className:"bg-gray-100 text-gray-600 hover:bg-gray-200 px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center space-x-1",children:[I.jsx("i",{className:"ri-download-line"}),I.jsx("span",{children:"Download File"})]})]})})]}),I.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[I.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Additional Information"}),I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-500",children:"Created"}),I.jsx("p",{className:"font-medium text-gray-900",children:new Date(g.created_at).toLocaleDateString()})]}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-500",children:"Last Updated"}),I.jsx("p",{className:"font-medium text-gray-900",children:new Date(g.updated_at).toLocaleDateString()})]})]})]})]}),I.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:I.jsx("div",{className:"flex justify-end",children:I.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Close"})})})]})})]})]})};function ho({children:e,className:t="",padding:s="md",shadow:r="md",rounded:a="lg",border:n=!1,hover:i=!1}){const l=n?"border border-gray-200":"",o=i?"hover:shadow-lg transition-shadow duration-200":"";return I.jsx("div",{className:`bg-white ${{none:"",sm:"p-3",md:"p-6",lg:"p-8"}[s]} ${{none:"",sm:"shadow-sm",md:"shadow-md",lg:"shadow-lg",xl:"shadow-xl"}[r]} ${{none:"",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl","2xl":"rounded-2xl"}[a]} ${l} ${o} ${t}`,children:e})}const xo="critical",go="high",fo="moderate",po="medium",bo="low",yo={RESOLVED:"resolved",IN_PROGRESS:"in_progress",PENDING:"pending",CLOSED:"closed"},vo="safe",jo="injured",No="unknown";function wo(){const e=a(),[t,s]=n.useState(null),[r,i]=n.useState(!1),[l,o]=n.useState([]),[d,c]=n.useState(!0),[u,m]=n.useState(null),[h,x]=n.useState("all"),[g,f]=n.useState(""),[p,b]=n.useState(new Set),[y,v]=n.useState({}),[j,N]=n.useState({}),[w,S]=n.useState({}),k=((e,t)=>{const[s,r]=n.useState(e);return n.useEffect(()=>{const s=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(s)}},[e,t]),s})(g,300),C=n.useMemo(()=>l.filter(e=>{const t="all"===h||e.status?.toLowerCase()===h.toLowerCase(),s=!k||e.incident_type?.toLowerCase().includes(k.toLowerCase())||e.description?.toLowerCase().includes(k.toLowerCase())||e.location&&e.location.toLowerCase().includes(k.toLowerCase());return t&&s}),[l,h,k]);n.useMemo(()=>({total:C.length,resolved:C.filter(e=>e.status===yo.RESOLVED).length,inProgress:C.filter(e=>e.status===yo.IN_PROGRESS).length,critical:C.filter(e=>e.priority_level===xo).length}),[C]),n.useEffect(()=>{const t=D();if(!t.isAuthenticated)return void e("/auth/login");s(t.userData),i(!0);const r=()=>{const t=D();t.isAuthenticated?(i(t.isAuthenticated),s(t.userData)):e("/auth/login")};return window.addEventListener("storage",r),window.addEventListener("authStateChanged",r),()=>{window.removeEventListener("storage",r),window.removeEventListener("authStateChanged",r)}},[e]),n.useEffect(()=>{r&&$()},[r]),n.useEffect(()=>{l.length>0&&(async()=>{const e=l.filter(e=>e.latitude&&e.longitude&&!e.location);for(const s of e){const e=`${s.latitude},${s.longitude}`;if(!y[e]&&!w[e])try{await new Promise(e=>setTimeout(e,1e3));const t=await R(s.latitude,s.longitude);v(s=>({...s,[e]:t}))}catch(t){}}})()},[l,y,w]);const $=n.useCallback(async()=>{c(!0),m(null);try{const s=D().userData;let r=s?.userId||s?.user_id||s?.id;if(!r){const e=["userInfo","user","admin","staff"];for(const t of e){const e=localStorage.getItem(t)||sessionStorage.getItem(t);if(e)try{const t=JSON.parse(e);if(r=t.userId||t.user_id||t.id||t.admin_id||t.staff_id,r)break}catch(Nh){}}}if(!r)throw new Error("User ID not found. Please try logging in again.");const a=new AbortController,n=setTimeout(()=>a.abort(),5e3);try{const e=await fetch("/api/health",{signal:a.signal});if(clearTimeout(n),!e.ok)throw new Error(`Backend health check failed: ${e.status} ${e.statusText}`)}catch(e){throw clearTimeout(n),new Error("Cannot connect to backend server. Please ensure the server is running.")}const i=new AbortController,l=setTimeout(()=>i.abort(),1e4),d=await fetch(`/api/incidents/user/${r}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},signal:i.signal});if(clearTimeout(l),!d.ok){let e;try{if(e=await d.text(),e.trim().startsWith("{")||e.trim().startsWith("[")){const t=JSON.parse(e);throw new Error(t.message||`HTTP error! status: ${d.status}`)}throw new Error(`HTTP error! status: ${d.status} - ${d.statusText}`)}catch(t){throw new Error(`HTTP error! status: ${d.status} - ${d.statusText}`)}}const c=await d.json();if(!c.success||!c.incidents)throw new Error(c.message||"Failed to fetch incidents");{const e=c.incidents.map(e=>({...e,timeline:_(e)}));o(e)}}catch(s){s instanceof Error&&"AbortError"===s.name?m("Request timed out. Please check your connection and try again."):m(s instanceof Error?s.message:"Failed to fetch incident reports. Please try again later.")}finally{c(!1)}},[]),_=n.useCallback(e=>{const t=[],s=e.date_reported,r=e.updated_at||e.date_reported;t.push({id:`${e.incident_id}-1`,stage:"Reported",status:"Submitted",timestamp:s,description:`Incident report submitted: ${e.incident_type}`,notes:"Initial report received and logged"}),e.validation_status&&"unvalidated"!==e.validation_status&&t.push({id:`${e.incident_id}-2`,stage:"Validation",status:"validated"===e.validation_status?"Validated":"Rejected",timestamp:r,description:`Report ${e.validation_status} by admin team`,assignedTo:"validated"===e.validation_status?"Valid by Admin Team":"Invalid by Admin Team",notes:e.validation_notes||"Priority level confirmed"}),(e.assigned_team_name||e.assigned_staff_name)&&t.push({id:`${e.incident_id}-3`,stage:"Assigned",status:"Assigned",timestamp:r,description:`Incident assigned to ${e.assigned_team_name||e.assigned_staff_name}`,assignedTo:e.assigned_team_name||e.assigned_staff_name,notes:"Response team notified and dispatched"}),e.status&&"pending"!==e.status&&([yo.IN_PROGRESS,"investigation",yo.RESOLVED,yo.CLOSED].includes(e.status)&&t.push({id:`${e.incident_id}-4`,stage:"In Progress",status:"In Progress",timestamp:r,description:"Response team dispatched and investigation started",assignedTo:e.assigned_team_name||e.assigned_staff_name,notes:"Team arrived at scene and began assessment"}),e.status===yo.RESOLVED&&t.push({id:`${e.incident_id}-6`,stage:"Resolution",status:"Resolved",timestamp:r,description:"Incident successfully resolved and contained",assignedTo:e.assigned_team_name||e.assigned_staff_name,notes:"All immediate threats addressed and situation stabilized"}),e.status===yo.CLOSED&&t.push({id:`${e.incident_id}-7`,stage:"Closed",status:"Closed",timestamp:r,description:"Incident officially closed and case completed",assignedTo:e.assigned_team_name||e.assigned_staff_name,notes:"All documentation completed and follow-up scheduled"}));const a=T(e.status),n=t[t.length-1];return n&&n.stage!==a&&t.push({id:`${e.incident_id}-current`,stage:a,status:e.status?.replace("_"," ").charAt(0).toUpperCase()+e.status?.replace("_"," ").slice(1)||"Current",timestamp:r,description:`Currently at ${a} stage`,assignedTo:e.assigned_team_name||e.assigned_staff_name,notes:"Latest status update"}),t},[]),A=n.useCallback(e=>{switch(e?.toLowerCase()){case xo:return"bg-red-50 text-red-700 border-red-200 ring-1 ring-red-200";case go:return"bg-orange-50 text-orange-700 border-orange-200 ring-1 ring-orange-200";case fo:case po:return"bg-yellow-50 text-yellow-700 border-yellow-200 ring-1 ring-yellow-200";case bo:return"bg-green-50 text-green-700 border-green-200 ring-1 ring-green-200";default:return"bg-gray-50 text-gray-700 border-gray-200 ring-1 ring-gray-200"}},[]),P=n.useCallback(e=>{switch(e?.toLowerCase()){case yo.RESOLVED:return"bg-green-50 text-green-700 border-green-200 ring-1 ring-green-200";case yo.IN_PROGRESS:case"in progress":return"bg-blue-50 text-blue-700 border-blue-200 ring-1 ring-blue-200";case yo.PENDING:return"bg-yellow-50 text-yellow-700 border-yellow-200 ring-1 ring-yellow-200";case yo.CLOSED:default:return"bg-gray-50 text-gray-700 border-gray-200 ring-1 ring-gray-200"}},[]),L=n.useCallback(e=>{switch(e?.toLowerCase()){case vo:return"bg-green-50 text-green-700 border-green-200 ring-1 ring-green-200";case jo:return"bg-red-50 text-red-700 border-red-200 ring-1 ring-red-200";case No:return"bg-yellow-50 text-yellow-700 border-yellow-200 ring-1 ring-yellow-200";default:return"bg-gray-50 text-gray-700 border-gray-200 ring-1 ring-gray-200"}},[]),E=n.useCallback(e=>{switch(e.toLowerCase()){case"reported":return"bg-blue-500";case"validation":return"bg-yellow-500";case"assigned":return"bg-purple-500";case"in progress":return"bg-orange-500";case"resolution":case"resolved":return"bg-green-500";case"closed":return"bg-indigo-500";case"follow-up":case"monitoring":return"bg-teal-500";default:return"bg-gray-500"}},[]),T=n.useCallback(e=>{switch(e?.toLowerCase()){case yo.PENDING:return"Reported";case yo.IN_PROGRESS:case"in progress":return"In Progress";case yo.RESOLVED:return"Resolution";case yo.CLOSED:return"Closed";default:return"Reported"}},[]),O=n.useCallback(e=>{if(!e)return"N/A";try{const t=new Date(e);return isNaN(t.getTime())?"Invalid Date":t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return"Invalid Date"}},[]),F=n.useCallback(e=>{b(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),R=n.useCallback(async(e,t)=>{const s=Number(e),r=Number(t),a=`${s},${r}`;if(j[a])return j[a];S(e=>({...e,[a]:!0}));try{const e=await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${s}&longitude=${r}&localityLanguage=en`,{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(1e4)});if(e.ok){const t=await e.json(),s=[];if(t.road?s.push(t.road):t.locality&&!t.locality.includes("Barangay")&&s.push(t.locality),t.locality&&t.locality.includes("Barangay")?s.push(t.locality):t.suburb&&t.suburb.toLowerCase().includes("barangay")&&s.push(t.suburb),t.county&&t.county!==t.locality&&t.county!==t.suburb&&s.push(t.county),t.city&&t.city!==t.county&&t.city!==t.locality&&t.city!==t.suburb&&s.push(t.city),s.length>0){const e=s.join(", ");return N(t=>({...t,[a]:e})),e}}try{const e=await fetch(`/api/geocode?lat=${s}&lon=${r}`,{signal:AbortSignal.timeout(1e4)});if(e.ok){const t=await e.json();if(t.display_name){const e=t.display_name.split(", ").slice(0,3).join(", ");return N(t=>({...t,[a]:e})),e}}}catch(n){}const t=s>=0?"N":"S",i=r>=0?"E":"W",l=`${Math.abs(s).toFixed(4)}°${t}, ${Math.abs(r).toFixed(4)}°${i}`;return N(e=>({...e,[a]:l})),l}catch(i){const e=`${s.toFixed(4)}, ${r.toFixed(4)}`;return N(t=>({...t,[a]:e})),e}finally{S(e=>({...e,[a]:!1}))}},[j]),M=n.useCallback(()=>{e("/incident-report")},[e]),B=n.useCallback(()=>{f(""),x("all")},[]);return r?I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[I.jsx(ut,{isAuthenticated:r,userData:t}),I.jsxs("div",{className:"container mx-auto px-4 py-8",children:[I.jsx("div",{className:"mb-8",children:I.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-r from-blue-600 via-indigo-600 to-blue-700 p-8 text-white",children:[I.jsx("div",{className:"absolute inset-0 bg-black/10"}),I.jsx("div",{className:"relative z-10",children:I.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[I.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:I.jsx("i",{className:"ri-file-list-3-line text-2xl"})}),I.jsxs("div",{children:[I.jsx("h1",{className:"text-3xl lg:text-4xl font-bold",children:"History Report"}),I.jsx("p",{className:"text-blue-100 text-lg",children:"Track and manage your incident reports"})]})]}),I.jsx("p",{className:"text-blue-100 text-base max-w-2xl",children:"View detailed timelines, track progress, and monitor the status of all your reported incidents with comprehensive analytics."})]})})}),I.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/10 rounded-full"}),I.jsx("div",{className:"absolute -bottom-6 -left-6 w-32 h-32 bg-white/5 rounded-full"})]})}),I.jsx(ho,{className:"mb-8 shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:I.jsxs("div",{className:"p-6",children:[I.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[I.jsxs("div",{className:"flex-1",children:[I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-search-line mr-2 text-blue-500"}),"Search Reports"]}),I.jsxs("div",{className:"relative group",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-search-line text-gray-400 group-focus-within:text-blue-500 transition-colors"})}),I.jsx("input",{type:"text",placeholder:"Search by incident type, description, or location...",value:g,onChange:e=>f(e.target.value),className:"w-full pl-12 pr-12 py-4 bg-gray-50 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 focus:bg-white text-base transition-all duration-200 placeholder-gray-400"}),k!==g&&I.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2",children:I.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"})}),g&&I.jsx("button",{onClick:()=>f(""),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:I.jsx("i",{className:"ri-close-line text-lg"})})]})]}),I.jsxs("div",{className:"lg:w-80",children:[I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-filter-line mr-2 text-blue-500"}),"Filter by Status"]}),I.jsxs("div",{className:"relative",children:[I.jsxs("select",{value:h,onChange:e=>x(e.target.value),className:"w-full px-4 py-4 bg-gray-50 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 focus:bg-white text-base transition-all duration-200 appearance-none cursor-pointer",children:[I.jsx("option",{value:"all",children:"All Status"}),I.jsx("option",{value:"resolved",children:"✅ Resolved"}),I.jsx("option",{value:"in_progress",children:"🔄 In Progress"}),I.jsx("option",{value:"pending",children:"⏳ Pending"}),I.jsx("option",{value:"closed",children:"🔒 Closed"})]}),I.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-arrow-down-s-line text-gray-400"})})]})]}),(g||"all"!==h)&&I.jsx("div",{className:"flex items-end",children:I.jsxs(lt,{onClick:B,className:"px-6 py-4 text-gray-600 hover:text-gray-800 bg-gray-100 hover:bg-gray-200 border-2 border-gray-200 rounded-xl font-medium transition-all duration-200 hover:scale-105",children:[I.jsx("i",{className:"ri-refresh-line mr-2"}),"Clear Filters"]})})]}),(g||"all"!==h)&&I.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:I.jsxs("div",{className:"flex flex-wrap gap-2",children:[I.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"Active filters:"}),g&&I.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium",children:[I.jsx("i",{className:"ri-search-line"}),'"',g,'"',I.jsx("button",{onClick:()=>f(""),className:"ml-1 hover:bg-blue-200 rounded-full p-0.5 transition-colors",children:I.jsx("i",{className:"ri-close-line text-xs"})})]}),"all"!==h&&I.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium",children:[I.jsx("i",{className:"ri-filter-line"}),h.replace("_"," ").charAt(0).toUpperCase()+h.replace("_"," ").slice(1),I.jsx("button",{onClick:()=>x("all"),className:"ml-1 hover:bg-green-200 rounded-full p-0.5 transition-colors",children:I.jsx("i",{className:"ri-close-line text-xs"})})]})]})})]})}),d?I.jsx(ho,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:I.jsx("div",{className:"p-12",children:I.jsxs("div",{className:"flex flex-col items-center justify-center",children:[I.jsxs("div",{className:"relative mb-6",children:[I.jsx("div",{className:"w-16 h-16 border-4 border-blue-200 rounded-full animate-spin"}),I.jsx("div",{className:"absolute top-0 left-0 w-16 h-16 border-4 border-transparent border-t-blue-600 rounded-full animate-spin"})]}),I.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Loading Reports"}),I.jsx("p",{className:"text-gray-600 text-center max-w-md",children:"Fetching your incident reports and preparing the timeline view..."}),I.jsxs("div",{className:"mt-6 flex items-center space-x-2 text-sm text-gray-500",children:[I.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),I.jsx("span",{children:"Connecting to backend server"})]})]})})}):u?I.jsx(ho,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:I.jsx("div",{className:"p-12",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:I.jsx("i",{className:"ri-error-warning-line text-3xl text-red-500"})}),I.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Unable to Load Reports"}),I.jsx("p",{className:"text-red-600 mb-6 text-lg font-medium max-w-lg mx-auto",children:u}),I.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-6 mb-8 max-w-2xl mx-auto",children:[I.jsxs("h4",{className:"font-semibold text-gray-800 mb-4 flex items-center",children:[I.jsx("i",{className:"ri-bug-line mr-2 text-blue-500"}),"Debug Information"]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[I.jsxs("div",{children:[I.jsx("span",{className:"font-medium text-gray-600",children:"API Endpoint:"}),I.jsxs("p",{className:"font-mono text-gray-800 break-all",children:["/api/incidents/user/",t?.userId||t?.user_id||t?.id||"unknown"]})]}),I.jsxs("div",{children:[I.jsx("span",{className:"font-medium text-gray-600",children:"User ID:"}),I.jsx("p",{className:"font-mono text-gray-800",children:t?.userId||t?.user_id||t?.id||"No ID found"})]}),I.jsxs("div",{children:[I.jsx("span",{className:"font-medium text-gray-600",children:"User Type:"}),I.jsx("p",{className:"font-mono text-gray-800",children:t?.userType||"Unknown"})]}),I.jsxs("div",{children:[I.jsx("span",{className:"font-medium text-gray-600",children:"Status:"}),I.jsx("p",{className:"font-mono text-gray-800",children:"Authentication Required"})]})]})]}),I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[I.jsxs(lt,{onClick:$,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-xl font-medium transition-all duration-200 hover:scale-105 shadow-lg",children:[I.jsx("i",{className:"ri-refresh-line mr-2"}),"Try Again"]}),I.jsxs(lt,{onClick:()=>window.location.reload(),className:"bg-gray-600 hover:bg-gray-700 text-white px-8 py-4 rounded-xl font-medium transition-all duration-200 hover:scale-105 shadow-lg",children:[I.jsx("i",{className:"ri-restart-line mr-2"}),"Refresh Page"]})]})]})})}):0===C.length?I.jsx(ho,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:I.jsx("div",{className:"p-12",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:I.jsx("i",{className:"ri-file-list-line text-3xl text-gray-400"})}),I.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:g||"all"!==h?"No Matching Reports":"No Reports Found"}),I.jsx("p",{className:"text-gray-600 mb-8 text-lg max-w-md mx-auto",children:g||"all"!==h?"No incident reports match your current search and filter criteria. Try adjusting your filters or search terms.":"You haven't created any incident reports yet. Start by reporting your first incident to track its progress."}),I.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:g||"all"!==h?I.jsxs(lt,{onClick:B,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-xl font-medium transition-all duration-200 hover:scale-105 shadow-lg",children:[I.jsx("i",{className:"ri-refresh-line mr-2"}),"Clear Filters"]}):I.jsxs(lt,{onClick:M,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-xl font-medium transition-all duration-200 hover:scale-105 shadow-lg",children:[I.jsx("i",{className:"ri-add-line mr-2"}),"Create First Report"]})})]})})}):I.jsx("div",{className:"space-y-6",children:C.map(e=>I.jsx(ho,{className:"hover:shadow-xl transition-all duration-300 border-0 bg-white/90 backdrop-blur-sm overflow-hidden group",children:I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:`h-1 w-full ${A(e.priority_level).split(" ")[0]} opacity-60`}),I.jsxs("div",{className:"p-6 lg:p-8",children:[I.jsx("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between mb-6",children:I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 mb-4",children:[I.jsxs("div",{className:"flex-1",children:[I.jsx("h3",{className:"text-xl lg:text-2xl font-bold text-gray-900 mb-2 group-hover:text-blue-600 transition-colors",children:e.incident_type}),I.jsx("p",{className:"text-gray-700 text-base leading-relaxed line-clamp-2",children:e.description})]}),I.jsxs("div",{className:"flex flex-wrap gap-2 sm:justify-end",children:[I.jsxs("span",{className:`px-4 py-2 rounded-full text-sm font-semibold shadow-sm ${A(e.priority_level)}`,children:[I.jsx("i",{className:"ri-flag-line mr-1"}),I.jsxs("span",{className:"hidden sm:inline",children:[e.priority_level?.charAt(0).toUpperCase()+e.priority_level?.slice(1)," Priority"]}),I.jsx("span",{className:"sm:hidden",children:e.priority_level?.charAt(0).toUpperCase()+e.priority_level?.slice(1)})]}),I.jsxs("span",{className:`px-4 py-2 rounded-full text-sm font-semibold shadow-sm ${P(e.status)}`,children:[I.jsx("i",{className:"ri-checkbox-circle-line mr-1"}),e.status?.replace("_"," ").charAt(0).toUpperCase()+e.status?.replace("_"," ").slice(1)]}),I.jsxs("span",{className:`px-4 py-2 rounded-full text-sm font-semibold shadow-sm ${L(e.reporter_safe_status)}`,children:[I.jsx("i",{className:"ri-shield-check-line mr-1"}),e.reporter_safe_status?.charAt(0).toUpperCase()+e.reporter_safe_status?.slice(1)]})]})]}),I.jsx("div",{className:"bg-gray-50 rounded-xl p-4 mb-4",children:I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[I.jsxs("div",{className:"flex items-start space-x-3",children:[I.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:I.jsx("i",{className:"ri-map-pin-line text-blue-600"})}),I.jsxs("div",{className:"flex-1",children:[I.jsx("h4",{className:"font-semibold text-gray-800 text-sm mb-1",children:"Location"}),I.jsx("p",{className:"text-gray-700 text-base",children:e.location&&""!==e.location.trim()?e.location:e.latitude&&e.longitude?w[`${e.latitude},${e.longitude}`]?I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent mr-2"}),I.jsx("span",{className:"text-gray-500",children:"Loading location..."})]}):j[`${e.latitude},${e.longitude}`]||`${Number(e.latitude).toFixed(6)}, ${Number(e.longitude).toFixed(6)}`:"Location not specified"}),e.latitude&&e.longitude&&I.jsxs("div",{className:"text-xs text-gray-500 mt-2 font-mono bg-white px-2 py-1 rounded border",children:["Lat: ",Number(e.latitude).toFixed(6),", Lng: ",Number(e.longitude).toFixed(6)]})]})]}),e.latitude&&e.longitude&&I.jsxs("button",{onClick:()=>{const t=`https://www.google.com/maps?q=${Number(e.latitude)},${Number(e.longitude)}`;window.open(t,"_blank")},className:"flex items-center px-4 py-2 text-sm text-blue-600 hover:text-blue-700 font-medium transition-all duration-200 bg-blue-50 hover:bg-blue-100 rounded-lg border border-blue-200 hover:scale-105",children:[I.jsx("i",{className:"ri-map-line mr-2"}),I.jsx("span",{className:"hidden sm:inline",children:"View on Map"}),I.jsx("span",{className:"sm:hidden",children:"Map"})]})]})}),(e.assigned_team_name||e.assigned_staff_name)&&I.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-4 p-3 bg-green-50 rounded-lg border border-green-200",children:[I.jsx("i",{className:"ri-user-line mr-3 text-green-600"}),I.jsx("span",{className:"font-medium",children:"Assigned to:"}),I.jsx("span",{className:"ml-2 font-semibold text-green-700",children:e.assigned_team_name||e.assigned_staff_name})]})]})}),I.jsx("div",{className:"border-t border-gray-200 pt-6",children:I.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4 text-sm text-gray-600",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-time-line mr-2 text-blue-500"}),I.jsx("span",{className:"font-medium",children:"Reported:"}),I.jsx("span",{className:"ml-2",children:O(e.date_reported)})]}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-refresh-line mr-2 text-green-500"}),I.jsx("span",{className:"font-medium",children:"Updated:"}),I.jsx("span",{className:"ml-2",children:O(e.updated_at)})]})]}),e.validation_notes&&I.jsxs("div",{className:"flex items-start bg-blue-50 p-3 rounded-lg border border-blue-200",children:[I.jsx("i",{className:"ri-chat-1-line mr-2 mt-0.5 text-blue-500"}),I.jsxs("div",{children:[I.jsx("span",{className:"text-xs font-medium text-blue-700 block mb-1",children:"Admin Notes:"}),I.jsxs("span",{className:"text-sm text-blue-800 italic",children:['"',e.validation_notes,'"']})]})]})]})}),I.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:I.jsxs("button",{onClick:()=>F(e.incident_id),className:"flex items-center justify-center w-full px-6 py-3 text-blue-600 hover:text-blue-700 font-semibold transition-all duration-200 hover:bg-blue-50 rounded-xl border-2 border-blue-200 hover:border-blue-300 group",children:[I.jsx("i",{className:"ri-arrow-down-s-line mr-2 transition-transform duration-200 "+(p.has(e.incident_id)?"rotate-180":"")}),p.has(e.incident_id)?"Hide Timeline":"View Detailed Timeline",I.jsx("i",{className:"ri-time-line ml-2"})]})}),p.has(e.incident_id)&&e.timeline&&I.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200 bg-gradient-to-br from-gray-50 to-blue-50 rounded-2xl p-6",children:[I.jsxs("div",{className:"flex items-center justify-between mb-8",children:[I.jsxs("h4",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[I.jsx("div",{className:"p-2 bg-blue-100 rounded-lg mr-3",children:I.jsx("i",{className:"ri-time-line text-blue-600 text-xl"})}),"Incident Timeline"]}),I.jsxs("div",{className:"text-right",children:[I.jsx("div",{className:"text-sm text-gray-500",children:"Total Stages"}),I.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.timeline?.length||0})]})]}),I.jsx("div",{className:"mb-8 p-6 bg-gradient-to-r from-blue-500 to-blue-600 rounded-2xl text-white shadow-lg",children:I.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:I.jsx("i",{className:"ri-pulse-line text-2xl"})}),I.jsxs("div",{children:[I.jsx("h5",{className:"text-xl font-bold mb-1",children:"Current Stage"}),I.jsxs("p",{className:"text-blue-100 text-lg",children:[T(e.status)," -"," ",e.status?.replace("_"," ").charAt(0).toUpperCase()+e.status?.replace("_"," ").slice(1)]})]})]}),I.jsxs("div",{className:"text-left lg:text-right",children:[I.jsx("div",{className:"text-blue-200 text-sm mb-1",children:"Last Updated"}),I.jsx("div",{className:"text-white text-lg font-semibold",children:O(e.updated_at)})]})]})}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-1 bg-gradient-to-b from-blue-200 via-indigo-200 to-blue-300 rounded-full"}),I.jsx("div",{className:"space-y-6",children:e.timeline?.map((t,s)=>{const r=t.id.includes("current"),a=s===(e.timeline?.length||0)-1;return I.jsxs("div",{className:"relative flex items-start group",children:[I.jsxs("div",{className:"relative z-10 flex-shrink-0",children:[I.jsx("div",{className:`w-6 h-6 rounded-full ${E(t.stage)} border-4 border-white shadow-lg flex items-center justify-center ${r?"ring-4 ring-blue-300 ring-offset-2 animate-pulse":""}`,children:r?I.jsx("i",{className:"ri-pulse-line text-white text-xs"}):I.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),!a&&I.jsx("div",{className:"absolute top-6 left-1/2 transform -translate-x-1/2 w-0.5 h-6 bg-gradient-to-b from-blue-300 to-blue-400"})]}),I.jsx("div",{className:"ml-6 flex-1 min-w-0",children:I.jsxs("div",{className:"rounded-2xl p-6 border-2 transition-all duration-300 group-hover:shadow-lg "+(r?"bg-gradient-to-r from-blue-50 to-blue-100 border-blue-300 shadow-lg":"bg-white border-gray-200 hover:border-blue-200 hover:bg-blue-50/30"),children:[I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 mb-4",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsxs("span",{className:`px-4 py-2 rounded-full text-sm font-bold text-white shadow-sm ${E(t.stage)} ${r?"ring-2 ring-blue-300":""}`,children:[t.stage,r&&I.jsx("span",{className:"ml-2 animate-pulse",children:"●"})]}),I.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold border-2 "+(r?"bg-blue-100 text-blue-700 border-blue-300":"bg-gray-100 text-gray-700 border-gray-300"),children:t.status})]}),I.jsxs("div",{className:"text-right",children:[I.jsx("div",{className:"text-sm font-medium text-gray-600 mb-1",children:"Timestamp"}),I.jsx("div",{className:"text-sm font-semibold text-gray-800",children:O(t.timestamp)})]})]}),I.jsx("p",{className:"text-gray-700 text-base leading-relaxed mb-4 font-medium",children:t.description}),t.assignedTo&&I.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-4 p-3 bg-green-50 rounded-lg border border-green-200",children:[I.jsx("i",{className:"ri-user-line mr-2 text-green-600"}),I.jsx("span",{className:"font-medium",children:"Assigned to:"}),I.jsx("span",{className:"ml-2 font-semibold text-green-700",children:t.assignedTo})]}),t.notes&&I.jsx("div",{className:"p-4 rounded-xl border-l-4 "+(r?"text-blue-800 bg-blue-50 border-blue-400":"text-gray-700 bg-gray-50 border-gray-300"),children:I.jsxs("div",{className:"flex items-start",children:[I.jsx("i",{className:"ri-chat-1-line mr-2 mt-0.5 text-blue-500"}),I.jsxs("div",{children:[I.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-1",children:"Notes:"}),I.jsx("div",{className:"text-sm italic",children:t.notes})]})]})}),r&&I.jsx("div",{className:"mt-4 p-3 bg-gradient-to-r from-blue-100 to-blue-200 border border-blue-200 rounded-xl",children:I.jsxs("div",{className:"flex items-center text-blue-700 font-semibold",children:[I.jsx("i",{className:"ri-information-line mr-2"}),I.jsx("span",{children:"This is the current stage of your incident"})]})})]})})]},t.id)})})]})]})]})]})},e.incident_id))})]})]}):null}function So(){const e=a(),[t,s]=n.useState(!1),[r,i]=n.useState(null),[l,o]=n.useState(""),[d,c]=n.useState(null),[u,m]=n.useState(!1),[h,x]=n.useState(!1),[g,f]=n.useState(!1),[p,b]=n.useState(""),[y,v]=n.useState(null);n.useEffect(()=>{const t=D();if(t.isAuthenticated){if("user"!==t.userType){if("admin"===t.userType)return void e("/admin");if("staff"===t.userType)return void e("/staff")}s(!0),i(t.userData)}else e("/auth/login")},[e]);const j=e=>["Poor","Fair","Good","Very Good","Excellent"][e-1];return t?I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50",children:[I.jsx(ut,{isAuthenticated:t,userData:r}),I.jsx("div",{className:"container mx-auto px-4 py-8",children:I.jsxs("div",{className:"max-w-2xl mx-auto",children:[I.jsxs("div",{className:"text-center mb-8",children:[I.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center shadow-lg",children:I.jsx("i",{className:"ri-feedback-line text-2xl text-white"})}),I.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent mb-3",children:"Submit Feedback"}),I.jsx("p",{className:"text-gray-600 text-lg",children:"Help us improve by sharing your thoughts and suggestions"})]}),h&&I.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl shadow-sm animate-in slide-in-from-top-2 duration-300",children:I.jsxs("div",{className:"flex items-center gap-3 text-green-800",children:[I.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-green-100 to-emerald-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-check-circle-line text-green-600"})}),I.jsx("span",{className:"font-medium",children:"Thank you for your feedback! We appreciate your input."})]})}),g&&I.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-red-50 to-rose-50 border border-red-200 rounded-xl shadow-sm animate-in slide-in-from-top-2 duration-300",children:I.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[I.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-red-100 to-rose-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-error-warning-line text-red-600"})}),I.jsx("span",{className:"font-medium",children:p})]})}),I.jsx(ho,{className:"p-8 shadow-xl border-0 bg-white/80 backdrop-blur-sm",children:I.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!l.trim())return b("Please enter your feedback"),f(!0),void setTimeout(()=>f(!1),5e3);if(l.trim().length<10)return b("Please provide at least 10 characters of feedback"),f(!0),void setTimeout(()=>f(!1),5e3);if(l.trim().length>1e3)return b("Feedback must be less than 1000 characters"),f(!0),void setTimeout(()=>f(!1),5e3);m(!0),f(!1);try{await Je({message:l.trim(),rating:d}),x(!0),o(""),c(null),setTimeout(()=>x(!1),5e3)}catch(t){b(t.message||"Failed to submit feedback. Please try again."),f(!0),setTimeout(()=>f(!1),5e3)}finally{m(!1)}},className:"space-y-8",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-4",children:"How would you rate your experience?"}),I.jsx("div",{className:"flex gap-2 mb-3",children:[1,2,3,4,5].map(e=>I.jsxs("button",{type:"button",onClick:()=>(e=>{c(e===d?null:e)})(e),onMouseEnter:()=>v(e),onMouseLeave:()=>v(null),className:"group relative w-14 h-14 rounded-full border-2 transition-all duration-200 flex items-center justify-center transform hover:scale-110 focus:outline-none focus:ring-4 focus:ring-yellow-200 "+((y?e<=y:d&&e<=d)?"bg-gradient-to-r from-yellow-400 to-amber-400 border-yellow-400 text-white shadow-lg":"bg-gray-50 border-gray-300 text-gray-400 hover:bg-yellow-50 hover:border-yellow-300 hover:text-yellow-500"),"aria-label":`Rate ${e} star${e>1?"s":""} - ${j(e)}`,children:[I.jsx("i",{className:"ri-star-fill text-xl"}),I.jsx("div",{className:"absolute -top-12 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap",children:j(e)})]},e))}),d&&I.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:["You rated: ",d," star",d>1?"s":""," - ",j(d)]})]}),I.jsxs("div",{children:[I.jsx("label",{htmlFor:"feedback",className:"block text-sm font-semibold text-gray-700 mb-3",children:"Your Feedback"}),I.jsxs("div",{className:"relative",children:[I.jsx("textarea",{id:"feedback",value:l,onChange:e=>o(e.target.value),placeholder:"Tell us what you think about the application, suggest improvements, or report any issues...",className:"w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 resize-vertical min-h-[140px] text-gray-700 placeholder-gray-400",rows:6,maxLength:1e3}),I.jsxs("div",{className:"absolute bottom-3 right-3 text-xs text-gray-400 bg-white px-2 py-1 rounded",children:[l.length,"/1000"]})]}),l.length>0&&l.length<10&&I.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"Please provide at least 10 characters"})]}),I.jsxs("div",{className:"flex gap-4 pt-4",children:[I.jsx(lt,{type:"submit",variant:"primary",size:"lg",disabled:u||l.trim().length<10,className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 transform hover:scale-[1.02] transition-all duration-200 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:u?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Submitting..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-send-plane-line mr-2"}),"Submit Feedback"]})}),I.jsxs(lt,{type:"button",variant:"outline",size:"lg",onClick:()=>e(-1),disabled:u,className:"border-2 border-gray-300 hover:border-gray-400 hover:bg-gray-50 transform hover:scale-[1.02] transition-all duration-200",children:[I.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back"]})]})]})}),I.jsx("div",{className:"mt-8 text-center",children:I.jsxs("div",{className:"inline-flex items-center gap-2 text-sm text-gray-500 bg-white/60 backdrop-blur-sm px-4 py-2 rounded-full",children:[I.jsx("i",{className:"ri-heart-line text-red-400"}),I.jsx("p",{children:"Your feedback helps us make ProteQ better for everyone in Rosario, Batangas."})]})})]})})]}):I.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center shadow-lg",children:I.jsx("i",{className:"ri-loader-4-line text-2xl text-white animate-spin"})}),I.jsx("p",{className:"text-gray-600 font-medium",children:"Checking authentication..."})]})})}function ko(){const e=a(),[t,s]=n.useState(!1),[r,i]=n.useState(null),[l,o]=n.useState(!1),[d,c]=n.useState(!1),[u,m]=n.useState(null),[h,x]=n.useState(null),[g,f]=n.useState(!0),[p,b]=n.useState(null),[y,v]=n.useState(!1),[j,N]=n.useState(!1),[w,S]=n.useState({status:"safe",additional_info:""});n.useEffect(()=>{const t=D();t.isAuthenticated&&"user"===t.userType?(s(!0),i(t.userData),k(),C()):e("/auth/login")},[e]);const k=async()=>{try{const e=await V("/welfare/status");e.success?x(e):m("Failed to load welfare check system status")}catch(e){m("Failed to load welfare check system status")}},C=async()=>{try{const e=await V("/welfare/latest");e.success&&e.report&&(b(e.report),S({status:e.report.status,additional_info:e.report.additional_info||""}))}catch(e){}finally{f(!1)}},$=e=>{const{name:t,value:s}=e.target;S(e=>({...e,[t]:s}))},_=async()=>{o(!0),m(null);try{const e=await V("/welfare/submit",{method:"POST",body:JSON.stringify(w)});e.success?(c(!0),await C(),setTimeout(()=>{c(!1)},3e3)):m(e.message||"Failed to submit welfare check")}catch(e){m(e.message||"Failed to submit welfare check. Please try again.")}finally{o(!1)}},A=async()=>{if(p){N(!0),m(null);try{const e=await V(`/welfare/update/${p.report_id}`,{method:"PUT",body:JSON.stringify(w)});e.success?(c(!0),v(!1),await C(),setTimeout(()=>{c(!1)},3e3)):m(e.message||"Failed to update welfare check")}catch(e){m(e.message||"Failed to update welfare check. Please try again.")}finally{N(!1)}}};return t?g?I.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),I.jsx("p",{className:"text-gray-600",children:"Loading welfare check system..."})]})}):h&&!h.isActive?I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:[I.jsx(ut,{isAuthenticated:t,userData:r}),I.jsx("div",{className:"container mx-auto px-4 py-16",children:I.jsx("div",{className:"max-w-2xl mx-auto text-center",children:I.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8",children:[I.jsx("div",{className:"w-20 h-20 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-6",children:I.jsx("i",{className:"ri-pause-circle-line text-orange-600 text-4xl"})}),I.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:h.title}),I.jsx("p",{className:"text-lg text-gray-600 mb-6",children:h.description}),I.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-6",children:[I.jsxs("div",{className:"flex items-center justify-center text-orange-800 mb-2",children:[I.jsx("i",{className:"ri-information-line text-orange-600 mr-2"}),I.jsx("span",{className:"font-semibold",children:"System Currently Disabled"})]}),I.jsx("p",{className:"text-orange-700",children:h.messageWhenDisabled})]}),I.jsx("div",{className:"mt-8",children:I.jsxs("button",{onClick:()=>e("/"),className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-xl transition-colors",children:[I.jsx("i",{className:"ri-home-line mr-2"}),"Return to Home"]})})]})})})]}):I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:[I.jsx(ut,{isAuthenticated:t,userData:r}),I.jsxs("div",{className:"relative overflow-hidden",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/5 to-indigo-600/5"}),I.jsx("div",{className:"absolute inset-0 opacity-40",children:I.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(59, 130, 246, 0.05) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),I.jsx("div",{className:"relative container mx-auto px-4 py-16",children:I.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[I.jsxs("div",{className:"relative inline-flex items-center justify-center mb-8",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl blur-lg opacity-30 scale-110"}),I.jsx("div",{className:"relative w-20 h-20 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center shadow-xl",children:I.jsx("i",{className:"ri-heart-pulse-line text-3xl text-white"})})]}),I.jsx("h1",{className:"text-5xl md:text-6xl font-bold bg-gradient-to-r from-gray-900 via-blue-900 to-indigo-900 bg-clip-text text-transparent mb-6 leading-tight",children:h?.title||"Welfare Check"}),I.jsxs("p",{className:"text-xl md:text-2xl text-gray-600 mb-8 leading-relaxed",children:["Emergency Welfare Status Reporting",I.jsx("span",{className:"block text-lg text-gray-500 mt-2",children:h?.description||"Let us know your current status so we can ensure your safety during emergencies"})]}),I.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200/50 rounded-2xl p-6 max-w-3xl mx-auto shadow-lg backdrop-blur-sm",children:[I.jsxs("div",{className:"flex items-center justify-center text-blue-800",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-information-line text-blue-600"})}),I.jsx("p",{className:"font-semibold text-lg",children:"Your safety status helps us respond quickly to emergencies"})]}),I.jsx("p",{className:"text-blue-600 text-sm mt-2 opacity-80",children:"All welfare reports are treated with urgency and confidentiality"})]})]})})]}),I.jsx("div",{className:"container mx-auto px-4 pb-8",children:I.jsxs("div",{className:"max-w-4xl mx-auto",children:[d&&I.jsx("div",{className:"mb-6 p-6 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200/50 rounded-2xl shadow-lg backdrop-blur-sm",children:I.jsxs("div",{className:"flex items-center gap-3 text-green-800",children:[I.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-check-circle-line text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"font-semibold text-lg",children:p&&y?"Welfare check updated successfully!":"Welfare check submitted successfully!"}),I.jsx("p",{className:"text-green-600 text-sm mt-1",children:"Emergency responders have been notified"})]})]})}),u&&I.jsx("div",{className:"mb-6 p-6 bg-gradient-to-r from-red-50 to-orange-50 border border-red-200/50 rounded-2xl shadow-lg backdrop-blur-sm",children:I.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[I.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-error-warning-line text-red-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"font-semibold text-lg",children:p&&y?"Failed to update welfare check":"Failed to submit welfare check"}),I.jsx("p",{className:"text-red-600 text-sm mt-1",children:u})]})]})}),p&&!y&&I.jsxs("div",{className:"mb-6 bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-6",children:[I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-heart-pulse-line text-blue-600"})}),"Current Status"]}),I.jsxs("button",{onClick:()=>{v(!0),m(null)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center",children:[I.jsx("i",{className:"ri-edit-line mr-2"}),"Edit Status"]})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4 "+("safe"===p.status?"bg-green-50":"bg-red-50"),children:I.jsx("i",{className:"text-2xl "+("safe"===p.status?"ri-checkbox-circle-line text-green-600":"ri-error-warning-line text-red-600")})}),I.jsxs("div",{children:[I.jsx("p",{className:"font-semibold text-gray-900",children:"safe"===p.status?"I am safe":"I need help"}),I.jsxs("p",{className:"text-sm text-gray-500",children:["Submitted: ",new Date(p.submitted_at).toLocaleString()]})]})]}),p.additional_info&&I.jsxs("div",{className:"md:col-span-2",children:[I.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Additional Information:"}),I.jsx("p",{className:"text-gray-600 bg-gray-50 rounded-lg p-3",children:p.additional_info})]})]})]}),(!p||y)&&I.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8",children:I.jsxs("form",{onSubmit:async e=>{e.preventDefault(),p&&y?await A():await _()},className:"space-y-8",children:[I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-heart-pulse-line text-blue-600"})}),y?"Update Status":"Current Status"]}),y&&I.jsxs("button",{type:"button",onClick:()=>{v(!1),p&&S({status:p.status,additional_info:p.additional_info||""})},className:"text-gray-500 hover:text-gray-700 px-3 py-1 rounded-lg hover:bg-gray-100 transition-colors",children:[I.jsx("i",{className:"ri-close-line mr-1"}),"Cancel"]})]}),I.jsx("p",{className:"text-gray-600 mt-2",children:y?"Update your welfare status below":"Please select your current welfare status"})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-4",children:[I.jsx("i",{className:"ri-heart-pulse-line mr-2 text-blue-600"}),"Current Status ",I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{value:"safe",label:"I am safe",icon:"ri-checkbox-circle-line",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"},{value:"needs_help",label:"I need help",icon:"ri-error-warning-line",color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200"}].map(e=>I.jsxs("label",{className:"relative cursor-pointer rounded-xl p-6 border-2 transition-all duration-200 "+(w.status===e.value?e.bgColor+" "+e.borderColor+" border-2":"bg-gray-50 border-gray-200 hover:bg-gray-100"),children:[I.jsx("input",{type:"radio",name:"status",value:e.value,checked:w.status===e.value,onChange:$,className:"sr-only"}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-12 h-12 "+e.bgColor+" rounded-lg flex items-center justify-center mr-4",children:I.jsx("i",{className:e.icon+" text-2xl "+e.color})}),I.jsx("div",{children:I.jsx("div",{className:"font-semibold text-gray-900",children:e.label})})]}),w.status===e.value&&I.jsx("div",{className:"absolute top-4 right-4",children:I.jsx("i",{className:"ri-check-line text-green-600 text-xl"})})]},e.value))})]})]}),I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[I.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[I.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-file-text-line text-orange-600"})}),"Additional Information"]}),I.jsx("p",{className:"text-gray-600 mt-2",children:"Provide any additional details about your situation"})]}),I.jsxs("div",{children:[I.jsxs("label",{htmlFor:"additional_info",className:"block text-sm font-semibold text-gray-700 mb-3",children:[I.jsx("i",{className:"ri-file-text-line mr-2 text-orange-600"}),"Additional Information ",I.jsx("span",{className:"text-gray-500",children:"(optional)"})]}),I.jsx("textarea",{id:"additional_info",name:"additional_info",value:w.additional_info,onChange:$,rows:4,placeholder:"Any additional information about your situation, needs, or concerns",className:"w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all resize-none"})]})]}),I.jsx("div",{className:"border-t border-gray-200 pt-8",children:I.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:I.jsx("button",{type:"submit",disabled:l||j,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold py-4 px-8 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 disabled:cursor-not-allowed disabled:transform-none",children:l?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Submitting Welfare Check..."]}):j?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Updating Welfare Check..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:(y?"ri-save-line":"ri-send-plane-line")+" mr-2"}),y?"Update Welfare Check":"Submit Welfare Check"]})})})})]})})]})})]}):null}function Co(){const[e,t]=n.useState([]),[s,r]=n.useState(!0),[a,i]=n.useState(0),[l,o]=n.useState("all"),[d,c]=n.useState(1),[u,m]=n.useState(1),[h,x]=n.useState(0);n.useEffect(()=>{g()},[d,l]);const g=async()=>{try{r(!0);const e=20*(d-1),s=await at(20,e);if(s.success){let e=s.notifications;"unread"===l?e=e.filter(e=>!e.is_read):"all"!==l&&(e=e.filter(e=>e.type===l)),t(e),i(s.unreadCount),m(Math.ceil(s.total/20)),x(s.total)}}catch(e){}finally{r(!1)}},f=(e,t)=>{switch(e){case"alert":return"emergency"===t?"ri-error-warning-fill":"ri-alarm-warning-line";case"safety_protocol":return"ri-shield-check-line";case"welfare":return"ri-heart-pulse-line";case"system":return"ri-settings-line";default:return"ri-notification-line"}},p=e=>{switch(e){case"emergency":return"text-red-600 bg-red-50 border-red-200";case"warning":return"text-orange-600 bg-orange-50 border-orange-200";case"info":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},b=e=>{switch(e){case"alert":return"Alert";case"safety_protocol":return"Safety Protocol";case"welfare":return"Welfare Check";case"system":return"System";default:return"Notification"}},y=e=>{switch(e){case"emergency":return"Emergency";case"warning":return"Warning";case"info":return"Info";default:return"General"}};return I.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:I.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[I.jsx("div",{className:"mb-8",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Notifications"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Stay updated with alerts, safety protocols, and welfare checks"})]}),a>0&&I.jsx("button",{onClick:async()=>{try{await it(),t(e=>e.map(e=>({...e,is_read:!0}))),i(0)}catch(e){}},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Mark all as read"})]})}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-notification-line text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:h})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-error-warning-line text-red-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Unread"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:a})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-alarm-warning-line text-orange-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Alerts"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(e=>"alert"===e.type).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-shield-check-line text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Safety"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(e=>"safety_protocol"===e.type).length})]})]})})]}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:I.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"all",label:"All",count:h},{key:"unread",label:"Unread",count:a},{key:"alert",label:"Alerts",count:e.filter(e=>"alert"===e.type).length},{key:"safety_protocol",label:"Safety",count:e.filter(e=>"safety_protocol"===e.type).length},{key:"welfare",label:"Welfare",count:e.filter(e=>"welfare"===e.type).length},{key:"system",label:"System",count:e.filter(e=>"system"===e.type).length}].map(e=>I.jsxs("button",{onClick:()=>o(e.key),className:"px-3 py-1 rounded-full text-sm font-medium transition-colors "+(l===e.key?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[e.label," (",e.count,")"]},e.key))})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:s?I.jsx("div",{className:"flex items-center justify-center h-64",children:I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):0===e.length?I.jsxs("div",{className:"text-center py-12",children:[I.jsx("i",{className:"ri-notification-off-line text-6xl text-gray-300"}),I.jsx("p",{className:"text-gray-500 mt-4 text-lg",children:"No notifications found"}),I.jsx("p",{className:"text-gray-400 mt-2",children:"You're all caught up!"})]}):I.jsx("div",{className:"divide-y divide-gray-200",children:e.map(e=>I.jsx("div",{onClick:()=>(async e=>{try{await nt(e),t(t=>t.map(t=>t.id===e?{...t,is_read:!0}:t)),i(e=>Math.max(0,e-1))}catch(s){}})(e.id),className:"p-6 hover:bg-gray-50 cursor-pointer transition-colors "+(e.is_read?"":"bg-blue-50"),children:I.jsxs("div",{className:"flex items-start space-x-4",children:[I.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0 border ${p(e.severity)}`,children:I.jsx("i",{className:`${f(e.type,e.severity)} text-lg`})}),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[I.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.title}),!e.is_read&&I.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"New"}),I.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${p(e.severity)}`,children:y(e.severity)}),I.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:b(e.type)})]}),I.jsx("p",{className:"text-gray-600 mb-3",children:e.message}),I.jsx("div",{className:"flex items-center text-sm text-gray-500 space-x-4",children:I.jsxs("span",{children:[I.jsx("i",{className:"ri-time-line mr-1"}),new Date(e.created_at).toLocaleString()]})})]})]})},e.id))})}),u>1&&I.jsxs("div",{className:"flex items-center justify-between mt-6",children:[I.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",20*(d-1)+1," to"," ",Math.min(20*d,h)," of ",h," results"]}),I.jsxs("div",{className:"flex space-x-2",children:[I.jsx("button",{onClick:()=>c(e=>Math.max(1,e-1)),disabled:1===d,className:"px-3 py-1 text-sm border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),I.jsx("button",{onClick:()=>c(e=>Math.min(u,e+1)),disabled:d===u,className:"px-3 py-1 text-sm border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]})]})})}function $o(){const e=a(),[t,s]=n.useState(!1),[r,i]=n.useState(null),[l,o]=n.useState(""),[d,c]=n.useState(null),[u,m]=n.useState(null),[h,x]=n.useState(!1),[g,f]=n.useState(!1),[p,b]=n.useState(!1),[y,v]=n.useState(""),[j,N]=n.useState(0),w=1e3;n.useEffect(()=>{const t=D();t.isAuthenticated?(s(!0),i(t.userData)):e("/auth/login")},[e]);const S=e=>({1:"Poor",2:"Fair",3:"Good",4:"Very Good",5:"Excellent"}[e]);return t?I.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50",children:I.jsx("div",{className:"container mx-auto px-4 py-8",children:I.jsxs("div",{className:"max-w-3xl mx-auto",children:[I.jsxs("div",{className:"text-center mb-8",children:[I.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-3xl flex items-center justify-center shadow-xl",children:I.jsx("i",{className:"ri-feedback-line text-3xl text-white"})}),I.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-3 bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Share Your Feedback"}),I.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto leading-relaxed",children:"Your insights help us create a better experience for everyone in our ProteQ community"}),r&&I.jsxs("div",{className:"mt-6 inline-flex items-center gap-3 px-6 py-3 bg-white border border-blue-100 rounded-2xl shadow-sm",children:[I.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-white"})}),I.jsxs("div",{className:"text-left",children:[I.jsx("div",{className:"font-semibold text-gray-900",children:r.name||`${r.first_name} ${r.last_name}`}),I.jsx("div",{className:"text-sm text-gray-600",children:r.position&&r.department?`${r.position} • ${r.department}`:r.position||r.department||"Team Member"})]})]})]}),g&&I.jsx("div",{className:"mb-8 p-6 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-2xl shadow-sm animate-in slide-in-from-top-2 duration-300",children:I.jsxs("div",{className:"flex items-center gap-4",children:[I.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-check-circle-line text-2xl text-green-600"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"font-semibold text-green-900 text-lg",children:"Thank you for your feedback!"}),I.jsx("p",{className:"text-green-700 mt-1",children:"Your input has been successfully submitted and will help us improve."})]})]})}),p&&I.jsx("div",{className:"mb-8 p-6 bg-gradient-to-r from-red-50 to-rose-50 border border-red-200 rounded-2xl shadow-sm animate-in slide-in-from-top-2 duration-300",children:I.jsxs("div",{className:"flex items-center gap-4",children:[I.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-error-warning-line text-2xl text-red-600"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"font-semibold text-red-900 text-lg",children:"Oops! Something went wrong"}),I.jsx("p",{className:"text-red-700 mt-1",children:y})]})]})}),I.jsx(ho,{className:"p-8 shadow-xl border-0 bg-white/80 backdrop-blur-sm",children:I.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!l.trim())return v("Please enter your feedback"),b(!0),void setTimeout(()=>b(!1),5e3);if(l.trim().length<10)return v("Please provide more detailed feedback (at least 10 characters)"),b(!0),void setTimeout(()=>b(!1),5e3);x(!0),b(!1);try{await Je({message:l.trim(),rating:d}),f(!0),o(""),c(null),N(0),setTimeout(()=>f(!1),5e3)}catch(t){v(t.message||"Failed to submit feedback. Please try again."),b(!0),setTimeout(()=>b(!1),5e3)}finally{x(!1)}},className:"space-y-8",children:[I.jsxs("div",{className:"space-y-4",children:[I.jsx("div",{children:I.jsx("label",{className:"block text-lg font-semibold text-gray-900 mb-2",children:"How would you rate your experience?"})}),I.jsx("div",{className:"flex items-center gap-3",children:[1,2,3,4,5].map(e=>I.jsxs("button",{type:"button",onClick:()=>(e=>{c(e===d?null:e)})(e),onMouseEnter:()=>m(e),onMouseLeave:()=>m(null),className:"group relative w-14 h-14 rounded-full border-2 transition-all duration-200 flex items-center justify-center transform hover:scale-110 focus:outline-none focus:ring-4 focus:ring-blue-200 "+((u?e<=u:e<=(d||0))?"bg-gradient-to-br from-yellow-400 to-orange-400 border-yellow-400 text-white shadow-lg":"bg-white border-gray-300 text-gray-400 hover:bg-yellow-50 hover:border-yellow-300 shadow-sm"),"aria-label":`Rate ${e} star${e>1?"s":""} - ${S(e)}`,children:[I.jsx("i",{className:"ri-star-fill text-xl"}),I.jsx("div",{className:"absolute -top-12 left-1/2 transform -translate-x-1/2 px-3 py-1 bg-gray-900 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap",children:S(e)})]},e))}),(d||u)&&I.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[I.jsx("div",{className:"flex text-yellow-400",children:[1,2,3,4,5].map(e=>I.jsx("i",{className:"ri-star-fill "+(e<=(u||d||0)?"text-yellow-400":"text-gray-300")},e))}),I.jsxs("span",{className:"text-gray-700 font-medium",children:[S(u||d),d&&!u&&` (${d}/5)`]})]})]}),I.jsxs("div",{className:"space-y-3",children:[I.jsxs("label",{htmlFor:"feedback",className:"block text-lg font-semibold text-gray-900",children:["Your Feedback ",I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsxs("div",{className:"relative",children:[I.jsx("textarea",{id:"feedback",value:l,onChange:e=>{const t=e.target.value;t.length<=w&&(o(t),N(t.length))},placeholder:"Share your thoughts, suggestions, or report any issues you've encountered. The more specific you are, the better we can help improve the experience...",className:"w-full px-6 py-4 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-200 focus:border-blue-500 transition-all duration-200 resize-none min-h-[140px] text-gray-900 placeholder-gray-500 bg-white/50",rows:6,maxLength:w,required:!0,"aria-describedby":"char-count feedback-help"}),I.jsxs("div",{className:"absolute bottom-4 right-4 text-sm text-gray-500",id:"char-count",children:[j,"/",w]})]}),I.jsx("p",{id:"feedback-help",className:"text-sm text-gray-600",children:"Please provide at least 10 characters to help us understand your feedback better."})]}),I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-4",children:[I.jsx(lt,{type:"submit",variant:"primary",size:"lg",disabled:h||!l.trim()||l.trim().length<10,className:"flex-1 h-14 text-lg font-semibold shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:h?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-3 text-xl"}),"Submitting Feedback..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-send-plane-line mr-3 text-xl"}),"Submit Feedback"]})}),I.jsxs(lt,{type:"button",variant:"outline",size:"lg",onClick:()=>e(-1),disabled:h,className:"sm:w-auto h-14 text-lg font-semibold border-2 hover:bg-gray-50 transition-all duration-200",children:[I.jsx("i",{className:"ri-arrow-left-line mr-3 text-xl"}),"Back"]})]})]})}),I.jsx("div",{className:"mt-8 text-center",children:I.jsxs("div",{className:"inline-flex items-center gap-2 px-6 py-3 bg-white/60 backdrop-blur-sm rounded-full border border-gray-200",children:[I.jsx("i",{className:"ri-shield-check-line text-blue-600"}),I.jsx("span",{className:"text-gray-700 font-medium",children:"Your feedback helps us make ProteQ better for everyone in Rosario, Batangas"})]})})]})})}):I.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-600 rounded-2xl flex items-center justify-center shadow-lg",children:I.jsx("i",{className:"ri-loader-4-line text-2xl text-white animate-spin"})}),I.jsx("p",{className:"text-gray-600 font-medium",children:"Checking authentication..."})]})})}delete Fl.Icon.Default.prototype._getIconUrl,Fl.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const _o=[{name:"Alupay",lat:13.8404,lng:121.2922,type:"residential"},{name:"Antipolo",lat:13.708,lng:121.3096,type:"mountainous"},{name:"Bagong Pook",lat:13.8402,lng:121.2216,type:"residential"},{name:"Balibago",lat:13.8512,lng:121.2855,type:"residential"},{name:"Barangay A",lat:13.8457,lng:121.2104,type:"urban"},{name:"Barangay B",lat:13.8461,lng:121.2065,type:"urban"},{name:"Barangay C",lat:13.8467,lng:121.2032,type:"urban"},{name:"Barangay D",lat:13.844,lng:121.2035,type:"urban"},{name:"Barangay E",lat:13.8415,lng:121.2047,type:"urban"},{name:"Bayawang",lat:13.7944,lng:121.2798,type:"agricultural"},{name:"Baybayin",lat:13.8277,lng:121.2589,type:"coastal"},{name:"Bulihan",lat:13.7967,lng:121.2351,type:"agricultural"},{name:"Cahigam",lat:13.8021,lng:121.2501,type:"agricultural"},{name:"Calantas",lat:13.734,lng:121.3129,type:"mountainous"},{name:"Colongan",lat:13.8114,lng:121.1762,type:"agricultural"},{name:"Itlugan",lat:13.819,lng:121.2036,type:"residential"},{name:"Leviste",lat:13.7694,lng:121.2868,type:"agricultural"},{name:"Lumbangan",lat:13.8122,lng:121.2649,type:"agricultural"},{name:"Maalas-as",lat:13.8112,lng:121.2122,type:"residential"},{name:"Mabato",lat:13.8144,lng:121.2913,type:"coastal"},{name:"Mabunga",lat:13.781,lng:121.2924,type:"agricultural"},{name:"Macalamcam A",lat:13.8551,lng:121.3046,type:"coastal"},{name:"Macalamcam B",lat:13.8606,lng:121.3265,type:"coastal"},{name:"Malaya",lat:13.8535,lng:121.172,type:"mountainous"},{name:"Maligaya",lat:13.8182,lng:121.2742,type:"agricultural"},{name:"Marilag",lat:13.8562,lng:121.1764,type:"mountainous"},{name:"Masaya",lat:13.8383,lng:121.1852,type:"residential"},{name:"Matamis",lat:13.7216,lng:121.3305,type:"mountainous"},{name:"Mavalor",lat:13.8177,lng:121.2315,type:"residential"},{name:"Mayuro",lat:13.7944,lng:121.2623,type:"agricultural"},{name:"Namuco",lat:13.8382,lng:121.2036,type:"commercial"},{name:"Namunga",lat:13.8431,lng:121.1978,type:"residential"},{name:"Nasi",lat:13.7699,lng:121.3127,type:"mountainous"},{name:"Natu",lat:13.842,lng:121.2683,type:"agricultural"},{name:"Palakpak",lat:13.7079,lng:121.332,type:"mountainous"},{name:"Pinagsibaan",lat:13.8438,lng:121.3141,type:"coastal"},{name:"Putingkahoy",lat:13.8349,lng:121.3227,type:"coastal"},{name:"Quilib",lat:13.8603,lng:121.2002,type:"mountainous"},{name:"Salao",lat:13.8578,lng:121.3455,type:"coastal"},{name:"San Carlos",lat:13.8478,lng:121.2475,type:"commercial"},{name:"San Ignacio",lat:13.8335,lng:121.1764,type:"mountainous"},{name:"San Isidro",lat:13.8074,lng:121.3152,type:"coastal"},{name:"San Jose",lat:13.8419,lng:121.2329,type:"commercial"},{name:"San Roque",lat:13.8518,lng:121.2039,type:"residential"},{name:"Santa Cruz",lat:13.8599,lng:121.1853,type:"mountainous"},{name:"Timbugan",lat:13.8095,lng:121.1869,type:"agricultural"},{name:"Tiquiwan",lat:13.8284,lng:121.2399,type:"residential"},{name:"Tulos",lat:13.7231,lng:121.2971,type:"mountainous"}],Ao=[{name:"Municipal Hall",lat:13.8454,lng:121.2089,type:"government",description:"Rosario Municipal Government Center"},{name:"Rosario Central School",lat:13.8442,lng:121.2095,type:"education",description:"Primary Educational Institution"},{name:"Public Market",lat:13.8448,lng:121.2078,type:"commercial",description:"Main Commercial Center"},{name:"Health Center",lat:13.846,lng:121.2085,type:"healthcare",description:"Municipal Health Facility"},{name:"Catholic Church",lat:13.8445,lng:121.2092,type:"religious",description:"St. Isidore Parish Church"}],Po=(e,t=!1)=>{const s=t?35:25;return Fl.divIcon({className:"custom-marker",html:`<div style="\n      background-color: ${e};\n      width: ${s}px;\n      height: ${s}px;\n      border-radius: 50%;\n      border: 3px solid white;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      color: white;\n      font-weight: bold;\n      font-size: ${t?"16px":"12px"};\n    ">${t?"★":"●"}</div>`,iconSize:[s,s],iconAnchor:[s/2,s/2]})},Lo=13.87,Eo=13.7,To=121.35,Io=121.16,Oo=[13.8454,121.2089],Fo=({activeFilter:e,onFilterChange:t,showLandmarks:s,onToggleLandmarks:r})=>{const[a,i]=n.useState(!1),l=[{value:"all",label:"All Barangays",color:"#6B7280"},{value:"urban",label:"Urban",color:"#3B82F6"},{value:"residential",label:"Residential",color:"#10B981"},{value:"commercial",label:"Commercial",color:"#F59E0B"},{value:"agricultural",label:"Agricultural",color:"#8B5CF6"},{value:"coastal",label:"Coastal",color:"#06B6D4"},{value:"mountainous",label:"Mountainous",color:"#84CC16"}];return I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"hidden md:block absolute top-4 right-4 z-[1000] bg-white rounded-lg shadow-lg p-4 max-w-xs",children:[I.jsx("h3",{className:"font-bold text-lg mb-3 text-gray-800",children:"Map Controls"}),I.jsxs("div",{className:"mb-4",children:[I.jsx("h4",{className:"font-semibold text-sm mb-2 text-gray-700",children:"Filter by Type:"}),I.jsx("div",{className:"space-y-1",children:l.map(s=>I.jsxs("button",{onClick:()=>t(s.value),className:"w-full text-left px-3 py-2 rounded text-sm flex items-center gap-2 transition-colors "+(e===s.value?"bg-blue-100 text-blue-800 border border-blue-300":"hover:bg-gray-100 text-gray-700"),children:[I.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.color}}),s.label]},s.value))})]}),I.jsx("div",{className:"mb-4",children:I.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[I.jsx("input",{type:"checkbox",checked:s,onChange:e=>r(e.target.checked),className:"rounded"}),"Show Key Landmarks"]})}),I.jsxs("div",{className:"border-t pt-3",children:[I.jsx("h4",{className:"font-semibold text-sm mb-2 text-gray-700",children:"Legend:"}),I.jsxs("div",{className:"space-y-1 text-xs",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),I.jsx("span",{children:"● Barangay"})]}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-4 h-4 rounded-full bg-red-600 flex items-center justify-center text-white text-xs",children:"★"}),I.jsx("span",{children:"★ Landmark"})]})]})]})]}),I.jsxs("div",{className:"md:hidden",children:[I.jsxs("button",{onClick:()=>i(!a),className:"absolute top-4 right-4 z-[1000] bg-white rounded-lg shadow-lg p-3 flex items-center gap-2",children:[I.jsx("i",{className:"ri-settings-3-line text-lg text-gray-700"}),I.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Controls"}),I.jsx("i",{className:`ri-arrow-${a?"up":"down"}-s-line text-gray-700 transition-transform`})]}),a&&I.jsxs("div",{className:"absolute top-16 left-4 right-4 z-[1000] bg-white rounded-lg shadow-xl p-4 max-h-[70vh] overflow-y-auto",children:[I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsx("h3",{className:"font-bold text-lg text-gray-800",children:"Map Controls"}),I.jsx("button",{onClick:()=>i(!1),className:"p-1 rounded-full hover:bg-gray-100",children:I.jsx("i",{className:"ri-close-line text-gray-500"})})]}),I.jsxs("div",{className:"mb-4",children:[I.jsx("h4",{className:"font-semibold text-sm mb-3 text-gray-700",children:"Filter by Type:"}),I.jsx("div",{className:"grid grid-cols-2 gap-2",children:l.map(s=>I.jsxs("button",{onClick:()=>{t(s.value)},className:"px-3 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors "+(e===s.value?"bg-blue-100 text-blue-800 border border-blue-300":"hover:bg-gray-100 text-gray-700 border border-gray-200"),children:[I.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:s.color}}),I.jsx("span",{className:"truncate",children:s.label})]},s.value))})]}),I.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:I.jsxs("label",{className:"flex items-center gap-3 text-sm text-gray-700",children:[I.jsx("input",{type:"checkbox",checked:s,onChange:e=>r(e.target.checked),className:"rounded w-4 h-4"}),I.jsx("span",{className:"font-medium",children:"Show Key Landmarks"})]})}),I.jsxs("div",{className:"border-t pt-4",children:[I.jsx("h4",{className:"font-semibold text-sm mb-3 text-gray-700",children:"Legend:"}),I.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-500 flex-shrink-0"}),I.jsx("span",{children:"Barangay"})]}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-4 h-4 rounded-full bg-red-600 flex items-center justify-center text-white text-xs",children:"★"}),I.jsx("span",{children:"Landmark"})]})]})]}),I.jsx("div",{className:"mt-4 pt-4 border-t",children:I.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[I.jsx("button",{onClick:()=>{t("all"),r(!0)},className:"px-3 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:"Show All"}),I.jsx("button",{onClick:()=>i(!1),className:"px-3 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-300 transition-colors",children:"Close"})]})})]}),a&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-[999]",onClick:()=>i(!1)})]})]})},Ro=()=>{const[e,t]=n.useState("all"),[s,r]=n.useState(!0),a="all"===e?_o:_o.filter(t=>t.type===e);return n.useEffect(()=>{if(!document.querySelector('link[href*="leaflet"]')){const e=document.createElement("link");e.rel="stylesheet",e.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",e.integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=",e.crossOrigin="",document.head.appendChild(e)}},[]),I.jsxs("div",{className:"min-h-screen bg-gray-50",children:[I.jsx(ut,{}),I.jsx("div",{className:"bg-green-600 text-white p-6",children:I.jsx("div",{className:"max-w-7xl mx-auto",children:I.jsxs("div",{className:"flex items-center gap-4",children:[I.jsx("button",{onClick:()=>window.history.back(),className:"flex items-center justify-center w-10 h-10 rounded-full bg-white/20 hover:bg-white/30 transition-colors duration-200 group","aria-label":"Go back",children:I.jsx("i",{className:"ri-arrow-left-line text-xl text-white group-hover:text-green-100"})}),I.jsxs("div",{className:"flex-1",children:[I.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Interactive Map of Rosario, Batangas"}),I.jsxs("p",{className:"text-green-100",children:["Explore all ",_o.length," barangays and key landmarks in our municipality"]})]})]})})}),I.jsxs("div",{className:"relative h-[calc(100vh-200px)]",children:[I.jsxs(Jl,{center:Oo,zoom:13,style:{height:"100%",width:"100%"},className:"z-0",maxBounds:[[Eo-.01,Io-.01],[Lo+.01,To+.01]],minZoom:11,maxZoom:18,children:[I.jsx(Ql,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),I.jsx(Vl,{center:Oo,radius:8e3,fillColor:"green",fillOpacity:.1,color:"green",weight:2,opacity:.6}),a.map(e=>{return I.jsx(Kl,{position:[e.lat,e.lng],icon:Po((t=e.type,{urban:"#3B82F6",residential:"#10B981",commercial:"#F59E0B",agricultural:"#8B5CF6",coastal:"#06B6D4",mountainous:"#84CC16"}[t]||"#6B7280")),children:I.jsx(Xl,{children:I.jsxs("div",{className:"p-2",children:[I.jsxs("h3",{className:"font-bold text-lg text-gray-800",children:["Barangay ",e.name]}),I.jsxs("div",{className:"mt-2 space-y-1 text-sm",children:[I.jsxs("p",{children:[I.jsx("span",{className:"font-semibold",children:"Type:"})," ",e.type.charAt(0).toUpperCase()+e.type.slice(1)]}),I.jsxs("p",{children:[I.jsx("span",{className:"font-semibold",children:"Coordinates:"})," ",e.lat.toFixed(4),", ",e.lng.toFixed(4)]}),I.jsxs("p",{children:[I.jsx("span",{className:"font-semibold",children:"Municipality:"})," Rosario, Batangas"]})]}),I.jsx("div",{className:"mt-3 pt-2 border-t border-gray-200",children:I.jsx("button",{onClick:()=>window.open(`https://maps.google.com/?q=${e.lat},${e.lng}`,"_blank"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View in Google Maps →"})})]})})},e.name);var t}),s&&Ao.map(e=>{return I.jsx(Kl,{position:[e.lat,e.lng],icon:Po((t=e.type,{government:"#DC2626",education:"#7C3AED",commercial:"#F59E0B",healthcare:"#059669",religious:"#BE185D"}[t]||"#6B7280"),!0),children:I.jsx(Xl,{children:I.jsxs("div",{className:"p-2",children:[I.jsx("h3",{className:"font-bold text-lg text-gray-800",children:e.name}),I.jsxs("div",{className:"mt-2 space-y-1 text-sm",children:[I.jsxs("p",{children:[I.jsx("span",{className:"font-semibold",children:"Type:"})," ",e.type.charAt(0).toUpperCase()+e.type.slice(1)]}),I.jsxs("p",{children:[I.jsx("span",{className:"font-semibold",children:"Description:"})," ",e.description]}),I.jsxs("p",{children:[I.jsx("span",{className:"font-semibold",children:"Coordinates:"})," ",e.lat.toFixed(4),", ",e.lng.toFixed(4)]})]}),I.jsx("div",{className:"mt-3 pt-2 border-t border-gray-200",children:I.jsx("button",{onClick:()=>window.open(`https://maps.google.com/?q=${e.lat},${e.lng}`,"_blank"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View in Google Maps →"})})]})})},e.name);var t})]}),I.jsx(Fo,{activeFilter:e,onFilterChange:t,showLandmarks:s,onToggleLandmarks:r})]}),I.jsx("div",{className:"bg-white border-t border-gray-200 p-6",children:I.jsxs("div",{className:"max-w-7xl mx-auto",children:[I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"text-2xl font-bold text-green-600",children:_o.length}),I.jsx("div",{className:"text-sm text-gray-600",children:"Total Barangays"})]}),I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Ao.length}),I.jsx("div",{className:"text-sm text-gray-600",children:"Key Landmarks"})]}),I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"~50 km²"}),I.jsx("div",{className:"text-sm text-gray-600",children:"Total Area"})]})]}),I.jsx("div",{className:"mt-6 text-center text-sm text-gray-500",children:I.jsx("p",{children:"© 2024 MDRRMO Rosario, Batangas. Interactive map for disaster risk reduction and emergency response."})})]})})]})},Do=()=>{const[e,t]=n.useState(null),[s,a]=n.useState(!1),[i,l]=n.useState(!1),[o,d]=n.useState(!1);return n.useEffect(()=>{window.scrollTo(0,0);const e=D();if(e.isAuthenticated){if("admin"===e.userType)return void(window.location.href="/admin");if("staff"===e.userType)return void(window.location.href="/staff")}const s=e.isAuthenticated&&"user"===e.userType;a(s),t(s?e.userData:null);const r=()=>{const e=D();if(e.isAuthenticated){if("admin"===e.userType)return void(window.location.href="/admin");if("staff"===e.userType)return void(window.location.href="/staff")}const s=e.isAuthenticated&&"user"===e.userType;a(s),t(s?e.userData:null)};return window.addEventListener("storage",r),window.addEventListener("authStateChanged",r),()=>{window.removeEventListener("storage",r),window.removeEventListener("authStateChanged",r)}},[]),I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50",children:[I.jsx(ut,{isAuthenticated:s,userData:e}),I.jsxs("div",{className:"relative overflow-hidden",children:[I.jsxs("div",{className:"relative h-[400px] md:h-[500px] lg:h-[600px] bg-gradient-to-r from-blue-900/90 to-blue-800/80",children:[I.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url('/images/rosario-hero.png')"}}),I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-900/90 to-blue-800/85"}),I.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_30%_40%,rgba(255,255,255,0.1),transparent_50%)]"})]}),I.jsx("div",{className:"absolute inset-0 flex items-center",children:I.jsx("div",{className:"container mx-auto px-4 lg:px-8",children:I.jsx("div",{className:"max-w-5xl",children:I.jsxs("div",{className:"text-left",children:[I.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 md:w-20 md:h-20 lg:w-24 lg:h-24 bg-white/95 backdrop-blur-sm rounded-2xl mb-6 md:mb-8 shadow-2xl border border-white/20",children:I.jsx("i",{className:"ri-information-line text-2xl md:text-3xl lg:text-4xl text-blue-600"})}),I.jsxs("h1",{className:"text-3xl md:text-5xl lg:text-6xl font-bold text-white mb-4 md:mb-6 leading-tight text-balance",children:["About",I.jsx("span",{className:"block text-yellow-300 bg-gradient-to-r from-yellow-300 to-yellow-400 bg-clip-text text-transparent",children:"MDRRMO Rosario"})]}),I.jsx("p",{className:"text-lg md:text-xl lg:text-2xl text-blue-100 max-w-3xl mb-8 md:mb-10 leading-relaxed text-pretty",children:"Learn about our mission, vision, and commitment to building a disaster-resilient community in Rosario, Batangas."})]})})})})]}),I.jsx("section",{className:"py-20 md:py-28",children:I.jsxs("div",{className:"container mx-auto px-4 lg:px-8 max-w-7xl",children:[I.jsxs("div",{className:"text-center mb-16 md:mb-20",children:[I.jsx("h2",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 mb-6 text-balance",children:"About MDRRMO Rosario"}),I.jsx("p",{className:"text-xl md:text-2xl text-gray-600 max-w-4xl mx-auto text-pretty",children:"Committed to building a resilient and disaster-ready community in Rosario, Batangas"})]}),I.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 md:gap-16 items-center",children:[I.jsxs("div",{className:"space-y-8",children:[I.jsxs("div",{className:"bg-white rounded-2xl p-8 md:p-10 shadow-xl border-2 border-blue-100",children:[I.jsxs("div",{className:"flex items-center mb-6",children:[I.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-100 to-blue-200 rounded-xl flex items-center justify-center mr-4",children:I.jsx("i",{className:"ri-eye-line text-2xl text-blue-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Our Vision"})]}),I.jsx("p",{className:"text-gray-700 text-lg leading-relaxed",children:"A disaster-resilient and safe community where every resident is prepared, protected, and empowered to face any emergency with confidence and unity."})]}),I.jsxs("div",{className:"bg-white rounded-2xl p-8 md:p-10 shadow-xl border-2 border-green-100",children:[I.jsxs("div",{className:"flex items-center mb-6",children:[I.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-100 to-green-200 rounded-xl flex items-center justify-center mr-4",children:I.jsx("i",{className:"ri-target-line text-2xl text-green-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Our Mission"})]}),I.jsx("p",{className:"text-gray-700 text-lg leading-relaxed",children:"To provide comprehensive disaster risk reduction and management services through proactive planning, rapid response, and community engagement, ensuring the safety and well-being of all residents in Rosario, Batangas."})]})]}),I.jsxs("div",{className:"space-y-8",children:[I.jsxs("div",{className:"bg-white rounded-2xl p-8 md:p-10 shadow-xl border-2 border-purple-100",children:[I.jsxs("div",{className:"flex items-center mb-6",children:[I.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-100 to-purple-200 rounded-xl flex items-center justify-center mr-4",children:I.jsx("i",{className:"ri-information-line text-2xl text-purple-600"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Key Information"})]}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"flex items-start",children:[I.jsx("i",{className:"ri-map-pin-line text-blue-500 mt-1 mr-3"}),I.jsxs("div",{children:[I.jsx("p",{className:"font-semibold text-gray-900",children:"Location"}),I.jsx("p",{className:"text-gray-600",children:"Municipal Hall, Rosario, Batangas, Philippines"})]})]}),I.jsxs("div",{className:"flex items-start",children:[I.jsx("i",{className:"ri-team-line text-blue-500 mt-1 mr-3"}),I.jsxs("div",{children:[I.jsx("p",{className:"font-semibold text-gray-900",children:"Coverage"}),I.jsx("p",{className:"text-gray-600",children:"All 48 barangays of Rosario, Batangas"})]})]}),I.jsxs("div",{className:"flex items-start",children:[I.jsx("i",{className:"ri-time-line text-blue-500 mt-1 mr-3"}),I.jsxs("div",{children:[I.jsx("p",{className:"font-semibold text-gray-900",children:"Service Hours"}),I.jsx("p",{className:"text-gray-600",children:"24/7 Emergency Response"})]})]})]})]}),I.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-2xl p-8 md:p-10 text-white",children:[I.jsxs("div",{className:"flex items-center mb-6",children:[I.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center mr-4",children:I.jsx("i",{className:"ri-shield-star-line text-2xl text-white"})}),I.jsx("h3",{className:"text-2xl md:text-3xl font-bold",children:"Our Commitment"})]}),I.jsx("p",{className:"text-blue-100 text-lg leading-relaxed mb-6",children:"We are dedicated to ensuring the safety and security of every resident through continuous improvement of our emergency response capabilities, community education, and disaster preparedness programs."}),I.jsxs("div",{className:"flex flex-wrap gap-3",children:[I.jsx("span",{className:"bg-white/20 px-4 py-2 rounded-full text-sm font-medium",children:"Disaster Preparedness"}),I.jsx("span",{className:"bg-white/20 px-4 py-2 rounded-full text-sm font-medium",children:"Emergency Response"}),I.jsx("span",{className:"bg-white/20 px-4 py-2 rounded-full text-sm font-medium",children:"Community Safety"})]})]})]})]}),I.jsxs("div",{className:"mt-16 md:mt-20",children:[I.jsx("h3",{className:"text-3xl md:text-4xl font-bold text-gray-900 text-center mb-12",children:"Our Core Functions"}),I.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8",children:[{icon:"ri-shield-check-line",title:"Disaster Prevention & Mitigation",description:"Proactive measures to reduce disaster risks and vulnerabilities",color:"from-red-100 to-red-200",iconColor:"text-red-600"},{icon:"ri-alarm-warning-line",title:"Disaster Preparedness",description:"Community education and capacity building for emergency readiness",color:"from-orange-100 to-orange-200",iconColor:"text-orange-600"},{icon:"ri-flashlight-line",title:"Disaster Response",description:"Rapid and coordinated emergency response during disasters",color:"from-yellow-100 to-yellow-200",iconColor:"text-yellow-600"},{icon:"ri-refresh-line",title:"Disaster Recovery",description:"Rehabilitation and reconstruction efforts post-disaster",color:"from-green-100 to-green-200",iconColor:"text-green-600"}].map((e,t)=>I.jsxs("div",{className:"bg-white rounded-2xl p-6 md:p-8 shadow-lg hover:shadow-xl hover:-translate-y-2 transition-all duration-300 border-2 border-gray-100",children:[I.jsx("div",{className:`w-16 h-16 bg-gradient-to-br ${e.color} rounded-2xl flex items-center justify-center mb-6`,children:I.jsx("i",{className:`${e.icon} text-2xl ${e.iconColor}`})}),I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:e.title}),I.jsx("p",{className:"text-gray-600 leading-relaxed",children:e.description})]},t))})]}),I.jsx("div",{className:"mt-16 md:mt-20",children:I.jsxs("div",{className:"bg-white rounded-3xl p-8 md:p-12 shadow-xl border-2 border-gray-100",children:[I.jsxs("div",{className:"text-center mb-12",children:[I.jsx("h3",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-6",children:"Get in Touch"}),I.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"We're here to serve you. Reach out to us for any emergency or non-emergency concerns."})]}),I.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:[I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:I.jsx("i",{className:"ri-phone-line text-blue-600 text-2xl"})}),I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:"Emergency Hotline"}),I.jsx("p",{className:"text-gray-600 mb-2",children:"(043) 311.2935"}),I.jsx("p",{className:"text-sm text-gray-500",children:"Available 24/7"})]}),I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:I.jsx("i",{className:"ri-mail-line text-green-600 text-2xl"})}),I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:"Email"}),I.jsx("p",{className:"text-gray-600 mb-2",children:"mdrrmo@rosario.gov.ph"}),I.jsx("p",{className:"text-sm text-gray-500",children:"General inquiries"})]}),I.jsxs("div",{className:"text-center md:col-span-2 lg:col-span-1",children:[I.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:I.jsx("i",{className:"ri-map-pin-line text-purple-600 text-2xl"})}),I.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:"Office Location"}),I.jsx("p",{className:"text-gray-600 mb-2",children:"Municipal Hall, Rosario"}),I.jsx("p",{className:"text-sm text-gray-500",children:"Batangas, Philippines"})]})]})]})})]})}),I.jsx("section",{className:"py-20 md:py-28 bg-gradient-to-br from-indigo-50 to-purple-50",children:I.jsxs("div",{className:"container mx-auto px-4 lg:px-8 max-w-7xl",children:[I.jsxs("div",{className:"text-center mb-16 md:mb-20",children:[I.jsx("h2",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 mb-6 text-balance",children:"Development Team"}),I.jsx("p",{className:"text-xl md:text-2xl text-gray-600 max-w-4xl mx-auto text-pretty",children:"The talented developers behind this emergency management platform"})]}),I.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-8 md:gap-10",children:[{name:"Sharmaine Abrenica",role:"Project Manager",image:"/images/dev/alex.jpg"},{name:"Clark Alisuag",role:"UI/UX Designer",image:"/images/dev/sarah.jpg"},{name:"Keith Andrei Ciruelas",role:"Full-Stack Developer",image:"/images/dev/KIT.jpg"}].map((e,t)=>I.jsxs("div",{className:"bg-white rounded-2xl p-6 md:p-8 shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 border-2 border-gray-100 group",children:[I.jsx("div",{className:"relative mb-6",children:I.jsxs("div",{className:"w-24 h-24 md:w-28 md:h-28 mx-auto bg-gradient-to-br from-indigo-100 to-purple-200 rounded-full flex items-center justify-center overflow-hidden border-4 border-white shadow-lg group-hover:scale-105 transition-transform duration-300",children:[I.jsx("img",{src:e.image||"/images/dev/placeholder.jpg",alt:e.name,className:"w-full h-full object-cover",onError:e=>{const t=e.currentTarget;t.style.display="none";const s=t.nextElementSibling;s&&(s.style.display="flex")}}),I.jsx("div",{className:"hidden w-full h-full bg-gradient-to-br from-indigo-100 to-purple-200 items-center justify-center text-indigo-600 font-bold text-2xl",children:e.name.split(" ").map(e=>e[0]).join("")})]})}),I.jsxs("div",{className:"text-center mb-6",children:[I.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-900 mb-2",children:e.name}),I.jsx("p",{className:"text-indigo-600 font-semibold text-lg mb-1",children:e.role})]})]},t))})]})}),I.jsx("section",{className:"bg-gradient-to-br from-blue-600 to-blue-700 py-16 md:py-20",children:I.jsxs("div",{className:"container mx-auto px-4 lg:px-8 max-w-4xl text-center",children:[I.jsx("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-white mb-6",children:"Ready to Get Involved?"}),I.jsx("p",{className:"text-xl text-blue-100 mb-8 max-w-2xl mx-auto",children:"Join our community of prepared citizens and help us build a safer, more resilient Rosario."}),I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[I.jsx(r,{to:"/incident-report",className:"bg-yellow-500 hover:bg-yellow-400 text-blue-900 px-8 py-4 rounded-xl font-bold text-lg transition-all duration-300 shadow-2xl hover:shadow-yellow-500/25 hover:-translate-y-1",children:"Report an Incident"}),I.jsx(r,{to:"/evacuation-center",className:"bg-white/20 hover:bg-white/30 text-white px-8 py-4 rounded-xl font-bold text-lg transition-all duration-300 border-2 border-white/30 hover:border-white/50",children:"Find Evacuation Centers"})]})]})}),I.jsxs("footer",{className:"bg-gradient-to-br from-gray-900 to-gray-800 text-white",children:[I.jsx("div",{className:"py-16 md:py-20",children:I.jsx("div",{className:"container mx-auto px-4 lg:px-8 max-w-7xl",children:I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 md:gap-12",children:[I.jsxs("div",{className:"lg:col-span-2",children:[I.jsxs("div",{className:"flex items-center mb-6",children:[I.jsx("div",{className:"w-12 h-12 flex items-center justify-center mr-4",children:I.jsx("img",{src:"/images/partners/MDRRMO.png",alt:"Logo",className:"w-40 h-50 rounded-lg shadow-md object-contain"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-xl font-bold",children:"MDRRMO Rosario"}),I.jsx("p",{className:"text-gray-400 text-sm",children:"Batangas Province"})]})]}),I.jsx("p",{className:"text-gray-300 mb-6 leading-relaxed max-w-md",children:"Municipal Disaster Risk Reduction & Management Office committed to protecting and serving our community through comprehensive disaster preparedness and emergency response."}),I.jsxs("div",{className:"flex space-x-4",children:[I.jsx("a",{href:"https://www.facebook.com/RosarioMDRRMO",className:"w-10 h-10 bg-gray-700 hover:bg-blue-600 rounded-lg flex items-center justify-center transition-colors duration-300",children:I.jsx("i",{className:"ri-facebook-fill text-lg"})}),I.jsx("a",{href:"#",className:"w-10 h-10 bg-gray-700 hover:bg-blue-600 rounded-lg flex items-center justify-center transition-colors duration-300",children:I.jsx("i",{className:"ri-twitter-fill text-lg"})}),I.jsx("a",{href:"#",className:"w-10 h-10 bg-gray-700 hover:bg-blue-600 rounded-lg flex items-center justify-center transition-colors duration-300",children:I.jsx("i",{className:"ri-instagram-line text-lg"})})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-lg font-semibold mb-6",children:"Quick Links"}),I.jsxs("ul",{className:"space-y-3",children:[I.jsx("li",{children:I.jsx(r,{to:"/",onClick:()=>{setTimeout(()=>{window.scrollTo(0,0)},100)},className:"text-gray-300 hover:text-white transition-colors duration-300",children:"Home"})}),I.jsx("li",{children:I.jsx(r,{to:"/evacuation-center",className:"text-gray-300 hover:text-white transition-colors duration-300",children:"Evacuation Centers"})}),I.jsx("li",{children:I.jsx(r,{to:"/safety-protocols",className:"text-gray-300 hover:text-white transition-colors duration-300",children:"Safety Protocols"})}),I.jsx("li",{children:I.jsx(r,{to:"/incident-report",className:"text-gray-300 hover:text-white transition-colors duration-300",children:"Report Incident"})}),I.jsx("li",{children:I.jsx(r,{to:"/about",className:"text-gray-300 hover:text-white transition-colors duration-300",children:"About"})})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-lg font-semibold mb-6",children:"Contact Information"}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"flex items-start",children:[I.jsx("i",{className:"ri-map-pin-line text-blue-400 mt-1 mr-3"}),I.jsxs("div",{children:[I.jsx("p",{className:"text-gray-300 text-sm",children:"Municipal Hall, Rosario"}),I.jsx("p",{className:"text-gray-300 text-sm",children:"Batangas, Philippines"})]})]}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-phone-line text-blue-400 mr-3"}),I.jsx("p",{className:"text-gray-300 text-sm",children:"(043) 311.2935"})]}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-mail-line text-blue-400 mr-3"}),I.jsx("p",{className:"text-gray-300 text-sm",children:"mdrrmo@rosario.gov.ph"})]})]})]})]})})}),I.jsx("div",{className:"border-t border-gray-700 py-8",children:I.jsxs("div",{className:"container mx-auto px-4 lg:px-8 max-w-7xl",children:[I.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[I.jsx("div",{className:"text-gray-400 text-sm mb-4 md:mb-0",children:"© 2024 MDRRMO Rosario, Batangas. All rights reserved."}),I.jsxs("div",{className:"flex flex-wrap gap-6 text-sm",children:[I.jsx("button",{onClick:()=>l(!0),className:"text-gray-400 hover:text-white transition-colors duration-300",children:"Privacy Policy"}),I.jsx("button",{onClick:()=>d(!0),className:"text-gray-400 hover:text-white transition-colors duration-300",children:"Terms of Service"})]})]}),I.jsx("div",{className:"mt-4 text-center",children:I.jsxs("p",{className:"text-gray-500 text-sm",children:["Made with ",I.jsx("span",{className:"text-red-500",children:"❤️"})," in the Philippines"]})})]})})]}),I.jsx(xt,{isOpen:i,onClose:()=>l(!1)}),I.jsx(gt,{isOpen:o,onClose:()=>d(!1)})]})},Mo=({collapsed:e=!1})=>{const t=i(),[s,a]=n.useState(["dashboard"]),l=e,o=e=>"/admin/dashboard"===e&&("/admin"===t.pathname||"/admin/"===t.pathname)||(t.pathname===e||t.pathname.startsWith(e+"/")),d=(e,t=0)=>{const n=e.children&&e.children.length>0,i=s.includes(e.id),c=o(e.path)||!!n&&e.children.some(e=>o(e.path));return I.jsxs("div",{className:"mb-1 group relative",children:[I.jsx("div",{className:"relative",children:n?I.jsxs("button",{onClick:()=>{return t=e.id,void a(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:`w-full flex items-center ${l?"justify-center px-0":"justify-between px-4"} py-3 text-left rounded-lg transition-all duration-200 ${c?"bg-blue-600 text-white shadow-lg":"text-gray-700 hover:bg-gray-100 hover:text-blue-600"} ${t>0&&!l?"ml-4":""}`,children:[I.jsxs("div",{className:"flex items-center "+(l?"justify-center":""),children:[I.jsx("i",{className:`${e.icon} text-lg ${l?"":"mr-3"}`}),!l&&I.jsxs(I.Fragment,{children:[I.jsx("span",{className:"font-medium",children:e.label}),e.badge&&I.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:e.badge})]})]}),!l&&I.jsx("i",{className:`ri-arrow-${i?"up":"down"}-s-line text-lg transition-transform`})]}):I.jsxs(r,{to:e.path,className:`flex items-center ${l?"justify-center px-0":"px-4"} py-3 rounded-lg transition-all duration-200 ${c?"bg-blue-600 text-white shadow-lg":"text-gray-700 hover:bg-gray-100 hover:text-blue-600"} ${t>0&&!l?"ml-4":""}`,children:[I.jsx("i",{className:`${e.icon} text-lg ${l?"":"mr-3"}`}),!l&&I.jsxs(I.Fragment,{children:[I.jsx("span",{className:"font-medium",children:e.label}),e.badge&&I.jsx("span",{className:"ml-auto px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:e.badge})]})]})}),!l&&n&&i&&I.jsx("div",{className:"mt-1 space-y-1",children:e.children.map(e=>d(e,t+1))}),l&&n&&I.jsx("div",{className:"absolute left-full top-0 ml-2 hidden group-hover:block bg-white border border-gray-200 rounded-md shadow-lg py-2 z-50 min-w-[200px]",children:e.children.map(e=>{const t=o(e.path);return I.jsxs(r,{to:e.path,className:"flex items-center px-3 py-2 text-sm "+(t?"text-blue-600 font-medium bg-blue-50":"text-gray-700 hover:bg-gray-100"),children:[I.jsx("i",{className:`${e.icon} text-base mr-2`}),I.jsx("span",{children:e.label})]},e.id)})}),l&&!n&&I.jsx("div",{className:"absolute left-full top-1/2 -translate-y-1/2 ml-2 px-2 py-1 text-xs bg-gray-800 text-white rounded shadow hidden group-hover:block whitespace-nowrap z-50",children:e.label})]},e.id)};return I.jsxs("div",{className:(l?"w-20":"w-64")+" bg-white shadow-xl border-r border-gray-200 h-full flex flex-col transition-all duration-200",children:[I.jsx("div",{className:(l?"p-4":"p-6")+" border-b border-gray-200",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"bg-blue-600 rounded-lg flex items-center justify-center "+(l?"w-10 h-10":"w-10 h-10 mr-3"),children:I.jsx("i",{className:"ri-admin-line text-white text-xl"})}),!l&&I.jsxs("div",{className:"flex-1",children:[I.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Admin Panel"}),I.jsx("p",{className:"text-sm text-gray-500",children:"SoteROS Emergency"})]})]})}),I.jsx("div",{className:`flex-1 ${l?"p-2":"p-4"} overflow-y-auto relative thin-scrollbar`,children:I.jsx("nav",{className:"space-y-2",children:[{id:"dashboard",label:"Dashboard",icon:"ri-dashboard-3-line",path:"/admin/dashboard"},{id:"alerts",label:"Alerts",icon:"ri-notification-3-line",path:"/admin/alerts"},{id:"evacuation",label:"Evacuation Management",icon:"ri-map-pin-line",path:"/admin/evacuation",children:[{id:"evacuation-centers",label:"Evacuation Centers",icon:"ri-building-2-line",path:"/admin/evacuation/centers"},{id:"evacuation-resources",label:"Evacuation Resources",icon:"ri-tools-line",path:"/admin/evacuation/resources"}]},{id:"incidents",label:"Incident Management",icon:"ri-error-warning-line",path:"/admin/incidents",children:[{id:"incident-map",label:"Incident Map",icon:"ri-map-pin-2-line",path:"/admin/incidents/map"},{id:"view-incidents",label:"View Incidents",icon:"ri-eye-line",path:"/admin/incidents/view"}]},{id:"users",label:"User Management",icon:"ri-user-line",path:"/admin/users"},{id:"staff",label:"Staff Management",icon:"ri-team-line",path:"/admin/staff"},{id:"teams",label:"Teams Management",icon:"ri-group-line",path:"/admin/teams"},{id:"safety-protocols",label:"Safety Protocols",icon:"ri-shield-check-line",path:"/admin/safety-protocols"},{id:"welfare",label:"Welfare Check",icon:"ri-heart-pulse-line",path:"/admin/welfare"},{id:"feedback",label:"User Feedback",icon:"ri-chat-1-line",path:"/admin/feedback"},{id:"activity-logs",label:"Activity Logs",icon:"ri-history-line",path:"/admin/activity-logs"}].map(e=>d(e))})}),I.jsx("div",{className:(l?"p-2":"p-4")+" border-t border-gray-200",children:I.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[I.jsx("i",{className:`${l?"ri-information-line":"ri-shield-check-line"} ${l?"":"mr-2"}`}),!l&&I.jsx("span",{children:"Emergency Management System"})]})})]})},Bo=({children:e})=>{const[t,s]=n.useState(!0),[r,a]=n.useState(!1),[l,o]=n.useState(!1),c=i();n.useEffect(()=>{u();const e=()=>{u()};return window.addEventListener("authStateChanged",e),()=>{window.removeEventListener("authStateChanged",e)}},[]);const u=()=>{const e=D();a(e.isAuthenticated),o("admin"===e.userType),s(!1)};return t?I.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),I.jsx("p",{className:"text-gray-600",children:"Checking authentication..."})]})}):r&&l?I.jsx(I.Fragment,{children:e}):I.jsx(d,{to:"/admin/login",state:{from:c},replace:!0})};const Uo=new class{ws=null;reconnectAttempts=0;maxReconnectAttempts=5;reconnectInterval=3e3;isConnecting=!1;messageHandlers=new Map;connectionState="disconnected";constructor(){this.connect=this.connect.bind(this),this.disconnect=this.disconnect.bind(this),this.send=this.send.bind(this),this.on=this.on.bind(this),this.off=this.off.bind(this)}connect(e){return new Promise((t,s)=>{if(this.isConnecting||"connected"===this.connectionState)t();else{this.isConnecting=!0,this.connectionState="connecting";try{const r="https:"===window.location.protocol?"wss:":"ws:",a=window.location.hostname,n=`${r}//${a}:${"5000"}?token=${encodeURIComponent(e)}`;this.ws=new WebSocket(n),this.ws.onopen=()=>{this.connectionState="connected",this.reconnectAttempts=0,this.isConnecting=!1,t()},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);this.handleMessage(t)}catch(t){}},this.ws.onclose=t=>{this.connectionState="disconnected",this.isConnecting=!1,1e3!==t.code&&this.attemptReconnect(e)},this.ws.onerror=e=>{this.connectionState="disconnected",this.isConnecting=!1,s(e)},setTimeout(()=>{"connected"!==this.connectionState&&(this.isConnecting=!1,s(new Error("WebSocket connection timeout")))},1e4)}catch(r){this.isConnecting=!1,s(r)}}})}attemptReconnect(e){this.reconnectAttempts>=this.maxReconnectAttempts||(this.reconnectAttempts++,setTimeout(()=>{this.connect(e).catch(()=>{})},this.reconnectInterval*this.reconnectAttempts))}handleMessage(e){(this.messageHandlers.get(e.type)||[]).forEach(t=>{try{t(e.data)}catch(s){}})}send(e,t){if(this.ws&&this.ws.readyState===WebSocket.OPEN){const s={type:e,data:t,timestamp:(new Date).toISOString()};this.ws.send(JSON.stringify(s))}}on(e,t){this.messageHandlers.has(e)||this.messageHandlers.set(e,[]),this.messageHandlers.get(e).push(t)}off(e,t){const s=this.messageHandlers.get(e);if(s){const e=s.indexOf(t);e>-1&&s.splice(e,1)}}disconnect(){this.ws&&(this.ws.close(1e3,"Client disconnect"),this.ws=null),this.connectionState="disconnected",this.messageHandlers.clear()}getConnectionState(){return this.connectionState}isConnected(){return"connected"===this.connectionState&&this.ws?.readyState===WebSocket.OPEN}},qo=({children:e})=>{const t=a(),[s,r]=n.useState(!1),[i,l]=n.useState(!1),[o,d]=n.useState(null),[u,m]=n.useState([]),[h,x]=n.useState([]),[g,f]=n.useState(!1),[p,b]=n.useState(!1),[y,v]=n.useState(!1),[j,N]=n.useState(()=>{const e=localStorage.getItem("readNotifications");return e?new Set(JSON.parse(e)):new Set}),[w,S]=n.useState("disconnected"),k=n.useRef(!1),[C,$]=n.useState(0);n.useEffect(()=>{const e=D();e.isAuthenticated&&"admin"===e.userType&&d(e.userData);const t=()=>{const e=D();e.isAuthenticated&&"admin"===e.userType?d(e.userData):d(null)};return window.addEventListener("authStateChanged",t),()=>window.removeEventListener("authStateChanged",t)},[]),n.useEffect(()=>((async()=>{const e=D();if(e.isAuthenticated&&"admin"===e.userType&&e.token&&!k.current){k.current=!0,"default"===Notification.permission&&await Notification.requestPermission();try{S("connecting"),await Uo.connect(e.token),S("connected"),Uo.on("new_incident",_),Uo.on("new_welfare_report",A),Uo.on("incident_updated",P),Uo.on("welfare_updated",L)}catch(t){S("disconnected")}}})(),E(),()=>{Uo.off("new_incident",_),Uo.off("new_welfare_report",A),Uo.off("incident_updated",P),Uo.off("welfare_updated",L)}),[]),n.useEffect(()=>{localStorage.setItem("readNotifications",JSON.stringify([...j]))},[j]);const _=e=>{$(e=>e+1),m(t=>{const s={...e,id:e.id||e.incident_id,date_reported:e.date_reported||(new Date).toISOString()};return t.some(e=>e.id===s.id||e.incident_id===s.id)?t:[s,...t].slice(0,10)}),"granted"===Notification.permission&&new Notification("New Incident Report",{body:`${e.incident_type||"Incident"} reported at ${e.location||"Unknown location"}`,icon:"/images/Slogo.png",tag:`incident-${e.id}`})},A=e=>{$(e=>e+1),x(t=>{const s={...e,type:"welfare",id:`welfare_${e.report_id||e.id}`,title:"Welfare Check - Needs Help",description:e.additional_info||e.description||"User needs assistance",date_reported:e.submitted_at||e.date_reported||(new Date).toISOString(),priority_level:"high",user_name:`${e.first_name||""} ${e.last_name||""}`.trim()||e.user_name||"Unknown User"};return t.some(t=>t.id===s.id||t.report_id===e.report_id)?t:[s,...t].slice(0,5)}),"granted"===Notification.permission&&new Notification("Welfare Check - Needs Help",{body:`${e.user_name||"User"} needs assistance`,icon:"/images/Slogo.png",tag:`welfare-${e.report_id||e.id}`})},P=e=>{m(t=>t.map(t=>t.id===e.id||t.incident_id===e.id?{...t,...e}:t))},L=e=>{x(t=>t.map(t=>t.id===`welfare_${e.report_id}`||t.report_id===e.report_id?{...t,...e}:t))},E=async()=>{b(!0);try{const[e,t]=await Promise.allSettled([Oe(),V("/admin/welfare/reports?status=needs_help&limit=5")]);let s=[];"fulfilled"===e.status&&e.value.success&&Array.isArray(e.value.incidents)&&(s=e.value.incidents.slice(0,10),m(s));let r=[];"fulfilled"===t.status&&t.value.success&&Array.isArray(t.value.reports)&&(r=t.value.reports.map(e=>({...e,type:"welfare",id:`welfare_${e.report_id}`,title:"Welfare Check - Needs Help",description:e.additional_info||"User needs assistance",date_reported:e.submitted_at,priority_level:"high",user_name:`${e.first_name||""} ${e.last_name||""}`.trim()||e.user_name||"Unknown User"})),x(r));const a=[...s,...r],n=new Set(a.map(e=>String(e.id||e.incident_id)));N(e=>new Set([...e].filter(e=>n.has(e))))}catch(e){}finally{b(!1)}},T=[...u,...h].sort((e,t)=>new Date(t.date_reported||t.submitted_at).getTime()-new Date(e.date_reported||e.submitted_at).getTime()),O=y?T:T.slice(0,10),F=T.filter(e=>!j.has(String(e.id||e.incident_id))).length,R=T.filter(e=>"high"===e.priority_level||"critical"===e.priority_level||"welfare"===e.type).length;n.useEffect(()=>{const e=e=>{const t=e.target;!g||t.closest(".notification-dropdown")||t.closest(".notification-button")||f(!1)};return g&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[g]);const B=()=>r(!s),U=()=>l(!i);return I.jsx(Bo,{children:I.jsxs("div",{className:"h-screen bg-gray-50 flex",children:[I.jsx("div",{className:"hidden lg:flex transition-all duration-300 "+(s?"w-20":"w-64"),children:I.jsx(Mo,{collapsed:s,onToggleCollapse:B})}),i&&I.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:U}),I.jsx("div",{className:"fixed left-0 top-0 h-full w-64 bg-white shadow-xl overflow-y-auto thin-scrollbar",children:I.jsx(Mo,{})})]}),I.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[I.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 px-4 py-3 sticky top-0 z-30",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("button",{onClick:U,className:"lg:hidden p-2 rounded-lg text-gray-600 hover:bg-gray-100 mr-3",children:I.jsx("i",{className:"ri-menu-line text-xl"})}),I.jsx("button",{onClick:B,className:"hidden lg:block p-2 rounded-lg text-gray-600 hover:bg-gray-100 mr-3",children:I.jsx("i",{className:`ri-${s?"menu-unfold":"menu-fold"}-line text-xl`})}),I.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Admin Dashboard"})]}),I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsxs("div",{className:"relative",children:[I.jsxs("button",{onClick:()=>{g||(E(),$(0)),f(!g)},className:"notification-button p-3 rounded-xl text-gray-600 hover:bg-blue-50 hover:text-blue-600 relative transition-all duration-200 group",children:[I.jsx("i",{className:"ri-notification-3-line text-xl group-hover:scale-110 transition-transform"}),F>0&&I.jsx("span",{className:"absolute -top-1 -right-1 w-6 h-6 bg-gradient-to-r from-red-500 to-red-600 text-white text-xs rounded-full flex items-center justify-center font-bold shadow-lg animate-pulse",children:F>99?"99+":F}),C>0&&I.jsx("div",{className:"absolute -top-1 -left-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white animate-bounce",children:I.jsx("div",{className:"w-full h-full bg-green-400 rounded-full animate-ping"})}),R>0&&I.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-orange-500 rounded-full border-2 border-white"})]}),g&&I.jsxs("div",{className:"notification-dropdown absolute right-0 mt-2 w-[520px] h-[520px] max-w-[100vw] max-h-[80vh] overflow-hidden bg-white rounded-xl shadow-2xl border border-gray-200 z-50 backdrop-blur-sm",children:[I.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-t-xl",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsxs("h3",{className:"font-bold text-gray-900 text-lg flex items-center",children:[I.jsx("i",{className:"ri-notification-3-line mr-2 text-blue-600"}),"Incident Alerts"]}),I.jsxs("div",{className:"ml-3 flex items-center",children:["connected"===w&&I.jsxs("div",{className:"flex items-center text-green-600 text-xs",children:[I.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse mr-1"}),I.jsx("span",{className:"font-medium",children:"Live"})]}),"connecting"===w&&I.jsxs("div",{className:"flex items-center text-yellow-600 text-xs",children:[I.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse mr-1"}),I.jsx("span",{className:"font-medium",children:"Connecting..."})]}),"disconnected"===w&&I.jsxs("div",{className:"flex items-center text-red-600 text-xs",children:[I.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full mr-1"}),I.jsx("span",{className:"font-medium",children:"Offline"})]})]})]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("button",{onClick:E,disabled:p,className:"p-1 hover:bg-gray-200 rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh notifications",children:I.jsx("i",{className:"ri-refresh-line text-gray-500 "+(p?"animate-spin":"")})}),I.jsx("button",{onClick:()=>f(!1),className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:I.jsx("i",{className:"ri-close-line text-gray-500"})})]})]}),F>0&&I.jsx("div",{className:"mt-3 flex justify-center",children:I.jsxs("button",{onClick:()=>{const e=[...u,...h].map(e=>String(e.id||e.incident_id));N(new Set(e))},className:"px-3 py-1 bg-blue-600 text-white text-xs rounded-full hover:bg-blue-700 transition-colors flex items-center",children:[I.jsx("i",{className:"ri-check-double-line mr-1"}),"Mark All Read"]})})]}),I.jsx("div",{className:"h-[380px] max-h-[60vh] overflow-y-auto",children:p?I.jsxs("div",{className:"p-8 text-center text-gray-500",children:[I.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-3"}),I.jsx("p",{className:"text-sm font-medium",children:"Loading notifications..."}),I.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Fetching latest incidents and welfare reports"})]}):0===T.length?I.jsxs("div",{className:"p-8 text-center text-gray-500",children:[I.jsx("i",{className:"ri-notification-off-line text-4xl mb-3 block text-gray-300"}),I.jsx("p",{className:"text-sm font-medium",children:"No notifications"}),I.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"New incidents and welfare reports will appear here"})]}):O.map(e=>{const s=e.id||e.incident_id,r=String(s),a=j.has(r),n="high"===e.priority_level||"critical"===e.priority_level||"welfare"===e.type,i="welfare"===e.type;return I.jsxs("div",{className:`px-4 py-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition-all duration-200 relative group ${a?"":"bg-blue-50/50 border-l-4 border-l-blue-500"} ${n?"ring-1 ring-red-200 bg-red-50/30":""}`,onClick:()=>{a||(e=>{const t=String(e);N(e=>new Set([...e,t]))})(r),t(i?"/admin/welfare":"/admin/incidents/view"),f(!1)},children:[!a&&I.jsx("div",{className:"absolute left-3 top-4 w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),n&&I.jsx("div",{className:"absolute right-3 top-3",children:I.jsx("i",{className:(i?"ri-heart-pulse-line":"ri-fire-line")+" text-red-500 text-sm animate-pulse"})}),I.jsxs("div",{className:`${a?"":"ml-4"} ${n?"pr-6":""}`,children:[I.jsxs("div",{className:"flex items-start justify-between mb-2",children:[I.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[I.jsx("p",{className:"text-sm font-semibold "+(a?"text-gray-700":"text-gray-900"),children:i?"Welfare Check - Needs Help":e.incident_type}),I.jsx("span",{className:`px-2 py-1 text-xs font-bold rounded-full border ${(e=>{if(i)return"bg-red-100 text-red-800 border-red-200";switch(e){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.priority_level)}`,children:i?"WELFARE":e.priority_level?.toUpperCase()}),n&&I.jsxs("span",{className:"text-xs text-red-600 font-bold flex items-center",children:[I.jsx("i",{className:(i?"ri-heart-pulse-line":"ri-alarm-warning-line")+" mr-1"}),i?"NEEDS HELP":"URGENT"]})]}),I.jsx("span",{className:"text-xs text-gray-400 ml-2",children:new Date(e.date_reported||e.submitted_at).toLocaleDateString()})]}),I.jsx("p",{className:"text-xs leading-relaxed mb-2 "+(a?"text-gray-500":"text-gray-600"),children:i?I.jsxs("span",{children:[I.jsx("strong",{children:e.user_name})," needs assistance",e.description&&` - ${e.description.length>80?e.description.substring(0,80)+"...":e.description}`]}):e.description?.length>100?`${e.description.substring(0,100)}...`:e.description}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsxs("span",{className:"text-xs text-gray-400 flex items-center",children:[I.jsx("i",{className:"ri-time-line mr-1"}),new Date(e.date_reported||e.submitted_at).toLocaleTimeString()]}),i?I.jsxs("span",{className:"text-xs text-gray-400 flex items-center",children:[I.jsx("i",{className:"ri-user-line mr-1"}),e.user_name]}):e.location&&I.jsxs("span",{className:"text-xs text-gray-400 flex items-center",children:[I.jsx("i",{className:"ri-map-pin-line mr-1"}),e.location.length>20?`${e.location.substring(0,20)}...`:e.location]})]}),I.jsxs("div",{className:"flex items-center text-xs text-gray-500 group-hover:text-blue-600 transition-colors",children:[I.jsx("span",{className:"mr-1",children:i?"View Welfare":"View"}),I.jsx("i",{className:"ri-arrow-right-s-line group-hover:translate-x-1 transition-transform"})]})]})]})]},s)})}),T.length>10&&!y&&I.jsx("div",{className:"p-3 border-t border-gray-100 bg-gray-50 rounded-b-xl",children:I.jsxs("button",{onClick:()=>v(!0),className:"w-full py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center font-medium",children:[I.jsx("i",{className:"ri-eye-line mr-2"}),"See More (",T.length-10," more)"]})}),y&&T.length>10&&I.jsx("div",{className:"p-3 border-t border-gray-100 bg-gray-50 rounded-b-xl",children:I.jsxs("button",{onClick:()=>v(!1),className:"w-full py-2 bg-gray-600 text-white text-sm rounded-lg hover:bg-gray-700 transition-colors flex items-center justify-center font-medium",children:[I.jsx("i",{className:"ri-eye-off-line mr-2"}),"Show Less"]})})]})]}),I.jsxs("div",{className:"relative group",children:[I.jsxs("button",{className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-white text-sm"})}),I.jsxs("div",{className:"hidden md:block text-left",children:[I.jsx("p",{className:"text-sm font-medium text-gray-900",children:o?.name||o?.first_name||o?.firstName||"Admin"}),I.jsx("p",{className:"text-xs text-gray-500",children:o?.email||"admin@example.com"})]}),I.jsx("i",{className:"ri-arrow-down-s-line text-gray-400"})]}),I.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50",children:I.jsxs("div",{className:"py-2",children:[I.jsxs("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),t("/admin/profile")},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[I.jsx("i",{className:"ri-user-line mr-3"}),"Profile Settings"]}),I.jsx("div",{className:"border-t border-gray-100 my-1"}),I.jsxs("button",{onClick:async()=>{try{await J()}catch(e){}finally{M(),Uo.disconnect(),t("/admin/login")}},className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[I.jsx("i",{className:"ri-logout-box-line mr-3"}),"Logout"]})]})})]})]})]})}),I.jsx("main",{className:"flex-1 overflow-y-auto p-6 bg-gray-50",children:e||I.jsx(c,{})})]})]})})},zo=()=>{const[e,t]=n.useState({email:"",password:""}),[s,r]=n.useState(!1),[i,l]=n.useState(null),o=a(),d=e=>{const{name:s,value:r}=e.target;t(e=>({...e,[s]:r})),i&&l(null)};return I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-4 relative overflow-hidden",children:[I.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[I.jsx("div",{className:"absolute -top-40 -left-40 w-80 h-80 bg-gradient-to-br from-blue-400/20 to-indigo-400/20 rounded-full blur-3xl animate-pulse"}),I.jsx("div",{className:"absolute -bottom-40 -right-40 w-96 h-96 bg-gradient-to-br from-indigo-400/20 to-purple-400/20 rounded-full blur-3xl animate-pulse delay-1000"}),I.jsx("div",{className:"absolute top-1/4 right-1/4 w-32 h-32 bg-gradient-to-br from-blue-300/30 to-indigo-300/30 rounded-full blur-2xl animate-bounce delay-500"}),I.jsx("div",{className:"absolute top-20 left-20 w-2 h-2 bg-blue-400 rounded-full animate-ping delay-300"}),I.jsx("div",{className:"absolute top-40 right-32 w-1 h-1 bg-indigo-400 rounded-full animate-ping delay-700"}),I.jsx("div",{className:"absolute bottom-32 left-1/3 w-1.5 h-1.5 bg-purple-400 rounded-full animate-ping delay-1000"}),I.jsx("div",{className:"absolute top-1/3 left-10 w-8 h-8 border border-blue-300/40 rotate-45 animate-spin-slow"}),I.jsx("div",{className:"absolute bottom-1/3 right-16 w-6 h-6 border border-indigo-300/40 rounded-full animate-pulse delay-500"})]}),I.jsxs("div",{className:"max-w-md w-full relative z-10",children:[I.jsxs("div",{className:"text-center mb-8",children:[I.jsxs("div",{className:"mx-auto w-20 h-20 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-full flex items-center justify-center mb-4 shadow-2xl relative",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full blur-lg opacity-50 animate-pulse"}),I.jsx("i",{className:"ri-shield-user-line text-3xl text-white relative z-10"}),I.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-green-400 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-check-line text-xs text-white"})})]}),I.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-700 bg-clip-text text-transparent mb-2",children:"Admin Portal"}),I.jsx("p",{className:"text-gray-600 font-medium",children:"ProteQ Emergency Management System"}),I.jsxs("div",{className:"flex justify-center items-center gap-4 mt-4",children:[I.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[I.jsx("i",{className:"ri-shield-check-line text-green-500"}),I.jsx("span",{children:"Secure"})]}),I.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[I.jsx("i",{className:"ri-lock-line text-blue-500"}),I.jsx("span",{children:"Encrypted"})]}),I.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[I.jsx("i",{className:"ri-verified-badge-line text-indigo-500"}),I.jsx("span",{children:"Verified"})]})]})]}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl p-8 border border-white/20 relative overflow-hidden",children:[I.jsx("div",{className:"absolute top-0 left-0 w-20 h-20 bg-gradient-to-br from-blue-400/20 to-transparent rounded-br-full"}),I.jsx("div",{className:"absolute bottom-0 right-0 w-16 h-16 bg-gradient-to-tl from-indigo-400/20 to-transparent rounded-tl-full"}),I.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),e.email&&e.password){r(!0),l(null);try{const t=await G(e.email,e.password);if(t.success){const e={...t.admin,token:t.token,userType:"admin"};localStorage.setItem("userInfo",JSON.stringify(e)),localStorage.setItem("adminToken",t.token),window.dispatchEvent(new Event("authStateChanged")),o("/admin/dashboard")}else l(t.message||"Login failed")}catch(s){l(s instanceof Error?s.message:"Login failed. Please try again.")}finally{r(!1)}}else l("Please fill in all fields")},className:"space-y-6 relative z-10",children:[i&&I.jsx("div",{className:"bg-red-50/80 backdrop-blur-sm border border-red-200/50 rounded-xl p-4 animate-shake",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-error-warning-line text-red-500 mr-2"}),I.jsx("span",{className:"text-red-700 text-sm font-medium",children:i})]})}),I.jsxs("div",{children:[I.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address"}),I.jsxs("div",{className:"relative group",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-mail-line text-gray-400 group-focus-within:text-blue-500 transition-colors"})}),I.jsx("input",{type:"email",id:"email",name:"email",value:e.email,onChange:d,className:"block w-full pl-12 pr-4 py-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-all duration-200 bg-white/50 backdrop-blur-sm hover:bg-white/70",placeholder:"admin@example.com",required:!0}),I.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/0 via-blue-500/0 to-blue-500/0 group-focus-within:from-blue-500/10 group-focus-within:via-transparent group-focus-within:to-indigo-500/10 transition-all duration-300 pointer-events-none"})]})]}),I.jsxs("div",{children:[I.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Password"}),I.jsxs("div",{className:"relative group",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-lock-line text-gray-400 group-focus-within:text-blue-500 transition-colors"})}),I.jsx("input",{type:"password",id:"password",name:"password",value:e.password,onChange:d,className:"block w-full pl-12 pr-4 py-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-all duration-200 bg-white/50 backdrop-blur-sm hover:bg-white/70",placeholder:"Enter your password",required:!0}),I.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/0 via-blue-500/0 to-blue-500/0 group-focus-within:from-blue-500/10 group-focus-within:via-transparent group-focus-within:to-indigo-500/10 transition-all duration-300 pointer-events-none"})]})]}),I.jsxs("button",{type:"submit",disabled:s,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-4 px-6 rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:ring-2 focus:ring-blue-500/50 focus:ring-offset-2 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-semibold shadow-lg hover:shadow-xl transform hover:scale-[1.02] active:scale-[0.98] relative overflow-hidden",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 translate-x-[-100%] hover:translate-x-[100%] transition-transform duration-700"}),s?I.jsxs("div",{className:"flex items-center justify-center relative z-10",children:[I.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Signing In..."]}):I.jsxs("div",{className:"flex items-center justify-center relative z-10",children:[I.jsx("i",{className:"ri-login-box-line mr-2"}),"Sign In to Admin Portal"]})]})]}),I.jsx("div",{className:"mt-8 text-center relative z-10",children:I.jsx("p",{className:"text-sm text-gray-600",children:"Need help? Contact your system administrator"})})]}),I.jsxs("div",{className:"mt-6 flex justify-center items-center gap-6 text-xs text-gray-500",children:[I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("i",{className:"ri-shield-check-line text-green-500"}),I.jsx("span",{children:"SSL Secured"})]}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("i",{className:"ri-time-line text-blue-500"}),I.jsx("span",{children:"24/7 Monitoring"})]}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("i",{className:"ri-user-settings-line text-indigo-500"}),I.jsx("span",{children:"Admin Access"})]})]})]})]})},Wo=()=>{const[e,t]=n.useState({name:"",email:"",password:"",confirmPassword:""}),[s,r]=n.useState(!1),[i,l]=n.useState(null),o=a(),d=e=>{const{name:s,value:r}=e.target;t(e=>({...e,[s]:r})),i&&l(null)};return I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-4 relative overflow-hidden",children:[I.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[I.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-blue-400/20 to-indigo-600/20 rounded-full blur-3xl animate-pulse"}),I.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-tr from-purple-400/20 to-blue-600/20 rounded-full blur-3xl animate-pulse delay-1000"}),I.jsx("div",{className:"absolute top-1/2 left-1/4 w-32 h-32 bg-gradient-to-br from-indigo-400/30 to-blue-600/30 rounded-full blur-2xl animate-bounce delay-500"}),I.jsx("div",{className:"absolute top-1/4 right-1/4 w-24 h-24 bg-gradient-to-br from-blue-400/30 to-purple-600/30 rounded-full blur-2xl animate-bounce delay-700"}),I.jsx("div",{className:"absolute top-20 left-20 w-2 h-2 bg-blue-400 rounded-full animate-ping"}),I.jsx("div",{className:"absolute top-40 right-32 w-1 h-1 bg-indigo-500 rounded-full animate-ping delay-300"}),I.jsx("div",{className:"absolute bottom-32 left-1/3 w-1.5 h-1.5 bg-purple-400 rounded-full animate-ping delay-700"}),I.jsx("div",{className:"absolute bottom-20 right-20 w-2 h-2 bg-blue-500 rounded-full animate-ping delay-1000"})]}),I.jsxs("div",{className:"max-w-md w-full relative z-10",children:[I.jsxs("div",{className:"text-center mb-8",children:[I.jsxs("div",{className:"mx-auto w-20 h-20 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-full flex items-center justify-center mb-4 shadow-2xl relative",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-400 to-indigo-600 rounded-full blur-lg opacity-50 animate-pulse"}),I.jsx("i",{className:"ri-shield-user-line text-3xl text-white relative z-10"})]}),I.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-gray-900 to-blue-800 bg-clip-text text-transparent mb-2",children:"Create Admin Account"}),I.jsx("p",{className:"text-gray-600 font-medium",children:"ProteQ Emergency Management System"}),I.jsxs("div",{className:"flex justify-center items-center space-x-4 mt-4 text-xs text-gray-500",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-shield-check-line text-green-500 mr-1"}),I.jsx("span",{children:"Secure"})]}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-lock-line text-blue-500 mr-1"}),I.jsx("span",{children:"Encrypted"})]}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-verified-badge-line text-purple-500 mr-1"}),I.jsx("span",{children:"Verified"})]})]})]}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl p-8 border border-white/20 relative",children:[I.jsx("div",{className:"absolute top-0 left-0 w-20 h-20 bg-gradient-to-br from-blue-400/20 to-transparent rounded-tl-3xl"}),I.jsx("div",{className:"absolute bottom-0 right-0 w-20 h-20 bg-gradient-to-tl from-indigo-400/20 to-transparent rounded-br-3xl"}),I.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),e.name&&e.email&&e.password&&e.confirmPassword)if(e.password===e.confirmPassword)if(e.password.length<6)l("Password must be at least 6 characters long");else{r(!0),l(null);try{const t=await H(e.name,e.email,e.password);t.success?o("/admin/login"):l(t.message||"Registration failed")}catch(s){l(s instanceof Error?s.message:"Registration failed. Please try again.")}finally{r(!1)}}else l("Passwords do not match");else l("Please fill in all fields")},className:"space-y-6 relative z-10",children:[i&&I.jsx("div",{className:"bg-red-50/80 backdrop-blur-sm border border-red-200 rounded-xl p-4 animate-shake",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-error-warning-line text-red-500 mr-2"}),I.jsx("span",{className:"text-red-700 text-sm font-medium",children:i})]})}),I.jsxs("div",{className:"group",children:[I.jsx("label",{htmlFor:"name",className:"block text-sm font-semibold text-gray-700 mb-2 group-focus-within:text-blue-600 transition-colors",children:"Full Name"}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-user-line text-gray-400 group-focus-within:text-blue-500 transition-colors"})}),I.jsx("input",{type:"text",id:"name",name:"name",value:e.name,onChange:d,className:"block w-full pl-12 pr-4 py-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white/50 backdrop-blur-sm hover:bg-white/70",placeholder:"Enter your full name",required:!0})]})]}),I.jsxs("div",{className:"group",children:[I.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-gray-700 mb-2 group-focus-within:text-blue-600 transition-colors",children:"Email Address"}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-mail-line text-gray-400 group-focus-within:text-blue-500 transition-colors"})}),I.jsx("input",{type:"email",id:"email",name:"email",value:e.email,onChange:d,className:"block w-full pl-12 pr-4 py-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white/50 backdrop-blur-sm hover:bg-white/70",placeholder:"admin@example.com",required:!0})]})]}),I.jsxs("div",{className:"group",children:[I.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-gray-700 mb-2 group-focus-within:text-blue-600 transition-colors",children:"Password"}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-lock-line text-gray-400 group-focus-within:text-blue-500 transition-colors"})}),I.jsx("input",{type:"password",id:"password",name:"password",value:e.password,onChange:d,className:"block w-full pl-12 pr-4 py-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white/50 backdrop-blur-sm hover:bg-white/70",placeholder:"Create a strong password",required:!0})]})]}),I.jsxs("div",{className:"group",children:[I.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-semibold text-gray-700 mb-2 group-focus-within:text-blue-600 transition-colors",children:"Confirm Password"}),I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:I.jsx("i",{className:"ri-lock-line text-gray-400 group-focus-within:text-blue-500 transition-colors"})}),I.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:e.confirmPassword,onChange:d,className:"block w-full pl-12 pr-4 py-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white/50 backdrop-blur-sm hover:bg-white/70",placeholder:"Confirm your password",required:!0})]})]}),I.jsxs("button",{type:"submit",disabled:s,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-700 text-white py-4 px-6 rounded-xl hover:from-blue-700 hover:to-indigo-800 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-semibold shadow-lg hover:shadow-xl transform hover:scale-[1.02] relative overflow-hidden group",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),s?I.jsxs("div",{className:"flex items-center justify-center relative z-10",children:[I.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Creating Account..."]}):I.jsxs("div",{className:"flex items-center justify-center relative z-10",children:[I.jsx("i",{className:"ri-user-add-line mr-2"}),"Create Account"]})]})]})]}),I.jsx("div",{className:"text-center mt-6",children:I.jsxs("div",{className:"flex justify-center items-center space-x-6 text-xs text-gray-500",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-shield-check-line text-green-500 mr-1"}),I.jsx("span",{children:"256-bit SSL"})]}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-time-line text-blue-500 mr-1"}),I.jsx("span",{children:"24/7 Support"})]}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-global-line text-purple-500 mr-1"}),I.jsx("span",{children:"Global Access"})]})]})})]})]})},Vo=({active:e,payload:t,label:s})=>{if(e&&t&&t.length){const e=t[0]?.payload;return I.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-lg border border-gray-200",children:[I.jsx("p",{className:"font-medium text-gray-900 mb-1",children:e?.timeLabel||s}),t.map((e,t)=>I.jsx("p",{className:"text-sm",style:{color:e.color},children:`${e.dataKey}: ${e.value.toLocaleString()}`},t)),e?.formattedTime&&I.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Time: ",e.formattedTime]}),e?.sampleDateTime&&I.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["Latest: ",e.sampleDateTime]}),e?.dateRange&&I.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Consecutive Dates: ",e.dateRange]}),e?.timeRange&&I.jsxs("p",{className:"text-xs text-purple-600 mt-1",children:["Time Range: ",e.timeRange]})]})}return null},Ho=l.memo(({data:e,title:t,dataKey:s="count",color:r="#3b82f6",height:a=300,stacked:n=!1,stackKeys:i=[]})=>{if(!e||0===e.length)return I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow duration-200",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:t}),I.jsx("div",{className:"flex items-center justify-center",style:{height:a},children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 mx-auto mb-3 bg-gray-100 rounded-full flex items-center justify-center",children:I.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),I.jsx("p",{className:"text-gray-500 font-medium",children:"No data available"}),I.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Data will appear here when available"})]})})]});const l=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#06b6d4","#f97316","#84cc16"];return I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow duration-200",children:[I.jsxs("div",{className:"flex items-center justify-between mb-6",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),I.jsxs("span",{className:"text-sm text-gray-500 bg-gray-50 px-2 py-1 rounded-full",children:[e.length," ",1===e.length?"item":"items"]})]}),I.jsx("div",{style:{height:a},children:I.jsx(f,{width:"100%",height:"100%",children:I.jsxs(p,{data:e,margin:{top:10,right:30,left:20,bottom:5},children:[I.jsx(b,{strokeDasharray:"3 3",className:"opacity-20",stroke:"#e5e7eb"}),I.jsx(y,{dataKey:"name",fontSize:12,tick:{fill:"#6b7280"},axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"}}),I.jsx(v,{fontSize:12,tick:{fill:"#6b7280"},axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"},tickFormatter:e=>e.toLocaleString()}),I.jsx(j,{content:I.jsx(Vo,{})}),n&&i.length>0&&I.jsx(N,{}),n&&i.length>0?i.map((e,t)=>I.jsx(w,{dataKey:e,stackId:"stack",fill:l[t%l.length],radius:t===i.length-1?[4,4,0,0]:[0,0,0,0]},e)):I.jsx(w,{dataKey:s,fill:r,radius:[4,4,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})})})]})});Ho.displayName="BarChart";const Go=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#f97316","#6366f1","#84cc16"],Jo=l.memo(({data:e,title:t,dataKey:s="count",nameKey:r="name",height:a=300,colors:n})=>{const i=e?.reduce((e,t)=>e+t[s],0)||0,l=e?.reduce((e,t)=>Math.max(e,t[s]),0)||0,o=e?.find(e=>e[s]===l);if(!e||0===e.length)return I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow duration-200",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:t}),I.jsxs("div",{className:"flex flex-col items-center justify-center",style:{height:a},children:[I.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-3",children:I.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),I.jsx("p",{className:"text-gray-500 text-sm",children:"No data available"})]})]});const d=({active:e,payload:t})=>{if(e&&t&&t.length){const e=t[0],s=(e.value/i*100).toFixed(1);return I.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-lg border border-gray-200",children:[I.jsx("p",{className:"font-medium text-gray-900",children:e.name}),I.jsxs("p",{className:"text-sm text-gray-600",children:["Value: ",I.jsx("span",{className:"font-medium text-gray-900",children:e.value.toLocaleString()})]}),I.jsxs("p",{className:"text-sm text-gray-600",children:["Percentage: ",I.jsxs("span",{className:"font-medium text-gray-900",children:[s,"%"]})]})]})}return null};return I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow duration-200",children:[I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),I.jsxs("div",{className:"text-right",children:[I.jsxs("p",{className:"text-sm text-gray-500",children:["Total: ",I.jsx("span",{className:"font-medium text-gray-900",children:i.toLocaleString()})]}),o&&I.jsxs("p",{className:"text-xs text-gray-400",children:["Largest: ",o[r]," (",l.toLocaleString(),")"]})]})]}),I.jsx("div",{style:{height:a},children:I.jsx(f,{width:"100%",height:"100%",children:I.jsxs(S,{children:[I.jsx(k,{data:e,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:t})=>t>.05?`${e}: ${(100*t).toFixed(0)}%`:"",outerRadius:Math.min(.35*a,100),fill:"#8884d8",dataKey:s,nameKey:r,animationBegin:0,animationDuration:800,children:e.map((e,t)=>I.jsx(C,{fill:n?.[e.name]||Go[t%Go.length],className:"hover:opacity-80 transition-opacity duration-200 cursor-pointer"},`cell-${t}`))}),I.jsx(j,{content:I.jsx(d,{})}),I.jsx(N,{wrapperStyle:{paddingTop:"20px",fontSize:"14px"},iconType:"circle"})]})})}),I.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:I.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[I.jsxs("span",{children:["Categories: ",I.jsx("span",{className:"font-medium text-gray-900",children:e.length})]}),I.jsxs("span",{children:["Average: ",I.jsx("span",{className:"font-medium text-gray-900",children:(i/e.length).toLocaleString()})]})]})})]})}),Ko=({active:e,payload:t,label:s})=>{if(e&&t&&t.length){const e=t.reduce((e,t)=>e+(t.value||0),0);return I.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-lg p-3 min-w-[200px]",children:[I.jsx("p",{className:"font-semibold text-gray-900 mb-2 text-sm",children:s}),I.jsxs("div",{className:"space-y-1",children:[t.map((e,t)=>I.jsxs("div",{className:"flex items-center justify-between text-xs",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:e.color}}),I.jsx("span",{className:"text-gray-700 capitalize",children:e.dataKey})]}),I.jsx("span",{className:"font-medium text-gray-900",children:e.value})]},t)),I.jsx("div",{className:"border-t border-gray-100 pt-1 mt-2",children:I.jsxs("div",{className:"flex items-center justify-between text-xs font-semibold",children:[I.jsx("span",{className:"text-gray-700",children:"Total"}),I.jsx("span",{className:"text-gray-900",children:e})]})})]})]})}return null},Yo=({payload:e})=>I.jsx("div",{className:"flex flex-wrap gap-4 justify-center mt-4",children:e?.map((e,t)=>I.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[I.jsx("div",{className:"w-3 h-3 rounded-sm shadow-sm",style:{backgroundColor:e.color}}),I.jsx("span",{className:"text-gray-700 capitalize font-medium",children:e.value})]},t))}),Zo=l.memo(({data:e,title:t,stackKeys:s,colors:r=["#ef4444","#f59e0b","#10b981","#3b82f6","#8b5cf6","#ec4899"],height:a=300})=>{if(!e||0===e.length)return I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow duration-200",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:t}),I.jsx("div",{className:"flex items-center justify-center",style:{height:a},children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4 mx-auto",children:I.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),I.jsx("p",{className:"text-gray-600 font-medium",children:"No data available"}),I.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Chart data will appear here when available"})]})})]});const n=e.length,i=Math.max(...e.map(e=>s.reduce((t,s)=>t+(Number(e[s])||0),0)));return I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow duration-200",children:[I.jsxs("div",{className:"flex items-center justify-between mb-6",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),I.jsx("div",{className:"text-right",children:I.jsxs("p",{className:"text-xs text-gray-500",children:[n," categories • Max: ",i]})})]}),I.jsx("div",{style:{height:a},children:I.jsx(f,{width:"100%",height:"100%",children:I.jsxs(p,{data:e,margin:{top:10,right:30,left:20,bottom:5},children:[I.jsx(b,{strokeDasharray:"2 4",className:"opacity-20",stroke:"#e5e7eb"}),I.jsx(y,{dataKey:"name",fontSize:12,tick:{fill:"#6b7280"},axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"}}),I.jsx(v,{fontSize:12,tick:{fill:"#6b7280"},axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"}}),I.jsx(j,{content:I.jsx(Ko,{})}),I.jsx(N,{content:I.jsx(Yo,{})}),s.map((e,t)=>I.jsx(w,{dataKey:e,stackId:"a",fill:r[t%r.length],radius:t===s.length-1?[6,6,0,0]:[0,0,0,0],className:"hover:opacity-80 transition-opacity duration-200",stroke:"rgba(255,255,255,0.1)",strokeWidth:.5},e))]})})})]})}),Xo=l.memo(({data:e,title:t,color:s="#3b82f6",height:r=300})=>{const a=e=>{if(!e||"string"!=typeof e)return"Invalid Date";if(e.includes("-")&&2===e.split("-").length){const[t,s]=e.split("-");return new Date(Number.parseInt(t),Number.parseInt(s)-1,1).toLocaleDateString("en-US",{year:"numeric",month:"short"})}if(/^\d{6}$/.test(e)){const t=Number.parseInt(e.substring(0,4)),s=Number.parseInt(e.substring(4,6)),r=new Date(t,0,1),a=7*(s-1),n=new Date(r.getTime()+24*a*60*60*1e3),i=n.getDay(),l=0===i?-6:1-i;return`Week ${s} (${new Date(n.getTime()+24*l*60*60*1e3).toLocaleDateString("en-US",{month:"short",day:"numeric"})})`}if(e.includes("-")&&3===e.split("-").length){return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})},n=e?.reduce((e,t)=>e+t.count,0)||0,i=e?.length?Math.round(n/e.length):0,l=e?.reduce((e,t)=>Math.max(e,t.count),0)||0,o=e?.length>=2?e[e.length-1].count>e[0].count?"up":e[e.length-1].count<e[0].count?"down":"stable":"stable",d=({active:e,payload:t,label:r})=>{if(e&&t&&t.length){const e=t[0].value,n=a(r);return I.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-lg p-3 min-w-[160px]",children:[I.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:n}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s}}),I.jsx("span",{className:"text-sm text-gray-600",children:"Count:"}),I.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.toLocaleString()})]}),i>0&&I.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e>i?`+${e-i} above avg`:e<i?i-e+" below avg":"At average"})]})}return null};return e&&0!==e.length?I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow duration-200",children:[I.jsxs("div",{className:"flex items-start justify-between mb-6",children:[I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t}),I.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[I.jsxs("span",{children:["Total: ",I.jsx("span",{className:"font-medium text-gray-900",children:n.toLocaleString()})]}),I.jsxs("span",{children:["Avg: ",I.jsx("span",{className:"font-medium text-gray-900",children:i.toLocaleString()})]}),I.jsxs("span",{children:["Peak: ",I.jsx("span",{className:"font-medium text-gray-900",children:l.toLocaleString()})]})]})]}),I.jsxs("div",{className:"flex items-center gap-1 text-sm",children:["up"===o&&I.jsxs(I.Fragment,{children:[I.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),I.jsx("span",{className:"text-green-600 font-medium",children:"Trending up"})]}),"down"===o&&I.jsxs(I.Fragment,{children:[I.jsx("svg",{className:"w-4 h-4 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"})}),I.jsx("span",{className:"text-red-600 font-medium",children:"Trending down"})]}),"stable"===o&&I.jsxs(I.Fragment,{children:[I.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14"})}),I.jsx("span",{className:"text-gray-600 font-medium",children:"Stable"})]})]})]}),I.jsx("div",{style:{height:r},children:I.jsx(f,{width:"100%",height:"100%",children:I.jsxs($,{data:e,margin:{top:5,right:30,left:20,bottom:5},children:[I.jsx(b,{strokeDasharray:"3 3",className:"opacity-20",stroke:"#e5e7eb"}),I.jsx(y,{dataKey:"date",tickFormatter:a,fontSize:12,stroke:"#6b7280",tickLine:{stroke:"#d1d5db"}}),I.jsx(v,{fontSize:12,stroke:"#6b7280",tickLine:{stroke:"#d1d5db"},tickFormatter:e=>e.toLocaleString()}),I.jsx(j,{content:I.jsx(d,{})}),I.jsx(N,{}),I.jsx(_,{type:"monotone",dataKey:"count",stroke:s,strokeWidth:3,dot:{fill:s,strokeWidth:2,r:4,className:"drop-shadow-sm"},activeDot:{r:7,fill:s,stroke:"#ffffff",strokeWidth:2,className:"drop-shadow-md"},className:"drop-shadow-sm"})]})})})]}):I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:t}),I.jsx("div",{className:"flex items-center justify-center",style:{height:r},children:I.jsxs("div",{className:"text-center",children:[I.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),I.jsx("p",{className:"text-gray-500 font-medium",children:"No data available"}),I.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Data trends will appear here when available"})]})})]})}),Qo={},ed=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=s?.nonce||s?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in Qo)return;Qo[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,a&&r.setAttribute("nonce",a),document.head.appendChild(r),t?new Promise((t,s)=>{r.addEventListener("load",t),r.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})};function td(e){return(td="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var sd=Uint8Array,rd=Uint16Array,ad=Int32Array,nd=new sd([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),id=new sd([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ld=new sd([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),od=function(e,t){for(var s=new rd(31),r=0;r<31;++r)s[r]=t+=1<<e[r-1];var a=new ad(s[30]);for(r=1;r<30;++r)for(var n=s[r];n<s[r+1];++n)a[n]=n-s[r]<<5|r;return{b:s,r:a}},dd=od(nd,2),cd=dd.b,ud=dd.r;cd[28]=258,ud[258]=28;for(var md=od(id,0).r,hd=new rd(32768),xd=0;xd<32768;++xd){var gd=(43690&xd)>>1|(21845&xd)<<1;gd=(61680&(gd=(52428&gd)>>2|(13107&gd)<<2))>>4|(3855&gd)<<4,hd[xd]=((65280&gd)>>8|(255&gd)<<8)>>1}var fd=function(e,t,s){for(var r=e.length,a=0,n=new rd(t);a<r;++a)e[a]&&++n[e[a]-1];var i,l=new rd(t);for(a=1;a<t;++a)l[a]=l[a-1]+n[a-1]<<1;if(s){i=new rd(1<<t);var o=15-t;for(a=0;a<r;++a)if(e[a])for(var d=a<<4|e[a],c=t-e[a],u=l[e[a]-1]++<<c,m=u|(1<<c)-1;u<=m;++u)i[hd[u]>>o]=d}else for(i=new rd(r),a=0;a<r;++a)e[a]&&(i[a]=hd[l[e[a]-1]++]>>15-e[a]);return i},pd=new sd(288);for(xd=0;xd<144;++xd)pd[xd]=8;for(xd=144;xd<256;++xd)pd[xd]=9;for(xd=256;xd<280;++xd)pd[xd]=7;for(xd=280;xd<288;++xd)pd[xd]=8;var bd=new sd(32);for(xd=0;xd<32;++xd)bd[xd]=5;var yd=fd(pd,9,0),vd=fd(bd,5,0),jd=function(e){return(e+7)/8|0},Nd=function(e,t,s){s<<=7&t;var r=t/8|0;e[r]|=s,e[r+1]|=s>>8},wd=function(e,t,s){s<<=7&t;var r=t/8|0;e[r]|=s,e[r+1]|=s>>8,e[r+2]|=s>>16},Sd=function(e,t){for(var s=[],r=0;r<e.length;++r)e[r]&&s.push({s:r,f:e[r]});var a=s.length,n=s.slice();if(!a)return{t:Ld,l:0};if(1==a){var i=new sd(s[0].s+1);return i[s[0].s]=1,{t:i,l:1}}s.sort(function(e,t){return e.f-t.f}),s.push({s:-1,f:25001});var l=s[0],o=s[1],d=0,c=1,u=2;for(s[0]={s:-1,f:l.f+o.f,l:l,r:o};c!=a-1;)l=s[s[d].f<s[u].f?d++:u++],o=s[d!=c&&s[d].f<s[u].f?d++:u++],s[c++]={s:-1,f:l.f+o.f,l:l,r:o};var m=n[0].s;for(r=1;r<a;++r)n[r].s>m&&(m=n[r].s);var h=new rd(m+1),x=kd(s[c-1],h,0);if(x>t){r=0;var g=0,f=x-t,p=1<<f;for(n.sort(function(e,t){return h[t.s]-h[e.s]||e.f-t.f});r<a;++r){var b=n[r].s;if(!(h[b]>t))break;g+=p-(1<<x-h[b]),h[b]=t}for(g>>=f;g>0;){var y=n[r].s;h[y]<t?g-=1<<t-h[y]++-1:++r}for(;r>=0&&g;--r){var v=n[r].s;h[v]==t&&(--h[v],++g)}x=t}return{t:new sd(h),l:x}},kd=function(e,t,s){return-1==e.s?Math.max(kd(e.l,t,s+1),kd(e.r,t,s+1)):t[e.s]=s},Cd=function(e){for(var t=e.length;t&&!e[--t];);for(var s=new rd(++t),r=0,a=e[0],n=1,i=function(e){s[r++]=e},l=1;l<=t;++l)if(e[l]==a&&l!=t)++n;else{if(!a&&n>2){for(;n>138;n-=138)i(32754);n>2&&(i(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(i(a),--n;n>6;n-=6)i(8304);n>2&&(i(n-3<<5|8208),n=0)}for(;n--;)i(a);n=1,a=e[l]}return{c:s.subarray(0,r),n:t}},$d=function(e,t){for(var s=0,r=0;r<t.length;++r)s+=e[r]*t[r];return s},_d=function(e,t,s){var r=s.length,a=jd(t+2);e[a]=255&r,e[a+1]=r>>8,e[a+2]=255^e[a],e[a+3]=255^e[a+1];for(var n=0;n<r;++n)e[a+n+4]=s[n];return 8*(a+4+r)},Ad=function(e,t,s,r,a,n,i,l,o,d,c){Nd(t,c++,s),++a[256];for(var u=Sd(a,15),m=u.t,h=u.l,x=Sd(n,15),g=x.t,f=x.l,p=Cd(m),b=p.c,y=p.n,v=Cd(g),j=v.c,N=v.n,w=new rd(19),S=0;S<b.length;++S)++w[31&b[S]];for(S=0;S<j.length;++S)++w[31&j[S]];for(var k=Sd(w,7),C=k.t,$=k.l,_=19;_>4&&!C[ld[_-1]];--_);var A,P,L,E,T=d+5<<3,I=$d(a,pd)+$d(n,bd)+i,O=$d(a,m)+$d(n,g)+i+14+3*_+$d(w,C)+2*w[16]+3*w[17]+7*w[18];if(o>=0&&T<=I&&T<=O)return _d(t,c,e.subarray(o,o+d));if(Nd(t,c,1+(O<I)),c+=2,O<I){A=fd(m,h,0),P=m,L=fd(g,f,0),E=g;var F=fd(C,$,0);Nd(t,c,y-257),Nd(t,c+5,N-1),Nd(t,c+10,_-4),c+=14;for(S=0;S<_;++S)Nd(t,c+3*S,C[ld[S]]);c+=3*_;for(var R=[b,j],D=0;D<2;++D){var M=R[D];for(S=0;S<M.length;++S){var B=31&M[S];Nd(t,c,F[B]),c+=C[B],B>15&&(Nd(t,c,M[S]>>5&127),c+=M[S]>>12)}}}else A=yd,P=pd,L=vd,E=bd;for(S=0;S<l;++S){var U=r[S];if(U>255){wd(t,c,A[(B=U>>18&31)+257]),c+=P[B+257],B>7&&(Nd(t,c,U>>23&31),c+=nd[B]);var q=31&U;wd(t,c,L[q]),c+=E[q],q>3&&(wd(t,c,U>>5&8191),c+=id[q])}else wd(t,c,A[U]),c+=P[U]}return wd(t,c,A[256]),c+P[256]},Pd=new ad([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ld=new sd(0),Ed=function(e,t,s,r,a,n){var i=n.z||e.length,l=new sd(r+i+5*(1+Math.ceil(i/7e3))+a),o=l.subarray(r,l.length-a),d=n.l,c=7&(n.r||0);if(t){c&&(o[0]=n.r>>3);for(var u=Pd[t-1],m=u>>13,h=8191&u,x=(1<<s)-1,g=n.p||new rd(32768),f=n.h||new rd(x+1),p=Math.ceil(s/3),b=2*p,y=function(t){return(e[t]^e[t+1]<<p^e[t+2]<<b)&x},v=new ad(25e3),j=new rd(288),N=new rd(32),w=0,S=0,k=n.i||0,C=0,$=n.w||0,_=0;k+2<i;++k){var A=y(k),P=32767&k,L=f[A];if(g[P]=L,f[A]=P,$<=k){var E=i-k;if((w>7e3||C>24576)&&(E>423||!d)){c=Ad(e,o,0,v,j,N,S,C,_,k-_,c),C=w=S=0,_=k;for(var T=0;T<286;++T)j[T]=0;for(T=0;T<30;++T)N[T]=0}var I=2,O=0,F=h,R=P-L&32767;if(E>2&&A==y(k-R))for(var D=Math.min(m,E)-1,M=Math.min(32767,k),B=Math.min(258,E);R<=M&&--F&&P!=L;){if(e[k+I]==e[k+I-R]){for(var U=0;U<B&&e[k+U]==e[k+U-R];++U);if(U>I){if(I=U,O=R,U>D)break;var q=Math.min(R,U-2),z=0;for(T=0;T<q;++T){var W=k-R+T&32767,V=W-g[W]&32767;V>z&&(z=V,L=W)}}}R+=(P=L)-(L=g[P])&32767}if(O){v[C++]=268435456|ud[I]<<18|md[O];var H=31&ud[I],G=31&md[O];S+=nd[H]+id[G],++j[257+H],++N[G],$=k+I,++w}else v[C++]=e[k],++j[e[k]]}}for(k=Math.max(k,$);k<i;++k)v[C++]=e[k],++j[e[k]];c=Ad(e,o,d,v,j,N,S,C,_,k-_,c),d||(n.r=7&c|o[c/8|0]<<3,c-=7,n.h=f,n.p=g,n.i=k,n.w=$)}else{for(k=n.w||0;k<i+d;k+=65535){var J=k+65535;J>=i&&(o[c/8|0]=d,J=i),c=_d(o,c+1,e.subarray(k,J))}n.i=i}return function(e,t,s){return(null==s||s>e.length)&&(s=e.length),new sd(e.subarray(t,s))}(l,0,r+jd(c)+a)},Td=function(){var e=1,t=0;return{p:function(s){for(var r=e,a=t,n=0|s.length,i=0;i!=n;){for(var l=Math.min(i+2655,n);i<l;++i)a+=r+=s[i];r=(65535&r)+15*(r>>16),a=(65535&a)+15*(a>>16)}e=r,t=a},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},Id=function(e,t,s){for(;s;++t)e[t]=s,s>>>=8};function Od(e,t){t||(t={});var s=Td();s.p(e);var r=function(e,t,s,r,a){if(!a&&(a={l:1},t.dictionary)){var n=t.dictionary.subarray(-32768),i=new sd(n.length+e.length);i.set(n),i.set(e,n.length),e=i,a.w=n.length}return Ed(e,null==t.level?6:t.level,null==t.mem?a.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,s,r,a)}(e,t,t.dictionary?6:2,4);return function(e,t){var s=t.level,r=0==s?0:s<6?1:9==s?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=Td();a.p(t.dictionary),Id(e,2,a.d())}}(r,t),Id(r,r.length-4,s.d()),r}var Fd="undefined"!=typeof TextDecoder&&new TextDecoder;try{Fd.decode(Ld,{stream:!0})}catch(Nh){}function Rd(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}function Dd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var s=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=s){var r,a,n,i,l=[],o=!0,d=!1;try{if(n=(s=s.call(e)).next,0===t);else for(;!(o=(r=n.call(s)).done)&&(l.push(r.value),l.length!==t);o=!0);}catch(c){d=!0,a=c}finally{try{if(!o&&null!=s.return&&(i=s.return(),Object(i)!==i))return}finally{if(d)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Rd(e,t);var s={}.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Rd(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Md(e,t="utf8"){return new TextDecoder(t).decode(e)}const Bd=new TextEncoder;const Ud=(()=>{const e=new Uint8Array(4);return!((new Uint32Array(e.buffer)[0]=1)&e[0])})(),qd={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class zd{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=8192,t={}){let s=!1;"number"==typeof e?e=new ArrayBuffer(e):(s=!0,this.lastWrittenByte=e.byteLength);const r=t.offset?t.offset>>>0:0,a=e.byteLength-r;let n=r;(ArrayBuffer.isView(e)||e instanceof zd)&&(e.byteLength!==e.buffer.byteLength&&(n=e.byteOffset+r),e=e.buffer),this.lastWrittenByte=s?a:0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=n,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,n,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(void 0===e)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const t=2*(this.offset+e),s=new Uint8Array(t);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=t,this.byteLength=t,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const s=qd[t].BYTES_PER_ELEMENT*e,r=this.byteOffset+this.offset,a=this.buffer.slice(r,r+s);if(this.littleEndian===Ud&&"uint8"!==t&&"int8"!==t){const e=new Uint8Array(this.buffer.slice(r,r+s));e.reverse();const a=new qd[t](e.buffer);return this.offset+=s,a.reverse(),a}const n=new qd[t](a);return this.offset+=s,n}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let s=0;s<e;s++)t+=this.readChar();return t}readUtf8(e=1){return Md(this.readBytes(e))}decodeText(e=1,t="utf8"){return Md(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(function(e){return Bd.encode(e)}(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Wd(e){let t=e.length;for(;--t>=0;)e[t]=0}Wd(new Array(576));Wd(new Array(60));Wd(new Array(512));Wd(new Array(256));Wd(new Array(29));Wd(new Array(30));var Vd=(e,t,s,r)=>{let a=65535&e,n=e>>>16&65535,i=0;for(;0!==s;){i=s>2e3?2e3:s,s-=i;do{a=a+t[r++]|0,n=n+a|0}while(--i);a%=65521,n%=65521}return a|n<<16};const Hd=new Uint32Array((()=>{let e,t=[];for(var s=0;s<256;s++){e=s;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[s]=e}return t})());var Gd=(e,t,s,r)=>{const a=Hd,n=r+s;e^=-1;for(let i=r;i<n;i++)e=e>>>8^a[255&(e^t[i])];return-1^e},Jd={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Kd={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Yd=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Zd=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const s=t.shift();if(s){if("object"!=typeof s)throw new TypeError(s+"must be non-object");for(const t in s)Yd(s,t)&&(e[t]=s[t])}}return e},Xd=e=>{let t=0;for(let r=0,a=e.length;r<a;r++)t+=e[r].length;const s=new Uint8Array(t);for(let r=0,a=0,n=e.length;r<n;r++){let t=e[r];s.set(t,a),a+=t.length}return s};let Qd=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Bb){Qd=!1}const ec=new Uint8Array(256);for(let Ub=0;Ub<256;Ub++)ec[Ub]=Ub>=252?6:Ub>=248?5:Ub>=240?4:Ub>=224?3:Ub>=192?2:1;ec[254]=ec[254]=1;var tc=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,s,r,a,n,i=e.length,l=0;for(a=0;a<i;a++)s=e.charCodeAt(a),55296==(64512&s)&&a+1<i&&(r=e.charCodeAt(a+1),56320==(64512&r)&&(s=65536+(s-55296<<10)+(r-56320),a++)),l+=s<128?1:s<2048?2:s<65536?3:4;for(t=new Uint8Array(l),n=0,a=0;n<l;a++)s=e.charCodeAt(a),55296==(64512&s)&&a+1<i&&(r=e.charCodeAt(a+1),56320==(64512&r)&&(s=65536+(s-55296<<10)+(r-56320),a++)),s<128?t[n++]=s:s<2048?(t[n++]=192|s>>>6,t[n++]=128|63&s):s<65536?(t[n++]=224|s>>>12,t[n++]=128|s>>>6&63,t[n++]=128|63&s):(t[n++]=240|s>>>18,t[n++]=128|s>>>12&63,t[n++]=128|s>>>6&63,t[n++]=128|63&s);return t},sc=(e,t)=>{const s=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,a;const n=new Array(2*s);for(a=0,r=0;r<s;){let t=e[r++];if(t<128){n[a++]=t;continue}let i=ec[t];if(i>4)n[a++]=65533,r+=i-1;else{for(t&=2===i?31:3===i?15:7;i>1&&r<s;)t=t<<6|63&e[r++],i--;i>1?n[a++]=65533:t<65536?n[a++]=t:(t-=65536,n[a++]=55296|t>>10&1023,n[a++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Qd)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let s="";for(let r=0;r<t;r++)s+=String.fromCharCode(e[r]);return s})(n,a)},rc=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let s=t-1;for(;s>=0&&128==(192&e[s]);)s--;return s<0||0===s?t:s+ec[e[s]]>t?s:t};var ac=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const nc=16209;var ic=function(e,t){let s,r,a,n,i,l,o,d,c,u,m,h,x,g,f,p,b,y,v,j,N,w,S,k;const C=e.state;s=e.next_in,S=e.input,r=s+(e.avail_in-5),a=e.next_out,k=e.output,n=a-(t-e.avail_out),i=a+(e.avail_out-257),l=C.dmax,o=C.wsize,d=C.whave,c=C.wnext,u=C.window,m=C.hold,h=C.bits,x=C.lencode,g=C.distcode,f=(1<<C.lenbits)-1,p=(1<<C.distbits)-1;e:do{h<15&&(m+=S[s++]<<h,h+=8,m+=S[s++]<<h,h+=8),b=x[m&f];t:for(;;){if(y=b>>>24,m>>>=y,h-=y,y=b>>>16&255,0===y)k[a++]=65535&b;else{if(!(16&y)){if(64&y){if(32&y){C.mode=16191;break e}e.msg="invalid literal/length code",C.mode=nc;break e}b=x[(65535&b)+(m&(1<<y)-1)];continue t}for(v=65535&b,y&=15,y&&(h<y&&(m+=S[s++]<<h,h+=8),v+=m&(1<<y)-1,m>>>=y,h-=y),h<15&&(m+=S[s++]<<h,h+=8,m+=S[s++]<<h,h+=8),b=g[m&p];;){if(y=b>>>24,m>>>=y,h-=y,y=b>>>16&255,16&y){if(j=65535&b,y&=15,h<y&&(m+=S[s++]<<h,h+=8,h<y&&(m+=S[s++]<<h,h+=8)),j+=m&(1<<y)-1,j>l){e.msg="invalid distance too far back",C.mode=nc;break e}if(m>>>=y,h-=y,y=a-n,j>y){if(y=j-y,y>d&&C.sane){e.msg="invalid distance too far back",C.mode=nc;break e}if(N=0,w=u,0===c){if(N+=o-y,y<v){v-=y;do{k[a++]=u[N++]}while(--y);N=a-j,w=k}}else if(c<y){if(N+=o+c-y,y-=c,y<v){v-=y;do{k[a++]=u[N++]}while(--y);if(N=0,c<v){y=c,v-=y;do{k[a++]=u[N++]}while(--y);N=a-j,w=k}}}else if(N+=c-y,y<v){v-=y;do{k[a++]=u[N++]}while(--y);N=a-j,w=k}for(;v>2;)k[a++]=w[N++],k[a++]=w[N++],k[a++]=w[N++],v-=3;v&&(k[a++]=w[N++],v>1&&(k[a++]=w[N++]))}else{N=a-j;do{k[a++]=k[N++],k[a++]=k[N++],k[a++]=k[N++],v-=3}while(v>2);v&&(k[a++]=k[N++],v>1&&(k[a++]=k[N++]))}break}if(64&y){e.msg="invalid distance code",C.mode=nc;break e}b=g[(65535&b)+(m&(1<<y)-1)]}}break}}while(s<r&&a<i);v=h>>3,s-=v,h-=v<<3,m&=(1<<h)-1,e.next_in=s,e.next_out=a,e.avail_in=s<r?r-s+5:5-(s-r),e.avail_out=a<i?i-a+257:257-(a-i),C.hold=m,C.bits=h};const lc=15,oc=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),dc=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),cc=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),uc=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var mc=(e,t,s,r,a,n,i,l)=>{const o=l.bits;let d,c,u,m,h,x,g=0,f=0,p=0,b=0,y=0,v=0,j=0,N=0,w=0,S=0,k=null;const C=new Uint16Array(16),$=new Uint16Array(16);let _,A,P,L=null;for(g=0;g<=lc;g++)C[g]=0;for(f=0;f<r;f++)C[t[s+f]]++;for(y=o,b=lc;b>=1&&0===C[b];b--);if(y>b&&(y=b),0===b)return a[n++]=20971520,a[n++]=20971520,l.bits=1,0;for(p=1;p<b&&0===C[p];p++);for(y<p&&(y=p),N=1,g=1;g<=lc;g++)if(N<<=1,N-=C[g],N<0)return-1;if(N>0&&(0===e||1!==b))return-1;for($[1]=0,g=1;g<lc;g++)$[g+1]=$[g]+C[g];for(f=0;f<r;f++)0!==t[s+f]&&(i[$[t[s+f]]++]=f);if(0===e?(k=L=i,x=20):1===e?(k=oc,L=dc,x=257):(k=cc,L=uc,x=0),S=0,f=0,g=p,h=n,v=y,j=0,u=-1,w=1<<y,m=w-1,1===e&&w>852||2===e&&w>592)return 1;for(;;){_=g-j,i[f]+1<x?(A=0,P=i[f]):i[f]>=x?(A=L[i[f]-x],P=k[i[f]-x]):(A=96,P=0),d=1<<g-j,c=1<<v,p=c;do{c-=d,a[h+(S>>j)+c]=_<<24|A<<16|P}while(0!==c);for(d=1<<g-1;S&d;)d>>=1;if(0!==d?(S&=d-1,S+=d):S=0,f++,0===--C[g]){if(g===b)break;g=t[s+i[f]]}if(g>y&&(S&m)!==u){for(0===j&&(j=y),h+=p,v=g-j,N=1<<v;v+j<b&&(N-=C[v+j],!(N<=0));)v++,N<<=1;if(w+=1<<v,1===e&&w>852||2===e&&w>592)return 1;u=S&m,a[u]=y<<24|v<<16|h-n}}return 0!==S&&(a[h+S]=g-j<<24|64<<16),l.bits=y,0};const{Z_FINISH:hc,Z_BLOCK:xc,Z_TREES:gc,Z_OK:fc,Z_STREAM_END:pc,Z_NEED_DICT:bc,Z_STREAM_ERROR:yc,Z_DATA_ERROR:vc,Z_MEM_ERROR:jc,Z_BUF_ERROR:Nc,Z_DEFLATED:wc}=Kd,Sc=16180,kc=16190,Cc=16191,$c=16192,_c=16194,Ac=16199,Pc=16200,Lc=16206,Ec=16209,Tc=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Ic(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Oc=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Sc||t.mode>16211?1:0},Fc=e=>{if(Oc(e))return yc;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Sc,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,fc},Rc=e=>{if(Oc(e))return yc;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Fc(e)},Dc=(e,t)=>{let s;if(Oc(e))return yc;const r=e.state;return t<0?(s=0,t=-t):(s=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?yc:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=s,r.wbits=t,Rc(e))},Mc=(e,t)=>{if(!e)return yc;const s=new Ic;e.state=s,s.strm=e,s.window=null,s.mode=Sc;const r=Dc(e,t);return r!==fc&&(e.state=null),r};let Bc,Uc,qc=!0;const zc=e=>{if(qc){Bc=new Int32Array(512),Uc=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(mc(1,e.lens,0,288,Bc,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;mc(2,e.lens,0,32,Uc,0,e.work,{bits:5}),qc=!1}e.lencode=Bc,e.lenbits=9,e.distcode=Uc,e.distbits=5},Wc=(e,t,s,r)=>{let a;const n=e.state;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),r>=n.wsize?(n.window.set(t.subarray(s-n.wsize,s),0),n.wnext=0,n.whave=n.wsize):(a=n.wsize-n.wnext,a>r&&(a=r),n.window.set(t.subarray(s-r,s-r+a),n.wnext),(r-=a)?(n.window.set(t.subarray(s-r,s),0),n.wnext=r,n.whave=n.wsize):(n.wnext+=a,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=a))),0};var Vc={inflateReset:Rc,inflateReset2:Dc,inflateResetKeep:Fc,inflateInit:e=>Mc(e,15),inflateInit2:Mc,inflate:(e,t)=>{let s,r,a,n,i,l,o,d,c,u,m,h,x,g,f,p,b,y,v,j,N,w,S=0;const k=new Uint8Array(4);let C,$;const _=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Oc(e)||!e.output||!e.input&&0!==e.avail_in)return yc;s=e.state,s.mode===Cc&&(s.mode=$c),i=e.next_out,a=e.output,o=e.avail_out,n=e.next_in,r=e.input,l=e.avail_in,d=s.hold,c=s.bits,u=l,m=o,w=fc;e:for(;;)switch(s.mode){case Sc:if(0===s.wrap){s.mode=$c;break}for(;c<16;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}if(2&s.wrap&&35615===d){0===s.wbits&&(s.wbits=15),s.check=0,k[0]=255&d,k[1]=d>>>8&255,s.check=Gd(s.check,k,2,0),d=0,c=0,s.mode=16181;break}if(s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",s.mode=Ec;break}if((15&d)!==wc){e.msg="unknown compression method",s.mode=Ec;break}if(d>>>=4,c-=4,N=8+(15&d),0===s.wbits&&(s.wbits=N),N>15||N>s.wbits){e.msg="invalid window size",s.mode=Ec;break}s.dmax=1<<s.wbits,s.flags=0,e.adler=s.check=1,s.mode=512&d?16189:Cc,d=0,c=0;break;case 16181:for(;c<16;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}if(s.flags=d,(255&s.flags)!==wc){e.msg="unknown compression method",s.mode=Ec;break}if(57344&s.flags){e.msg="unknown header flags set",s.mode=Ec;break}s.head&&(s.head.text=d>>8&1),512&s.flags&&4&s.wrap&&(k[0]=255&d,k[1]=d>>>8&255,s.check=Gd(s.check,k,2,0)),d=0,c=0,s.mode=16182;case 16182:for(;c<32;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}s.head&&(s.head.time=d),512&s.flags&&4&s.wrap&&(k[0]=255&d,k[1]=d>>>8&255,k[2]=d>>>16&255,k[3]=d>>>24&255,s.check=Gd(s.check,k,4,0)),d=0,c=0,s.mode=16183;case 16183:for(;c<16;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}s.head&&(s.head.xflags=255&d,s.head.os=d>>8),512&s.flags&&4&s.wrap&&(k[0]=255&d,k[1]=d>>>8&255,s.check=Gd(s.check,k,2,0)),d=0,c=0,s.mode=16184;case 16184:if(1024&s.flags){for(;c<16;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}s.length=d,s.head&&(s.head.extra_len=d),512&s.flags&&4&s.wrap&&(k[0]=255&d,k[1]=d>>>8&255,s.check=Gd(s.check,k,2,0)),d=0,c=0}else s.head&&(s.head.extra=null);s.mode=16185;case 16185:if(1024&s.flags&&(h=s.length,h>l&&(h=l),h&&(s.head&&(N=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Uint8Array(s.head.extra_len)),s.head.extra.set(r.subarray(n,n+h),N)),512&s.flags&&4&s.wrap&&(s.check=Gd(s.check,r,h,n)),l-=h,n+=h,s.length-=h),s.length))break e;s.length=0,s.mode=16186;case 16186:if(2048&s.flags){if(0===l)break e;h=0;do{N=r[n+h++],s.head&&N&&s.length<65536&&(s.head.name+=String.fromCharCode(N))}while(N&&h<l);if(512&s.flags&&4&s.wrap&&(s.check=Gd(s.check,r,h,n)),l-=h,n+=h,N)break e}else s.head&&(s.head.name=null);s.length=0,s.mode=16187;case 16187:if(4096&s.flags){if(0===l)break e;h=0;do{N=r[n+h++],s.head&&N&&s.length<65536&&(s.head.comment+=String.fromCharCode(N))}while(N&&h<l);if(512&s.flags&&4&s.wrap&&(s.check=Gd(s.check,r,h,n)),l-=h,n+=h,N)break e}else s.head&&(s.head.comment=null);s.mode=16188;case 16188:if(512&s.flags){for(;c<16;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}if(4&s.wrap&&d!==(65535&s.check)){e.msg="header crc mismatch",s.mode=Ec;break}d=0,c=0}s.head&&(s.head.hcrc=s.flags>>9&1,s.head.done=!0),e.adler=s.check=0,s.mode=Cc;break;case 16189:for(;c<32;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}e.adler=s.check=Tc(d),d=0,c=0,s.mode=kc;case kc:if(0===s.havedict)return e.next_out=i,e.avail_out=o,e.next_in=n,e.avail_in=l,s.hold=d,s.bits=c,bc;e.adler=s.check=1,s.mode=Cc;case Cc:if(t===xc||t===gc)break e;case $c:if(s.last){d>>>=7&c,c-=7&c,s.mode=Lc;break}for(;c<3;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}switch(s.last=1&d,d>>>=1,c-=1,3&d){case 0:s.mode=16193;break;case 1:if(zc(s),s.mode=Ac,t===gc){d>>>=2,c-=2;break e}break;case 2:s.mode=16196;break;case 3:e.msg="invalid block type",s.mode=Ec}d>>>=2,c-=2;break;case 16193:for(d>>>=7&c,c-=7&c;c<32;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",s.mode=Ec;break}if(s.length=65535&d,d=0,c=0,s.mode=_c,t===gc)break e;case _c:s.mode=16195;case 16195:if(h=s.length,h){if(h>l&&(h=l),h>o&&(h=o),0===h)break e;a.set(r.subarray(n,n+h),i),l-=h,n+=h,o-=h,i+=h,s.length-=h;break}s.mode=Cc;break;case 16196:for(;c<14;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}if(s.nlen=257+(31&d),d>>>=5,c-=5,s.ndist=1+(31&d),d>>>=5,c-=5,s.ncode=4+(15&d),d>>>=4,c-=4,s.nlen>286||s.ndist>30){e.msg="too many length or distance symbols",s.mode=Ec;break}s.have=0,s.mode=16197;case 16197:for(;s.have<s.ncode;){for(;c<3;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}s.lens[_[s.have++]]=7&d,d>>>=3,c-=3}for(;s.have<19;)s.lens[_[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,C={bits:s.lenbits},w=mc(0,s.lens,0,19,s.lencode,0,s.work,C),s.lenbits=C.bits,w){e.msg="invalid code lengths set",s.mode=Ec;break}s.have=0,s.mode=16198;case 16198:for(;s.have<s.nlen+s.ndist;){for(;S=s.lencode[d&(1<<s.lenbits)-1],f=S>>>24,p=S>>>16&255,b=65535&S,!(f<=c);){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}if(b<16)d>>>=f,c-=f,s.lens[s.have++]=b;else{if(16===b){for($=f+2;c<$;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}if(d>>>=f,c-=f,0===s.have){e.msg="invalid bit length repeat",s.mode=Ec;break}N=s.lens[s.have-1],h=3+(3&d),d>>>=2,c-=2}else if(17===b){for($=f+3;c<$;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}d>>>=f,c-=f,N=0,h=3+(7&d),d>>>=3,c-=3}else{for($=f+7;c<$;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}d>>>=f,c-=f,N=0,h=11+(127&d),d>>>=7,c-=7}if(s.have+h>s.nlen+s.ndist){e.msg="invalid bit length repeat",s.mode=Ec;break}for(;h--;)s.lens[s.have++]=N}}if(s.mode===Ec)break;if(0===s.lens[256]){e.msg="invalid code -- missing end-of-block",s.mode=Ec;break}if(s.lenbits=9,C={bits:s.lenbits},w=mc(1,s.lens,0,s.nlen,s.lencode,0,s.work,C),s.lenbits=C.bits,w){e.msg="invalid literal/lengths set",s.mode=Ec;break}if(s.distbits=6,s.distcode=s.distdyn,C={bits:s.distbits},w=mc(2,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,C),s.distbits=C.bits,w){e.msg="invalid distances set",s.mode=Ec;break}if(s.mode=Ac,t===gc)break e;case Ac:s.mode=Pc;case Pc:if(l>=6&&o>=258){e.next_out=i,e.avail_out=o,e.next_in=n,e.avail_in=l,s.hold=d,s.bits=c,ic(e,m),i=e.next_out,a=e.output,o=e.avail_out,n=e.next_in,r=e.input,l=e.avail_in,d=s.hold,c=s.bits,s.mode===Cc&&(s.back=-1);break}for(s.back=0;S=s.lencode[d&(1<<s.lenbits)-1],f=S>>>24,p=S>>>16&255,b=65535&S,!(f<=c);){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}if(p&&!(240&p)){for(y=f,v=p,j=b;S=s.lencode[j+((d&(1<<y+v)-1)>>y)],f=S>>>24,p=S>>>16&255,b=65535&S,!(y+f<=c);){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}d>>>=y,c-=y,s.back+=y}if(d>>>=f,c-=f,s.back+=f,s.length=b,0===p){s.mode=16205;break}if(32&p){s.back=-1,s.mode=Cc;break}if(64&p){e.msg="invalid literal/length code",s.mode=Ec;break}s.extra=15&p,s.mode=16201;case 16201:if(s.extra){for($=s.extra;c<$;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}s.length+=d&(1<<s.extra)-1,d>>>=s.extra,c-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=16202;case 16202:for(;S=s.distcode[d&(1<<s.distbits)-1],f=S>>>24,p=S>>>16&255,b=65535&S,!(f<=c);){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}if(!(240&p)){for(y=f,v=p,j=b;S=s.distcode[j+((d&(1<<y+v)-1)>>y)],f=S>>>24,p=S>>>16&255,b=65535&S,!(y+f<=c);){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}d>>>=y,c-=y,s.back+=y}if(d>>>=f,c-=f,s.back+=f,64&p){e.msg="invalid distance code",s.mode=Ec;break}s.offset=b,s.extra=15&p,s.mode=16203;case 16203:if(s.extra){for($=s.extra;c<$;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}s.offset+=d&(1<<s.extra)-1,d>>>=s.extra,c-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){e.msg="invalid distance too far back",s.mode=Ec;break}s.mode=16204;case 16204:if(0===o)break e;if(h=m-o,s.offset>h){if(h=s.offset-h,h>s.whave&&s.sane){e.msg="invalid distance too far back",s.mode=Ec;break}h>s.wnext?(h-=s.wnext,x=s.wsize-h):x=s.wnext-h,h>s.length&&(h=s.length),g=s.window}else g=a,x=i-s.offset,h=s.length;h>o&&(h=o),o-=h,s.length-=h;do{a[i++]=g[x++]}while(--h);0===s.length&&(s.mode=Pc);break;case 16205:if(0===o)break e;a[i++]=s.length,o--,s.mode=Pc;break;case Lc:if(s.wrap){for(;c<32;){if(0===l)break e;l--,d|=r[n++]<<c,c+=8}if(m-=o,e.total_out+=m,s.total+=m,4&s.wrap&&m&&(e.adler=s.check=s.flags?Gd(s.check,a,m,i-m):Vd(s.check,a,m,i-m)),m=o,4&s.wrap&&(s.flags?d:Tc(d))!==s.check){e.msg="incorrect data check",s.mode=Ec;break}d=0,c=0}s.mode=16207;case 16207:if(s.wrap&&s.flags){for(;c<32;){if(0===l)break e;l--,d+=r[n++]<<c,c+=8}if(4&s.wrap&&d!==(4294967295&s.total)){e.msg="incorrect length check",s.mode=Ec;break}d=0,c=0}s.mode=16208;case 16208:w=pc;break e;case Ec:w=vc;break e;case 16210:return jc;default:return yc}return e.next_out=i,e.avail_out=o,e.next_in=n,e.avail_in=l,s.hold=d,s.bits=c,(s.wsize||m!==e.avail_out&&s.mode<Ec&&(s.mode<Lc||t!==hc))&&Wc(e,e.output,e.next_out,m-e.avail_out),u-=e.avail_in,m-=e.avail_out,e.total_in+=u,e.total_out+=m,s.total+=m,4&s.wrap&&m&&(e.adler=s.check=s.flags?Gd(s.check,a,m,e.next_out-m):Vd(s.check,a,m,e.next_out-m)),e.data_type=s.bits+(s.last?64:0)+(s.mode===Cc?128:0)+(s.mode===Ac||s.mode===_c?256:0),(0===u&&0===m||t===hc)&&w===fc&&(w=Nc),w},inflateEnd:e=>{if(Oc(e))return yc;let t=e.state;return t.window&&(t.window=null),e.state=null,fc},inflateGetHeader:(e,t)=>{if(Oc(e))return yc;const s=e.state;return 2&s.wrap?(s.head=t,t.done=!1,fc):yc},inflateSetDictionary:(e,t)=>{const s=t.length;let r,a,n;return Oc(e)?yc:(r=e.state,0!==r.wrap&&r.mode!==kc?yc:r.mode===kc&&(a=1,a=Vd(a,t,s,0),a!==r.check)?vc:(n=Wc(e,t,s,s),n?(r.mode=16210,jc):(r.havedict=1,fc)))},inflateInfo:"pako inflate (from Nodeca project)"};var Hc=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Gc=Object.prototype.toString,{Z_NO_FLUSH:Jc,Z_FINISH:Kc,Z_OK:Yc,Z_STREAM_END:Zc,Z_NEED_DICT:Xc,Z_STREAM_ERROR:Qc,Z_DATA_ERROR:eu,Z_MEM_ERROR:tu}=Kd;function su(e){this.options=Zd({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ac,this.strm.avail_out=0;let s=Vc.inflateInit2(this.strm,t.windowBits);if(s!==Yc)throw new Error(Jd[s]);if(this.header=new Hc,Vc.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=tc(t.dictionary):"[object ArrayBuffer]"===Gc.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(s=Vc.inflateSetDictionary(this.strm,t.dictionary),s!==Yc)))throw new Error(Jd[s])}su.prototype.push=function(e,t){const s=this.strm,r=this.options.chunkSize,a=this.options.dictionary;let n,i,l;if(this.ended)return!1;for(i=t===~~t?t:!0===t?Kc:Jc,"[object ArrayBuffer]"===Gc.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;;){for(0===s.avail_out&&(s.output=new Uint8Array(r),s.next_out=0,s.avail_out=r),n=Vc.inflate(s,i),n===Xc&&a&&(n=Vc.inflateSetDictionary(s,a),n===Yc?n=Vc.inflate(s,i):n===eu&&(n=Xc));s.avail_in>0&&n===Zc&&s.state.wrap>0&&0!==e[s.next_in];)Vc.inflateReset(s),n=Vc.inflate(s,i);switch(n){case Qc:case eu:case Xc:case tu:return this.onEnd(n),this.ended=!0,!1}if(l=s.avail_out,s.next_out&&(0===s.avail_out||n===Zc))if("string"===this.options.to){let e=rc(s.output,s.next_out),t=s.next_out-e,a=sc(s.output,e);s.next_out=t,s.avail_out=r-t,t&&s.output.set(s.output.subarray(e,e+t),0),this.onData(a)}else this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out));if(n!==Yc||0!==l){if(n===Zc)return n=Vc.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(0===s.avail_in)break}}return!0},su.prototype.onData=function(e){this.chunks.push(e)},su.prototype.onEnd=function(e){e===Yc&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Xd(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ru=function(e,t){const s=new su(t);if(s.push(e),s.err)throw s.msg||Jd[s.err];return s.result},au={Inflate:su,inflate:ru};const{Inflate:nu,inflate:iu}=au;var lu=nu,ou=iu;const du=[];for(let Ub=0;Ub<256;Ub++){let e=Ub;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;du[Ub]=e}const cu=4294967295;function uu(e,t){return(function(e,t,s){let r=e;for(let a=0;a<s;a++)r=du[255&(r^t[a])]^r>>>8;return r}(cu,e,t)^cu)>>>0}function mu(e,t,s){const r=e.readUint32(),a=uu(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(a!==r)throw new Error(`CRC mismatch for chunk ${s}. Expected ${r}, found ${a}`)}function hu(e,t,s){for(let r=0;r<s;r++)t[r]=e[r]}function xu(e,t,s,r){let a=0;for(;a<r;a++)t[a]=e[a];for(;a<s;a++)t[a]=e[a]+t[a-r]&255}function gu(e,t,s,r){let a=0;if(0===s.length)for(;a<r;a++)t[a]=e[a];else for(;a<r;a++)t[a]=e[a]+s[a]&255}function fu(e,t,s,r,a){let n=0;if(0===s.length){for(;n<a;n++)t[n]=e[n];for(;n<r;n++)t[n]=e[n]+(t[n-a]>>1)&255}else{for(;n<a;n++)t[n]=e[n]+(s[n]>>1)&255;for(;n<r;n++)t[n]=e[n]+(t[n-a]+s[n]>>1)&255}}function pu(e,t,s,r,a){let n=0;if(0===s.length){for(;n<a;n++)t[n]=e[n];for(;n<r;n++)t[n]=e[n]+t[n-a]&255}else{for(;n<a;n++)t[n]=e[n]+s[n]&255;for(;n<r;n++)t[n]=e[n]+bu(t[n-a],s[n],s[n-a])&255}}function bu(e,t,s){const r=e+t-s,a=Math.abs(r-e),n=Math.abs(r-t),i=Math.abs(r-s);return a<=n&&a<=i?e:n<=i?t:s}function yu(e,t,s,r,a,n){switch(e){case 0:hu(t,s,a);break;case 1:xu(t,s,a,n);break;case 2:gu(t,s,r,a);break;case 3:fu(t,s,r,a,n);break;case 4:pu(t,s,r,a,n);break;default:throw new Error(`Unsupported filter: ${e}`)}}const vu=new Uint16Array([255]),ju=255===new Uint8Array(vu.buffer)[0];function Nu(e){return(255&e)<<8|e>>8&255}const wu=new Uint16Array([255]),Su=255===new Uint8Array(wu.buffer)[0],ku=new Uint8Array(0);function Cu(e){const{data:t,width:s,height:r,channels:a,depth:n}=e,i=Math.ceil(n/8)*a,l=Math.ceil(n/8*a*s),o=new Uint8Array(r*l);let d,c,u=ku,m=0;for(let h=0;h<r;h++){switch(d=t.subarray(m+1,m+1+l),c=o.subarray(h*l,(h+1)*l),t[m]){case 0:hu(d,c,l);break;case 1:xu(d,c,l,i);break;case 2:gu(d,c,u,l);break;case 3:fu(d,c,u,l,i);break;case 4:pu(d,c,u,l,i);break;default:throw new Error(`Unsupported filter: ${t[m]}`)}u=c,m+=l+1}if(16===n){const e=new Uint16Array(o.buffer);if(Su)for(let t=0;t<e.length;t++)e[t]=$u(e[t]);return e}return o}function $u(e){return(255&e)<<8|e>>8&255}const _u=Uint8Array.of(137,80,78,71,13,10,26,10);function Au(e){if(!function(e){if(e.length<_u.length)return!1;for(let t=0;t<_u.length;t++)if(e[t]!==_u[t])return!1;return!0}(e.readBytes(_u.length)))throw new Error("wrong PNG signature")}const Pu=new TextDecoder("latin1");function Lu(e){if(function(e){if(!Eu.test(e))throw new Error("invalid latin1 text")}(e),0===e.length||e.length>79)throw new Error("keyword length must be between 1 and 79")}const Eu=/^[\u0000-\u00FF]*$/;function Tu(e,t,s){const r=Iu(t);e[r]=function(e,t){return Pu.decode(e.readBytes(t))}(t,s-r.length-1)}function Iu(e){for(e.mark();0!==e.readByte(););const t=e.offset;e.reset();const s=Pu.decode(e.readBytes(t-e.offset-1));return e.skip(1),Lu(s),s}const Ou=-1,Fu=0,Ru=2,Du=3,Mu=4,Bu=6,Uu=-1,qu=0,zu=-1,Wu=0,Vu=-1,Hu=0,Gu=1,Ju=0,Ku=1,Yu=2,Zu=0,Xu=1;class Qu extends zd{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,t={}){super(e);const{checkCrc:s=!1}=t;this._checkCrc=s,this._inflator=new lu,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Uu,this._filterMethod=zu,this._interlaceMethod=Vu,this._colorType=Ou,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Au(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(Au(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const s=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case"tEXt":Tu(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e)}if(this.offset-s!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?mu(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const s=this.offset;switch("fdAT"!==t&&"IDAT"!==t&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=s+e}if(this.offset-s!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?mu(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=function(e){if(1!==e&&2!==e&&4!==e&&8!==e&&16!==e)throw new Error(`invalid bit depth: ${e}`);return e}(this.readUint8());const t=this.readUint8();let s;switch(this._colorType=t,t){case Fu:s=1;break;case Ru:s=3;break;case Du:s=1;break;case Mu:s=2;break;case Bu:s=4;break;default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==qu)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!=0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const t=e/3;this._hasPalette=!0;const s=[];this._palette=s;for(let r=0;r<t;r++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,s=this.offset+this.byteOffset;if(s+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,s,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Fu:case Ru:if(e%2!=0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break;case Du:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let t=0;for(;t<e;t++){const e=this.readByte();this._palette[t].push(e)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const t=Iu(this),s=this.readUint8();if(s!==qu)throw new Error(`Unsupported iCCP compression method: ${s}`);const r=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:ou(r)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),s=this.readByte();this._png.resolution={x:e,y:t,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:8===this._apng.depth?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(e);if(s){if(s.data=Cu({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),0===e||0===s.xOffset&&0===s.yOffset&&s.width===this._png.width&&s.height===this._png.height)t.data=s.data;else{const r=this._apng.frames.at(e-1);this.disposeFrame(s,r,t),this.addFrameDataToCanvas(t,s)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,s){switch(e.disposeOp){case Ju:break;case Ku:for(let t=0;t<this._png.height;t++)for(let r=0;r<this._png.width;r++){const a=(t*e.width+r)*this._png.channels;for(let e=0;e<this._png.channels;e++)s.data[a+e]=0}break;case Yu:s.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const s=1<<this._png.depth,r=(e,s)=>({index:((e+t.yOffset)*this._png.width+t.xOffset+s)*this._png.channels,frameIndex:(e*t.width+s)*this._png.channels});switch(t.blendOp){case Zu:for(let s=0;s<t.height;s++)for(let a=0;a<t.width;a++){const{index:n,frameIndex:i}=r(s,a);for(let s=0;s<this._png.channels;s++)e.data[n+s]=t.data[i+s]}break;case Xu:for(let a=0;a<t.height;a++)for(let n=0;n<t.width;n++){const{index:i,frameIndex:l}=r(a,n);for(let r=0;r<this._png.channels;r++){const a=t.data[l+this._png.channels-1]/s,n=r%(this._png.channels-1)==0?1:t.data[l+r],o=Math.floor(a*n+(1-a)*e.data[i+r]);e.data[i+r]+=o}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Wu)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Hu)this._png.data=Cu({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else{if(this._interlaceMethod!==Gu)throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._png.data=function(e){const{data:t,width:s,height:r,channels:a,depth:n}=e,i=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(n/8)*a,o=new Uint8Array(r*s*l);let d=0;for(let c=0;c<7;c++){const e=i[c],a=Math.ceil((s-e.x)/e.xStep),n=Math.ceil((r-e.y)/e.yStep);if(a<=0||n<=0)continue;const u=a*l,m=new Uint8Array(u);for(let i=0;i<n;i++){const n=t[d++],c=t.subarray(d,d+u);d+=u;const h=new Uint8Array(u);yu(n,c,h,m,u,l),m.set(h);for(let t=0;t<a;t++){const a=e.x+t*e.xStep,n=e.y+i*e.yStep;if(!(a>=s||n>=r))for(let e=0;e<l;e++)o[(n*s+a)*l+e]=h[t*l+e]}}}if(16===n){const e=new Uint16Array(o.buffer);if(ju)for(let t=0;t<e.length;t++)e[t]=Nu(e[t]);return e}return o}({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth})}this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Ju,blendOp:Zu,data:e}),this._inflator=new lu,this._writingDataChunks=!1}}var em,tm;(tm=em||(em={}))[tm.UNKNOWN=0]="UNKNOWN",tm[tm.METRE=1]="METRE";var sm=function(){return"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this}();function rm(){sm.console&&"function"==typeof sm.console.log&&sm.console.log.apply(sm.console,arguments)}var am={log:rm,warn:function(e){sm.console&&("function"==typeof sm.console.warn?sm.console.warn.apply(sm.console,arguments):rm.call(null,arguments))},error:function(e){sm.console&&("function"==typeof sm.console.error?sm.console.error.apply(sm.console,arguments):rm(e))}};function nm(e,t,s){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){om(r.response,t,s)},r.onerror=function(){am.error("could not download file")},r.send()}function im(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(s){}return t.status>=200&&t.status<=299}function lm(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(s){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var om=sm.saveAs||("object"!==("undefined"==typeof window?"undefined":td(window))||window!==sm?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(e,t,s){var r=sm.URL||sm.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener","string"==typeof e?(a.href=e,a.origin!==location.origin?im(a.href)?nm(e,t,s):lm(a,a.target="_blank"):lm(a)):(a.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(a.href)},4e4),setTimeout(function(){lm(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,s){if(t=t||e.name||"download","string"==typeof e)if(im(e))nm(e,t,s);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){lm(r)})}else navigator.msSaveOrOpenBlob((a=e,void 0===(n=s)?n={autoBom:!1}:"object"!==td(n)&&(am.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob([String.fromCharCode(65279),a],{type:a.type}):a),t);var a,n}:function(e,t,s,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return nm(e,t,s);var a="application/octet-stream"===e.type,n=/constructor/i.test(sm.HTMLElement)||sm.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||a&&n)&&"object"===("undefined"==typeof FileReader?"undefined":td(FileReader))){var l=new FileReader;l.onloadend=function(){var e=l.result;e=i?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},l.readAsDataURL(e)}else{var o=sm.URL||sm.webkitURL,d=o.createObjectURL(e);r?r.location=d:location.href=d,r=null,setTimeout(function(){o.revokeObjectURL(d)},4e4)}});
/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function dm(e){var t;e=e||"",this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var s=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],r=0;r<s.length;r++){var a=s[r].re,n=s[r].process,i=a.exec(e);i&&(t=n(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),s=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==s.length&&(s="0"+s),"#"+e+t+s}}var cm=sm.atob.bind(sm),um=sm.btoa.bind(sm);
/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function mm(e,t){var s=e[0],r=e[1],a=e[2],n=e[3];s=xm(s,r,a,n,t[0],7,-680876936),n=xm(n,s,r,a,t[1],12,-389564586),a=xm(a,n,s,r,t[2],17,606105819),r=xm(r,a,n,s,t[3],22,-1044525330),s=xm(s,r,a,n,t[4],7,-176418897),n=xm(n,s,r,a,t[5],12,1200080426),a=xm(a,n,s,r,t[6],17,-1473231341),r=xm(r,a,n,s,t[7],22,-45705983),s=xm(s,r,a,n,t[8],7,1770035416),n=xm(n,s,r,a,t[9],12,-1958414417),a=xm(a,n,s,r,t[10],17,-42063),r=xm(r,a,n,s,t[11],22,-1990404162),s=xm(s,r,a,n,t[12],7,1804603682),n=xm(n,s,r,a,t[13],12,-40341101),a=xm(a,n,s,r,t[14],17,-1502002290),s=gm(s,r=xm(r,a,n,s,t[15],22,1236535329),a,n,t[1],5,-165796510),n=gm(n,s,r,a,t[6],9,-1069501632),a=gm(a,n,s,r,t[11],14,643717713),r=gm(r,a,n,s,t[0],20,-373897302),s=gm(s,r,a,n,t[5],5,-701558691),n=gm(n,s,r,a,t[10],9,38016083),a=gm(a,n,s,r,t[15],14,-660478335),r=gm(r,a,n,s,t[4],20,-405537848),s=gm(s,r,a,n,t[9],5,568446438),n=gm(n,s,r,a,t[14],9,-1019803690),a=gm(a,n,s,r,t[3],14,-187363961),r=gm(r,a,n,s,t[8],20,1163531501),s=gm(s,r,a,n,t[13],5,-1444681467),n=gm(n,s,r,a,t[2],9,-51403784),a=gm(a,n,s,r,t[7],14,1735328473),s=fm(s,r=gm(r,a,n,s,t[12],20,-1926607734),a,n,t[5],4,-378558),n=fm(n,s,r,a,t[8],11,-2022574463),a=fm(a,n,s,r,t[11],16,1839030562),r=fm(r,a,n,s,t[14],23,-35309556),s=fm(s,r,a,n,t[1],4,-1530992060),n=fm(n,s,r,a,t[4],11,1272893353),a=fm(a,n,s,r,t[7],16,-155497632),r=fm(r,a,n,s,t[10],23,-1094730640),s=fm(s,r,a,n,t[13],4,681279174),n=fm(n,s,r,a,t[0],11,-358537222),a=fm(a,n,s,r,t[3],16,-722521979),r=fm(r,a,n,s,t[6],23,76029189),s=fm(s,r,a,n,t[9],4,-640364487),n=fm(n,s,r,a,t[12],11,-421815835),a=fm(a,n,s,r,t[15],16,530742520),s=pm(s,r=fm(r,a,n,s,t[2],23,-995338651),a,n,t[0],6,-198630844),n=pm(n,s,r,a,t[7],10,1126891415),a=pm(a,n,s,r,t[14],15,-1416354905),r=pm(r,a,n,s,t[5],21,-57434055),s=pm(s,r,a,n,t[12],6,1700485571),n=pm(n,s,r,a,t[3],10,-1894986606),a=pm(a,n,s,r,t[10],15,-1051523),r=pm(r,a,n,s,t[1],21,-2054922799),s=pm(s,r,a,n,t[8],6,1873313359),n=pm(n,s,r,a,t[15],10,-30611744),a=pm(a,n,s,r,t[6],15,-1560198380),r=pm(r,a,n,s,t[13],21,1309151649),s=pm(s,r,a,n,t[4],6,-145523070),n=pm(n,s,r,a,t[11],10,-1120210379),a=pm(a,n,s,r,t[2],15,718787259),r=pm(r,a,n,s,t[9],21,-343485551),e[0]=km(s,e[0]),e[1]=km(r,e[1]),e[2]=km(a,e[2]),e[3]=km(n,e[3])}function hm(e,t,s,r,a,n){return t=km(km(t,e),km(r,n)),km(t<<a|t>>>32-a,s)}function xm(e,t,s,r,a,n,i){return hm(t&s|~t&r,e,t,a,n,i)}function gm(e,t,s,r,a,n,i){return hm(t&r|s&~r,e,t,a,n,i)}function fm(e,t,s,r,a,n,i){return hm(t^s^r,e,t,a,n,i)}function pm(e,t,s,r,a,n,i){return hm(s^(t|~r),e,t,a,n,i)}function bm(e){var t,s=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)mm(r,ym(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(mm(r,a),t=0;t<16;t++)a[t]=0;return a[14]=8*s,mm(r,a),r}function ym(e){var t,s=[];for(t=0;t<64;t+=4)s[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return s}var vm="0123456789abcdef".split("");function jm(e){for(var t="",s=0;s<4;s++)t+=vm[e>>8*s+4&15]+vm[e>>8*s&15];return t}function Nm(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function wm(e){return bm(e).map(Nm).join("")}var Sm="5d41402abc4b2a76b9719d911017c592"!=function(e){for(var t=0;t<e.length;t++)e[t]=jm(e[t]);return e.join("")}(bm("hello"));function km(e,t){if(Sm){var s=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(s>>16)<<16|65535&s}return e+t&4294967295}
/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Cm(e,t){var s,r,a,n;if(e!==s){for(var i=(a=e,n=1+(256/e.length|0),new Array(n+1).join(a)),l=[],o=0;o<256;o++)l[o]=o;var d=0;for(o=0;o<256;o++){var c=l[o];d=(d+c+i.charCodeAt(o))%256,l[o]=l[d],l[d]=c}s=e,r=l}else l=r;var u=t.length,m=0,h=0,x="";for(o=0;o<u;o++)h=(h+(c=l[m=(m+1)%256]))%256,l[m]=l[h],l[h]=c,i=l[(l[m]+l[h])%256],x+=String.fromCharCode(t.charCodeAt(o)^i);return x}
/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var $m={print:4,modify:8,copy:16,"annot-forms":32};function _m(e,t,s,r){this.v=1,this.r=2;var a=192;e.forEach(function(e){if(void 0!==$m.perm)throw new Error("Invalid permission: "+e);a+=$m[e]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var n=(t+this.padding).substr(0,32),i=(s+this.padding).substr(0,32);this.O=this.processOwnerPassword(n,i),this.P=-(1+(255^a)),this.encryptionKey=wm(n+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Cm(this.encryptionKey,this.padding)}function Am(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",s=e.length,r=0;r<s;r++){var a=e.charCodeAt(r);t+=a<33||35===a||37===a||40===a||41===a||47===a||60===a||62===a||91===a||93===a||123===a||125===a||a>126?"#"+("0"+a.toString(16)).slice(-2):e[r]}return t}function Pm(e){if("object"!==td(e))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,s,r){if(r=r||!1,"string"!=typeof e||"function"!=typeof s||"boolean"!=typeof r)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var a=Math.random().toString(35);return t[e][a]=[s,!!r],a},this.unsubscribe=function(e){for(var s in t)if(t[s][e])return delete t[s][e],0===Object.keys(t[s]).length&&delete t[s],!0;return!1},this.publish=function(s){if(t.hasOwnProperty(s)){var r=Array.prototype.slice.call(arguments,1),a=[];for(var n in t[s]){var i=t[s][n];try{i[0].apply(e,r)}catch(l){sm.console&&am.error("jsPDF PubSub Error",l.message,l)}i[1]&&a.push(n)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Lm(e){if(!(this instanceof Lm))return new Lm(e);var t="opacity,stroke-opacity".split(",");for(var s in e)e.hasOwnProperty(s)&&t.indexOf(s)>=0&&(this[s]=e[s]);this.id="",this.objectNumber=-1}function Em(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Tm(e,t,s,r,a){if(!(this instanceof Tm))return new Tm(e,t,s,r,a);this.type="axial"===e?2:3,this.coords=t,this.colors=s,Em.call(this,r,a)}function Im(e,t,s,r,a){if(!(this instanceof Im))return new Im(e,t,s,r,a);this.boundingBox=e,this.xStep=t,this.yStep=s,this.stream="",this.cloneIndex=0,Em.call(this,r,a)}function Om(e){var t,s="string"==typeof arguments[0]?arguments[0]:"p",r=arguments[1],a=arguments[2],n=arguments[3],i=[],l=1,o=16,d="S",c=null;"object"===td(e=e||{})&&(s=e.orientation,r=e.unit||r,a=e.format||a,n=e.compress||e.compressPdf||n,null!==(c=e.encryption||null)&&(c.userPassword=c.userPassword||"",c.ownerPassword=c.ownerPassword||"",c.userPermissions=c.userPermissions||[]),l="number"==typeof e.userUnit?Math.abs(e.userUnit):1,void 0!==e.precision&&(t=e.precision),void 0!==e.floatPrecision&&(o=e.floatPrecision),d=e.defaultPathOperation||"S"),i=e.filters||(!0===n?["FlateEncode"]:i),r=r||"mm",s=(""+(s||"P")).toLowerCase();var u=e.putOnlyUsedFonts||!1,m={},h={internal:{},__private__:{}};h.__private__.PubSub=Pm;var x="1.3",g=h.__private__.getPdfVersion=function(){return x};h.__private__.setPdfVersion=function(e){x=e};var f={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return f};var p=h.__private__.getPageFormat=function(e){return f[e]};a=a||"a4";var b="compat",y="advanced",v=b;function j(){this.saveGraphicsState(),Z(new Le(me,0,0,-me,0,ms()*me).toString()+" cm"),this.setFontSize(this.getFontSize()/me),d="n",v=y}function N(){this.restoreGraphicsState(),d="S",v=b}var w=h.__private__.combineFontStyleAndFontWeight=function(e,t){if("bold"==e&&"normal"==t||"bold"==e&&400==t||"normal"==e&&"italic"==t||"bold"==e&&"italic"==t)throw new Error("Invalid Combination of fontweight and fontstyle");return t&&(e=400==t||"normal"===t?"italic"===e?"italic":"normal":700!=t&&"bold"!==t||"normal"!==e?(700==t?"bold":t)+""+e:"bold"),e};h.advancedAPI=function(e){var t=v===b;return t&&j.call(this),"function"!=typeof e||(e(this),t&&N.call(this)),this},h.compatAPI=function(e){var t=v===y;return t&&N.call(this),"function"!=typeof e||(e(this),t&&j.call(this)),this},h.isAdvancedAPI=function(){return v===y};var S,k=function(e){if(v!==y)throw new Error(e+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},C=h.roundToPrecision=h.__private__.roundToPrecision=function(e,s){var r=t||s;if(isNaN(e)||isNaN(r))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return e.toFixed(r).replace(/0+$/,"")};S=h.hpf=h.__private__.hpf="number"==typeof o?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return C(e,o)}:"smart"===o?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return C(e,e>-1&&e<1?16:5)}:function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return C(e,16)};var $=h.f2=h.__private__.f2=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return C(e,2)},_=h.__private__.f3=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f3");return C(e,3)},A=h.scale=h.__private__.scale=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.scale");return v===b?e*me:v===y?e:void 0},P=function(e){return A((t=e,v===b?ms()-t:v===y?t:void 0));var t};h.__private__.setPrecision=h.setPrecision=function(e){"number"==typeof parseInt(e,10)&&(t=parseInt(e,10))};var L,E="00000000000000000000000000000000",T=h.__private__.getFileId=function(){return E},I=h.__private__.setFileId=function(e){return E=void 0!==e&&/^[a-fA-F0-9]{32}$/.test(e)?e.toUpperCase():E.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==c&&(bt=new _m(c.userPermissions,c.userPassword,c.ownerPassword,E)),E};h.setFileId=function(e){return I(e),this},h.getFileId=function(){return T()};var O=h.__private__.convertDateToPDFDate=function(e){var t=e.getTimezoneOffset(),s=t<0?"+":"-",r=Math.floor(Math.abs(t/60)),a=Math.abs(t%60),n=[s,B(r),"'",B(a),"'"].join("");return["D:",e.getFullYear(),B(e.getMonth()+1),B(e.getDate()),B(e.getHours()),B(e.getMinutes()),B(e.getSeconds()),n].join("")},F=h.__private__.convertPDFDateToDate=function(e){var t=parseInt(e.substr(2,4),10),s=parseInt(e.substr(6,2),10)-1,r=parseInt(e.substr(8,2),10),a=parseInt(e.substr(10,2),10),n=parseInt(e.substr(12,2),10),i=parseInt(e.substr(14,2),10);return new Date(t,s,r,a,n,i,0)},R=h.__private__.setCreationDate=function(e){var t;if(void 0===e&&(e=new Date),e instanceof Date)t=O(e);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(e))throw new Error("Invalid argument passed to jsPDF.setCreationDate");t=e}return L=t},D=h.__private__.getCreationDate=function(e){var t=L;return"jsDate"===e&&(t=F(L)),t};h.setCreationDate=function(e){return R(e),this},h.getCreationDate=function(e){return D(e)};var M,B=h.__private__.padd2=function(e){return("0"+parseInt(e)).slice(-2)},U=h.__private__.padd2Hex=function(e){return("00"+(e=e.toString())).substr(e.length)},q=0,z=[],W=[],V=0,H=[],G=[],J=!1,K=W;h.__private__.setCustomOutputDestination=function(e){J=!0,K=e};var Y=function(e){J||(K=e)};h.__private__.resetCustomOutputDestination=function(){J=!1,K=W};var Z=h.__private__.out=function(e){return e=e.toString(),V+=e.length+1,K.push(e),K},X=h.__private__.write=function(e){return Z(1===arguments.length?e.toString():Array.prototype.join.call(arguments," "))},Q=h.__private__.getArrayBuffer=function(e){for(var t=e.length,s=new ArrayBuffer(t),r=new Uint8Array(s);t--;)r[t]=e.charCodeAt(t);return s},ee=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return ee};var te=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(e){return te=v===y?e/me:e,this};var se,re=h.__private__.getFontSize=h.getFontSize=function(){return v===b?te:te*me},ae=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(e){return ae=e,this},h.__private__.getR2L=h.getR2L=function(){return ae};var ne,ie=h.__private__.setZoomMode=function(e){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(e))se=e;else if(isNaN(e)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(e))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+e+'" is not recognized.');se=e}else se=parseInt(e,10)};h.__private__.getZoomMode=function(){return se};var le,oe=h.__private__.setPageMode=function(e){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(e))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+e+'" is not recognized.');ne=e};h.__private__.getPageMode=function(){return ne};var de=h.__private__.setLayoutMode=function(e){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(e))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+e+'" is not recognized.');le=e};h.__private__.getLayoutMode=function(){return le},h.__private__.setDisplayMode=h.setDisplayMode=function(e,t,s){return ie(e),de(t),oe(s),this};var ce={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(e){if(-1===Object.keys(ce).indexOf(e))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ce[e]},h.__private__.getDocumentProperties=function(){return ce},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(e){for(var t in ce)ce.hasOwnProperty(t)&&e[t]&&(ce[t]=e[t]);return this},h.__private__.setDocumentProperty=function(e,t){if(-1===Object.keys(ce).indexOf(e))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ce[e]=t};var ue,me,he,xe,ge,fe={},pe={},be=[],ye={},ve={},je={},Ne={},we=null,Se=0,ke=[],Ce=new Pm(h),$e=e.hotfixes||[],_e={},Ae={},Pe=[],Le=function e(t,s,r,a,n,i){if(!(this instanceof e))return new e(t,s,r,a,n,i);isNaN(t)&&(t=1),isNaN(s)&&(s=0),isNaN(r)&&(r=0),isNaN(a)&&(a=1),isNaN(n)&&(n=0),isNaN(i)&&(i=0),this._matrix=[t,s,r,a,n,i]};Object.defineProperty(Le.prototype,"sx",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(Le.prototype,"shy",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(Le.prototype,"shx",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(Le.prototype,"sy",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(Le.prototype,"tx",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(Le.prototype,"ty",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(Le.prototype,"a",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(Le.prototype,"b",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(Le.prototype,"c",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(Le.prototype,"d",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(Le.prototype,"e",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(Le.prototype,"f",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(Le.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Le.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Le.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Le.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),Le.prototype.join=function(e){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(S).join(e)},Le.prototype.multiply=function(e){var t=e.sx*this.sx+e.shy*this.shx,s=e.sx*this.shy+e.shy*this.sy,r=e.shx*this.sx+e.sy*this.shx,a=e.shx*this.shy+e.sy*this.sy,n=e.tx*this.sx+e.ty*this.shx+this.tx,i=e.tx*this.shy+e.ty*this.sy+this.ty;return new Le(t,s,r,a,n,i)},Le.prototype.decompose=function(){var e=this.sx,t=this.shy,s=this.shx,r=this.sy,a=this.tx,n=this.ty,i=Math.sqrt(e*e+t*t),l=(e/=i)*s+(t/=i)*r;s-=e*l,r-=t*l;var o=Math.sqrt(s*s+r*r);return l/=o,e*(r/=o)<t*(s/=o)&&(e=-e,t=-t,l=-l,i=-i),{scale:new Le(i,0,0,o,0,0),translate:new Le(1,0,0,1,a,n),rotate:new Le(e,t,-t,e,0,0),skew:new Le(1,0,l,1,0,0)}},Le.prototype.toString=function(e){return this.join(" ")},Le.prototype.inversed=function(){var e=this.sx,t=this.shy,s=this.shx,r=this.sy,a=this.tx,n=this.ty,i=1/(e*r-t*s),l=r*i,o=-t*i,d=-s*i,c=e*i;return new Le(l,o,d,c,-l*a-d*n,-o*a-c*n)},Le.prototype.applyToPoint=function(e){var t=e.x*this.sx+e.y*this.shx+this.tx,s=e.x*this.shy+e.y*this.sy+this.ty;return new ts(t,s)},Le.prototype.applyToRectangle=function(e){var t=this.applyToPoint(e),s=this.applyToPoint(new ts(e.x+e.w,e.y+e.h));return new ss(t.x,t.y,s.x-t.x,s.y-t.y)},Le.prototype.clone=function(){var e=this.sx,t=this.shy,s=this.shx,r=this.sy,a=this.tx,n=this.ty;return new Le(e,t,s,r,a,n)},h.Matrix=Le;var Ee=h.matrixMult=function(e,t){return t.multiply(e)},Te=new Le(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Te;var Ie=function(e,t){if(!ve[e]){var s=(t instanceof Tm?"Sh":"P")+(Object.keys(ye).length+1).toString(10);t.id=s,ve[e]=s,ye[s]=t,Ce.publish("addPattern",t)}};h.ShadingPattern=Tm,h.TilingPattern=Im,h.addShadingPattern=function(e,t){return k("addShadingPattern()"),Ie(e,t),this},h.beginTilingPattern=function(e){k("beginTilingPattern()"),as(e.boundingBox[0],e.boundingBox[1],e.boundingBox[2]-e.boundingBox[0],e.boundingBox[3]-e.boundingBox[1],e.matrix)},h.endTilingPattern=function(e,t){k("endTilingPattern()"),t.stream=G[M].join("\n"),Ie(e,t),Ce.publish("endTilingPattern",t),Pe.pop().restore()};var Oe,Fe=h.__private__.newObject=function(){var e=Re();return De(e,!0),e},Re=h.__private__.newObjectDeferred=function(){return q++,z[q]=function(){return V},q},De=function(e,t){return t="boolean"==typeof t&&t,z[e]=V,t&&Z(e+" 0 obj"),e},Me=h.__private__.newAdditionalObject=function(){var e={objId:Re(),content:""};return H.push(e),e},Be=Re(),Ue=Re(),qe=h.__private__.decodeColorString=function(e){var t=e.split(" ");if(2!==t.length||"g"!==t[1]&&"G"!==t[1])5!==t.length||"k"!==t[4]&&"K"!==t[4]||(t=[(1-t[0])*(1-t[3]),(1-t[1])*(1-t[3]),(1-t[2])*(1-t[3]),"r"]);else{var s=parseFloat(t[0]);t=[s,s,s,"r"]}for(var r="#",a=0;a<3;a++)r+=("0"+Math.floor(255*parseFloat(t[a])).toString(16)).slice(-2);return r},ze=h.__private__.encodeColorString=function(e){var t;"string"==typeof e&&(e={ch1:e});var s=e.ch1,r=e.ch2,a=e.ch3,n=e.ch4,i="draw"===e.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof s&&"#"!==s.charAt(0)){var l=new dm(s);if(l.ok)s=l.toHex();else if(!/^\d*\.?\d*$/.test(s))throw new Error('Invalid color "'+s+'" passed to jsPDF.encodeColorString.')}if("string"==typeof s&&/^#[0-9A-Fa-f]{3}$/.test(s)&&(s="#"+s[1]+s[1]+s[2]+s[2]+s[3]+s[3]),"string"==typeof s&&/^#[0-9A-Fa-f]{6}$/.test(s)){var o=parseInt(s.substr(1),16);s=o>>16&255,r=o>>8&255,a=255&o}if(void 0===r||void 0===n&&s===r&&r===a)t="string"==typeof s?s+" "+i[0]:2===e.precision?$(s/255)+" "+i[0]:_(s/255)+" "+i[0];else if(void 0===n||"object"===td(n)){if(n&&!isNaN(n.a)&&0===n.a)return["1.","1.","1.",i[1]].join(" ");t="string"==typeof s?[s,r,a,i[1]].join(" "):2===e.precision?[$(s/255),$(r/255),$(a/255),i[1]].join(" "):[_(s/255),_(r/255),_(a/255),i[1]].join(" ")}else t="string"==typeof s?[s,r,a,n,i[2]].join(" "):2===e.precision?[$(s),$(r),$(a),$(n),i[2]].join(" "):[_(s),_(r),_(a),_(n),i[2]].join(" ");return t},We=h.__private__.getFilters=function(){return i},Ve=h.__private__.putStream=function(e){var t=(e=e||{}).data||"",s=e.filters||We(),r=e.alreadyAppliedFilters||[],a=e.addLength1||!1,n=t.length,i=e.objectId,l=function(e){return e};if(null!==c&&void 0===i)throw new Error("ObjectId must be passed to putStream for file encryption");null!==c&&(l=bt.encryptor(i,0));var o={};!0===s&&(s=["FlateEncode"]);var d=e.additionalKeyValues||[],u=(o=void 0!==Om.API.processDataByFilters?Om.API.processDataByFilters(t,s):{data:t,reverseChain:[]}).reverseChain+(Array.isArray(r)?r.join(" "):r.toString());if(0!==o.data.length&&(d.push({key:"Length",value:o.data.length}),!0===a&&d.push({key:"Length1",value:n})),0!=u.length)if(u.split("/").length-1==1)d.push({key:"Filter",value:u});else{d.push({key:"Filter",value:"["+u+"]"});for(var m=0;m<d.length;m+=1)if("DecodeParms"===d[m].key){for(var h=[],x=0;x<o.reverseChain.split("/").length-1;x+=1)h.push("null");h.push(d[m].value),d[m].value="["+h.join(" ")+"]"}}Z("<<");for(var g=0;g<d.length;g++)Z("/"+d[g].key+" "+d[g].value);Z(">>"),0!==o.data.length&&(Z("stream"),Z(l(o.data)),Z("endstream"))},He=h.__private__.putPage=function(e){var t=e.number,s=e.data,r=e.objId,a=e.contentsObjId;De(r,!0),Z("<</Type /Page"),Z("/Parent "+e.rootDictionaryObjId+" 0 R"),Z("/Resources "+e.resourceDictionaryObjId+" 0 R"),Z("/MediaBox ["+parseFloat(S(e.mediaBox.bottomLeftX))+" "+parseFloat(S(e.mediaBox.bottomLeftY))+" "+S(e.mediaBox.topRightX)+" "+S(e.mediaBox.topRightY)+"]"),null!==e.cropBox&&Z("/CropBox ["+S(e.cropBox.bottomLeftX)+" "+S(e.cropBox.bottomLeftY)+" "+S(e.cropBox.topRightX)+" "+S(e.cropBox.topRightY)+"]"),null!==e.bleedBox&&Z("/BleedBox ["+S(e.bleedBox.bottomLeftX)+" "+S(e.bleedBox.bottomLeftY)+" "+S(e.bleedBox.topRightX)+" "+S(e.bleedBox.topRightY)+"]"),null!==e.trimBox&&Z("/TrimBox ["+S(e.trimBox.bottomLeftX)+" "+S(e.trimBox.bottomLeftY)+" "+S(e.trimBox.topRightX)+" "+S(e.trimBox.topRightY)+"]"),null!==e.artBox&&Z("/ArtBox ["+S(e.artBox.bottomLeftX)+" "+S(e.artBox.bottomLeftY)+" "+S(e.artBox.topRightX)+" "+S(e.artBox.topRightY)+"]"),"number"==typeof e.userUnit&&1!==e.userUnit&&Z("/UserUnit "+e.userUnit),Ce.publish("putPage",{objId:r,pageContext:ke[t],pageNumber:t,page:s}),Z("/Contents "+a+" 0 R"),Z(">>"),Z("endobj");var n=s.join("\n");return v===y&&(n+="\nQ"),De(a,!0),Ve({data:n,filters:We(),objectId:a}),Z("endobj"),r},Ge=h.__private__.putPages=function(){var e,t,s=[];for(e=1;e<=Se;e++)ke[e].objId=Re(),ke[e].contentsObjId=Re();for(e=1;e<=Se;e++)s.push(He({number:e,data:G[e],objId:ke[e].objId,contentsObjId:ke[e].contentsObjId,mediaBox:ke[e].mediaBox,cropBox:ke[e].cropBox,bleedBox:ke[e].bleedBox,trimBox:ke[e].trimBox,artBox:ke[e].artBox,userUnit:ke[e].userUnit,rootDictionaryObjId:Be,resourceDictionaryObjId:Ue}));De(Be,!0),Z("<</Type /Pages");var r="/Kids [";for(t=0;t<Se;t++)r+=s[t]+" 0 R ";Z(r+"]"),Z("/Count "+Se),Z(">>"),Z("endobj"),Ce.publish("postPutPages")},Je=function(e){Ce.publish("putFont",{font:e,out:Z,newObject:Fe,putStream:Ve}),!0!==e.isAlreadyPutted&&(e.objectNumber=Fe(),Z("<<"),Z("/Type /Font"),Z("/BaseFont /"+Am(e.postScriptName)),Z("/Subtype /Type1"),"string"==typeof e.encoding&&Z("/Encoding /"+e.encoding),Z("/FirstChar 32"),Z("/LastChar 255"),Z(">>"),Z("endobj"))},Ke=function(e){e.objectNumber=Fe();var t=[];t.push({key:"Type",value:"/XObject"}),t.push({key:"Subtype",value:"/Form"}),t.push({key:"BBox",value:"["+[S(e.x),S(e.y),S(e.x+e.width),S(e.y+e.height)].join(" ")+"]"}),t.push({key:"Matrix",value:"["+e.matrix.toString()+"]"});var s=e.pages[1].join("\n");Ve({data:s,additionalKeyValues:t,objectId:e.objectNumber}),Z("endobj")},Ye=function(e,t){t||(t=21);var s=Fe(),r=function(e,t){var s,r=[],a=1/(t-1);for(s=0;s<1;s+=a)r.push(s);if(r.push(1),0!=e[0].offset){var n={offset:0,color:e[0].color};e.unshift(n)}if(1!=e[e.length-1].offset){var i={offset:1,color:e[e.length-1].color};e.push(i)}for(var l="",o=0,d=0;d<r.length;d++){for(s=r[d];s>e[o+1].offset;)o++;var c=e[o].offset,u=(s-c)/(e[o+1].offset-c),m=e[o].color,h=e[o+1].color;l+=U(Math.round((1-u)*m[0]+u*h[0]).toString(16))+U(Math.round((1-u)*m[1]+u*h[1]).toString(16))+U(Math.round((1-u)*m[2]+u*h[2]).toString(16))}return l.trim()}(e.colors,t),a=[];a.push({key:"FunctionType",value:"0"}),a.push({key:"Domain",value:"[0.0 1.0]"}),a.push({key:"Size",value:"["+t+"]"}),a.push({key:"BitsPerSample",value:"8"}),a.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),a.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ve({data:r,additionalKeyValues:a,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:s}),Z("endobj"),e.objectNumber=Fe(),Z("<< /ShadingType "+e.type),Z("/ColorSpace /DeviceRGB");var n="/Coords ["+S(parseFloat(e.coords[0]))+" "+S(parseFloat(e.coords[1]))+" ";2===e.type?n+=S(parseFloat(e.coords[2]))+" "+S(parseFloat(e.coords[3])):n+=S(parseFloat(e.coords[2]))+" "+S(parseFloat(e.coords[3]))+" "+S(parseFloat(e.coords[4]))+" "+S(parseFloat(e.coords[5])),Z(n+="]"),e.matrix&&Z("/Matrix ["+e.matrix.toString()+"]"),Z("/Function "+s+" 0 R"),Z("/Extend [true true]"),Z(">>"),Z("endobj")},Ze=function(e,t){var s=Re(),r=Fe();t.push({resourcesOid:s,objectOid:r}),e.objectNumber=r;var a=[];a.push({key:"Type",value:"/Pattern"}),a.push({key:"PatternType",value:"1"}),a.push({key:"PaintType",value:"1"}),a.push({key:"TilingType",value:"1"}),a.push({key:"BBox",value:"["+e.boundingBox.map(S).join(" ")+"]"}),a.push({key:"XStep",value:S(e.xStep)}),a.push({key:"YStep",value:S(e.yStep)}),a.push({key:"Resources",value:s+" 0 R"}),e.matrix&&a.push({key:"Matrix",value:"["+e.matrix.toString()+"]"}),Ve({data:e.stream,additionalKeyValues:a,objectId:e.objectNumber}),Z("endobj")},Xe=function(e){for(var t in e.objectNumber=Fe(),Z("<<"),e)switch(t){case"opacity":Z("/ca "+$(e[t]));break;case"stroke-opacity":Z("/CA "+$(e[t]))}Z(">>"),Z("endobj")},Qe=function(e){De(e.resourcesOid,!0),Z("<<"),Z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var e in Z("/Font <<"),fe)fe.hasOwnProperty(e)&&(!1===u||!0===u&&m.hasOwnProperty(e))&&Z("/"+e+" "+fe[e].objectNumber+" 0 R");Z(">>")}(),function(){if(Object.keys(ye).length>0){for(var e in Z("/Shading <<"),ye)ye.hasOwnProperty(e)&&ye[e]instanceof Tm&&ye[e].objectNumber>=0&&Z("/"+e+" "+ye[e].objectNumber+" 0 R");Ce.publish("putShadingPatternDict"),Z(">>")}}(),function(e){if(Object.keys(ye).length>0){for(var t in Z("/Pattern <<"),ye)ye.hasOwnProperty(t)&&ye[t]instanceof h.TilingPattern&&ye[t].objectNumber>=0&&ye[t].objectNumber<e&&Z("/"+t+" "+ye[t].objectNumber+" 0 R");Ce.publish("putTilingPatternDict"),Z(">>")}}(e.objectOid),function(){if(Object.keys(je).length>0){var e;for(e in Z("/ExtGState <<"),je)je.hasOwnProperty(e)&&je[e].objectNumber>=0&&Z("/"+e+" "+je[e].objectNumber+" 0 R");Ce.publish("putGStateDict"),Z(">>")}}(),function(){for(var e in Z("/XObject <<"),_e)_e.hasOwnProperty(e)&&_e[e].objectNumber>=0&&Z("/"+e+" "+_e[e].objectNumber+" 0 R");Ce.publish("putXobjectDict"),Z(">>")}(),Z(">>"),Z("endobj")},et=function(e){pe[e.fontName]=pe[e.fontName]||{},pe[e.fontName][e.fontStyle]=e.id},tt=function(e,t,s,r,a){var n={id:"F"+(Object.keys(fe).length+1).toString(10),postScriptName:e,fontName:t,fontStyle:s,encoding:r,isStandardFont:a||!1,metadata:{}};return Ce.publish("addFont",{font:n,instance:this}),fe[n.id]=n,et(n),n.id},st=h.__private__.pdfEscape=h.pdfEscape=function(e,t){return function(e,t){var s,r,a,n,i,l,o,d,c;if(a=(t=t||{}).sourceEncoding||"Unicode",i=t.outputEncoding,(t.autoencode||i)&&fe[ue].metadata&&fe[ue].metadata[a]&&fe[ue].metadata[a].encoding&&(n=fe[ue].metadata[a].encoding,!i&&fe[ue].encoding&&(i=fe[ue].encoding),!i&&n.codePages&&(i=n.codePages[0]),"string"==typeof i&&(i=n[i]),i)){for(o=!1,l=[],s=0,r=e.length;s<r;s++)(d=i[e.charCodeAt(s)])?l.push(String.fromCharCode(d)):l.push(e[s]),l[s].charCodeAt(0)>>8&&(o=!0);e=l.join("")}for(s=e.length;void 0===o&&0!==s;)e.charCodeAt(s-1)>>8&&(o=!0),s--;if(!o)return e;for(l=t.noBOM?[]:[254,255],s=0,r=e.length;s<r;s++){if((c=(d=e.charCodeAt(s))>>8)>>8)throw new Error("Character at position "+s+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");l.push(c),l.push(d-(c<<8))}return String.fromCharCode.apply(void 0,l)}(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},rt=h.__private__.beginPage=function(e){G[++Se]=[],ke[Se]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(e[0]),topRightY:Number(e[1])}},it(Se),Y(G[M])},at=function(e,t){var r,n,i;switch(s=t||s,"string"==typeof e&&(r=p(e.toLowerCase()),Array.isArray(r)&&(n=r[0],i=r[1])),Array.isArray(e)&&(n=e[0]*me,i=e[1]*me),isNaN(n)&&(n=a[0],i=a[1]),(n>14400||i>14400)&&(am.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),n=Math.min(14400,n),i=Math.min(14400,i)),a=[n,i],s.substr(0,1)){case"l":i>n&&(a=[i,n]);break;case"p":n>i&&(a=[i,n])}rt(a),Dt(Ft),Z(Ht),0!==Xt&&Z(Xt+" J"),0!==Qt&&Z(Qt+" j"),Ce.publish("addPage",{pageNumber:Se})},nt=function(e){e>0&&e<=Se&&(G.splice(e,1),ke.splice(e,1),Se--,M>Se&&(M=Se),this.setPage(M))},it=function(e){e>0&&e<=Se&&(M=e)},lt=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return G.length-1},ot=function(e,t,s){var r,a=void 0;return s=s||{},e=void 0!==e?e:fe[ue].fontName,t=void 0!==t?t:fe[ue].fontStyle,r=e.toLowerCase(),void 0!==pe[r]&&void 0!==pe[r][t]?a=pe[r][t]:void 0!==pe[e]&&void 0!==pe[e][t]?a=pe[e][t]:!1===s.disableWarning&&am.warn("Unable to look up font label for font '"+e+"', '"+t+"'. Refer to getFontList() for available fonts."),a||s.noFallback||null==(a=pe.times[t])&&(a=pe.times.normal),a},dt=h.__private__.putInfo=function(){var e=Fe(),t=function(e){return e};for(var s in null!==c&&(t=bt.encryptor(e,0)),Z("<<"),Z("/Producer ("+st(t("jsPDF "+Om.version))+")"),ce)ce.hasOwnProperty(s)&&ce[s]&&Z("/"+s.substr(0,1).toUpperCase()+s.substr(1)+" ("+st(t(ce[s]))+")");Z("/CreationDate ("+st(t(L))+")"),Z(">>"),Z("endobj")},ct=h.__private__.putCatalog=function(e){var t=(e=e||{}).rootDictionaryObjId||Be;switch(Fe(),Z("<<"),Z("/Type /Catalog"),Z("/Pages "+t+" 0 R"),se||(se="fullwidth"),se){case"fullwidth":Z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Z("/OpenAction [3 0 R /Fit]");break;case"original":Z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var s=""+se;"%"===s.substr(s.length-1)&&(se=parseInt(se)/100),"number"==typeof se&&Z("/OpenAction [3 0 R /XYZ null null "+$(se)+"]")}switch(le||(le="continuous"),le){case"continuous":Z("/PageLayout /OneColumn");break;case"single":Z("/PageLayout /SinglePage");break;case"two":case"twoleft":Z("/PageLayout /TwoColumnLeft");break;case"tworight":Z("/PageLayout /TwoColumnRight")}ne&&Z("/PageMode /"+ne),Ce.publish("putCatalog"),Z(">>"),Z("endobj")},ut=h.__private__.putTrailer=function(){Z("trailer"),Z("<<"),Z("/Size "+(q+1)),Z("/Root "+q+" 0 R"),Z("/Info "+(q-1)+" 0 R"),null!==c&&Z("/Encrypt "+bt.oid+" 0 R"),Z("/ID [ <"+E+"> <"+E+"> ]"),Z(">>")},mt=h.__private__.putHeader=function(){Z("%PDF-"+x),Z("%ºß¬à")},ht=h.__private__.putXRef=function(){var e="0000000000";Z("xref"),Z("0 "+(q+1)),Z("0000000000 65535 f ");for(var t=1;t<=q;t++)"function"==typeof z[t]?Z((e+z[t]()).slice(-10)+" 00000 n "):void 0!==z[t]?Z((e+z[t]).slice(-10)+" 00000 n "):Z("0000000000 00000 n ")},xt=h.__private__.buildDocument=function(){var e;q=0,V=0,W=[],z=[],H=[],Be=Re(),Ue=Re(),Y(W),Ce.publish("buildDocument"),mt(),Ge(),function(){Ce.publish("putAdditionalObjects");for(var e=0;e<H.length;e++){var t=H[e];De(t.objId,!0),Z(t.content),Z("endobj")}Ce.publish("postPutAdditionalObjects")}(),e=[],function(){for(var e in fe)fe.hasOwnProperty(e)&&(!1===u||!0===u&&m.hasOwnProperty(e))&&Je(fe[e])}(),function(){var e;for(e in je)je.hasOwnProperty(e)&&Xe(je[e])}(),function(){for(var e in _e)_e.hasOwnProperty(e)&&Ke(_e[e])}(),function(e){var t;for(t in ye)ye.hasOwnProperty(t)&&(ye[t]instanceof Tm?Ye(ye[t]):ye[t]instanceof Im&&Ze(ye[t],e))}(e),Ce.publish("putResources"),e.forEach(Qe),Qe({resourcesOid:Ue,objectOid:Number.MAX_SAFE_INTEGER}),Ce.publish("postPutResources"),null!==c&&(bt.oid=Fe(),Z("<<"),Z("/Filter /Standard"),Z("/V "+bt.v),Z("/R "+bt.r),Z("/U <"+bt.toHexString(bt.U)+">"),Z("/O <"+bt.toHexString(bt.O)+">"),Z("/P "+bt.P),Z(">>"),Z("endobj")),dt(),ct();var t=V;return ht(),ut(),Z("startxref"),Z(""+t),Z("%%EOF"),Y(G[M]),W.join("\n")},gt=h.__private__.getBlob=function(e){return new Blob([Q(e)],{type:"application/pdf"})},ft=h.output=h.__private__.output=((Oe=function(e,t){switch("string"==typeof(t=t||{})?t={filename:t}:t.filename=t.filename||"generated.pdf",e){case void 0:return xt();case"save":h.save(t.filename);break;case"arraybuffer":return Q(xt());case"blob":return gt(xt());case"bloburi":case"bloburl":if(void 0!==sm.URL&&"function"==typeof sm.URL.createObjectURL)return sm.URL&&sm.URL.createObjectURL(gt(xt()))||void 0;am.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var s="",r=xt();try{s=um(r)}catch(x){s=um(unescape(encodeURIComponent(r)))}return"data:application/pdf;filename="+t.filename+";base64,"+s;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(sm)){var a="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",n=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';t.pdfObjectUrl&&(a=t.pdfObjectUrl,n="");var i='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+a+'"'+n+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(t)+");<\/script></body></html>",l=sm.open();return null!==l&&l.document.write(i),l}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(sm)){var o='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(t.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+t.filename+'" width="500px" height="400px" /></body></html>',d=sm.open();if(null!==d){d.document.write(o);var c=this;d.document.documentElement.querySelector("#pdfViewer").onload=function(){d.document.title=t.filename,d.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(c.output("bloburl"))}}return d}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(sm))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var u='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",t)+'"></iframe></body></html>',m=sm.open();if(null!==m&&(m.document.write(u),m.document.title=t.filename),m||"undefined"==typeof safari)return m;break;case"datauri":case"dataurl":return sm.document.location.href=this.output("datauristring",t);default:return null}}).foo=function(){try{return Oe.apply(this,arguments)}catch(s){var e=s.stack||"";~e.indexOf(" at ")&&(e=e.split(" at ")[1]);var t="Error in function "+e.split("\n")[0].split("<")[0]+": "+s.message;if(!sm.console)throw new Error(t);sm.console.error(t,s),sm.alert&&alert(t)}},Oe.foo.bar=Oe,Oe.foo),pt=function(e){return!0===Array.isArray($e)&&$e.indexOf(e)>-1};switch(r){case"pt":me=1;break;case"mm":me=72/25.4;break;case"cm":me=72/2.54;break;case"in":me=72;break;case"px":me=1==pt("px_scaling")?.75:96/72;break;case"pc":case"em":me=12;break;case"ex":me=6;break;default:if("number"!=typeof r)throw new Error("Invalid unit: "+r);me=r}var bt=null;R(),I();var yt=h.__private__.getPageInfo=h.getPageInfo=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ke[e].objId,pageNumber:e,pageContext:ke[e]}},vt=h.__private__.getPageInfoByObjId=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var t in ke)if(ke[t].objId===e)break;return yt(t)},jt=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:ke[M].objId,pageNumber:M,pageContext:ke[M]}};h.addPage=function(){return at.apply(this,arguments),this},h.setPage=function(){return it.apply(this,arguments),Y.call(this,G[M]),this},h.insertPage=function(e){return this.addPage(),this.movePage(M,e),this},h.movePage=function(e,t){var s,r;if(e>t){s=G[e],r=ke[e];for(var a=e;a>t;a--)G[a]=G[a-1],ke[a]=ke[a-1];G[t]=s,ke[t]=r,this.setPage(t)}else if(e<t){s=G[e],r=ke[e];for(var n=e;n<t;n++)G[n]=G[n+1],ke[n]=ke[n+1];G[t]=s,ke[t]=r,this.setPage(t)}return this},h.deletePage=function(){return nt.apply(this,arguments),this},h.__private__.text=h.text=function(e,t,s,r,a){var n,i,l,o,d,c,u,h,x,g=(r=r||{}).scope||this;if("number"==typeof e&&"number"==typeof t&&("string"==typeof s||Array.isArray(s))){var f=s;s=t,t=e,e=f}if(arguments[3]instanceof Le==0?(l=arguments[4],o=arguments[5],"object"===td(u=arguments[3])&&null!==u||("string"==typeof l&&(o=l,l=null),"string"==typeof u&&(o=u,u=null),"number"==typeof u&&(l=u,u=null),r={flags:u,angle:l,align:o})):(k("The transform parameter of text() with a Matrix value"),x=a),isNaN(t)||isNaN(s)||null==e)throw new Error("Invalid arguments passed to jsPDF.text");if(0===e.length)return g;var p,b="",j="number"==typeof r.lineHeightFactor?r.lineHeightFactor:Ot,N=g.internal.scaleFactor;function w(e){return e=e.split("\t").join(Array(r.TabLen||9).join(" ")),st(e,u)}function C(e){for(var t,s=e.concat(),r=[],a=s.length;a--;)"string"==typeof(t=s.shift())?r.push(t):Array.isArray(e)&&(1===t.length||void 0===t[1]&&void 0===t[2])?r.push(t[0]):r.push([t[0],t[1],t[2]]);return r}function $(e,t){var s;if("string"==typeof e)s=t(e)[0];else if(Array.isArray(e)){for(var r,a,n=e.concat(),i=[],l=n.length;l--;)"string"==typeof(r=n.shift())?i.push(t(r)[0]):Array.isArray(r)&&"string"==typeof r[0]&&(a=t(r[0],r[1],r[2]),i.push([a[0],a[1],a[2]]));s=i}return s}var _=!1,P=!0;if("string"==typeof e)_=!0;else if(Array.isArray(e)){var L=e.concat();i=[];for(var E,T=L.length;T--;)("string"!=typeof(E=L.shift())||Array.isArray(E)&&"string"!=typeof E[0])&&(P=!1);_=P}if(!1===_)throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.');"string"==typeof e&&(e=e.match(/[\r?\n]/)?e.split(/\r\n|\r|\n/g):[e]);var I=te/g.internal.scaleFactor,O=I*(j-1);switch(r.baseline){case"bottom":s-=O;break;case"top":s+=I-O;break;case"hanging":s+=I-2*O;break;case"middle":s+=I/2-O}if((c=r.maxWidth||0)>0&&("string"==typeof e?e=g.splitTextToSize(e,c):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(g.splitTextToSize(t,c))},[]))),n={text:e,x:t,y:s,options:r,mutex:{pdfEscape:st,activeFontKey:ue,fonts:fe,activeFontSize:te}},Ce.publish("preProcessText",n),e=n.text,l=(r=n.options).angle,x instanceof Le==0&&l&&"number"==typeof l){l*=Math.PI/180,0===r.rotationDirection&&(l=-l),v===y&&(l=-l);var F=Math.cos(l),R=Math.sin(l);x=new Le(F,R,-R,F,0,0)}else l&&l instanceof Le&&(x=l);v!==y||x||(x=Te),void 0!==(d=r.charSpace||Yt)&&(b+=S(A(d))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(h=r.horizontalScale)&&(b+=S(100*h)+" Tz\n"),r.lang;var D=-1,M=void 0!==r.renderingMode?r.renderingMode:r.stroke,B=g.internal.getCurrentPageInfo().pageContext;switch(M){case 0:case!1:case"fill":D=0;break;case 1:case!0:case"stroke":D=1;break;case 2:case"fillThenStroke":D=2;break;case 3:case"invisible":D=3;break;case 4:case"fillAndAddForClipping":D=4;break;case 5:case"strokeAndAddPathForClipping":D=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":D=6;break;case 7:case"addToPathForClipping":D=7}var U=void 0!==B.usedRenderingMode?B.usedRenderingMode:-1;-1!==D?b+=D+" Tr\n":-1!==U&&(b+="0 Tr\n"),-1!==D&&(B.usedRenderingMode=D),o=r.align||"left";var q,z=te*j,W=g.internal.pageSize.getWidth(),V=fe[ue];d=r.charSpace||Yt,c=r.maxWidth||0,u=Object.assign({autoencode:!0,noBOM:!0},r.flags);var H=[],G=function(e){return g.getStringUnitWidth(e,{font:V,charSpace:d,fontSize:te,doKerning:!1})*te/N};if("[object Array]"===Object.prototype.toString.call(e)){var J;i=C(e),"left"!==o&&(q=i.map(G));var K,Y=0;if("right"===o){t-=q[0],e=[],T=i.length;for(var X=0;X<T;X++)0===X?(K=qt(t),J=zt(s)):(K=A(Y-q[X]),J=-z),e.push([i[X],K,J]),Y=q[X]}else if("center"===o){t-=q[0]/2,e=[],T=i.length;for(var Q=0;Q<T;Q++)0===Q?(K=qt(t),J=zt(s)):(K=A((Y-q[Q])/2),J=-z),e.push([i[Q],K,J]),Y=q[Q]}else if("left"===o){e=[],T=i.length;for(var ee=0;ee<T;ee++)e.push(i[ee])}else if("justify"===o&&"Identity-H"===V.encoding){e=[],T=i.length,c=0!==c?c:W;for(var se=0,re=0;re<T;re++)if(J=0===re?zt(s):-z,K=0===re?qt(t):se,re<T-1){var ne=A((c-q[re])/(i[re].split(" ").length-1)),ie=i[re].split(" ");e.push([ie[0]+" ",K,J]),se=0;for(var le=1;le<ie.length;le++){var oe=(G(ie[le-1]+" "+ie[le])-G(ie[le]))*N+ne;le==ie.length-1?e.push([ie[le],oe,0]):e.push([ie[le]+" ",oe,0]),se-=oe}}else e.push([i[re],K,J]);e.push(["",se,0])}else{if("justify"!==o)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(e=[],T=i.length,c=0!==c?c:W,re=0;re<T;re++){J=0===re?zt(s):-z,K=0===re?qt(t):0;var de=i[re].split(" ").length-1,ce=de>0?(c-q[re])/de:0;re<T-1?H.push(S(A(ce))):H.push(0),e.push([i[re],K,J])}}}!0===("boolean"==typeof r.R2L?r.R2L:ae)&&(e=$(e,function(e,t,s){return[e.split("").reverse().join(""),t,s]})),n={text:e,x:t,y:s,options:r,mutex:{pdfEscape:st,activeFontKey:ue,fonts:fe,activeFontSize:te}},Ce.publish("postProcessText",n),e=n.text,p=n.mutex.isHex||!1;var me=fe[ue].encoding;"WinAnsiEncoding"!==me&&"StandardEncoding"!==me||(e=$(e,function(e,t,s){return[w(e),t,s]})),i=C(e),e=[];for(var he,xe,ge,pe=Array.isArray(i[0])?1:0,be="",ye=function(e,t,s){var a="";return s instanceof Le?(s="number"==typeof r.angle?Ee(s,new Le(1,0,0,1,e,t)):Ee(new Le(1,0,0,1,e,t),s),v===y&&(s=Ee(new Le(1,0,0,-1,0,0),s)),a=s.join(" ")+" Tm\n"):a=S(e)+" "+S(t)+" Td\n",a},ve=0;ve<i.length;ve++){switch(be="",pe){case 1:ge=(p?"<":"(")+i[ve][0]+(p?">":")"),he=parseFloat(i[ve][1]),xe=parseFloat(i[ve][2]);break;case 0:ge=(p?"<":"(")+i[ve]+(p?">":")"),he=qt(t),xe=zt(s)}void 0!==H&&void 0!==H[ve]&&(be=H[ve]+" Tw\n"),0===ve?e.push(be+ye(he,xe,x)+ge):0===pe?e.push(be+ge):1===pe&&e.push(be+ye(he,xe,x)+ge)}e=0===pe?e.join(" Tj\nT* "):e.join(" Tj\n"),e+=" Tj\n";var je="BT\n/";return je+=ue+" "+te+" Tf\n",je+=S(te*j)+" TL\n",je+=Jt+"\n",je+=b,je+=e,Z(je+="ET"),m[ue]=!0,g};var Nt=h.__private__.clip=h.clip=function(e){return Z("evenodd"===e?"W*":"W"),this};h.clipEvenOdd=function(){return Nt("evenodd")},h.__private__.discardPath=h.discardPath=function(){return Z("n"),this};var wt=h.__private__.isValidStyle=function(e){var t=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(e)&&(t=!0),t};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(e){return wt(e)&&(d=e),this};var St=h.__private__.getStyle=h.getStyle=function(e){var t=d;switch(e){case"D":case"S":t="S";break;case"F":t="f";break;case"FD":case"DF":t="B";break;case"f":case"f*":case"B":case"B*":t=e}return t},kt=h.close=function(){return Z("h"),this};h.stroke=function(){return Z("S"),this},h.fill=function(e){return Ct("f",e),this},h.fillEvenOdd=function(e){return Ct("f*",e),this},h.fillStroke=function(e){return Ct("B",e),this},h.fillStrokeEvenOdd=function(e){return Ct("B*",e),this};var Ct=function(e,t){"object"===td(t)?At(t,e):Z(e)},$t=function(e){null===e||v===y&&void 0===e||(e=St(e),Z(e))};function _t(e,t,s,r,a){var n=new Im(t||this.boundingBox,s||this.xStep,r||this.yStep,this.gState,a||this.matrix);n.stream=this.stream;var i=e+"$$"+this.cloneIndex+++"$$";return Ie(i,n),n}var At=function(e,t){var s=ve[e.key],r=ye[s];if(r instanceof Tm)Z("q"),Z(Pt(t)),r.gState&&h.setGState(r.gState),Z(e.matrix.toString()+" cm"),Z("/"+s+" sh"),Z("Q");else if(r instanceof Im){var a=new Le(1,0,0,-1,0,ms());e.matrix&&(a=a.multiply(e.matrix||Te),s=_t.call(r,e.key,e.boundingBox,e.xStep,e.yStep,a).id),Z("q"),Z("/Pattern cs"),Z("/"+s+" scn"),r.gState&&h.setGState(r.gState),Z(t),Z("Q")}},Pt=function(e){switch(e){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Lt=h.moveTo=function(e,t){return Z(S(A(e))+" "+S(P(t))+" m"),this},Et=h.lineTo=function(e,t){return Z(S(A(e))+" "+S(P(t))+" l"),this},Tt=h.curveTo=function(e,t,s,r,a,n){return Z([S(A(e)),S(P(t)),S(A(s)),S(P(r)),S(A(a)),S(P(n)),"c"].join(" ")),this};h.__private__.line=h.line=function(e,t,s,r,a){if(isNaN(e)||isNaN(t)||isNaN(s)||isNaN(r)||!wt(a))throw new Error("Invalid arguments passed to jsPDF.line");return v===b?this.lines([[s-e,r-t]],e,t,[1,1],a||"S"):this.lines([[s-e,r-t]],e,t,[1,1]).stroke()},h.__private__.lines=h.lines=function(e,t,s,r,a,n){var i,l,o,d,c,u,m,h,x,g,f,p;if("number"==typeof e&&(p=s,s=t,t=e,e=p),r=r||[1,1],n=n||!1,isNaN(t)||isNaN(s)||!Array.isArray(e)||!Array.isArray(r)||!wt(a)||"boolean"!=typeof n)throw new Error("Invalid arguments passed to jsPDF.lines");for(Lt(t,s),i=r[0],l=r[1],d=e.length,g=t,f=s,o=0;o<d;o++)2===(c=e[o]).length?(g=c[0]*i+g,f=c[1]*l+f,Et(g,f)):(u=c[0]*i+g,m=c[1]*l+f,h=c[2]*i+g,x=c[3]*l+f,g=c[4]*i+g,f=c[5]*l+f,Tt(u,m,h,x,g,f));return n&&kt(),$t(a),this},h.path=function(e){for(var t=0;t<e.length;t++){var s=e[t],r=s.c;switch(s.op){case"m":Lt(r[0],r[1]);break;case"l":Et(r[0],r[1]);break;case"c":Tt.apply(this,r);break;case"h":kt()}}return this},h.__private__.rect=h.rect=function(e,t,s,r,a){if(isNaN(e)||isNaN(t)||isNaN(s)||isNaN(r)||!wt(a))throw new Error("Invalid arguments passed to jsPDF.rect");return v===b&&(r=-r),Z([S(A(e)),S(P(t)),S(A(s)),S(A(r)),"re"].join(" ")),$t(a),this},h.__private__.triangle=h.triangle=function(e,t,s,r,a,n,i){if(isNaN(e)||isNaN(t)||isNaN(s)||isNaN(r)||isNaN(a)||isNaN(n)||!wt(i))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[s-e,r-t],[a-s,n-r],[e-a,t-n]],e,t,[1,1],i,!0),this},h.__private__.roundedRect=h.roundedRect=function(e,t,s,r,a,n,i){if(isNaN(e)||isNaN(t)||isNaN(s)||isNaN(r)||isNaN(a)||isNaN(n)||!wt(i))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var l=4/3*(Math.SQRT2-1);return a=Math.min(a,.5*s),n=Math.min(n,.5*r),this.lines([[s-2*a,0],[a*l,0,a,n-n*l,a,n],[0,r-2*n],[0,n*l,-a*l,n,-a,n],[2*a-s,0],[-a*l,0,-a,-n*l,-a,-n],[0,2*n-r],[0,-n*l,a*l,-n,a,-n]],e+a,t,[1,1],i,!0),this},h.__private__.ellipse=h.ellipse=function(e,t,s,r,a){if(isNaN(e)||isNaN(t)||isNaN(s)||isNaN(r)||!wt(a))throw new Error("Invalid arguments passed to jsPDF.ellipse");var n=4/3*(Math.SQRT2-1)*s,i=4/3*(Math.SQRT2-1)*r;return Lt(e+s,t),Tt(e+s,t-i,e+n,t-r,e,t-r),Tt(e-n,t-r,e-s,t-i,e-s,t),Tt(e-s,t+i,e-n,t+r,e,t+r),Tt(e+n,t+r,e+s,t+i,e+s,t),$t(a),this},h.__private__.circle=h.circle=function(e,t,s,r){if(isNaN(e)||isNaN(t)||isNaN(s)||!wt(r))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(e,t,s,s,r)},h.setFont=function(e,t,s){return s&&(t=w(t,s)),ue=ot(e,t,{disableWarning:!1}),this};var It=h.__private__.getFont=h.getFont=function(){return fe[ot.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var e,t,s={};for(e in pe)if(pe.hasOwnProperty(e))for(t in s[e]=[],pe[e])pe[e].hasOwnProperty(t)&&s[e].push(t);return s},h.addFont=function(e,t,s,r,a){var n=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==n.indexOf(arguments[3])?a=arguments[3]:arguments[3]&&-1==n.indexOf(arguments[3])&&(s=w(s,r)),tt.call(this,e,t,s,a=a||"Identity-H")};var Ot,Ft=e.lineWidth||.200025,Rt=h.__private__.getLineWidth=h.getLineWidth=function(){return Ft},Dt=h.__private__.setLineWidth=h.setLineWidth=function(e){return Ft=e,Z(S(A(e))+" w"),this};h.__private__.setLineDash=Om.API.setLineDash=Om.API.setLineDashPattern=function(e,t){if(e=e||[],t=t||0,isNaN(t)||!Array.isArray(e))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return e=e.map(function(e){return S(A(e))}).join(" "),t=S(A(t)),Z("["+e+"] "+t+" d"),this};var Mt=h.__private__.getLineHeight=h.getLineHeight=function(){return te*Ot};h.__private__.getLineHeight=h.getLineHeight=function(){return te*Ot};var Bt=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(e){return"number"==typeof(e=e||1.15)&&(Ot=e),this},Ut=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Ot};Bt(e.lineHeight);var qt=h.__private__.getHorizontalCoordinate=function(e){return A(e)},zt=h.__private__.getVerticalCoordinate=function(e){return v===y?e:ke[M].mediaBox.topRightY-ke[M].mediaBox.bottomLeftY-A(e)},Wt=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(e){return S(qt(e))},Vt=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(e){return S(zt(e))},Ht=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return qe(Ht)},h.__private__.setStrokeColor=h.setDrawColor=function(e,t,s,r){return Ht=ze({ch1:e,ch2:t,ch3:s,ch4:r,pdfColorType:"draw",precision:2}),Z(Ht),this};var Gt=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return qe(Gt)},h.__private__.setFillColor=h.setFillColor=function(e,t,s,r){return Gt=ze({ch1:e,ch2:t,ch3:s,ch4:r,pdfColorType:"fill",precision:2}),Z(Gt),this};var Jt=e.textColor||"0 g",Kt=h.__private__.getTextColor=h.getTextColor=function(){return qe(Jt)};h.__private__.setTextColor=h.setTextColor=function(e,t,s,r){return Jt=ze({ch1:e,ch2:t,ch3:s,ch4:r,pdfColorType:"text",precision:3}),this};var Yt=e.charSpace,Zt=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Yt||0)};h.__private__.setCharSpace=h.setCharSpace=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Yt=e,this};var Xt=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(e){var t=h.CapJoinStyles[e];if(void 0===t)throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Xt=t,Z(t+" J"),this};var Qt=0;h.__private__.setLineJoin=h.setLineJoin=function(e){var t=h.CapJoinStyles[e];if(void 0===t)throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qt=t,Z(t+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(e){if(e=e||0,isNaN(e))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Z(S(A(e))+" M"),this},h.GState=Lm,h.setGState=function(e){(e="string"==typeof e?je[Ne[e]]:es(null,e)).equals(we)||(Z("/"+e.id+" gs"),we=e)};var es=function(e,t){if(!e||!Ne[e]){var s=!1;for(var r in je)if(je.hasOwnProperty(r)&&je[r].equals(t)){s=!0;break}if(s)t=je[r];else{var a="GS"+(Object.keys(je).length+1).toString(10);je[a]=t,t.id=a}return e&&(Ne[e]=t.id),Ce.publish("addGState",t),t}};h.addGState=function(e,t){return es(e,t),this},h.saveGraphicsState=function(){return Z("q"),be.push({key:ue,size:te,color:Jt}),this},h.restoreGraphicsState=function(){Z("Q");var e=be.pop();return ue=e.key,te=e.size,Jt=e.color,we=null,this},h.setCurrentTransformationMatrix=function(e){return Z(e.toString()+" cm"),this},h.comment=function(e){return Z("#"+e),this};var ts=function(e,t){var s=e||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return s},set:function(e){isNaN(e)||(s=parseFloat(e))}});var r=t||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return r},set:function(e){isNaN(e)||(r=parseFloat(e))}});var a="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return a},set:function(e){a=e.toString()}}),this},ss=function(e,t,s,r){ts.call(this,e,t),this.type="rect";var a=s||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return a},set:function(e){isNaN(e)||(a=parseFloat(e))}});var n=r||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return n},set:function(e){isNaN(e)||(n=parseFloat(e))}}),this},rs=function(){this.page=Se,this.currentPage=M,this.pages=G.slice(0),this.pagesContext=ke.slice(0),this.x=he,this.y=xe,this.matrix=ge,this.width=is(M),this.height=os(M),this.outputDestination=K,this.id="",this.objectNumber=-1};rs.prototype.restore=function(){Se=this.page,M=this.currentPage,ke=this.pagesContext,G=this.pages,he=this.x,xe=this.y,ge=this.matrix,ls(M,this.width),ds(M,this.height),K=this.outputDestination};var as=function(e,t,s,r,a){Pe.push(new rs),Se=M=0,G=[],he=e,xe=t,ge=a,rt([s,r])};for(var ns in h.beginFormObject=function(e,t,s,r,a){return as(e,t,s,r,a),this},h.endFormObject=function(e){return function(e){if(Ae[e])Pe.pop().restore();else{var t=new rs,s="Xo"+(Object.keys(_e).length+1).toString(10);t.id=s,Ae[e]=s,_e[s]=t,Ce.publish("addFormObject",t),Pe.pop().restore()}}(e),this},h.doFormObject=function(e,t){var s=_e[Ae[e]];return Z("q"),Z(t.toString()+" cm"),Z("/"+s.id+" Do"),Z("Q"),this},h.getFormObject=function(e){var t=_e[Ae[e]];return{x:t.x,y:t.y,width:t.width,height:t.height,matrix:t.matrix}},h.save=function(e,t){return e=e||"generated.pdf",(t=t||{}).returnPromise=t.returnPromise||!1,!1===t.returnPromise?(om(gt(xt()),e),"function"==typeof om.unload&&sm.setTimeout&&setTimeout(om.unload,911),this):new Promise(function(t,s){try{var r=om(gt(xt()),e);"function"==typeof om.unload&&sm.setTimeout&&setTimeout(om.unload,911),t(r)}catch(a){s(a.message)}})},Om.API)Om.API.hasOwnProperty(ns)&&("events"===ns&&Om.API.events.length?function(e,t){var s,r,a;for(a=t.length-1;-1!==a;a--)s=t[a][0],r=t[a][1],e.subscribe.apply(e,[s].concat("function"==typeof r?[r]:r))}(Ce,Om.API.events):h[ns]=Om.API[ns]);function is(e){return ke[e].mediaBox.topRightX-ke[e].mediaBox.bottomLeftX}function ls(e,t){ke[e].mediaBox.topRightX=t+ke[e].mediaBox.bottomLeftX}function os(e){return ke[e].mediaBox.topRightY-ke[e].mediaBox.bottomLeftY}function ds(e,t){ke[e].mediaBox.topRightY=t+ke[e].mediaBox.bottomLeftY}var cs=h.getPageWidth=function(e){return is(e=e||M)/me},us=h.setPageWidth=function(e,t){ls(e,t*me)},ms=h.getPageHeight=function(e){return os(e=e||M)/me},hs=h.setPageHeight=function(e,t){ds(e,t*me)};return h.internal={pdfEscape:st,getStyle:St,getFont:It,getFontSize:re,getCharSpace:Zt,getTextColor:Kt,getLineHeight:Mt,getLineHeightFactor:Ut,getLineWidth:Rt,write:X,getHorizontalCoordinate:qt,getVerticalCoordinate:zt,getCoordinateString:Wt,getVerticalCoordinateString:Vt,collections:{},newObject:Fe,newAdditionalObject:Me,newObjectDeferred:Re,newObjectDeferredBegin:De,getFilters:We,putStream:Ve,events:Ce,scaleFactor:me,pageSize:{getWidth:function(){return cs(M)},setWidth:function(e){us(M,e)},getHeight:function(){return ms(M)},setHeight:function(e){hs(M,e)}},encryptionOptions:c,encryption:bt,getEncryptor:function(e){return null!==c?bt.encryptor(e,0):function(e){return e}},output:ft,getNumberOfPages:lt,pages:G,out:Z,f2:$,f3:_,getPageInfo:yt,getPageInfoByObjId:vt,getCurrentPageInfo:jt,getPDFVersion:g,Point:ts,Rectangle:ss,Matrix:Le,hasHotfix:pt},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return cs(M)},set:function(e){us(M,e)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return ms(M)},set:function(e){hs(M,e)},enumerable:!0,configurable:!0}),function(e){for(var t=0,s=ee.length;t<s;t++){var r=tt.call(this,e[t][0],e[t][1],e[t][2],ee[t][3],!0);!1===u&&(m[r]=!0);var a=e[t][0].split("-");et({id:r,fontName:a[0],fontStyle:a[1]||""})}Ce.publish("addFonts",{fonts:fe,dictionary:pe})}.call(h,ee),ue="F1",at(a,s),Ce.publish("initialized"),h}_m.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},_m.prototype.toHexString=function(e){return e.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},_m.prototype.hexToBytes=function(e){for(var t=[],s=0;s<e.length;s+=2)t.push(String.fromCharCode(parseInt(e.substr(s,2),16)));return t.join("")},_m.prototype.processOwnerPassword=function(e,t){return Cm(wm(t).substr(0,5),e)},_m.prototype.encryptor=function(e,t){var s=wm(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(e){return Cm(s,e)}},Lm.prototype.equals=function(e){var t,s="id,objectNumber,equals";if(!e||td(e)!==td(this))return!1;var r=0;for(t in this)if(!(s.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t))return!1;if(this[t]!==e[t])return!1;r++}for(t in e)e.hasOwnProperty(t)&&s.indexOf(t)<0&&r--;return 0===r},Om.API={events:[]},Om.version="3.0.3";var Fm=Om.API,Rm=1,Dm=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Mm=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Bm=function(e){return e.toFixed(2)},Um=function(e){return e.toFixed(5)};Fm.__acroform__={};var qm=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},zm=function(e){return e*Rm},Wm=function(e){var t=new ih,s=vh.internal.getHeight(e)||0,r=vh.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Bm(r)),Number(Bm(s))],t},Vm=Fm.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},Hm=Fm.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},Gm=Fm.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Jm=Fm.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Gm(e,t-1)},Km=Fm.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Vm(e,t-1)},Ym=Fm.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Hm(e,t-1)},Zm=Fm.__acroform__.calculateCoordinates=function(e,t){var s=t.internal.getHorizontalCoordinate,r=t.internal.getVerticalCoordinate,a=e[0],n=e[1],i=e[2],l=e[3],o={};return o.lowerLeft_X=s(a)||0,o.lowerLeft_Y=r(n+l)||0,o.upperRight_X=s(a+i)||0,o.upperRight_Y=r(n)||0,[Number(Bm(o.lowerLeft_X)),Number(Bm(o.lowerLeft_Y)),Number(Bm(o.upperRight_X)),Number(Bm(o.upperRight_Y))]},Xm=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],s=e._V||e.DV,r=Qm(e,s),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+Bm(r.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC");var n=Wm(e);return n.scope=e.scope,n.stream=t.join("\n"),n}},Qm=function(e,t){var s=0===e.fontSize?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},a=(t=")"==(t="("==t.substr(0,1)?t.substr(1):t).substr(t.length-1)?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(e){return e.split("\n")}):a.map(function(e){return[e]});var n=s,i=vh.internal.getHeight(e)||0;i=i<0?-i:i;var l=vh.internal.getWidth(e)||0;l=l<0?-l:l;var o=function(t,s,r){if(t+1<a.length){var n=s+" "+a[t+1][0];return eh(n,e,r).width<=l-4}return!1};n++;e:for(;n>0;){t="",n--;var d,c,u=eh("3",e,n).height,m=e.multiline?i-n:(i-u)/2,h=m+=2,x=0,g=0,f=0;if(n<=0){t="(...) Tj\n",t+="% Width of Text: "+eh(t,e,n=12).width+", FieldWidth:"+l+"\n";break}for(var p="",b=0,y=0;y<a.length;y++)if(a.hasOwnProperty(y)){var v=!1;if(1!==a[y].length&&f!==a[y].length-1){if((u+2)*(b+2)+2>i)continue e;p+=a[y][f],v=!0,g=y,y--}else{p=" "==(p+=a[y][f]+" ").substr(p.length-1)?p.substr(0,p.length-1):p;var j=parseInt(y),N=o(j,p,n),w=y>=a.length-1;if(N&&!w){p+=" ",f=0;continue}if(N||w){if(w)g=j;else if(e.multiline&&(u+2)*(b+2)+2>i)continue e}else{if(!e.multiline)continue e;if((u+2)*(b+2)+2>i)continue e;g=j}}for(var S="",k=x;k<=g;k++){var C=a[k];if(e.multiline){if(k===g){S+=C[f]+" ",f=(f+1)%C.length;continue}if(k===x){S+=C[C.length-1]+" ";continue}}S+=C[0]+" "}switch(S=" "==S.substr(S.length-1)?S.substr(0,S.length-1):S,c=eh(S,e,n).width,e.textAlign){case"right":d=l-c-2;break;case"center":d=(l-c)/2;break;default:d=2}t+=Bm(d)+" "+Bm(h)+" Td\n",t+="("+Dm(S)+") Tj\n",t+=-Bm(d)+" 0 Td\n",h=-(n+2),c=0,x=v?g:g+1,b++,p=""}break}return r.text=t,r.fontSize=n,r},eh=function(e,t,s){var r=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(s),charSpace:0})*parseFloat(s);return{height:t.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(s),charSpace:0})*parseFloat(s)*1.5,width:a}},th={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},sh=function(e,t){var s={type:"reference",object:e};void 0===t.internal.getPageInfo(e.page).pageContext.annotations.find(function(e){return e.type===s.type&&e.object===s.object})&&t.internal.getPageInfo(e.page).pageContext.annotations.push(s)},rh=Fm.__acroform__.arrayToPdfArray=function(e,t,s){var r=function(e){return e};if(Array.isArray(e)){for(var a="[",n=0;n<e.length;n++)switch(0!==n&&(a+=" "),td(e[n])){case"boolean":case"number":case"object":a+=e[n].toString();break;case"string":"/"!==e[n].substr(0,1)?(void 0!==t&&s&&(r=s.internal.getEncryptor(t)),a+="("+Dm(r(e[n].toString()))+")"):a+=e[n].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},ah=function(e,t,s){var r=function(e){return e};return void 0!==t&&s&&(r=s.internal.getEncryptor(t)),(e=e||"").toString(),"("+Dm(r(e))+")"},nh=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};nh.prototype.toString=function(){return this.objId+" 0 R"},nh.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},nh.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(e){return"content"!=e&&"appearanceStreamContent"!=e&&"scope"!=e&&"objId"!=e&&"_"!=e.substring(0,1)});for(var s in t)if(!1===Object.getOwnPropertyDescriptor(this,t[s]).configurable){var r=t[s],a=this[r];a&&(Array.isArray(a)?e.push({key:r,value:rh(a,this.objId,this.scope)}):a instanceof nh?(a.scope=this.scope,e.push({key:r,value:a.objId+" 0 R"})):"function"!=typeof a&&e.push({key:r,value:a}))}return e};var ih=function(){nh.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};qm(ih,nh);var lh=function(){nh.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Dm(t(e))+")"}},set:function(t){e=t}})};qm(lh,nh);var oh=function e(){nh.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute F supplied.');t=e}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(t,3))},set:function(e){!0===Boolean(e)?this.F=Km(t,3):this.F=Ym(t,3)}});var s=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return s},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute Ff supplied.');s=e}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==r.length)return r},set:function(e){r=void 0!==e?e:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(e){r[0]=e}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(e){r[1]=e}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(e){r[2]=e}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(e){r[3]=e}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(e){switch(e){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=e;break;default:throw new Error('Invalid value "'+e+'" for attribute FT supplied.')}}});var n=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!n||n.length<1){if(this instanceof fh)return;n="FieldObject"+e.FieldNum++}var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Dm(t(n))+")"},set:function(e){n=e.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return n},set:function(e){n=e}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){i=e}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(e){l=e}});var o=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return o},set:function(e){o=e}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===d?50/Rm:d},set:function(e){d=e}});var c="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return c},set:function(e){c=e}});var u="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!u||this instanceof fh||this instanceof bh))return ah(u,this.objId,this.scope)},set:function(e){e=e.toString(),u=e}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof hh==0?ah(m,this.objId,this.scope):m},set:function(e){e=e.toString(),m=this instanceof hh==0?"("===e.substr(0,1)?Mm(e.substr(1,e.length-2)):Mm(e):e}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof hh==1?Mm(m.substr(1,m.length-1)):m},set:function(e){e=e.toString(),m=this instanceof hh==1?"/"+e:e}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(e){this.V=e}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof hh==0?ah(h,this.objId,this.scope):h},set:function(e){e=e.toString(),h=this instanceof hh==0?"("===e.substr(0,1)?Mm(e.substr(1,e.length-2)):Mm(e):e}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof hh==1?Mm(h.substr(1,h.length-1)):h},set:function(e){e=e.toString(),h=this instanceof hh==1?"/"+e:e}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(e){e=Boolean(e),g=e}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(e){x=e}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,1))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,1):this.Ff=Ym(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,2))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,2):this.Ff=Ym(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,3))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,3):this.Ff=Ym(this.Ff,3)}});var f=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==f)return f},set:function(e){if(-1===[0,1,2].indexOf(e))throw new Error('Invalid value "'+e+'" for attribute Q supplied.');f=e}}),Object.defineProperty(this,"textAlign",{get:function(){var e;switch(f){case 0:default:e="left";break;case 1:e="center";break;case 2:e="right"}return e},configurable:!0,enumerable:!0,set:function(e){switch(e){case"right":case 2:f=2;break;case"center":case 1:f=1;break;default:f=0}}})};qm(oh,nh);var dh=function(){oh.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return rh(t,this.objId,this.scope)},set:function(e){var s,r;r=[],"string"==typeof(s=e)&&(r=function(e,t,s){s||(s=1);for(var r,a=[];r=t.exec(e);)a.push(r[s]);return a}(s,/\((.*?)\)/g)),t=r}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,s){for(s=s||!1,e=(e=e||"").toString();-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),!1!==s););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,18))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,18):this.Ff=Ym(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,19))},set:function(e){!0===this.combo&&(!0===Boolean(e)?this.Ff=Km(this.Ff,19):this.Ff=Ym(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,20))},set:function(e){!0===Boolean(e)?(this.Ff=Km(this.Ff,20),t.sort()):this.Ff=Ym(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,22))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,22):this.Ff=Ym(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,23):this.Ff=Ym(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,27))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,27):this.Ff=Ym(this.Ff,27)}}),this.hasAppearanceStream=!1};qm(dh,oh);var ch=function(){dh.call(this),this.fontName="helvetica",this.combo=!1};qm(ch,dh);var uh=function(){ch.call(this),this.combo=!0};qm(uh,ch);var mh=function(){uh.call(this),this.edit=!0};qm(mh,uh);var hh=function(){oh.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,15))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,15):this.Ff=Ym(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,16))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,16):this.Ff=Ym(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,17))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,17):this.Ff=Ym(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,26):this.Ff=Ym(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(t).length){var s,r=[];for(s in r.push("<<"),t)r.push("/"+s+" ("+Dm(e(t[s]))+")");return r.push(">>"),r.join("\n")}},set:function(e){"object"===td(e)&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){"string"==typeof e&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};qm(hh,oh);var xh=function(){hh.call(this),this.pushButton=!0};qm(xh,hh);var gh=function(){hh.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};qm(gh,hh);var fh=function(){var e,t;oh.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(e){t=e}});var s,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};this.scope&&(e=this.scope.internal.getEncryptor(this.objId));var t,s=[];for(t in s.push("<<"),r)s.push("/"+t+" ("+Dm(e(r[t]))+")");return s.push(">>"),s.join("\n")},set:function(e){"object"===td(e)&&(r=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(e){"string"==typeof e&&(r.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return s},set:function(e){s=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return s.substr(1,s.length-1)},set:function(e){s="/"+e}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=vh.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};qm(fh,oh),gh.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var s=this.Kids[t];s.appearanceStreamContent=e.createAppearanceStream(s.optionName),s.caption=e.getCA()}},gh.prototype.createOption=function(e){var t=new fh;return t.Parent=this,t.optionName=e,this.Kids.push(t),wh.call(this.scope,t),t};var ph=function(){hh.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=vh.CheckBox.createAppearanceStream()};qm(ph,hh);var bh=function(){oh.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,13))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,13):this.Ff=Ym(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,21))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,21):this.Ff=Ym(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,23):this.Ff=Ym(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,24))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,24):this.Ff=Ym(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,25))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,25):this.Ff=Ym(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,26):this.Ff=Ym(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};qm(bh,oh);var yh=function(){bh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(Jm(this.Ff,14))},set:function(e){!0===Boolean(e)?this.Ff=Km(this.Ff,14):this.Ff=Ym(this.Ff,14)}}),this.password=!0};qm(yh,bh);var vh={CheckBox:{createAppearanceStream:function(){return{N:{On:vh.CheckBox.YesNormal},D:{On:vh.CheckBox.YesPushDown,Off:vh.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Wm(e);t.scope=e.scope;var s=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),n=Qm(e,e.caption);return s.push("0.749023 g"),s.push("0 0 "+Bm(vh.internal.getWidth(e))+" "+Bm(vh.internal.getHeight(e))+" re"),s.push("f"),s.push("BMC"),s.push("q"),s.push("0 0 1 rg"),s.push("/"+r+" "+Bm(n.fontSize)+" Tf "+a),s.push("BT"),s.push(n.text),s.push("ET"),s.push("Q"),s.push("EMC"),t.stream=s.join("\n"),t},YesNormal:function(e){var t=Wm(e);t.scope=e.scope;var s=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),a=[],n=vh.internal.getHeight(e),i=vh.internal.getWidth(e),l=Qm(e,e.caption);return a.push("1 g"),a.push("0 0 "+Bm(i)+" "+Bm(n)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Bm(i-1)+" "+Bm(n-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+s+" "+Bm(l.fontSize)+" Tf "+r),a.push(l.text),a.push("ET"),a.push("Q"),t.stream=a.join("\n"),t},OffPushDown:function(e){var t=Wm(e);t.scope=e.scope;var s=[];return s.push("0.749023 g"),s.push("0 0 "+Bm(vh.internal.getWidth(e))+" "+Bm(vh.internal.getHeight(e))+" re"),s.push("f"),t.stream=s.join("\n"),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:vh.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=vh.RadioButton.Circle.YesNormal,t.D[e]=vh.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Wm(e);t.scope=e.scope;var s=[],r=vh.internal.getWidth(e)<=vh.internal.getHeight(e)?vh.internal.getWidth(e)/4:vh.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var a=vh.internal.Bezier_C,n=Number((r*a).toFixed(5));return s.push("q"),s.push("1 0 0 1 "+Um(vh.internal.getWidth(e)/2)+" "+Um(vh.internal.getHeight(e)/2)+" cm"),s.push(r+" 0 m"),s.push(r+" "+n+" "+n+" "+r+" 0 "+r+" c"),s.push("-"+n+" "+r+" -"+r+" "+n+" -"+r+" 0 c"),s.push("-"+r+" -"+n+" -"+n+" -"+r+" 0 -"+r+" c"),s.push(n+" -"+r+" "+r+" -"+n+" "+r+" 0 c"),s.push("f"),s.push("Q"),t.stream=s.join("\n"),t},YesPushDown:function(e){var t=Wm(e);t.scope=e.scope;var s=[],r=vh.internal.getWidth(e)<=vh.internal.getHeight(e)?vh.internal.getWidth(e)/4:vh.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var a=Number((2*r).toFixed(5)),n=Number((a*vh.internal.Bezier_C).toFixed(5)),i=Number((r*vh.internal.Bezier_C).toFixed(5));return s.push("0.749023 g"),s.push("q"),s.push("1 0 0 1 "+Um(vh.internal.getWidth(e)/2)+" "+Um(vh.internal.getHeight(e)/2)+" cm"),s.push(a+" 0 m"),s.push(a+" "+n+" "+n+" "+a+" 0 "+a+" c"),s.push("-"+n+" "+a+" -"+a+" "+n+" -"+a+" 0 c"),s.push("-"+a+" -"+n+" -"+n+" -"+a+" 0 -"+a+" c"),s.push(n+" -"+a+" "+a+" -"+n+" "+a+" 0 c"),s.push("f"),s.push("Q"),s.push("0 g"),s.push("q"),s.push("1 0 0 1 "+Um(vh.internal.getWidth(e)/2)+" "+Um(vh.internal.getHeight(e)/2)+" cm"),s.push(r+" 0 m"),s.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),s.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),s.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),s.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),s.push("f"),s.push("Q"),t.stream=s.join("\n"),t},OffPushDown:function(e){var t=Wm(e);t.scope=e.scope;var s=[],r=vh.internal.getWidth(e)<=vh.internal.getHeight(e)?vh.internal.getWidth(e)/4:vh.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var a=Number((2*r).toFixed(5)),n=Number((a*vh.internal.Bezier_C).toFixed(5));return s.push("0.749023 g"),s.push("q"),s.push("1 0 0 1 "+Um(vh.internal.getWidth(e)/2)+" "+Um(vh.internal.getHeight(e)/2)+" cm"),s.push(a+" 0 m"),s.push(a+" "+n+" "+n+" "+a+" 0 "+a+" c"),s.push("-"+n+" "+a+" -"+a+" "+n+" -"+a+" 0 c"),s.push("-"+a+" -"+n+" -"+n+" -"+a+" 0 -"+a+" c"),s.push(n+" -"+a+" "+a+" -"+n+" "+a+" 0 c"),s.push("f"),s.push("Q"),t.stream=s.join("\n"),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:vh.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=vh.RadioButton.Cross.YesNormal,t.D[e]=vh.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Wm(e);t.scope=e.scope;var s=[],r=vh.internal.calculateCross(e);return s.push("q"),s.push("1 1 "+Bm(vh.internal.getWidth(e)-2)+" "+Bm(vh.internal.getHeight(e)-2)+" re"),s.push("W"),s.push("n"),s.push(Bm(r.x1.x)+" "+Bm(r.x1.y)+" m"),s.push(Bm(r.x2.x)+" "+Bm(r.x2.y)+" l"),s.push(Bm(r.x4.x)+" "+Bm(r.x4.y)+" m"),s.push(Bm(r.x3.x)+" "+Bm(r.x3.y)+" l"),s.push("s"),s.push("Q"),t.stream=s.join("\n"),t},YesPushDown:function(e){var t=Wm(e);t.scope=e.scope;var s=vh.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+Bm(vh.internal.getWidth(e))+" "+Bm(vh.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+Bm(vh.internal.getWidth(e)-2)+" "+Bm(vh.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Bm(s.x1.x)+" "+Bm(s.x1.y)+" m"),r.push(Bm(s.x2.x)+" "+Bm(s.x2.y)+" l"),r.push(Bm(s.x4.x)+" "+Bm(s.x4.y)+" m"),r.push(Bm(s.x3.x)+" "+Bm(s.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join("\n"),t},OffPushDown:function(e){var t=Wm(e);t.scope=e.scope;var s=[];return s.push("0.749023 g"),s.push("0 0 "+Bm(vh.internal.getWidth(e))+" "+Bm(vh.internal.getHeight(e))+" re"),s.push("f"),t.stream=s.join("\n"),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+s}};vh.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=vh.internal.getWidth(e),s=vh.internal.getHeight(e),r=Math.min(t,s);return{x1:{x:(t-r)/2,y:(s-r)/2+r},x2:{x:(t-r)/2+r,y:(s-r)/2},x3:{x:(t-r)/2,y:(s-r)/2},x4:{x:(t-r)/2+r,y:(s-r)/2+r}}}},vh.internal.getWidth=function(e){var t=0;return"object"===td(e)&&(t=zm(e.Rect[2])),t},vh.internal.getHeight=function(e){var t=0;return"object"===td(e)&&(t=zm(e.Rect[3])),t};var jh,Nh,wh=Fm.addField=function(e){if(function(e,t){if(t.scope=e,void 0!==e.internal&&(void 0===e.internal.acroformPlugin||!1===e.internal.acroformPlugin.isInitialized)){if(oh.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(th)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Rm=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new lh,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){var t;(t=e).internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0}),e.internal.events.subscribe("buildDocument",function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in t)if(t.hasOwnProperty(s)){var r=t[s];r.objId=void 0,r.hasAnnotation&&sh(r,e)}}(e)}),e.internal.events.subscribe("putCatalog",function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(e)}),e.internal.events.subscribe("postPutPages",function(t){!function(e,t){var s=!e;for(var r in e||(t.internal.newObjectDeferredBegin(t.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),t.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),e=e||t.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(e.hasOwnProperty(r)){var a=e[r],n=[],i=a.Rect;if(a.Rect&&(a.Rect=Zm(a.Rect,t)),t.internal.newObjectDeferredBegin(a.objId,!0),a.DA=vh.createDefaultAppearanceStream(a),"object"===td(a)&&"function"==typeof a.getKeyValueListForStream&&(n=a.getKeyValueListForStream()),a.Rect=i,a.hasAppearanceStream&&!a.appearanceStreamContent){var l=Xm(a);n.push({key:"AP",value:"<</N "+l+">>"}),t.internal.acroformPlugin.xForms.push(l)}if(a.appearanceStreamContent){var o="";for(var d in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(d)){var c=a.appearanceStreamContent[d];if(o+="/"+d+" ",o+="<<",Object.keys(c).length>=1||Array.isArray(c)){for(var r in c)if(c.hasOwnProperty(r)){var u=c[r];"function"==typeof u&&(u=u.call(t,a)),o+="/"+r+" "+u+" ",t.internal.acroformPlugin.xForms.indexOf(u)>=0||t.internal.acroformPlugin.xForms.push(u)}}else"function"==typeof(u=c)&&(u=u.call(t,a)),o+="/"+r+" "+u,t.internal.acroformPlugin.xForms.indexOf(u)>=0||t.internal.acroformPlugin.xForms.push(u);o+=">>"}n.push({key:"AP",value:"<<\n"+o+">>"})}t.internal.putStream({additionalKeyValues:n,objectId:a.objId}),t.internal.out("endobj")}s&&function(e,t){for(var s in e)if(e.hasOwnProperty(s)){var r=s,a=e[s];t.internal.newObjectDeferredBegin(a.objId,!0),"object"===td(a)&&"function"==typeof a.putStream&&a.putStream(),delete e[r]}}(t.internal.acroformPlugin.xForms,t)}(t,e)}),e.internal.acroformPlugin.isInitialized=!0}}(this,e),!(e instanceof oh))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};function Sh(e){return e.reduce(function(e,t,s){return e[t]=s,e},{})}Fm.AcroFormChoiceField=dh,Fm.AcroFormListBox=ch,Fm.AcroFormComboBox=uh,Fm.AcroFormEditBox=mh,Fm.AcroFormButton=hh,Fm.AcroFormPushButton=xh,Fm.AcroFormRadioButton=gh,Fm.AcroFormCheckBox=ph,Fm.AcroFormTextField=bh,Fm.AcroFormPasswordField=yh,Fm.AcroFormAppearance=vh,Fm.AcroForm={ChoiceField:dh,ListBox:ch,ComboBox:uh,EditBox:mh,Button:hh,PushButton:xh,RadioButton:gh,CheckBox:ph,TextField:bh,PasswordField:yh,Appearance:vh},Om.AcroForm={ChoiceField:dh,ListBox:ch,ComboBox:uh,EditBox:mh,Button:hh,PushButton:xh,RadioButton:gh,CheckBox:ph,TextField:bh,PasswordField:yh,Appearance:vh},Om.AcroForm,function(e){var t="addImage_";e.__addimage__={};var s="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(e,t){var a,n,i,l,o,d=s;if("RGBA"===(t=t||s)||void 0!==e.data&&e.data instanceof Uint8ClampedArray&&"height"in e&&"width"in e)return"RGBA";if(N(e))for(o in r)for(i=r[o],a=0;a<i.length;a+=1){for(l=!0,n=0;n<i[a].length;n+=1)if(void 0!==i[a][n]&&i[a][n]!==e[n]){l=!1;break}if(!0===l){d=o;break}}else for(o in r)for(i=r[o],a=0;a<i.length;a+=1){for(l=!0,n=0;n<i[a].length;n+=1)if(void 0!==i[a][n]&&i[a][n]!==e.charCodeAt(n)){l=!1;break}if(!0===l){d=o;break}}return d===s&&t!==s&&(d=t),d},n=function e(t){for(var s=this.internal.write,r=this.internal.putStream,a=(0,this.internal.getFilters)();-1!==a.indexOf("FlateEncode");)a.splice(a.indexOf("FlateEncode"),1);t.objectId=this.internal.newObject();var n=[];if(n.push({key:"Type",value:"/XObject"}),n.push({key:"Subtype",value:"/Image"}),n.push({key:"Width",value:t.width}),n.push({key:"Height",value:t.height}),t.colorSpace===p.INDEXED?n.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.palette.length/3-1)+" "+("sMask"in t&&void 0!==t.sMask?t.objectId+2:t.objectId+1)+" 0 R]"}):(n.push({key:"ColorSpace",value:"/"+t.colorSpace}),t.colorSpace===p.DEVICE_CMYK&&n.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),n.push({key:"BitsPerComponent",value:t.bitsPerComponent}),"decodeParameters"in t&&void 0!==t.decodeParameters&&n.push({key:"DecodeParms",value:"<<"+t.decodeParameters+">>"}),"transparency"in t&&Array.isArray(t.transparency)&&t.transparency.length>0){for(var i="",l=0,o=t.transparency.length;l<o;l++)i+=t.transparency[l]+" "+t.transparency[l]+" ";n.push({key:"Mask",value:"["+i+"]"})}void 0!==t.sMask&&n.push({key:"SMask",value:t.objectId+1+" 0 R"});var d=void 0!==t.filter?["/"+t.filter]:void 0;if(r({data:t.data,additionalKeyValues:n,alreadyAppliedFilters:d,objectId:t.objectId}),s("endobj"),"sMask"in t&&void 0!==t.sMask){var c,u=null!==(c=t.sMaskBitsPerComponent)&&void 0!==c?c:t.bitsPerComponent,m={width:t.width,height:t.height,colorSpace:"DeviceGray",bitsPerComponent:u,data:t.sMask};"filter"in t&&(m.decodeParameters="/Predictor ".concat(t.predictor," /Colors 1 /BitsPerComponent ").concat(u," /Columns ").concat(t.width),m.filter=t.filter),e.call(this,m)}if(t.colorSpace===p.INDEXED){var h=this.internal.newObject();r({data:S(new Uint8Array(t.palette)),objectId:h}),s("endobj")}},i=function(){var e=this.internal.collections[t+"images"];for(var s in e)n.call(this,e[s])},l=function(){var e,s=this.internal.collections[t+"images"],r=this.internal.write;for(var a in s)r("/I"+(e=s[a]).index,e.objectId,"0","R")},o=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var e=this.internal.collections[t+"images"];return o.call(this),e},c=function(){return Object.keys(this.internal.collections[t+"images"]).length},u=function(t){return"function"==typeof e["process"+t.toUpperCase()]},m=function(e){return"object"===td(e)&&1===e.nodeType},h=function(t,s){if("IMG"===t.nodeName&&t.hasAttribute("src")){var r=""+t.getAttribute("src");if(0===r.indexOf("data:image/"))return cm(unescape(r).split("base64,").pop());var a=e.loadFile(r,!0);if(void 0!==a)return a}if("CANVAS"===t.nodeName){if(0===t.width||0===t.height)throw new Error("Given canvas must have data. Canvas width: "+t.width+", height: "+t.height);var n;switch(s){case"PNG":n="image/png";break;case"WEBP":n="image/webp";break;default:n="image/jpeg"}return cm(t.toDataURL(n,1).split("base64,").pop())}},x=function(e){var s=this.internal.collections[t+"images"];if(s)for(var r in s)if(e===s[r].alias)return s[r]},g=function(e,t,s){return e||t||(e=-96,t=-96),e<0&&(e=-1*s.width*72/e/this.internal.scaleFactor),t<0&&(t=-1*s.height*72/t/this.internal.scaleFactor),0===e&&(e=t*s.width/s.height),0===t&&(t=e*s.height/s.width),[e,t]},f=function(e,t,s,r,a,n){var i=g.call(this,s,r,a),l=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=d.call(this);if(s=i[0],r=i[1],c[a.index]=a,n){n*=Math.PI/180;var u=Math.cos(n),m=Math.sin(n),h=function(e){return e.toFixed(4)},x=[h(u),h(m),h(-1*m),h(u),0,0,"cm"]}this.internal.write("q"),n?(this.internal.write([1,"0","0",1,l(e),o(t+r),"cm"].join(" ")),this.internal.write(x.join(" ")),this.internal.write([l(s),"0","0",l(r),"0","0","cm"].join(" "))):this.internal.write([l(s),"0","0",l(r),l(e),o(t+r),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+a.index+" Do"),this.internal.write("Q")},p=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},y=e.__addimage__.sHashCode=function(e){var t,s,r=0;if("string"==typeof e)for(s=e.length,t=0;t<s;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;else if(N(e))for(s=e.byteLength/2,t=0;t<s;t++)r=(r<<5)-r+e[t],r|=0;return r},v=e.__addimage__.validateStringAsBase64=function(e){(e=e||"").toString().trim();var t=!0;return 0===e.length&&(t=!1),e.length%4!=0&&(t=!1),!1===/^[A-Za-z0-9+/]+$/.test(e.substr(0,e.length-2))&&(t=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(e.substr(-2))&&(t=!1),t},j=e.__addimage__.extractImageFromDataUrl=function(e){if(null==e)return null;if(!(e=e.trim()).startsWith("data:"))return null;var t=e.indexOf(",");return t<0?null:e.substring(0,t).trim().endsWith("base64")?e.substring(t+1):null};e.__addimage__.isArrayBuffer=function(e){return e instanceof ArrayBuffer};var N=e.__addimage__.isArrayBufferView=function(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array},w=e.__addimage__.binaryStringToUint8Array=function(e){for(var t=e.length,s=new Uint8Array(t),r=0;r<t;r++)s[r]=e.charCodeAt(r);return s},S=e.__addimage__.arrayBufferToBinaryString=function(e){for(var t="",s=N(e)?e:new Uint8Array(e),r=0;r<s.length;r+=8192)t+=String.fromCharCode.apply(null,s.subarray(r,r+8192));return t};e.addImage=function(){var e,t,r,a,n,i,l,d,c;if("number"==typeof arguments[1]?(t=s,r=arguments[1],a=arguments[2],n=arguments[3],i=arguments[4],l=arguments[5],d=arguments[6],c=arguments[7]):(t=arguments[1],r=arguments[2],a=arguments[3],n=arguments[4],i=arguments[5],l=arguments[6],d=arguments[7],c=arguments[8]),"object"===td(e=arguments[0])&&!m(e)&&"imageData"in e){var u=e;e=u.imageData,t=u.format||t||s,r=u.x||r||0,a=u.y||a||0,n=u.w||u.width||n,i=u.h||u.height||i,l=u.alias||l,d=u.compression||d,c=u.rotation||u.angle||c}var h=this.internal.getFilters();if(void 0===d&&-1!==h.indexOf("FlateEncode")&&(d="SLOW"),isNaN(r)||isNaN(a))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var x=k.call(this,e,t,l,d);return f.call(this,r,a,n,i,x,c),this};var k=function(t,r,n,i){var l,o,d,g;if("string"==typeof t&&a(t)===s){t=unescape(t);var f=C(t,!1);(""!==f||void 0!==(f=e.loadFile(t,!0)))&&(t=f)}if(m(t)&&(t=h(t,r)),r=a(t,r),!u(r))throw new Error("addImage does not support files of type '"+r+"', please ensure that a plugin for '"+r+"' support is added.");if((null==(d=n)||0===d.length)&&(n="string"==typeof(g=t)||N(g)?y(g):N(g.data)?y(g.data):null),(l=x.call(this,n))||(t instanceof Uint8Array||"RGBA"===r||(o=t,t=w(t)),l=this["process"+r.toUpperCase()](t,c.call(this),n,function(t){return t&&"string"==typeof t&&(t=t.toUpperCase()),t in e.image_compression?t:b.NONE}(i),o)),!l)throw new Error("An unknown error occurred whilst processing the image.");return l},C=e.__addimage__.convertBase64ToBinaryString=function(e,t){t="boolean"!=typeof t||t;var s,r="";if("string"==typeof e){var a;s=null!==(a=j(e))&&void 0!==a?a:e;try{r=cm(s)}catch(n){if(t)throw v(s)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+n.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return r};e.getImageProperties=function(t){var r,n,i="";if(m(t)&&(t=h(t)),"string"==typeof t&&a(t)===s&&(""===(i=C(t,!1))&&(i=e.loadFile(t)||""),t=i),n=a(t),!u(n))throw new Error("addImage does not support files of type '"+n+"', please ensure that a plugin for '"+n+"' support is added.");if(t instanceof Uint8Array||(t=w(t)),!(r=this["process"+n.toUpperCase()](t)))throw new Error("An unknown error occurred whilst processing the image");return r.fileType=n,r}}(Om.API),
/**
 * @license
 * Copyright (c) 2014 Steven Spungin (TwelveTone LLC)  steven@twelvetone.tv
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
jh=Om.API,Nh=function(e){if(void 0!==e&&""!=e)return!0},Om.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),jh.events.push(["putPage",function(e){for(var t,s,r,a=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getPageInfoByObjId(e.objId),l=e.pageContext.annotations,o=!1,d=0;d<l.length&&!o;d++)switch((t=l[d]).type){case"link":(Nh(t.options.url)||Nh(t.options.pageNumber))&&(o=!0);break;case"reference":case"text":case"freetext":o=!0}if(0!=o){this.internal.write("/Annots [");for(var c=0;c<l.length;c++){t=l[c];var u=this.internal.pdfEscape,m=this.internal.getEncryptor(e.objId);switch(t.type){case"reference":this.internal.write(" "+t.object.objId+" 0 R ");break;case"text":var h=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(h.objId),f=t.title||"Note";r="<</Type /Annot /Subtype /Text "+(s="/Rect ["+a(t.bounds.x)+" "+n(t.bounds.y+t.bounds.h)+" "+a(t.bounds.x+t.bounds.w)+" "+n(t.bounds.y)+"] ")+"/Contents ("+u(g(t.contents))+")",r+=" /Popup "+x.objId+" 0 R",r+=" /P "+i.objId+" 0 R",r+=" /T ("+u(g(f))+") >>",h.content=r;var p=h.objId+" 0 R";r="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+a(t.bounds.x+30)+" "+n(t.bounds.y+t.bounds.h)+" "+a(t.bounds.x+t.bounds.w+30)+" "+n(t.bounds.y)+"] ")+" /Parent "+p,t.open&&(r+=" /Open true"),r+=" >>",x.content=r,this.internal.write(h.objId,"0 R",x.objId,"0 R");break;case"freetext":s="/Rect ["+a(t.bounds.x)+" "+n(t.bounds.y)+" "+a(t.bounds.x+t.bounds.w)+" "+n(t.bounds.y+t.bounds.h)+"] ";var b=t.color||"#000000";r="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+u(m(t.contents))+")",r+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+b+")",r+=" /Border [0 0 0]",r+=" >>",this.internal.write(r);break;case"link":if(t.options.name){var y=this.annotations._nameMap[t.options.name];t.options.pageNumber=y.page,t.options.top=y.y}else t.options.top||(t.options.top=0);if(s="/Rect ["+t.finalBounds.x+" "+t.finalBounds.y+" "+t.finalBounds.w+" "+t.finalBounds.h+"] ",r="",t.options.url)r="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+u(m(t.options.url))+") >>";else if(t.options.pageNumber)switch(r="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(t.options.pageNumber).objId+" 0 R",t.options.magFactor=t.options.magFactor||"XYZ",t.options.magFactor){case"Fit":r+=" /Fit]";break;case"FitH":r+=" /FitH "+t.options.top+"]";break;case"FitV":t.options.left=t.options.left||0,r+=" /FitV "+t.options.left+"]";break;default:var v=n(t.options.top);t.options.left=t.options.left||0,void 0===t.options.zoom&&(t.options.zoom=0),r+=" /XYZ "+t.options.left+" "+v+" "+t.options.zoom+"]"}""!=r&&(r+=" >>",this.internal.write(r))}}this.internal.write("]")}}]),jh.createAnnotation=function(e){var t=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":t.pageContext.annotations.push(e)}},jh.link=function(e,t,s,r,a){var n=this.internal.getCurrentPageInfo(),i=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString;n.pageContext.annotations.push({finalBounds:{x:i(e),y:l(t),w:i(e+s),h:l(t+r)},options:a,type:"link"})},jh.textWithLink=function(e,t,s,r){var a,n,i=this.getTextWidth(e),l=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==r.maxWidth){n=r.maxWidth;var o=this.splitTextToSize(e,n).length;a=Math.ceil(l*o)}else n=i,a=l;return this.text(e,t,s,r),s+=.2*l,"center"===r.align&&(t-=i/2),"right"===r.align&&(t-=i),this.link(t,s-l,n,a,r),i},jh.getTextWidth=function(e){var t=this.internal.getFontSize();return this.getStringUnitWidth(e)*t/this.internal.scaleFactor},
/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},s={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var n=e.__arabicParser__.isInArabicSubstitutionA=function(e){return void 0!==t[e.charCodeAt(0)]},i=e.__arabicParser__.isArabicLetter=function(e){return"string"==typeof e&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(e)},l=e.__arabicParser__.isArabicEndLetter=function(e){return i(e)&&n(e)&&t[e.charCodeAt(0)].length<=2},o=e.__arabicParser__.isArabicAlfLetter=function(e){return i(e)&&a.indexOf(e.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(e){return i(e)&&n(e)&&t[e.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(e){return i(e)&&n(e)&&t[e.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(e){return i(e)&&n(e)&&t[e.charCodeAt(0)].length>=3};var c=e.__arabicParser__.arabicLetterHasMedialForm=function(e){return i(e)&&n(e)&&4==t[e.charCodeAt(0)].length},u=e.__arabicParser__.resolveLigatures=function(e){var t=0,r=s,a="",n=0;for(t=0;t<e.length;t+=1)void 0!==r[e.charCodeAt(t)]?(n++,"number"==typeof(r=r[e.charCodeAt(t)])&&(a+=String.fromCharCode(r),r=s,n=0),t===e.length-1&&(r=s,a+=e.charAt(t-(n-1)),t-=n-1,n=0)):(r=s,a+=e.charAt(t-n),t-=n,n=0);return a};e.__arabicParser__.isArabicDiacritic=function(e){return void 0!==e&&void 0!==r[e.charCodeAt(0)]};var m=e.__arabicParser__.getCorrectForm=function(e,t,s){return i(e)?!1===n(e)?-1:!d(e)||!i(t)&&!i(s)||!i(s)&&l(t)||l(e)&&!i(t)||l(e)&&o(t)||l(e)&&l(t)?0:c(e)&&i(t)&&!l(t)&&i(s)&&d(s)?3:l(e)||!i(s)?1:2:-1},h=function(e){var s=0,r=0,a=0,n="",l="",o="",d=(e=e||"").split("\\s+"),c=[];for(s=0;s<d.length;s+=1){for(c.push(""),r=0;r<d[s].length;r+=1)n=d[s][r],l=d[s][r-1],o=d[s][r+1],i(n)?(a=m(n,l,o),c[s]+=-1!==a?String.fromCharCode(t[n.charCodeAt(0)][a]):n):c[s]+=n;c[s]=u(c[s])}return c.join(" ")},x=e.__arabicParser__.processArabic=e.processArabic=function(){var e,t="string"==typeof arguments[0]?arguments[0]:arguments[0].text,s=[];if(Array.isArray(t)){var r=0;for(s=[],r=0;r<t.length;r+=1)Array.isArray(t[r])?s.push([h(t[r][0]),t[r][1],t[r][2]]):s.push([h(t[r])]);e=s}else e=h(t);return"string"==typeof arguments[0]?e:(arguments[0].text=e,arguments[0])};e.events.push(["preProcessText",x])}(Om.API),Om.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform","javascript"===e.variant?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},
/**
 * @license
 * Copyright (c) 2014 Steven Spungin (TwelveTone LLC)  steven@twelvetone.tv
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var t=150;Object.defineProperty(this,"width",{get:function(){return t},set:function(e){t=isNaN(e)||!1===Number.isInteger(e)||e<0?150:e,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=t+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(e){s=isNaN(e)||!1===Number.isInteger(e)||e<0?300:e,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var r=[];Object.defineProperty(this,"childNodes",{get:function(){return r},set:function(e){r=e}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(e){a=e}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,t){var s;if("2d"!==(e=e||"2d"))return null;for(s in t)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=t[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Om.API),function(e){var t={left:0,top:0,bottom:0,right:0},s=!1,r=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new n,this.internal.__cell__.pages=1},n=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var t=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var s=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return s},set:function(e){s=e}});var r=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return r},set:function(e){r=e}});var a=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return a},set:function(e){a=e}});var n=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return n},set:function(e){n=e}});var i=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return i},set:function(e){i=e}}),this};n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},n.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(e){return r.call(this),this.internal.__cell__.headerFunction="function"==typeof e?e:void 0,this},e.getTextDimensions=function(e,t){r.call(this);var s=(t=t||{}).fontSize||this.getFontSize(),a=t.font||this.getFont(),n=t.scaleFactor||this.internal.scaleFactor,i=0,l=0,o=0,d=this;if(!Array.isArray(e)&&"string"!=typeof e){if("number"!=typeof e)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");e=String(e)}var c=t.maxWidth;c>0?"string"==typeof e?e=this.splitTextToSize(e,c):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(d.splitTextToSize(t,c))},[])):e=Array.isArray(e)?e:[e];for(var u=0;u<e.length;u++)i<(o=this.getStringUnitWidth(e[u],{font:a})*s)&&(i=o);return 0!==i&&(l=e.length),{w:i/=n,h:Math.max((l*s*this.getLineHeightFactor()-s*(this.getLineHeightFactor()-1))/n,0)}},e.cellAddPage=function(){r.call(this),this.addPage();var e=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new n(e.left,e.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=e.cell=function(){var e;e=arguments[0]instanceof n?arguments[0]:new n(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var a=this.internal.__cell__.lastCell,i=this.internal.__cell__.padding,l=this.internal.__cell__.margins||t,o=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return void 0!==a.lineNumber&&(a.lineNumber===e.lineNumber?(e.x=(a.x||0)+(a.width||0),e.y=a.y||0):a.y+a.height+e.height+l.bottom>this.getPageHeight()?(this.cellAddPage(),e.y=l.top,d&&o&&(this.printHeaderRow(e.lineNumber,!0),e.y+=o[0].height)):e.y=a.y+a.height||e.y),void 0!==e.text[0]&&(this.rect(e.x,e.y,e.width,e.height,!0===s?"FD":void 0),"right"===e.align?this.text(e.text,e.x+e.width-i,e.y+i,{align:"right",baseline:"top"}):"center"===e.align?this.text(e.text,e.x+e.width/2,e.y+i,{align:"center",baseline:"top",maxWidth:e.width-i-i}):this.text(e.text,e.x+i,e.y+i,{align:"left",baseline:"top",maxWidth:e.width-i-i})),this.internal.__cell__.lastCell=e,this};e.table=function(e,s,o,d,c){if(r.call(this),!o)throw new Error("No data for PDF table.");var u,m,h,x,g=[],f=[],p=[],b={},y={},v=[],j=[],N=(c=c||{}).autoSize||!1,w=!1!==c.printHeaders,S=c.css&&void 0!==c.css["font-size"]?16*c.css["font-size"]:c.fontSize||12,k=c.margins||Object.assign({width:this.getPageWidth()},t),C="number"==typeof c.padding?c.padding:3,$=c.headerBackgroundColor||"#c8c8c8",_=c.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=w,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=S,this.internal.__cell__.padding=C,this.internal.__cell__.headerBackgroundColor=$,this.internal.__cell__.headerTextColor=_,this.setFontSize(S),null==d)f=g=Object.keys(o[0]),p=g.map(function(){return"left"});else if(Array.isArray(d)&&"object"===td(d[0]))for(g=d.map(function(e){return e.name}),f=d.map(function(e){return e.prompt||e.name||""}),p=d.map(function(e){return e.align||"left"}),u=0;u<d.length;u+=1)y[d[u].name]=.7499990551181103*d[u].width;else Array.isArray(d)&&"string"==typeof d[0]&&(f=g=d,p=g.map(function(){return"left"}));if(N||Array.isArray(d)&&"string"==typeof d[0])for(u=0;u<g.length;u+=1){for(b[x=g[u]]=o.map(function(e){return e[x]}),this.setFont(void 0,"bold"),v.push(this.getTextDimensions(f[u],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=b[x],this.setFont(void 0,"normal"),h=0;h<m.length;h+=1)v.push(this.getTextDimensions(m[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);y[x]=Math.max.apply(null,v)+C+C,v=[]}if(w){var A={};for(u=0;u<g.length;u+=1)A[g[u]]={},A[g[u]].text=f[u],A[g[u]].align=p[u];var P=l.call(this,A,y);j=g.map(function(t){return new n(e,s,y[t],P,A[t].text,void 0,A[t].align)}),this.setTableHeaderRow(j),this.printHeaderRow(1,!1)}var L=d.reduce(function(e,t){return e[t.name]=t.align,e},{});for(u=0;u<o.length;u+=1){"rowStart"in c&&c.rowStart instanceof Function&&c.rowStart({row:u,data:o[u]},this);var E=l.call(this,o[u],y);for(h=0;h<g.length;h+=1){var T=o[u][g[h]];"cellStart"in c&&c.cellStart instanceof Function&&c.cellStart({row:u,col:h,data:T},this),i.call(this,new n(e,s,y[g[h]],E,T,u+2,L[g[h]]))}}return this.internal.__cell__.table_x=e,this.internal.__cell__.table_y=s,this};var l=function(e,t){var s=this.internal.__cell__.padding,r=this.internal.__cell__.table_font_size,a=this.internal.scaleFactor;return Object.keys(e).map(function(r){var a=e[r];return this.splitTextToSize(a.hasOwnProperty("text")?a.text:a,t[r]-s-s)},this).map(function(e){return this.getLineHeightFactor()*e.length*r/a+s+s},this).reduce(function(e,t){return Math.max(e,t)},0)};e.setTableHeaderRow=function(e){r.call(this),this.internal.__cell__.tableHeaderRow=e},e.printHeaderRow=function(e,t){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var a;if(s=!0,"function"==typeof this.internal.__cell__.headerFunction){var l=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new n(l[0],l[1],l[2],l[3],void 0,-1)}this.setFont(void 0,"bold");for(var o=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){a=this.internal.__cell__.tableHeaderRow[d].clone(),t&&(a.y=this.internal.__cell__.margins.top||0,o.push(a)),a.lineNumber=e;var c=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,a),this.setTextColor(c)}o.length>0&&this.setTableHeaderRow(o),this.setFont(void 0,"normal"),s=!1}}(Om.API);var kh={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Ch=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],$h=Sh(Ch),_h=[100,200,300,400,500,600,700,800,900],Ah=Sh(_h);function Ph(e){var t,s=e.family.replace(/"|'/g,"").toLowerCase(),r=(t=e.style,kh[t=t||"normal"]?t:"normal"),a=function(e){return e?"number"==typeof e?e>=100&&e<=900&&e%100==0?e:400:/^\d00$/.test(e)?parseInt(e):"bold"===e?700:400:400}(e.weight),n=function(e){return"number"==typeof $h[e=e||"normal"]?e:"normal"}(e.stretch);return{family:s,style:r,weight:a,stretch:n,src:e.src||[],ref:e.ref||{name:s,style:[n,r,a].join(" ")}}}function Lh(e,t,s,r){var a;for(a=s;a>=0&&a<t.length;a+=r)if(e[t[a]])return e[t[a]];for(a=s;a>=0&&a<t.length;a-=r)if(e[t[a]])return e[t[a]]}var Eh={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Th={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Ih(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Oh(e){return e.trimLeft()}function Fh(e,t){for(var s=0;s<e.length;){if(e.charAt(s)===t)return[e.substring(0,s),e.substring(s+1)];s+=1}return null}function Rh(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===t?null:[t[0],e.substring(t[0].length)]}var Dh,Mh,Bh,Uh,qh,zh,Wh,Vh,Hh=["times"];function Gh(e,t,s,r,a){var n=4,i=Yh;switch(a){case Om.API.image_compression.FAST:n=1,i=Kh;break;case Om.API.image_compression.MEDIUM:n=6,i=Zh;break;case Om.API.image_compression.SLOW:n=9,i=Xh}e=function(e,t,s,r){for(var a,n=e.length/t,i=new Uint8Array(e.length+n),l=[Jh,Kh,Yh,Zh,Xh],o=0;o<n;o+=1){var d=o*t,c=e.subarray(d,d+t);if(r)i.set(r(c,s,a),d+o);else{for(var u=l.length,m=[],h=0;h<u;h+=1)m[h]=l[h](c,s,a);var x=ex(m.concat());i.set(m[x],d+o)}a=c}return i}(e,t,Math.ceil(s*r/8),i);var l=Od(e,{level:n});return Om.API.__addimage__.arrayBufferToBinaryString(l)}function Jh(e){var t=Array.apply([],e);return t.unshift(0),t}function Kh(e,t){var s=e.length,r=[];r[0]=1;for(var a=0;a<s;a+=1){var n=e[a-t]||0;r[a+1]=e[a]-n+256&255}return r}function Yh(e,t,s){var r=e.length,a=[];a[0]=2;for(var n=0;n<r;n+=1){var i=s&&s[n]||0;a[n+1]=e[n]-i+256&255}return a}function Zh(e,t,s){var r=e.length,a=[];a[0]=3;for(var n=0;n<r;n+=1){var i=e[n-t]||0,l=s&&s[n]||0;a[n+1]=e[n]+256-(i+l>>>1)&255}return a}function Xh(e,t,s){var r=e.length,a=[];a[0]=4;for(var n=0;n<r;n+=1){var i=Qh(e[n-t]||0,s&&s[n]||0,s&&s[n-t]||0);a[n+1]=e[n]-i+256&255}return a}function Qh(e,t,s){if(e===t&&t===s)return e;var r=Math.abs(t-s),a=Math.abs(e-s),n=Math.abs(e+t-s-s);return r<=a&&r<=n?e:a<=n?t:s}function ex(e){var t=e.map(function(e){return e.reduce(function(e,t){return e+Math.abs(t)},0)});return t.indexOf(Math.min.apply(null,t))}function tx(e,t,s){var r=t*s,a=Math.floor(r/8),n=16-(r-8*a+s),i=(1<<s)-1;return rx(e,a)>>n&i}function sx(e,t,s,r){var a=s*r,n=Math.floor(a/8),i=16-(a-8*n+r),l=(1<<r)-1,o=(t&l)<<i;!function(e,t,s){if(t+1<e.byteLength)e.setUint16(t,s,!1);else{var r=s>>8&255;e.setUint8(t,r)}}(e,n,rx(e,n)&~(l<<i)&65535|o)}function rx(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function ax(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var s=e[t++]|e[t++]<<8,r=e[t++]|e[t++]<<8,a=e[t++],n=a>>7,i=1<<1+(7&a);e[t++],e[t++];var l=null,o=null;n&&(l=t,o=i,t+=3*i);var d=!0,c=[],u=0,m=null,h=0,x=null;for(this.width=s,this.height=r;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,x=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!(($=e[t++])>=0))throw Error("Invalid block size");if(0===$)break;t+=$}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var g=e[t++];u=e[t++]|e[t++]<<8,m=e[t++],1&g||(m=null),h=g>>2&7,t++;break;case 254:for(;;){if(!(($=e[t++])>=0))throw Error("Invalid block size");if(0===$)break;t+=$}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var f=e[t++]|e[t++]<<8,p=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,v=e[t++],j=v>>6&1,N=1<<1+(7&v),w=l,S=o,k=!1;v>>7&&(k=!0,w=t,S=N,t+=3*N);var C=t;for(t++;;){var $;if(!(($=e[t++])>=0))throw Error("Invalid block size");if(0===$)break;t+=$}c.push({x:f,y:p,width:b,height:y,has_local_palette:k,palette_offset:w,palette_size:S,data_offset:C,data_length:t-C,transparent_index:m,interlaced:!!j,delay:u,disposal:h});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return x},this.frameInfo=function(e){if(e<0||e>=c.length)throw new Error("Frame index out of range.");return c[e]},this.decodeAndBlitFrameBGRA=function(t,r){var a=this.frameInfo(t),n=a.width*a.height,i=new Uint8Array(n);nx(e,a.data_offset,i,n);var l=a.palette_offset,o=a.transparent_index;null===o&&(o=256);var d=a.width,c=s-d,u=d,m=4*(a.y*s+a.x),h=4*((a.y+a.height)*s+a.x),x=m,g=4*c;!0===a.interlaced&&(g+=4*s*7);for(var f=8,p=0,b=i.length;p<b;++p){var y=i[p];if(0===u&&(u=d,(x+=g)>=h&&(g=4*c+4*s*(f-1),x=m+(d+c)*(f<<1),f>>=1)),y===o)x+=4;else{var v=e[l+3*y],j=e[l+3*y+1],N=e[l+3*y+2];r[x++]=N,r[x++]=j,r[x++]=v,r[x++]=255}--u}},this.decodeAndBlitFrameRGBA=function(t,r){var a=this.frameInfo(t),n=a.width*a.height,i=new Uint8Array(n);nx(e,a.data_offset,i,n);var l=a.palette_offset,o=a.transparent_index;null===o&&(o=256);var d=a.width,c=s-d,u=d,m=4*(a.y*s+a.x),h=4*((a.y+a.height)*s+a.x),x=m,g=4*c;!0===a.interlaced&&(g+=4*s*7);for(var f=8,p=0,b=i.length;p<b;++p){var y=i[p];if(0===u&&(u=d,(x+=g)>=h&&(g=4*c+4*s*(f-1),x=m+(d+c)*(f<<1),f>>=1)),y===o)x+=4;else{var v=e[l+3*y],j=e[l+3*y+1],N=e[l+3*y+2];r[x++]=v,r[x++]=j,r[x++]=N,r[x++]=255}--u}}}function nx(e,t,s,r){for(var a=e[t++],n=1<<a,i=n+1,l=i+1,o=a+1,d=(1<<o)-1,c=0,u=0,m=0,h=e[t++],x=new Int32Array(4096),g=null;;){for(;c<16&&0!==h;)u|=e[t++]<<c,c+=8,1===h?h=e[t++]:--h;if(c<o)break;var f=u&d;if(u>>=o,c-=o,f!==n){if(f===i)break;for(var p=f<l?f:g,b=0,y=p;y>n;)y=x[y]>>8,++b;var v=y;if(m+b+(p!==f?1:0)>r)return void am.log("Warning, gif stream longer than expected.");s[m++]=v;var j=m+=b;for(p!==f&&(s[m++]=v),y=p;b--;)y=x[y],s[--j]=255&y,y>>=8;null!==g&&l<4096&&(x[l++]=g<<8|v,l>=d+1&&o<12&&(++o,d=d<<1|1)),g=f}else l=i+1,d=(1<<(o=a+1))-1,g=null}return m!==r&&am.log("Warning, gif stream shorter than expected."),s
/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/}function ix(e){var t,s,r,a,n,i=Math.floor,l=new Array(64),o=new Array(64),d=new Array(64),c=new Array(64),u=new Array(65535),m=new Array(65535),h=new Array(64),x=new Array(64),g=[],f=0,p=7,b=new Array(64),y=new Array(64),v=new Array(64),j=new Array(256),N=new Array(2048),w=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],$=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],_=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],P=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],L=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function E(e,t){for(var s=0,r=0,a=new Array,n=1;n<=16;n++){for(var i=1;i<=e[n];i++)a[t[r]]=[],a[t[r]][0]=s,a[t[r]][1]=n,r++,s++;s*=2}return a}function T(e){for(var t=e[0],s=e[1]-1;s>=0;)t&1<<s&&(f|=1<<p),s--,--p<0&&(255==f?(I(255),I(0)):I(f),p=7,f=0)}function I(e){g.push(e)}function O(e){I(e>>8&255),I(255&e)}function F(e,t,s,r,a){for(var n,i=a[0],l=a[240],o=function(e,t){var s,r,a,n,i,l,o,d,c,u,m=0;for(c=0;c<8;++c){s=e[m],r=e[m+1],a=e[m+2],n=e[m+3],i=e[m+4],l=e[m+5],o=e[m+6];var x=s+(d=e[m+7]),g=s-d,f=r+o,p=r-o,b=a+l,y=a-l,v=n+i,j=n-i,N=x+v,w=x-v,S=f+b,k=f-b;e[m]=N+S,e[m+4]=N-S;var C=.707106781*(k+w);e[m+2]=w+C,e[m+6]=w-C;var $=.382683433*((N=j+y)-(k=p+g)),_=.5411961*N+$,A=1.306562965*k+$,P=.707106781*(S=y+p),L=g+P,E=g-P;e[m+5]=E+_,e[m+3]=E-_,e[m+1]=L+A,e[m+7]=L-A,m+=8}for(m=0,c=0;c<8;++c){s=e[m],r=e[m+8],a=e[m+16],n=e[m+24],i=e[m+32],l=e[m+40],o=e[m+48];var T=s+(d=e[m+56]),I=s-d,O=r+o,F=r-o,R=a+l,D=a-l,M=n+i,B=n-i,U=T+M,q=T-M,z=O+R,W=O-R;e[m]=U+z,e[m+32]=U-z;var V=.707106781*(W+q);e[m+16]=q+V,e[m+48]=q-V;var H=.382683433*((U=B+D)-(W=F+I)),G=.5411961*U+H,J=1.306562965*W+H,K=.707106781*(z=D+F),Y=I+K,Z=I-K;e[m+40]=Z+G,e[m+24]=Z-G,e[m+8]=Y+J,e[m+56]=Y-J,m++}for(c=0;c<64;++c)u=e[c]*t[c],h[c]=u>0?u+.5|0:u-.5|0;return h}(e,t),d=0;d<64;++d)x[w[d]]=o[d];var c=x[0]-s;s=x[0],0==c?T(r[0]):(T(r[m[n=32767+c]]),T(u[n]));for(var g=63;g>0&&0==x[g];)g--;if(0==g)return T(i),s;for(var f,p=1;p<=g;){for(var b=p;0==x[p]&&p<=g;)++p;var y=p-b;if(y>=16){f=y>>4;for(var v=1;v<=f;++v)T(l);y&=15}n=32767+x[p],T(a[(y<<4)+m[n]]),T(u[n]),p++}return 63!=g&&T(i),s}function R(e){e=Math.min(Math.max(e,1),100),n!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],s=0;s<64;s++){var r=i((t[s]*e+50)/100);r=Math.min(Math.max(r,1),255),l[w[s]]=r}for(var a=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],n=0;n<64;n++){var u=i((a[n]*e+50)/100);u=Math.min(Math.max(u,1),255),o[w[n]]=u}for(var m=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],h=0,x=0;x<8;x++)for(var g=0;g<8;g++)d[h]=1/(l[w[h]]*m[x]*m[g]*8),c[h]=1/(o[w[h]]*m[x]*m[g]*8),h++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),n=e)}this.encode=function(e,n){var i,u;n&&R(n),g=new Array,f=0,p=7,O(65496),O(65504),O(16),I(74),I(70),I(73),I(70),I(0),I(1),I(1),I(0),O(1),O(1),I(0),I(0),function(){O(65499),O(132),I(0);for(var e=0;e<64;e++)I(l[e]);I(1);for(var t=0;t<64;t++)I(o[t])}(),i=e.width,u=e.height,O(65472),O(17),I(8),O(u),O(i),I(3),I(1),I(17),I(0),I(2),I(17),I(1),I(3),I(17),I(1),function(){O(65476),O(418),I(0);for(var e=0;e<16;e++)I(S[e+1]);for(var t=0;t<=11;t++)I(k[t]);I(16);for(var s=0;s<16;s++)I(C[s+1]);for(var r=0;r<=161;r++)I($[r]);I(1);for(var a=0;a<16;a++)I(_[a+1]);for(var n=0;n<=11;n++)I(A[n]);I(17);for(var i=0;i<16;i++)I(P[i+1]);for(var l=0;l<=161;l++)I(L[l])}(),O(65498),O(12),I(3),I(1),I(0),I(2),I(17),I(3),I(17),I(0),I(63),I(0);var m=0,h=0,x=0;f=0,p=7,this.encode.displayName="_encode_";for(var j,w,E,D,M,B,U,q,z,W=e.data,V=e.width,H=e.height,G=4*V,J=0;J<H;){for(j=0;j<G;){for(M=G*J+j,U=-1,q=0,z=0;z<64;z++)B=M+(q=z>>3)*G+(U=4*(7&z)),J+q>=H&&(B-=G*(J+1+q-H)),j+U>=G&&(B-=j+U-G+4),w=W[B++],E=W[B++],D=W[B++],b[z]=(N[w]+N[E+256|0]+N[D+512|0]>>16)-128,y[z]=(N[w+768|0]+N[E+1024|0]+N[D+1280|0]>>16)-128,v[z]=(N[w+1280|0]+N[E+1536|0]+N[D+1792|0]>>16)-128;m=F(b,d,m,t,r),h=F(y,c,h,s,a),x=F(v,c,x,s,a),j+=32}J+=8}if(p>=0){var K=[];K[1]=p+1,K[0]=(1<<p+1)-1,T(K)}return O(65497),new Uint8Array(g)},e=e||50,function(){for(var e=String.fromCharCode,t=0;t<256;t++)j[t]=e(t)}(),t=E(S,k),s=E(_,A),r=E(C,$),a=E(P,L),function(){for(var e=1,t=2,s=1;s<=15;s++){for(var r=e;r<t;r++)m[32767+r]=s,u[32767+r]=[],u[32767+r][1]=s,u[32767+r][0]=r;for(var a=-(t-1);a<=-e;a++)m[32767+a]=s,u[32767+a]=[],u[32767+a][1]=s,u[32767+a][0]=t-1+a;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)N[e]=19595*e,N[e+256|0]=38470*e,N[e+512|0]=7471*e+32768,N[e+768|0]=-11059*e,N[e+1024|0]=-21709*e,N[e+1280|0]=32768*e+8421375,N[e+1536|0]=-27439*e,N[e+1792|0]=-5329*e}(),R(e)}
/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function lx(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function ox(e){function t(e){if(!e)throw Error("assert :P")}function s(e,t,s){for(var r=0;4>r;r++)if(e[t+r]!=s.charCodeAt(r))return!0;return!1}function r(e,t,s,r,a){for(var n=0;n<a;n++)e[t+n]=s[r+n]}function a(e,t,s,r){for(var a=0;a<r;a++)e[t+a]=s}function n(e){return new Int32Array(e)}function i(e,t){for(var s=[],r=0;r<e;r++)s.push(new t);return s}function l(e,t){var s=[];return function e(s,r,a){for(var n=a[r],i=0;i<n&&(s.push(a.length>r+1?[]:new t),!(a.length<r+1));i++)e(s[i],r+1,a)}(s,0,e),s}var o=function(){var e=this;function o(e,t){for(var s=1<<t-1>>>0;e&s;)s>>>=1;return s?(e&s-1)+s:e}function d(e,s,r,a,n){t(!(a%r));do{e[s+(a-=r)]=n}while(0<a)}function c(e,s,r,a,i){if(t(2328>=i),512>=i)var l=n(512);else if(null==(l=n(i)))return 0;return function(e,s,r,a,i,l){var c,m,h=s,x=1<<r,g=n(16),f=n(16);for(t(0!=i),t(null!=a),t(null!=e),t(0<r),m=0;m<i;++m){if(15<a[m])return 0;++g[a[m]]}if(g[0]==i)return 0;for(f[1]=0,c=1;15>c;++c){if(g[c]>1<<c)return 0;f[c+1]=f[c]+g[c]}for(m=0;m<i;++m)c=a[m],0<a[m]&&(l[f[c]++]=m);if(1==f[15])return(a=new u).g=0,a.value=l[0],d(e,h,1,x,a),x;var p,b=-1,y=x-1,v=0,j=1,N=1,w=1<<r;for(m=0,c=1,i=2;c<=r;++c,i<<=1){if(j+=N<<=1,0>(N-=g[c]))return 0;for(;0<g[c];--g[c])(a=new u).g=c,a.value=l[m++],d(e,h+v,i,w,a),v=o(v,c)}for(c=r+1,i=2;15>=c;++c,i<<=1){if(j+=N<<=1,0>(N-=g[c]))return 0;for(;0<g[c];--g[c]){if(a=new u,(v&y)!=b){for(h+=w,p=1<<(b=c)-r;15>b&&!(0>=(p-=g[b]));)++b,p<<=1;x+=w=1<<(p=b-r),e[s+(b=v&y)].g=p+r,e[s+b].value=h-s-b}a.g=c-r,a.value=l[m++],d(e,h+(v>>r),i,w,a),v=o(v,c)}}return j!=2*f[15]-1?0:x}(e,s,r,a,i,l)}function u(){this.value=this.g=0}function m(){this.value=this.g=0}function h(){this.G=i(5,u),this.H=n(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(Rs,m)}function x(e,s,r,a){t(null!=e),t(null!=s),t(2147483648>a),e.Ca=254,e.I=0,e.b=-8,e.Ka=0,e.oa=s,e.pa=r,e.Jd=s,e.Yc=r+a,e.Zc=4<=a?r+a-4+1:r,C(e)}function g(e,t){for(var s=0;0<t--;)s|=_(e,128)<<t;return s}function f(e,t){var s=g(e,t);return $(e)?-s:s}function p(e,s,r,a){var n,i=0;for(t(null!=e),t(null!=s),t(4294967288>a),e.Sb=a,e.Ra=0,e.u=0,e.h=0,4<a&&(a=4),n=0;n<a;++n)i+=s[r+n]<<8*n;e.Ra=i,e.bb=a,e.oa=s,e.pa=r}function b(e){for(;8<=e.u&&e.bb<e.Sb;)e.Ra>>>=8,e.Ra+=e.oa[e.pa+e.bb]<<Bs-8>>>0,++e.bb,e.u-=8;w(e)&&(e.h=1,e.u=0)}function y(e,s){if(t(0<=s),!e.h&&s<=Ms){var r=N(e)&Ds[s];return e.u+=s,b(e),r}return e.h=1,e.u=0}function v(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function j(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function N(e){return e.Ra>>>(e.u&Bs-1)>>>0}function w(e){return t(e.bb<=e.Sb),e.h||e.bb==e.Sb&&e.u>Bs}function S(e,t){e.u=t,e.h=w(e)}function k(e){e.u>=Us&&(t(e.u>=Us),b(e))}function C(e){t(null!=e&&null!=e.oa),e.pa<e.Zc?(e.I=(e.oa[e.pa++]|e.I<<8)>>>0,e.b+=8):(t(null!=e&&null!=e.oa),e.pa<e.Yc?(e.b+=8,e.I=e.oa[e.pa++]|e.I<<8):e.Ka?e.b=0:(e.I<<=8,e.b+=8,e.Ka=1))}function $(e){return g(e,1)}function _(e,t){var s=e.Ca;0>e.b&&C(e);var r=e.b,a=s*t>>>8,n=(e.I>>>r>a)+0;for(n?(s-=a,e.I-=a+1<<r>>>0):s=a+1,r=s,a=0;256<=r;)a+=8,r>>=8;return r=7^a+qs[r],e.b-=r,e.Ca=(s<<r)-1,n}function A(e,t,s){e[t+0]=s>>24&255,e[t+1]=s>>16&255,e[t+2]=s>>8&255,e[t+3]=255&s}function P(e,t){return e[t+0]|e[t+1]<<8}function L(e,t){return P(e,t)|e[t+2]<<16}function E(e,t){return P(e,t)|P(e,t+2)<<16}function T(e,s){var r=1<<s;return t(null!=e),t(0<s),e.X=n(r),null==e.X?0:(e.Mb=32-s,e.Xa=s,1)}function I(e,s){t(null!=e),t(null!=s),t(e.Xa==s.Xa),r(s.X,0,e.X,0,1<<s.Xa)}function O(){this.X=[],this.Xa=this.Mb=0}function F(e,s,r,a){t(null!=r),t(null!=a);var n=r[0],i=a[0];return 0==n&&(n=(e*i+s/2)/s),0==i&&(i=(s*n+e/2)/e),0>=n||0>=i?0:(r[0]=n,a[0]=i,1)}function R(e,t){return e+(1<<t)-1>>>t}function D(e,t){return((4278255360&e)+(4278255360&t)>>>0&4278255360)+((16711935&e)+(16711935&t)>>>0&16711935)>>>0}function M(t,s){e[s]=function(s,r,a,n,i,l,o){var d;for(d=0;d<i;++d){var c=e[t](l[o+d-1],a,n+d);l[o+d]=D(s[r+d],c)}}}function B(){this.ud=this.hd=this.jd=0}function U(e,t){return((4278124286&(e^t))>>>1)+(e&t)>>>0}function q(e){return 0<=e&&256>e?e:0>e?0:255<e?255:void 0}function z(e,t){return q(e+(e-t+.5>>1))}function W(e,t,s){return Math.abs(t-s)-Math.abs(e-s)}function V(e,t,s,r,a,n,i){for(r=n[i-1],s=0;s<a;++s)n[i+s]=r=D(e[t+s],r)}function H(e,t,s,r,a){var n;for(n=0;n<s;++n){var i=e[t+n],l=i>>8&255,o=16711935&(o=(o=16711935&i)+((l<<16)+l));r[a+n]=(4278255360&i)+o>>>0}}function G(e,t){t.jd=255&e,t.hd=e>>8&255,t.ud=e>>16&255}function J(e,t,s,r,a,n){var i;for(i=0;i<r;++i){var l=t[s+i],o=l>>>8,d=l,c=255&(c=(c=l>>>16)+((e.jd<<24>>24)*(o<<24>>24)>>>5));d=255&(d=(d+=(e.hd<<24>>24)*(o<<24>>24)>>>5)+((e.ud<<24>>24)*(c<<24>>24)>>>5)),a[n+i]=(4278255360&l)+(c<<16)+d}}function K(t,s,r,a,n){e[s]=function(e,t,s,r,i,l,o,d,c){for(r=o;r<d;++r)for(o=0;o<c;++o)i[l++]=n(s[a(e[t++])])},e[t]=function(t,s,i,l,o,d,c){var u=8>>t.b,m=t.Ea,h=t.K[0],x=t.w;if(8>u)for(t=(1<<t.b)-1,x=(1<<u)-1;s<i;++s){var g,f=0;for(g=0;g<m;++g)g&t||(f=a(l[o++])),d[c++]=n(h[f&x]),f>>=u}else e["VP8LMapColor"+r](l,o,h,x,d,c,s,i,m)}}function Y(e,t,s,r,a){for(s=t+s;t<s;){var n=e[t++];r[a++]=n>>16&255,r[a++]=n>>8&255,r[a++]=255&n}}function Z(e,t,s,r,a){for(s=t+s;t<s;){var n=e[t++];r[a++]=n>>16&255,r[a++]=n>>8&255,r[a++]=255&n,r[a++]=n>>24&255}}function X(e,t,s,r,a){for(s=t+s;t<s;){var n=(i=e[t++])>>16&240|i>>12&15,i=240&i|i>>28&15;r[a++]=n,r[a++]=i}}function Q(e,t,s,r,a){for(s=t+s;t<s;){var n=(i=e[t++])>>16&248|i>>13&7,i=i>>5&224|i>>3&31;r[a++]=n,r[a++]=i}}function ee(e,t,s,r,a){for(s=t+s;t<s;){var n=e[t++];r[a++]=255&n,r[a++]=n>>8&255,r[a++]=n>>16&255}}function te(e,t,s,a,n,i){if(0==i)for(s=t+s;t<s;)A(a,((i=e[t++])[0]>>24|i[1]>>8&65280|i[2]<<8&16711680|i[3]<<24)>>>0),n+=32;else r(a,n,e,t,s)}function se(t,s){e[s][0]=e[t+"0"],e[s][1]=e[t+"1"],e[s][2]=e[t+"2"],e[s][3]=e[t+"3"],e[s][4]=e[t+"4"],e[s][5]=e[t+"5"],e[s][6]=e[t+"6"],e[s][7]=e[t+"7"],e[s][8]=e[t+"8"],e[s][9]=e[t+"9"],e[s][10]=e[t+"10"],e[s][11]=e[t+"11"],e[s][12]=e[t+"12"],e[s][13]=e[t+"13"],e[s][14]=e[t+"0"],e[s][15]=e[t+"0"]}function re(e){return e==Ur||e==qr||e==zr||e==Wr}function ae(){this.eb=[],this.size=this.A=this.fb=0}function ne(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ie(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ae,this.f.kb=new ne,this.sd=null}function le(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function oe(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function de(e){return alert("todo:WebPSamplerProcessPlane"),e.T}function ce(e,t){var s=e.T,a=t.ba.f.RGBA,n=a.eb,i=a.fb+e.ka*a.A,l=ga[t.ba.S],o=e.y,d=e.O,c=e.f,u=e.N,m=e.ea,h=e.W,x=t.cc,g=t.dc,f=t.Mc,p=t.Nc,b=e.ka,y=e.ka+e.T,v=e.U,j=v+1>>1;for(0==b?l(o,d,null,null,c,u,m,h,c,u,m,h,n,i,null,null,v):(l(t.ec,t.fc,o,d,x,g,f,p,c,u,m,h,n,i-a.A,n,i,v),++s);b+2<y;b+=2)x=c,g=u,f=m,p=h,u+=e.Rc,h+=e.Rc,i+=2*a.A,l(o,(d+=2*e.fa)-e.fa,o,d,x,g,f,p,c,u,m,h,n,i-a.A,n,i,v);return d+=e.fa,e.j+y<e.o?(r(t.ec,t.fc,o,d,v),r(t.cc,t.dc,c,u,j),r(t.Mc,t.Nc,m,h,j),s--):1&y||l(o,d,null,null,c,u,m,h,c,u,m,h,n,i+a.A,null,null,v),s}function ue(e,s,r){var a=e.F,n=[e.J];if(null!=a){var i=e.U,l=s.ba.S,o=l==Dr||l==zr;s=s.ba.f.RGBA;var d=[0],c=e.ka;d[0]=e.T,e.Kb&&(0==c?--d[0]:(--c,n[0]-=e.width),e.j+e.ka+e.T==e.o&&(d[0]=e.o-e.j-c));var u=s.eb;c=s.fb+c*s.A,e=wr(a,n[0],e.width,i,d,u,c+(o?0:3),s.A),t(r==d),e&&re(l)&&jr(u,c,o,i,d,s.A)}return 0}function me(e){var t=e.ma,s=t.ba.S,r=11>s,a=s==Or||s==Rr||s==Dr||s==Mr||12==s||re(s);if(t.memory=null,t.Ib=null,t.Jb=null,t.Nd=null,!Is(t.Oa,e,a?11:12))return 0;if(a&&re(s)&&ps(),e.da)alert("todo:use_scaling");else{if(r){if(t.Ib=de,e.Kb){if(s=e.U+1>>1,t.memory=n(e.U+2*s),null==t.memory)return 0;t.ec=t.memory,t.fc=0,t.cc=t.ec,t.dc=t.fc+e.U,t.Mc=t.cc,t.Nc=t.dc+s,t.Ib=ce,ps()}}else alert("todo:EmitYUV");a&&(t.Jb=ue,r&&gs())}if(r&&!_a){for(e=0;256>e;++e)Aa[e]=89858*(e-128)+Sa>>wa,Ea[e]=-22014*(e-128)+Sa,La[e]=-45773*(e-128),Pa[e]=113618*(e-128)+Sa>>wa;for(e=ka;e<Ca;++e)t=76283*(e-16)+Sa>>wa,Ta[e-ka]=Ve(t,255),Ia[e-ka]=Ve(t+8>>4,15);_a=1}return 1}function he(e){var s=e.ma,r=e.U,a=e.T;return t(!(1&e.ka)),0>=r||0>=a?0:(r=s.Ib(e,s),null!=s.Jb&&s.Jb(e,s,r),s.Dc+=r,1)}function xe(e){e.ma.memory=null}function ge(e,t,s,r){return 47!=y(e,8)?0:(t[0]=y(e,14)+1,s[0]=y(e,14)+1,r[0]=y(e,1),0!=y(e,3)?0:!e.h)}function fe(e,t){if(4>e)return e+1;var s=e-2>>1;return(2+(1&e)<<s)+y(t,s)+1}function pe(e,t){return 120<t?t-120:1<=(s=((s=Yr[t-1])>>4)*e+(8-(15&s)))?s:1;var s}function be(e,t,s){var r=N(s),a=e[t+=255&r].g-8;return 0<a&&(S(s,s.u+8),r=N(s),t+=e[t].value,t+=r&(1<<a)-1),S(s,s.u+e[t].g),e[t].value}function ye(e,s,r){return r.g+=e.g,r.value+=e.value<<s>>>0,t(8>=r.g),e.g}function ve(e,s,r){var a=e.xc;return t((s=0==a?0:e.vc[e.md*(r>>a)+(s>>a)])<e.Wb),e.Ya[s]}function je(e,s,a,n){var i=e.ab,l=e.c*s,o=e.C;s=o+s;var d=a,c=n;for(n=e.Ta,a=e.Ua;0<i--;){var u=e.gc[i],m=o,h=s,x=d,g=c,f=(c=n,d=a,u.Ea);switch(t(m<h),t(h<=u.nc),u.hc){case 2:Vs(x,g,(h-m)*f,c,d);break;case 0:var p=m,b=h,y=c,v=d,j=(C=u).Ea;0==p&&(zs(x,g,null,null,1,y,v),V(x,g+1,0,0,j-1,y,v+1),g+=j,v+=j,++p);for(var N=1<<C.b,w=N-1,S=R(j,C.b),k=C.K,C=C.w+(p>>C.b)*S;p<b;){var $=k,_=C,A=1;for(Ws(x,g,y,v-j,1,y,v);A<j;){var P=(A&~w)+N;P>j&&(P=j),(0,Ys[$[_++]>>8&15])(x,g+ +A,y,v+A-j,P-A,y,v+A),A=P}g+=j,v+=j,++p&w||(C+=S)}h!=u.nc&&r(c,d-f,c,d+(h-m-1)*f,f);break;case 1:for(f=x,b=g,j=(x=u.Ea)-(v=x&~(y=(g=1<<u.b)-1)),p=R(x,u.b),N=u.K,u=u.w+(m>>u.b)*p;m<h;){for(w=N,S=u,k=new B,C=b+v,$=b+x;b<C;)G(w[S++],k),Zs(k,f,b,g,c,d),b+=g,d+=g;b<$&&(G(w[S++],k),Zs(k,f,b,j,c,d),b+=j,d+=j),++m&y||(u+=p)}break;case 3:if(x==c&&g==d&&0<u.b){for(b=c,x=f=d+(h-m)*f-(v=(h-m)*R(u.Ea,u.b)),g=c,y=d,p=[],v=(j=v)-1;0<=v;--v)p[v]=g[y+v];for(v=j-1;0<=v;--v)b[x+v]=p[v];Hs(u,m,h,c,f,c,d)}else Hs(u,m,h,x,g,c,d)}d=n,c=a}c!=a&&r(n,a,d,c,l)}function Ne(e,s){var r=e.V,a=e.Ba+e.c*e.C,n=s-e.C;if(t(s<=e.l.o),t(16>=n),0<n){var i=e.l,l=e.Ta,o=e.Ua,d=i.width;if(je(e,n,r,a),n=o=[o],t((r=e.C)<(a=s)),t(i.v<i.va),a>i.o&&(a=i.o),r<i.j){var c=i.j-r;r=i.j,n[0]+=c*d}if(r>=a?r=0:(n[0]+=4*i.v,i.ka=r-i.j,i.U=i.va-i.v,i.T=a-r,r=1),r){if(o=o[0],11>(r=e.ca).S){var u=r.f.RGBA,m=(a=r.S,n=i.U,i=i.T,c=u.eb,u.A),h=i;for(u=u.fb+e.Ma*u.A;0<h--;){var x=l,g=o,f=n,p=c,b=u;switch(a){case Ir:Xs(x,g,f,p,b);break;case Or:Qs(x,g,f,p,b);break;case Ur:Qs(x,g,f,p,b),jr(p,b,0,f,1,0);break;case Fr:sr(x,g,f,p,b);break;case Rr:te(x,g,f,p,b,1);break;case qr:te(x,g,f,p,b,1),jr(p,b,0,f,1,0);break;case Dr:te(x,g,f,p,b,0);break;case zr:te(x,g,f,p,b,0),jr(p,b,1,f,1,0);break;case Mr:er(x,g,f,p,b);break;case Wr:er(x,g,f,p,b),Nr(p,b,f,1,0);break;case Br:tr(x,g,f,p,b);break;default:t(0)}o+=d,u+=m}e.Ma+=i}else alert("todo:EmitRescaledRowsYUVA");t(e.Ma<=r.height)}}e.C=s,t(e.C<=e.i)}function we(e){var t;if(0<e.ua)return 0;for(t=0;t<e.Wb;++t){var s=e.Ya[t].G,r=e.Ya[t].H;if(0<s[1][r[1]+0].g||0<s[2][r[2]+0].g||0<s[3][r[3]+0].g)return 0}return 1}function Se(e,s,r,a,n,i){if(0!=e.Z){var l=e.qd,o=e.rd;for(t(null!=xa[e.Z]);s<r;++s)xa[e.Z](l,o,a,n,a,n,i),l=a,o=n,n+=i;e.qd=l,e.rd=o}}function ke(e,s){var r=e.l.ma,a=0==r.Z||1==r.Z?e.l.j:e.C;if(a=e.C<a?a:e.C,t(s<=e.l.o),s>a){var n=e.l.width,i=r.ca,l=r.tb+n*a,o=e.V,d=e.Ba+e.c*a,c=e.gc;t(1==e.ab),t(3==c[0].hc),Js(c[0],a,s,o,d,i,l),Se(r,a,s,i,l,n)}e.C=e.Ma=s}function Ce(e,s,r,a,n,i,l){var o=e.$/a,d=e.$%a,c=e.m,u=e.s,m=r+e.$,h=m;n=r+a*n;var x=r+a*i,g=280+u.ua,f=e.Pb?o:16777216,p=0<u.ua?u.Wa:null,b=u.wc,y=m<x?ve(u,d,o):null;t(e.C<i),t(x<=n);var v=!1;e:for(;;){for(;v||m<x;){var j=0;if(o>=f){var C=m-r;t((f=e).Pb),f.wd=f.m,f.xd=C,0<f.s.ua&&I(f.s.Wa,f.s.vb),f=o+Xr}if(d&b||(y=ve(u,d,o)),t(null!=y),y.Qb&&(s[m]=y.qb,v=!0),!v)if(k(c),y.jc){j=c,C=s;var $=m,_=y.pd[N(j)&Rs-1];t(y.jc),256>_.g?(S(j,j.u+_.g),C[$]=_.value,j=0):(S(j,j.u+_.g-256),t(256<=_.value),j=_.value),0==j&&(v=!0)}else j=be(y.G[0],y.H[0],c);if(c.h)break;if(v||256>j){if(!v)if(y.nd)s[m]=(y.qb|j<<8)>>>0;else{if(k(c),v=be(y.G[1],y.H[1],c),k(c),C=be(y.G[2],y.H[2],c),$=be(y.G[3],y.H[3],c),c.h)break;s[m]=($<<24|v<<16|j<<8|C)>>>0}if(v=!1,++m,++d>=a&&(d=0,++o,null!=l&&o<=i&&!(o%16)&&l(e,o),null!=p))for(;h<m;)j=s[h++],p.X[(506832829*j&4294967295)>>>p.Mb]=j}else if(280>j){if(j=fe(j-256,c),C=be(y.G[4],y.H[4],c),k(c),C=pe(a,C=fe(C,c)),c.h)break;if(m-r<C||n-m<j)break e;for($=0;$<j;++$)s[m+$]=s[m+$-C];for(m+=j,d+=j;d>=a;)d-=a,++o,null!=l&&o<=i&&!(o%16)&&l(e,o);if(t(m<=n),d&b&&(y=ve(u,d,o)),null!=p)for(;h<m;)j=s[h++],p.X[(506832829*j&4294967295)>>>p.Mb]=j}else{if(!(j<g))break e;for(v=j-280,t(null!=p);h<m;)j=s[h++],p.X[(506832829*j&4294967295)>>>p.Mb]=j;j=m,t(!(v>>>(C=p).Xa)),s[j]=C.X[v],v=!0}v||t(c.h==w(c))}if(e.Pb&&c.h&&m<n)t(e.m.h),e.a=5,e.m=e.wd,e.$=e.xd,0<e.s.ua&&I(e.s.vb,e.s.Wa);else{if(c.h)break e;null!=l&&l(e,o>i?i:o),e.a=0,e.$=m-r}return 1}return e.a=3,0}function $e(e){t(null!=e),e.vc=null,e.yc=null,e.Ya=null;var s=e.Wa;null!=s&&(s.X=null),e.vb=null,t(null!=e)}function _e(){var t=new ns;return null==t?null:(t.a=0,t.xb=ha,se("Predictor","VP8LPredictors"),se("Predictor","VP8LPredictors_C"),se("PredictorAdd","VP8LPredictorsAdd"),se("PredictorAdd","VP8LPredictorsAdd_C"),Vs=H,Zs=J,Xs=Y,Qs=Z,er=X,tr=Q,sr=ee,e.VP8LMapColor32b=Gs,e.VP8LMapColor8b=Ks,t)}function Ae(e,s,r,l,o){var d=1,m=[e],x=[s],g=l.m,f=l.s,p=null,b=0;e:for(;;){if(r)for(;d&&y(g,1);){var v=m,j=x,w=l,C=1,$=w.m,_=w.gc[w.ab],A=y($,2);if(w.Oc&1<<A)d=0;else{switch(w.Oc|=1<<A,_.hc=A,_.Ea=v[0],_.nc=j[0],_.K=[null],++w.ab,t(4>=w.ab),A){case 0:case 1:_.b=y($,3)+2,C=Ae(R(_.Ea,_.b),R(_.nc,_.b),0,w,_.K),_.K=_.K[0];break;case 3:var P,L=y($,8)+1,E=16<L?0:4<L?1:2<L?2:3;if(v[0]=R(_.Ea,E),_.b=E,P=C=Ae(L,1,0,w,_.K)){var I,O=L,F=_,M=1<<(8>>F.b),B=n(M);if(null==B)P=0;else{var U=F.K[0],q=F.w;for(B[0]=F.K[0][0],I=1;I<1*O;++I)B[I]=D(U[q+I],B[I-1]);for(;I<4*M;++I)B[I]=0;F.K[0]=null,F.K[0]=B,P=1}}C=P;break;case 2:break;default:t(0)}d=C}}if(m=m[0],x=x[0],d&&y(g,1)&&!(d=1<=(b=y(g,4))&&11>=b)){l.a=3;break e}var z;if(z=d)t:{var W,V,H,G=l,J=m,K=x,Y=b,Z=r,X=G.m,Q=G.s,ee=[null],te=1,se=0,re=Zr[Y];s:for(;;){if(Z&&y(X,1)){var ae=y(X,3)+2,ne=R(J,ae),ie=R(K,ae),le=ne*ie;if(!Ae(ne,ie,0,G,ee))break s;for(ee=ee[0],Q.xc=ae,W=0;W<le;++W){var oe=ee[W]>>8&65535;ee[W]=oe,oe>=te&&(te=oe+1)}}if(X.h)break s;for(V=0;5>V;++V){var de=Gr[V];!V&&0<Y&&(de+=1<<Y),se<de&&(se=de)}var ce=i(te*re,u),ue=te,me=i(ue,h);if(null==me)var he=null;else t(65536>=ue),he=me;var xe=n(se);if(null==he||null==xe||null==ce){G.a=1;break s}var ge=ce;for(W=H=0;W<te;++W){var fe=he[W],pe=fe.G,be=fe.H,ve=0,je=1,Ne=0;for(V=0;5>V;++V){de=Gr[V],pe[V]=ge,be[V]=H,!V&&0<Y&&(de+=1<<Y);r:{var we,Se=de,ke=G,_e=xe,Pe=ge,Le=H,Ee=0,Te=ke.m,Ie=y(Te,1);if(a(_e,0,0,Se),Ie){var Oe=y(Te,1)+1,Fe=y(Te,1),Re=y(Te,0==Fe?1:8);_e[Re]=1,2==Oe&&(_e[Re=y(Te,8)]=1);var De=1}else{var Me=n(19),Be=y(Te,4)+4;if(19<Be){ke.a=3;var Ue=0;break r}for(we=0;we<Be;++we)Me[Kr[we]]=y(Te,3);var qe=void 0,ze=void 0,We=ke,Ve=Me,He=Se,Ge=_e,Je=0,Ke=We.m,Ye=8,Ze=i(128,u);a:for(;c(Ze,0,7,Ve,19);){if(y(Ke,1)){var Xe=2+2*y(Ke,3);if((qe=2+y(Ke,Xe))>He)break a}else qe=He;for(ze=0;ze<He&&qe--;){k(Ke);var Qe=Ze[0+(127&N(Ke))];S(Ke,Ke.u+Qe.g);var et=Qe.value;if(16>et)Ge[ze++]=et,0!=et&&(Ye=et);else{var tt=16==et,st=et-16,rt=Hr[st],at=y(Ke,Vr[st])+rt;if(ze+at>He)break a;for(var nt=tt?Ye:0;0<at--;)Ge[ze++]=nt}}Je=1;break a}Je||(We.a=3),De=Je}(De=De&&!Te.h)&&(Ee=c(Pe,Le,8,_e,Se)),De&&0!=Ee?Ue=Ee:(ke.a=3,Ue=0)}if(0==Ue)break s;if(je&&1==Jr[V]&&(je=0==ge[H].g),ve+=ge[H].g,H+=Ue,3>=V){var it,lt=xe[0];for(it=1;it<de;++it)xe[it]>lt&&(lt=xe[it]);Ne+=lt}}if(fe.nd=je,fe.Qb=0,je&&(fe.qb=(pe[3][be[3]+0].value<<24|pe[1][be[1]+0].value<<16|pe[2][be[2]+0].value)>>>0,0==ve&&256>pe[0][be[0]+0].value&&(fe.Qb=1,fe.qb+=pe[0][be[0]+0].value<<8)),fe.jc=!fe.Qb&&6>Ne,fe.jc){var ot,dt=fe;for(ot=0;ot<Rs;++ot){var ct=ot,ut=dt.pd[ct],mt=dt.G[0][dt.H[0]+ct];256<=mt.value?(ut.g=mt.g+256,ut.value=mt.value):(ut.g=0,ut.value=0,ct>>=ye(mt,8,ut),ct>>=ye(dt.G[1][dt.H[1]+ct],16,ut),ct>>=ye(dt.G[2][dt.H[2]+ct],0,ut),ye(dt.G[3][dt.H[3]+ct],24,ut))}}}Q.vc=ee,Q.Wb=te,Q.Ya=he,Q.yc=ce,z=1;break t}z=0}if(!(d=z)){l.a=3;break e}if(0<b){if(f.ua=1<<b,!T(f.Wa,b)){l.a=1,d=0;break e}}else f.ua=0;var ht=l,xt=m,gt=x,ft=ht.s,pt=ft.xc;if(ht.c=xt,ht.i=gt,ft.md=R(xt,pt),ft.wc=0==pt?-1:(1<<pt)-1,r){l.xb=ma;break e}if(null==(p=n(m*x))){l.a=1,d=0;break e}d=(d=Ce(l,p,0,m,x,x,null))&&!g.h;break e}return d?(null!=o?o[0]=p:(t(null==p),t(r)),l.$=0,r||$e(f)):$e(f),d}function Pe(e,s){var r=e.c*e.i,a=r+s+16*s;return t(e.c<=s),e.V=n(a),null==e.V?(e.Ta=null,e.Ua=0,e.a=1,0):(e.Ta=e.V,e.Ua=e.Ba+r+s,1)}function Le(e,s){var r=e.C,a=s-r,n=e.V,i=e.Ba+e.c*r;for(t(s<=e.l.o);0<a;){var l=16<a?16:a,o=e.l.ma,d=e.l.width,c=d*l,u=o.ca,m=o.tb+d*r,h=e.Ta,x=e.Ua;je(e,l,n,i),Sr(h,x,u,m,c),Se(o,r,r+l,u,m,d),a-=l,n+=l*e.c,r+=l}t(r==s),e.C=e.Ma=s}function Ee(){this.ub=this.yd=this.td=this.Rb=0}function Te(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ie(){this.Fb=this.Bb=this.Cb=0,this.Zb=n(4),this.Lb=n(4)}function Oe(){var e;this.Yb=(function e(t,s,r){for(var a=r[s],n=0;n<a&&(t.push(r.length>s+1?[]:0),!(r.length<s+1));n++)e(t[n],s+1,r)}(e=[],0,[3,11]),e)}function Fe(){this.jb=n(3),this.Wc=l([4,8],Oe),this.Xc=l([4,17],Oe)}function Re(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new n(4),this.od=new n(4)}function De(){this.ld=this.La=this.dd=this.tc=0}function Me(){this.Na=this.la=0}function Be(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ue(){this.ad=n(384),this.Za=0,this.Ob=n(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function qe(){this.uc=this.M=this.Nb=0,this.wa=Array(new De),this.Y=0,this.ya=Array(new Ue),this.aa=0,this.l=new He}function ze(){this.y=n(16),this.f=n(8),this.ea=n(8)}function We(){this.cb=this.a=0,this.sc="",this.m=new v,this.Od=new Ee,this.Kc=new Te,this.ed=new Re,this.Qa=new Ie,this.Ic=this.$c=this.Aa=0,this.D=new qe,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,v),this.ia=0,this.pb=i(4,Be),this.Pa=new Fe,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ze),this.Hd=0,this.rb=Array(new Me),this.sb=0,this.wa=Array(new De),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ue),this.L=this.aa=0,this.gd=l([4,2],De),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ve(e,t){return 0>e?0:e>t?t:e}function He(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ge(){var e=new We;return null!=e&&(e.a=0,e.sc="OK",e.cb=0,e.Xb=0,ta||(ta=Ze)),e}function Je(e,t,s){return 0==e.a&&(e.a=t,e.sc=s,e.cb=0),0}function Ke(e,t,s){return 3<=s&&157==e[t+0]&&1==e[t+1]&&42==e[t+2]}function Ye(e,s){if(null==e)return 0;if(e.a=0,e.sc="OK",null==s)return Je(e,2,"null VP8Io passed to VP8GetHeaders()");var r=s.data,n=s.w,i=s.ha;if(4>i)return Je(e,7,"Truncated header.");var l=r[n+0]|r[n+1]<<8|r[n+2]<<16,o=e.Od;if(o.Rb=!(1&l),o.td=l>>1&7,o.yd=l>>4&1,o.ub=l>>5,3<o.td)return Je(e,3,"Incorrect keyframe parameters.");if(!o.yd)return Je(e,4,"Frame not displayable.");n+=3,i-=3;var d=e.Kc;if(o.Rb){if(7>i)return Je(e,7,"cannot parse picture header");if(!Ke(r,n,i))return Je(e,3,"Bad code word");d.c=16383&(r[n+4]<<8|r[n+3]),d.Td=r[n+4]>>6,d.i=16383&(r[n+6]<<8|r[n+5]),d.Ud=r[n+6]>>6,n+=7,i-=7,e.za=d.c+15>>4,e.Ub=d.i+15>>4,s.width=d.c,s.height=d.i,s.Da=0,s.j=0,s.v=0,s.va=s.width,s.o=s.height,s.da=0,s.ib=s.width,s.hb=s.height,s.U=s.width,s.T=s.height,a((l=e.Pa).jb,0,255,l.jb.length),t(null!=(l=e.Qa)),l.Cb=0,l.Bb=0,l.Fb=1,a(l.Zb,0,0,l.Zb.length),a(l.Lb,0,0,l.Lb)}if(o.ub>i)return Je(e,7,"bad partition length");x(l=e.m,r,n,o.ub),n+=o.ub,i-=o.ub,o.Rb&&(d.Ld=$(l),d.Kd=$(l)),d=e.Qa;var c,u=e.Pa;if(t(null!=l),t(null!=d),d.Cb=$(l),d.Cb){if(d.Bb=$(l),$(l)){for(d.Fb=$(l),c=0;4>c;++c)d.Zb[c]=$(l)?f(l,7):0;for(c=0;4>c;++c)d.Lb[c]=$(l)?f(l,6):0}if(d.Bb)for(c=0;3>c;++c)u.jb[c]=$(l)?g(l,8):255}else d.Bb=0;if(l.Ka)return Je(e,3,"cannot parse segment header");if((d=e.ed).zd=$(l),d.Tb=g(l,6),d.wb=g(l,3),d.Pc=$(l),d.Pc&&$(l)){for(u=0;4>u;++u)$(l)&&(d.vd[u]=f(l,6));for(u=0;4>u;++u)$(l)&&(d.od[u]=f(l,6))}if(e.L=0==d.Tb?0:d.zd?1:2,l.Ka)return Je(e,3,"cannot parse filter header");var m=i;if(i=c=n,n=c+m,d=m,e.Xb=(1<<g(e.m,2))-1,m<3*(u=e.Xb))r=7;else{for(c+=3*u,d-=3*u,m=0;m<u;++m){var h=r[i+0]|r[i+1]<<8|r[i+2]<<16;h>d&&(h=d),x(e.Jc[+m],r,c,h),c+=h,d-=h,i+=3}x(e.Jc[+u],r,c,d),r=c<n?0:5}if(0!=r)return Je(e,r,"cannot parse partitions");for(r=g(c=e.m,7),i=$(c)?f(c,4):0,n=$(c)?f(c,4):0,d=$(c)?f(c,4):0,u=$(c)?f(c,4):0,c=$(c)?f(c,4):0,m=e.Qa,h=0;4>h;++h){if(m.Cb){var p=m.Zb[h];m.Fb||(p+=r)}else{if(0<h){e.pb[h]=e.pb[0];continue}p=r}var b=e.pb[h];b.Sc[0]=Qr[Ve(p+i,127)],b.Sc[1]=ea[Ve(p+0,127)],b.Eb[0]=2*Qr[Ve(p+n,127)],b.Eb[1]=101581*ea[Ve(p+d,127)]>>16,8>b.Eb[1]&&(b.Eb[1]=8),b.Qc[0]=Qr[Ve(p+u,117)],b.Qc[1]=ea[Ve(p+c,127)],b.lc=p+c}if(!o.Rb)return Je(e,4,"Not a key frame.");for($(l),o=e.Pa,r=0;4>r;++r){for(i=0;8>i;++i)for(n=0;3>n;++n)for(d=0;11>d;++d)u=_(l,la[r][i][n][d])?g(l,8):na[r][i][n][d],o.Wc[r][i].Yb[n][d]=u;for(i=0;17>i;++i)o.Xc[r][i]=o.Wc[r][oa[i]]}return e.kc=$(l),e.kc&&(e.Bd=g(l,8)),e.cb=1}function Ze(e,t,s,r,a,n,i){var l=t[a].Yb[s];for(s=0;16>a;++a){if(!_(e,l[s+0]))return a;for(;!_(e,l[s+1]);)if(l=t[++a].Yb[0],s=0,16==a)return 16;var o=t[a+1].Yb;if(_(e,l[s+2])){var d=e,c=0;if(_(d,(m=l)[(u=s)+3]))if(_(d,m[u+6])){for(l=0,u=2*(c=_(d,m[u+8]))+(m=_(d,m[u+9+c])),c=0,m=sa[u];m[l];++l)c+=c+_(d,m[l]);c+=3+(8<<u)}else _(d,m[u+7])?(c=7+2*_(d,165),c+=_(d,145)):c=5+_(d,159);else c=_(d,m[u+4])?3+_(d,m[u+5]):2;l=o[2]}else c=1,l=o[1];o=i+ra[a],0>(d=e).b&&C(d);var u,m=d.b,h=(u=d.Ca>>1)-(d.I>>m)>>31;--d.b,d.Ca+=h,d.Ca|=1,d.I-=(u+1&h)<<m,n[o]=((c^h)-h)*r[(0<a)+0]}return 16}function Xe(e){var t=e.rb[e.sb-1];t.la=0,t.Na=0,a(e.zc,0,0,e.zc.length),e.ja=0}function Qe(e,t,s,r,a){a=e[t+s+32*r]+(a>>3),e[t+s+32*r]=-256&a?0>a?0:255:a}function et(e,t,s,r,a,n){Qe(e,t,0,s,r+a),Qe(e,t,1,s,r+n),Qe(e,t,2,s,r-n),Qe(e,t,3,s,r-a)}function tt(e){return(20091*e>>16)+e}function st(e,t,s,r){var a,i=0,l=n(16);for(a=0;4>a;++a){var o=e[t+0]+e[t+8],d=e[t+0]-e[t+8],c=(35468*e[t+4]>>16)-tt(e[t+12]),u=tt(e[t+4])+(35468*e[t+12]>>16);l[i+0]=o+u,l[i+1]=d+c,l[i+2]=d-c,l[i+3]=o-u,i+=4,t++}for(a=i=0;4>a;++a)o=(e=l[i+0]+4)+l[i+8],d=e-l[i+8],c=(35468*l[i+4]>>16)-tt(l[i+12]),Qe(s,r,0,0,o+(u=tt(l[i+4])+(35468*l[i+12]>>16))),Qe(s,r,1,0,d+c),Qe(s,r,2,0,d-c),Qe(s,r,3,0,o-u),i++,r+=32}function rt(e,t,s,r){var a=e[t+0]+4,n=35468*e[t+4]>>16,i=tt(e[t+4]),l=35468*e[t+1]>>16;et(s,r,0,a+i,e=tt(e[t+1]),l),et(s,r,1,a+n,e,l),et(s,r,2,a-n,e,l),et(s,r,3,a-i,e,l)}function at(e,t,s,r,a){st(e,t,s,r),a&&st(e,t+16,s,r+4)}function nt(e,t,s,r){ar(e,t+0,s,r,1),ar(e,t+32,s,r+128,1)}function it(e,t,s,r){var a;for(e=e[t+0]+4,a=0;4>a;++a)for(t=0;4>t;++t)Qe(s,r,t,a,e)}function lt(e,t,s,r){e[t+0]&&lr(e,t+0,s,r),e[t+16]&&lr(e,t+16,s,r+4),e[t+32]&&lr(e,t+32,s,r+128),e[t+48]&&lr(e,t+48,s,r+128+4)}function ot(e,t,s,r){var a,i=n(16);for(a=0;4>a;++a){var l=e[t+0+a]+e[t+12+a],o=e[t+4+a]+e[t+8+a],d=e[t+4+a]-e[t+8+a],c=e[t+0+a]-e[t+12+a];i[0+a]=l+o,i[8+a]=l-o,i[4+a]=c+d,i[12+a]=c-d}for(a=0;4>a;++a)l=(e=i[0+4*a]+3)+i[3+4*a],o=i[1+4*a]+i[2+4*a],d=i[1+4*a]-i[2+4*a],c=e-i[3+4*a],s[r+0]=l+o>>3,s[r+16]=c+d>>3,s[r+32]=l-o>>3,s[r+48]=c-d>>3,r+=64}function dt(e,t,s){var r,a=t-32,n=Er,i=255-e[a-1];for(r=0;r<s;++r){var l,o=n,d=i+e[t-1];for(l=0;l<s;++l)e[t+l]=o[d+e[a+l]];t+=32}}function ct(e,t){dt(e,t,4)}function ut(e,t){dt(e,t,8)}function mt(e,t){dt(e,t,16)}function ht(e,t){var s;for(s=0;16>s;++s)r(e,t+32*s,e,t-32,16)}function xt(e,t){var s;for(s=16;0<s;--s)a(e,t,e[t-1],16),t+=32}function gt(e,t,s){var r;for(r=0;16>r;++r)a(t,s+32*r,e,16)}function ft(e,t){var s,r=16;for(s=0;16>s;++s)r+=e[t-1+32*s]+e[t+s-32];gt(r>>5,e,t)}function pt(e,t){var s,r=8;for(s=0;16>s;++s)r+=e[t-1+32*s];gt(r>>4,e,t)}function bt(e,t){var s,r=8;for(s=0;16>s;++s)r+=e[t+s-32];gt(r>>4,e,t)}function yt(e,t){gt(128,e,t)}function vt(e,t,s){return e+2*t+s+2>>2}function jt(e,t){var s,a=t-32;for(a=new Uint8Array([vt(e[a-1],e[a+0],e[a+1]),vt(e[a+0],e[a+1],e[a+2]),vt(e[a+1],e[a+2],e[a+3]),vt(e[a+2],e[a+3],e[a+4])]),s=0;4>s;++s)r(e,t+32*s,a,0,a.length)}function Nt(e,t){var s=e[t-1],r=e[t-1+32],a=e[t-1+64],n=e[t-1+96];A(e,t+0,16843009*vt(e[t-1-32],s,r)),A(e,t+32,16843009*vt(s,r,a)),A(e,t+64,16843009*vt(r,a,n)),A(e,t+96,16843009*vt(a,n,n))}function wt(e,t){var s,r=4;for(s=0;4>s;++s)r+=e[t+s-32]+e[t-1+32*s];for(r>>=3,s=0;4>s;++s)a(e,t+32*s,r,4)}function St(e,t){var s=e[t-1+0],r=e[t-1+32],a=e[t-1+64],n=e[t-1-32],i=e[t+0-32],l=e[t+1-32],o=e[t+2-32],d=e[t+3-32];e[t+0+96]=vt(r,a,e[t-1+96]),e[t+1+96]=e[t+0+64]=vt(s,r,a),e[t+2+96]=e[t+1+64]=e[t+0+32]=vt(n,s,r),e[t+3+96]=e[t+2+64]=e[t+1+32]=e[t+0+0]=vt(i,n,s),e[t+3+64]=e[t+2+32]=e[t+1+0]=vt(l,i,n),e[t+3+32]=e[t+2+0]=vt(o,l,i),e[t+3+0]=vt(d,o,l)}function kt(e,t){var s=e[t+1-32],r=e[t+2-32],a=e[t+3-32],n=e[t+4-32],i=e[t+5-32],l=e[t+6-32],o=e[t+7-32];e[t+0+0]=vt(e[t+0-32],s,r),e[t+1+0]=e[t+0+32]=vt(s,r,a),e[t+2+0]=e[t+1+32]=e[t+0+64]=vt(r,a,n),e[t+3+0]=e[t+2+32]=e[t+1+64]=e[t+0+96]=vt(a,n,i),e[t+3+32]=e[t+2+64]=e[t+1+96]=vt(n,i,l),e[t+3+64]=e[t+2+96]=vt(i,l,o),e[t+3+96]=vt(l,o,o)}function Ct(e,t){var s=e[t-1+0],r=e[t-1+32],a=e[t-1+64],n=e[t-1-32],i=e[t+0-32],l=e[t+1-32],o=e[t+2-32],d=e[t+3-32];e[t+0+0]=e[t+1+64]=n+i+1>>1,e[t+1+0]=e[t+2+64]=i+l+1>>1,e[t+2+0]=e[t+3+64]=l+o+1>>1,e[t+3+0]=o+d+1>>1,e[t+0+96]=vt(a,r,s),e[t+0+64]=vt(r,s,n),e[t+0+32]=e[t+1+96]=vt(s,n,i),e[t+1+32]=e[t+2+96]=vt(n,i,l),e[t+2+32]=e[t+3+96]=vt(i,l,o),e[t+3+32]=vt(l,o,d)}function $t(e,t){var s=e[t+0-32],r=e[t+1-32],a=e[t+2-32],n=e[t+3-32],i=e[t+4-32],l=e[t+5-32],o=e[t+6-32],d=e[t+7-32];e[t+0+0]=s+r+1>>1,e[t+1+0]=e[t+0+64]=r+a+1>>1,e[t+2+0]=e[t+1+64]=a+n+1>>1,e[t+3+0]=e[t+2+64]=n+i+1>>1,e[t+0+32]=vt(s,r,a),e[t+1+32]=e[t+0+96]=vt(r,a,n),e[t+2+32]=e[t+1+96]=vt(a,n,i),e[t+3+32]=e[t+2+96]=vt(n,i,l),e[t+3+64]=vt(i,l,o),e[t+3+96]=vt(l,o,d)}function _t(e,t){var s=e[t-1+0],r=e[t-1+32],a=e[t-1+64],n=e[t-1+96];e[t+0+0]=s+r+1>>1,e[t+2+0]=e[t+0+32]=r+a+1>>1,e[t+2+32]=e[t+0+64]=a+n+1>>1,e[t+1+0]=vt(s,r,a),e[t+3+0]=e[t+1+32]=vt(r,a,n),e[t+3+32]=e[t+1+64]=vt(a,n,n),e[t+3+64]=e[t+2+64]=e[t+0+96]=e[t+1+96]=e[t+2+96]=e[t+3+96]=n}function At(e,t){var s=e[t-1+0],r=e[t-1+32],a=e[t-1+64],n=e[t-1+96],i=e[t-1-32],l=e[t+0-32],o=e[t+1-32],d=e[t+2-32];e[t+0+0]=e[t+2+32]=s+i+1>>1,e[t+0+32]=e[t+2+64]=r+s+1>>1,e[t+0+64]=e[t+2+96]=a+r+1>>1,e[t+0+96]=n+a+1>>1,e[t+3+0]=vt(l,o,d),e[t+2+0]=vt(i,l,o),e[t+1+0]=e[t+3+32]=vt(s,i,l),e[t+1+32]=e[t+3+64]=vt(r,s,i),e[t+1+64]=e[t+3+96]=vt(a,r,s),e[t+1+96]=vt(n,a,r)}function Pt(e,t){var s;for(s=0;8>s;++s)r(e,t+32*s,e,t-32,8)}function Lt(e,t){var s;for(s=0;8>s;++s)a(e,t,e[t-1],8),t+=32}function Et(e,t,s){var r;for(r=0;8>r;++r)a(t,s+32*r,e,8)}function Tt(e,t){var s,r=8;for(s=0;8>s;++s)r+=e[t+s-32]+e[t-1+32*s];Et(r>>4,e,t)}function It(e,t){var s,r=4;for(s=0;8>s;++s)r+=e[t+s-32];Et(r>>3,e,t)}function Ot(e,t){var s,r=4;for(s=0;8>s;++s)r+=e[t-1+32*s];Et(r>>3,e,t)}function Ft(e,t){Et(128,e,t)}function Rt(e,t,s){var r=e[t-s],a=e[t+0],n=3*(a-r)+Pr[1020+e[t-2*s]-e[t+s]],i=Lr[112+(n+4>>3)];e[t-s]=Er[255+r+Lr[112+(n+3>>3)]],e[t+0]=Er[255+a-i]}function Dt(e,t,s,r){var a=e[t+0],n=e[t+s];return Tr[255+e[t-2*s]-e[t-s]]>r||Tr[255+n-a]>r}function Mt(e,t,s,r){return 4*Tr[255+e[t-s]-e[t+0]]+Tr[255+e[t-2*s]-e[t+s]]<=r}function Bt(e,t,s,r,a){var n=e[t-3*s],i=e[t-2*s],l=e[t-s],o=e[t+0],d=e[t+s],c=e[t+2*s],u=e[t+3*s];return 4*Tr[255+l-o]+Tr[255+i-d]>r?0:Tr[255+e[t-4*s]-n]<=a&&Tr[255+n-i]<=a&&Tr[255+i-l]<=a&&Tr[255+u-c]<=a&&Tr[255+c-d]<=a&&Tr[255+d-o]<=a}function Ut(e,t,s,r){var a=2*r+1;for(r=0;16>r;++r)Mt(e,t+r,s,a)&&Rt(e,t+r,s)}function qt(e,t,s,r){var a=2*r+1;for(r=0;16>r;++r)Mt(e,t+r*s,1,a)&&Rt(e,t+r*s,1)}function zt(e,t,s,r){var a;for(a=3;0<a;--a)Ut(e,t+=4*s,s,r)}function Wt(e,t,s,r){var a;for(a=3;0<a;--a)qt(e,t+=4,s,r)}function Vt(e,t,s,r,a,n,i,l){for(n=2*n+1;0<a--;){if(Bt(e,t,s,n,i))if(Dt(e,t,s,l))Rt(e,t,s);else{var o=e,d=t,c=s,u=o[d-2*c],m=o[d-c],h=o[d+0],x=o[d+c],g=o[d+2*c],f=27*(b=Pr[1020+3*(h-m)+Pr[1020+u-x]])+63>>7,p=18*b+63>>7,b=9*b+63>>7;o[d-3*c]=Er[255+o[d-3*c]+b],o[d-2*c]=Er[255+u+p],o[d-c]=Er[255+m+f],o[d+0]=Er[255+h-f],o[d+c]=Er[255+x-p],o[d+2*c]=Er[255+g-b]}t+=r}}function Ht(e,t,s,r,a,n,i,l){for(n=2*n+1;0<a--;){if(Bt(e,t,s,n,i))if(Dt(e,t,s,l))Rt(e,t,s);else{var o=e,d=t,c=s,u=o[d-c],m=o[d+0],h=o[d+c],x=Lr[112+(4+(g=3*(m-u))>>3)],g=Lr[112+(g+3>>3)],f=x+1>>1;o[d-2*c]=Er[255+o[d-2*c]+f],o[d-c]=Er[255+u+g],o[d+0]=Er[255+m-x],o[d+c]=Er[255+h-f]}t+=r}}function Gt(e,t,s,r,a,n){Vt(e,t,s,1,16,r,a,n)}function Jt(e,t,s,r,a,n){Vt(e,t,1,s,16,r,a,n)}function Kt(e,t,s,r,a,n){var i;for(i=3;0<i;--i)Ht(e,t+=4*s,s,1,16,r,a,n)}function Yt(e,t,s,r,a,n){var i;for(i=3;0<i;--i)Ht(e,t+=4,1,s,16,r,a,n)}function Zt(e,t,s,r,a,n,i,l){Vt(e,t,a,1,8,n,i,l),Vt(s,r,a,1,8,n,i,l)}function Xt(e,t,s,r,a,n,i,l){Vt(e,t,1,a,8,n,i,l),Vt(s,r,1,a,8,n,i,l)}function Qt(e,t,s,r,a,n,i,l){Ht(e,t+4*a,a,1,8,n,i,l),Ht(s,r+4*a,a,1,8,n,i,l)}function es(e,t,s,r,a,n,i,l){Ht(e,t+4,1,a,8,n,i,l),Ht(s,r+4,1,a,8,n,i,l)}function ts(){this.ba=new ie,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new oe,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ss(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function rs(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function as(){this.ua=0,this.Wa=new O,this.vb=new O,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new h,this.yc=new u}function ns(){this.xb=this.a=0,this.l=new He,this.ca=new ie,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new j,this.Pb=0,this.wd=new j,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new as,this.ab=0,this.gc=i(4,rs),this.Oc=0}function is(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new He,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ls(e,t,s,r,a,n,i){for(e=null==e?0:e[t+0],t=0;t<i;++t)a[n+t]=e+s[r+t]&255,e=a[n+t]}function os(e,t,s,r,a,n,i){var l;if(null==e)ls(null,null,s,r,a,n,i);else for(l=0;l<i;++l)a[n+l]=e[t+l]+s[r+l]&255}function ds(e,t,s,r,a,n,i){if(null==e)ls(null,null,s,r,a,n,i);else{var l,o=e[t+0],d=o,c=o;for(l=0;l<i;++l)d=c+(o=e[t+l])-d,c=s[r+l]+(-256&d?0>d?0:255:d)&255,d=o,a[n+l]=c}}function cs(e,s,a,i){var l=s.width,o=s.o;if(t(null!=e&&null!=s),0>a||0>=i||a+i>o)return null;if(!e.Cc){if(null==e.ga){var d;if(e.ga=new is,(d=null==e.ga)||(d=s.width*s.o,t(0==e.Gb.length),e.Gb=n(d),e.Uc=0,null==e.Gb?d=0:(e.mb=e.Gb,e.nb=e.Uc,e.rc=null,d=1),d=!d),!d){d=e.ga;var c=e.Fa,u=e.P,m=e.qc,h=e.mb,x=e.nb,g=u+1,f=m-1,b=d.l;if(t(null!=c&&null!=h&&null!=s),xa[0]=null,xa[1]=ls,xa[2]=os,xa[3]=ds,d.ca=h,d.tb=x,d.c=s.width,d.i=s.height,t(0<d.c&&0<d.i),1>=m)s=0;else if(d.$a=3&c[u+0],d.Z=c[u+0]>>2&3,d.Lc=c[u+0]>>4&3,u=c[u+0]>>6&3,0>d.$a||1<d.$a||4<=d.Z||1<d.Lc||u)s=0;else if(b.put=he,b.ac=me,b.bc=xe,b.ma=d,b.width=s.width,b.height=s.height,b.Da=s.Da,b.v=s.v,b.va=s.va,b.j=s.j,b.o=s.o,d.$a)e:{t(1==d.$a),s=_e();t:for(;;){if(null==s){s=0;break e}if(t(null!=d),d.mc=s,s.c=d.c,s.i=d.i,s.l=d.l,s.l.ma=d,s.l.width=d.c,s.l.height=d.i,s.a=0,p(s.m,c,g,f),!Ae(d.c,d.i,1,s,null))break t;if(1==s.ab&&3==s.gc[0].hc&&we(s.s)?(d.ic=1,c=s.c*s.i,s.Ta=null,s.Ua=0,s.V=n(c),s.Ba=0,null==s.V?(s.a=1,s=0):s=1):(d.ic=0,s=Pe(s,d.c)),!s)break t;s=1;break e}d.mc=null,s=0}else s=f>=d.c*d.i;d=!s}if(d)return null;1!=e.ga.Lc?e.Ga=0:i=o-a}t(null!=e.ga),t(a+i<=o);e:{if(s=(c=e.ga).c,o=c.l.o,0==c.$a){if(g=e.rc,f=e.Vc,b=e.Fa,u=e.P+1+a*s,m=e.mb,h=e.nb+a*s,t(u<=e.P+e.qc),0!=c.Z)for(t(null!=xa[c.Z]),d=0;d<i;++d)xa[c.Z](g,f,b,u,m,h,s),g=m,f=h,h+=s,u+=s;else for(d=0;d<i;++d)r(m,h,b,u,s),g=m,f=h,h+=s,u+=s;e.rc=g,e.Vc=f}else{if(t(null!=c.mc),s=a+i,t(null!=(d=c.mc)),t(s<=d.i),d.C>=s)s=1;else if(c.ic||gs(),c.ic){c=d.V,g=d.Ba,f=d.c;var y=d.i,v=(b=1,u=d.$/f,m=d.$%f,h=d.m,x=d.s,d.$),j=f*y,N=f*s,S=x.wc,C=v<N?ve(x,m,u):null;t(v<=j),t(s<=y),t(we(x));t:for(;;){for(;!h.h&&v<N;){if(m&S||(C=ve(x,m,u)),t(null!=C),k(h),256>(y=be(C.G[0],C.H[0],h)))c[g+v]=y,++v,++m>=f&&(m=0,++u<=s&&!(u%16)&&ke(d,u));else{if(!(280>y)){b=0;break t}y=fe(y-256,h);var $,_=be(C.G[4],C.H[4],h);if(k(h),!(v>=(_=pe(f,_=fe(_,h)))&&j-v>=y)){b=0;break t}for($=0;$<y;++$)c[g+v+$]=c[g+v+$-_];for(v+=y,m+=y;m>=f;)m-=f,++u<=s&&!(u%16)&&ke(d,u);v<N&&m&S&&(C=ve(x,m,u))}t(h.h==w(h))}ke(d,u>s?s:u);break t}!b||h.h&&v<j?(b=0,d.a=h.h?5:3):d.$=v,s=b}else s=Ce(d,d.V,d.Ba,d.c,d.i,s,Le);if(!s){i=0;break e}}a+i>=o&&(e.Cc=1),i=1}if(!i)return null;if(e.Cc&&(null!=(i=e.ga)&&(i.mc=null),e.ga=null,0<e.Ga))return alert("todo:WebPDequantizeLevels"),null}return e.nb+a*l}function us(e,t,s,r,a,n){for(;0<a--;){var i,l=e,o=t+(s?1:0),d=e,c=t+(s?0:3);for(i=0;i<r;++i){var u=d[c+4*i];255!=u&&(u*=32897,l[o+4*i+0]=l[o+4*i+0]*u>>23,l[o+4*i+1]=l[o+4*i+1]*u>>23,l[o+4*i+2]=l[o+4*i+2]*u>>23)}t+=n}}function ms(e,t,s,r,a){for(;0<r--;){var n;for(n=0;n<s;++n){var i=e[t+2*n+0],l=15&(d=e[t+2*n+1]),o=4369*l,d=(240&d|d>>4)*o>>16;e[t+2*n+0]=(240&i|i>>4)*o>>16&240|(15&i|i<<4)*o>>16>>4&15,e[t+2*n+1]=240&d|l}t+=a}}function hs(e,t,s,r,a,n,i,l){var o,d,c=255;for(d=0;d<a;++d){for(o=0;o<r;++o){var u=e[t+o];n[i+4*o]=u,c&=u}t+=s,i+=l}return 255!=c}function xs(e,t,s,r,a){var n;for(n=0;n<a;++n)s[r+n]=e[t+n]>>8}function gs(){jr=us,Nr=ms,wr=hs,Sr=xs}function fs(s,r,a){e[s]=function(e,s,n,i,l,o,d,c,u,m,h,x,g,f,p,b,y){var v,j=y-1>>1,N=l[o+0]|d[c+0]<<16,w=u[m+0]|h[x+0]<<16;t(null!=e);var S=3*N+w+131074>>2;for(r(e[s+0],255&S,S>>16,g,f),null!=n&&(S=3*w+N+131074>>2,r(n[i+0],255&S,S>>16,p,b)),v=1;v<=j;++v){var k=l[o+v]|d[c+v]<<16,C=u[m+v]|h[x+v]<<16,$=N+k+w+C+524296,_=$+2*(k+w)>>3;S=_+N>>1,N=($=$+2*(N+C)>>3)+k>>1,r(e[s+2*v-1],255&S,S>>16,g,f+(2*v-1)*a),r(e[s+2*v-0],255&N,N>>16,g,f+(2*v-0)*a),null!=n&&(S=$+w>>1,N=_+C>>1,r(n[i+2*v-1],255&S,S>>16,p,b+(2*v-1)*a),r(n[i+2*v+0],255&N,N>>16,p,b+(2*v+0)*a)),N=k,w=C}1&y||(S=3*N+w+131074>>2,r(e[s+y-1],255&S,S>>16,g,f+(y-1)*a),null!=n&&(S=3*w+N+131074>>2,r(n[i+y-1],255&S,S>>16,p,b+(y-1)*a)))}}function ps(){ga[Ir]=fa,ga[Or]=ba,ga[Fr]=pa,ga[Rr]=ya,ga[Dr]=va,ga[Mr]=ja,ga[Br]=Na,ga[Ur]=ba,ga[qr]=ya,ga[zr]=va,ga[Wr]=ja}function bs(e){return-16384&e?0>e?0:255:e>>$a}function ys(e,t){return bs((19077*e>>8)+(26149*t>>8)-14234)}function vs(e,t,s){return bs((19077*e>>8)-(6419*t>>8)-(13320*s>>8)+8708)}function js(e,t){return bs((19077*e>>8)+(33050*t>>8)-17685)}function Ns(e,t,s,r,a){r[a+0]=ys(e,s),r[a+1]=vs(e,t,s),r[a+2]=js(e,t)}function ws(e,t,s,r,a){r[a+0]=js(e,t),r[a+1]=vs(e,t,s),r[a+2]=ys(e,s)}function Ss(e,t,s,r,a){var n=vs(e,t,s);t=n<<3&224|js(e,t)>>3,r[a+0]=248&ys(e,s)|n>>5,r[a+1]=t}function ks(e,t,s,r,a){var n=240&js(e,t)|15;r[a+0]=240&ys(e,s)|vs(e,t,s)>>4,r[a+1]=n}function Cs(e,t,s,r,a){r[a+0]=255,Ns(e,t,s,r,a+1)}function $s(e,t,s,r,a){ws(e,t,s,r,a),r[a+3]=255}function _s(e,t,s,r,a){Ns(e,t,s,r,a),r[a+3]=255}function Ve(e,t){return 0>e?0:e>t?t:e}function As(t,s,r){e[t]=function(e,t,a,n,i,l,o,d,c){for(var u=d+(-2&c)*r;d!=u;)s(e[t+0],a[n+0],i[l+0],o,d),s(e[t+1],a[n+0],i[l+0],o,d+r),t+=2,++n,++l,d+=2*r;1&c&&s(e[t+0],a[n+0],i[l+0],o,d)}}function Ps(e,t,s){return 0==s?0==e?0==t?6:5:0==t?4:0:s}function Ls(e,t,s,r,a){switch(e>>>30){case 3:ar(t,s,r,a,0);break;case 2:nr(t,s,r,a);break;case 1:lr(t,s,r,a)}}function Es(e,t){var s,n,i=t.M,l=t.Nb,o=e.oc,d=e.pc+40,c=e.oc,u=e.pc+584,m=e.oc,h=e.pc+600;for(s=0;16>s;++s)o[d+32*s-1]=129;for(s=0;8>s;++s)c[u+32*s-1]=129,m[h+32*s-1]=129;for(0<i?o[d-1-32]=c[u-1-32]=m[h-1-32]=129:(a(o,d-32-1,127,21),a(c,u-32-1,127,9),a(m,h-32-1,127,9)),n=0;n<e.za;++n){var x=t.ya[t.aa+n];if(0<n){for(s=-1;16>s;++s)r(o,d+32*s-4,o,d+32*s+12,4);for(s=-1;8>s;++s)r(c,u+32*s-4,c,u+32*s+4,4),r(m,h+32*s-4,m,h+32*s+4,4)}var g=e.Gd,f=e.Hd+n,p=x.ad,b=x.Hc;if(0<i&&(r(o,d-32,g[f].y,0,16),r(c,u-32,g[f].f,0,8),r(m,h-32,g[f].ea,0,8)),x.Za){var y=o,v=d-32+16;for(0<i&&(n>=e.za-1?a(y,v,g[f].y[15],4):r(y,v,g[f+1].y,0,4)),s=0;4>s;s++)y[v+128+s]=y[v+256+s]=y[v+384+s]=y[v+0+s];for(s=0;16>s;++s,b<<=2)y=o,v=d+Oa[s],ca[x.Ob[s]](y,v),Ls(b,p,16*+s,y,v)}else if(y=Ps(n,i,x.Ob[0]),da[y](o,d),0!=b)for(s=0;16>s;++s,b<<=2)Ls(b,p,16*+s,o,d+Oa[s]);for(s=x.Gc,y=Ps(n,i,x.Dd),ua[y](c,u),ua[y](m,h),b=p,y=c,v=u,255&(x=0|s)&&(170&x?ir(b,256,y,v):or(b,256,y,v)),x=m,b=h,255&(s>>=8)&&(170&s?ir(p,320,x,b):or(p,320,x,b)),i<e.Ub-1&&(r(g[f].y,0,o,d+480,16),r(g[f].f,0,c,u+224,8),r(g[f].ea,0,m,h+224,8)),s=8*l*e.B,g=e.sa,f=e.ta+16*n+16*l*e.R,p=e.qa,x=e.ra+8*n+s,b=e.Ha,y=e.Ia+8*n+s,s=0;16>s;++s)r(g,f+s*e.R,o,d+32*s,16);for(s=0;8>s;++s)r(p,x+s*e.B,c,u+32*s,8),r(b,y+s*e.B,m,h+32*s,8)}}function Ts(e,r,a,n,i,l,o,d,c){var u=[0],m=[0],h=0,x=null!=c?c.kd:0,g=null!=c?c:new ss;if(null==e||12>a)return 7;g.data=e,g.w=r,g.ha=a,r=[r],a=[a],g.gb=[g.gb];e:{var f=r,b=a,y=g.gb;if(t(null!=e),t(null!=b),t(null!=y),y[0]=0,12<=b[0]&&!s(e,f[0],"RIFF")){if(s(e,f[0]+8,"WEBP")){y=3;break e}var v=E(e,f[0]+4);if(12>v||4294967286<v){y=3;break e}if(x&&v>b[0]-8){y=7;break e}y[0]=v,f[0]+=12,b[0]-=12}y=0}if(0!=y)return y;for(v=0<g.gb[0],a=a[0];;){e:{var N=e;b=r,y=a;var w=u,S=m,k=f=[0];if((_=h=[h])[0]=0,8>y[0])y=7;else{if(!s(N,b[0],"VP8X")){if(10!=E(N,b[0]+4)){y=3;break e}if(18>y[0]){y=7;break e}var C=E(N,b[0]+8),$=1+L(N,b[0]+12);if(2147483648<=$*(N=1+L(N,b[0]+15))){y=3;break e}null!=k&&(k[0]=C),null!=w&&(w[0]=$),null!=S&&(S[0]=N),b[0]+=18,y[0]-=18,_[0]=1}y=0}}if(h=h[0],f=f[0],0!=y)return y;if(b=!!(2&f),!v&&h)return 3;if(null!=l&&(l[0]=!!(16&f)),null!=o&&(o[0]=b),null!=d&&(d[0]=0),o=u[0],f=m[0],h&&b&&null==c){y=0;break}if(4>a){y=7;break}if(v&&h||!v&&!h&&!s(e,r[0],"ALPH")){a=[a],g.na=[g.na],g.P=[g.P],g.Sa=[g.Sa];e:{C=e,y=r,v=a;var _=g.gb;w=g.na,S=g.P,k=g.Sa,$=22,t(null!=C),t(null!=v),N=y[0];var A=v[0];for(t(null!=w),t(null!=k),w[0]=null,S[0]=null,k[0]=0;;){if(y[0]=N,v[0]=A,8>A){y=7;break e}var P=E(C,N+4);if(4294967286<P){y=3;break e}var T=8+P+1&-2;if($+=T,0<_&&$>_){y=3;break e}if(!s(C,N,"VP8 ")||!s(C,N,"VP8L")){y=0;break e}if(A[0]<T){y=7;break e}s(C,N,"ALPH")||(w[0]=C,S[0]=N+8,k[0]=P),N+=T,A-=T}}if(a=a[0],g.na=g.na[0],g.P=g.P[0],g.Sa=g.Sa[0],0!=y)break}a=[a],g.Ja=[g.Ja],g.xa=[g.xa];e:if(_=e,y=r,v=a,w=g.gb[0],S=g.Ja,k=g.xa,C=y[0],N=!s(_,C,"VP8 "),$=!s(_,C,"VP8L"),t(null!=_),t(null!=v),t(null!=S),t(null!=k),8>v[0])y=7;else{if(N||$){if(_=E(_,C+4),12<=w&&_>w-12){y=3;break e}if(x&&_>v[0]-8){y=7;break e}S[0]=_,y[0]+=8,v[0]-=8,k[0]=$}else k[0]=5<=v[0]&&47==_[C+0]&&!(_[C+4]>>5),S[0]=v[0];y=0}if(a=a[0],g.Ja=g.Ja[0],g.xa=g.xa[0],r=r[0],0!=y)break;if(4294967286<g.Ja)return 3;if(null==d||b||(d[0]=g.xa?2:1),o=[o],f=[f],g.xa){if(5>a){y=7;break}d=o,x=f,b=l,null==e||5>a?e=0:5<=a&&47==e[r+0]&&!(e[r+4]>>5)?(v=[0],_=[0],w=[0],p(S=new j,e,r,a),ge(S,v,_,w)?(null!=d&&(d[0]=v[0]),null!=x&&(x[0]=_[0]),null!=b&&(b[0]=w[0]),e=1):e=0):e=0}else{if(10>a){y=7;break}d=f,null==e||10>a||!Ke(e,r+3,a-3)?e=0:(x=e[r+0]|e[r+1]<<8|e[r+2]<<16,b=16383&(e[r+7]<<8|e[r+6]),e=16383&(e[r+9]<<8|e[r+8]),1&x||3<(x>>1&7)||!(x>>4&1)||x>>5>=g.Ja||!b||!e?e=0:(o&&(o[0]=b),d&&(d[0]=e),e=1))}if(!e)return 3;if(o=o[0],f=f[0],h&&(u[0]!=o||m[0]!=f))return 3;null!=c&&(c[0]=g,c.offset=r-c.w,t(4294967286>r-c.w),t(c.offset==c.ha-a));break}return 0==y||7==y&&h&&null==c?(null!=l&&(l[0]|=null!=g.na&&0<g.na.length),null!=n&&(n[0]=o),null!=i&&(i[0]=f),0):y}function Is(e,t,s){var r=t.width,a=t.height,n=0,i=0,l=r,o=a;if(t.Da=null!=e&&0<e.Da,t.Da&&(l=e.cd,o=e.bd,n=e.v,i=e.j,11>s||(n&=-2,i&=-2),0>n||0>i||0>=l||0>=o||n+l>r||i+o>a))return 0;if(t.v=n,t.j=i,t.va=n+l,t.o=i+o,t.U=l,t.T=o,t.da=null!=e&&0<e.da,t.da){if(!F(l,o,s=[e.ib],n=[e.hb]))return 0;t.ib=s[0],t.hb=n[0]}return t.ob=null!=e&&e.ob,t.Kb=null==e||!e.Sd,t.da&&(t.ob=t.ib<3*r/4&&t.hb<3*a/4,t.Kb=0),1}function Os(e){if(null==e)return 2;if(11>e.S){var t=e.f.RGBA;t.fb+=(e.height-1)*t.A,t.A=-t.A}else t=e.f.kb,e=e.height,t.O+=(e-1)*t.fa,t.fa=-t.fa,t.N+=(e-1>>1)*t.Ab,t.Ab=-t.Ab,t.W+=(e-1>>1)*t.Db,t.Db=-t.Db,null!=t.F&&(t.J+=(e-1)*t.lb,t.lb=-t.lb);return 0}function Fs(e,t,s,r){if(null==r||0>=e||0>=t)return 2;if(null!=s){if(s.Da){var a=s.cd,i=s.bd,l=-2&s.v,o=-2&s.j;if(0>l||0>o||0>=a||0>=i||l+a>e||o+i>t)return 2;e=a,t=i}if(s.da){if(!F(e,t,a=[s.ib],i=[s.hb]))return 2;e=a[0],t=i[0]}}r.width=e,r.height=t;e:{var d=r.width,c=r.height;if(e=r.S,0>=d||0>=c||!(e>=Ir&&13>e))e=2;else{if(0>=r.Rd&&null==r.sd){l=i=a=t=0;var u=(o=d*Da[e])*c;if(11>e||(i=(c+1)/2*(t=(d+1)/2),12==e&&(l=(a=d)*c)),null==(c=n(u+2*i+l))){e=1;break e}r.sd=c,11>e?((d=r.f.RGBA).eb=c,d.fb=0,d.A=o,d.size=u):((d=r.f.kb).y=c,d.O=0,d.fa=o,d.Fd=u,d.f=c,d.N=0+u,d.Ab=t,d.Cd=i,d.ea=c,d.W=0+u+i,d.Db=t,d.Ed=i,12==e&&(d.F=c,d.J=0+u+2*i),d.Tc=l,d.lb=a)}if(t=1,a=r.S,i=r.width,l=r.height,a>=Ir&&13>a)if(11>a)e=r.f.RGBA,t&=(o=Math.abs(e.A))*(l-1)+i<=e.size,t&=o>=i*Da[a],t&=null!=e.eb;else{e=r.f.kb,o=(i+1)/2,u=(l+1)/2,d=Math.abs(e.fa),c=Math.abs(e.Ab);var m=Math.abs(e.Db),h=Math.abs(e.lb),x=h*(l-1)+i;t&=d*(l-1)+i<=e.Fd,t&=c*(u-1)+o<=e.Cd,t=(t&=m*(u-1)+o<=e.Ed)&d>=i&c>=o&m>=o,t&=null!=e.y,t&=null!=e.f,t&=null!=e.ea,12==a&&(t&=h>=i,t&=x<=e.Tc,t&=null!=e.F)}else t=0;e=t?0:2}}return 0!=e||null!=s&&s.fd&&(e=Os(r)),e}var Rs=64,Ds=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ms=24,Bs=32,Us=8,qs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];M("Predictor0","PredictorAdd0"),e.Predictor0=function(){return 4278190080},e.Predictor1=function(e){return e},e.Predictor2=function(e,t,s){return t[s+0]},e.Predictor3=function(e,t,s){return t[s+1]},e.Predictor4=function(e,t,s){return t[s-1]},e.Predictor5=function(e,t,s){return U(U(e,t[s+1]),t[s+0])},e.Predictor6=function(e,t,s){return U(e,t[s-1])},e.Predictor7=function(e,t,s){return U(e,t[s+0])},e.Predictor8=function(e,t,s){return U(t[s-1],t[s+0])},e.Predictor9=function(e,t,s){return U(t[s+0],t[s+1])},e.Predictor10=function(e,t,s){return U(U(e,t[s-1]),U(t[s+0],t[s+1]))},e.Predictor11=function(e,t,s){var r=t[s+0];return 0>=W(r>>24&255,e>>24&255,(t=t[s-1])>>24&255)+W(r>>16&255,e>>16&255,t>>16&255)+W(r>>8&255,e>>8&255,t>>8&255)+W(255&r,255&e,255&t)?r:e},e.Predictor12=function(e,t,s){var r=t[s+0];return(q((e>>24&255)+(r>>24&255)-((t=t[s-1])>>24&255))<<24|q((e>>16&255)+(r>>16&255)-(t>>16&255))<<16|q((e>>8&255)+(r>>8&255)-(t>>8&255))<<8|q((255&e)+(255&r)-(255&t)))>>>0},e.Predictor13=function(e,t,s){var r=t[s-1];return(z((e=U(e,t[s+0]))>>24&255,r>>24&255)<<24|z(e>>16&255,r>>16&255)<<16|z(e>>8&255,r>>8&255)<<8|z(255&e,255&r))>>>0};var zs=e.PredictorAdd0;e.PredictorAdd1=V,M("Predictor2","PredictorAdd2"),M("Predictor3","PredictorAdd3"),M("Predictor4","PredictorAdd4"),M("Predictor5","PredictorAdd5"),M("Predictor6","PredictorAdd6"),M("Predictor7","PredictorAdd7"),M("Predictor8","PredictorAdd8"),M("Predictor9","PredictorAdd9"),M("Predictor10","PredictorAdd10"),M("Predictor11","PredictorAdd11"),M("Predictor12","PredictorAdd12"),M("Predictor13","PredictorAdd13");var Ws=e.PredictorAdd2;K("ColorIndexInverseTransform","MapARGB","32b",function(e){return e>>8&255},function(e){return e}),K("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(e){return e},function(e){return e>>8&255});var Vs,Hs=e.ColorIndexInverseTransform,Gs=e.MapARGB,Js=e.VP8LColorIndexInverseTransformAlpha,Ks=e.MapAlpha,Ys=e.VP8LPredictorsAdd=[];Ys.length=16,(e.VP8LPredictors=[]).length=16,(e.VP8LPredictorsAdd_C=[]).length=16,(e.VP8LPredictors_C=[]).length=16;var Zs,Xs,Qs,er,tr,sr,rr,ar,nr,ir,lr,or,dr,cr,ur,mr,hr,xr,gr,fr,pr,br,yr,vr,jr,Nr,wr,Sr,kr=n(511),Cr=n(2041),$r=n(225),_r=n(767),Ar=0,Pr=Cr,Lr=$r,Er=_r,Tr=kr,Ir=0,Or=1,Fr=2,Rr=3,Dr=4,Mr=5,Br=6,Ur=7,qr=8,zr=9,Wr=10,Vr=[2,3,7],Hr=[3,3,11],Gr=[280,256,256,256,40],Jr=[0,1,1,1,0],Kr=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Yr=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Zr=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Xr=8,Qr=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ea=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ta=null,sa=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ra=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],aa=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],na=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],ia=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],la=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],oa=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],da=[],ca=[],ua=[],ma=1,ha=2,xa=[],ga=[];fs("UpsampleRgbLinePair",Ns,3),fs("UpsampleBgrLinePair",ws,3),fs("UpsampleRgbaLinePair",_s,4),fs("UpsampleBgraLinePair",$s,4),fs("UpsampleArgbLinePair",Cs,4),fs("UpsampleRgba4444LinePair",ks,2),fs("UpsampleRgb565LinePair",Ss,2);var fa=e.UpsampleRgbLinePair,pa=e.UpsampleBgrLinePair,ba=e.UpsampleRgbaLinePair,ya=e.UpsampleBgraLinePair,va=e.UpsampleArgbLinePair,ja=e.UpsampleRgba4444LinePair,Na=e.UpsampleRgb565LinePair,wa=16,Sa=1<<wa-1,ka=-227,Ca=482,$a=6,_a=0,Aa=n(256),Pa=n(256),La=n(256),Ea=n(256),Ta=n(Ca-ka),Ia=n(Ca-ka);As("YuvToRgbRow",Ns,3),As("YuvToBgrRow",ws,3),As("YuvToRgbaRow",_s,4),As("YuvToBgraRow",$s,4),As("YuvToArgbRow",Cs,4),As("YuvToRgba4444Row",ks,2),As("YuvToRgb565Row",Ss,2);var Oa=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Fa=[0,2,8],Ra=[8,7,6,4,4,2,2,2,1,1,1,1];this.WebPDecodeRGBA=function(e,s,l,o,d){var c=Or,u=new ts,m=new ie;u.ba=m,m.S=c,m.width=[m.width],m.height=[m.height];var h=m.width,x=m.height,g=new le;if(null==g||null==e)var f=2;else t(null!=g),f=Ts(e,s,l,g.width,g.height,g.Pd,g.Qd,g.format,null);if(0!=f?h=0:(null!=h&&(h[0]=g.width[0]),null!=x&&(x[0]=g.height[0]),h=1),h){m.width=m.width[0],m.height=m.height[0],null!=o&&(o[0]=m.width),null!=d&&(d[0]=m.height);e:{if(o=new He,(d=new ss).data=e,d.w=s,d.ha=l,d.kd=1,s=[0],t(null!=d),(0==(e=Ts(d.data,d.w,d.ha,null,null,null,s,null,d))||7==e)&&s[0]&&(e=4),0==(s=e)){if(t(null!=u),o.data=d.data,o.w=d.w+d.offset,o.ha=d.ha-d.offset,o.put=he,o.ac=me,o.bc=xe,o.ma=u,d.xa){if(null==(e=_e())){u=1;break e}if(function(e,s){var r=[0],a=[0],n=[0];t:for(;;){if(null==e)return 0;if(null==s)return e.a=2,0;if(e.l=s,e.a=0,p(e.m,s.data,s.w,s.ha),!ge(e.m,r,a,n)){e.a=3;break t}if(e.xb=ha,s.width=r[0],s.height=a[0],!Ae(r[0],a[0],1,e,null))break t;return 1}return t(0!=e.a),0}(e,o)){if(o=0==(s=Fs(o.width,o.height,u.Oa,u.ba))){t:{o=e;s:for(;;){if(null==o){o=0;break t}if(t(null!=o.s.yc),t(null!=o.s.Ya),t(0<o.s.Wb),t(null!=(l=o.l)),t(null!=(d=l.ma)),0!=o.xb){if(o.ca=d.ba,o.tb=d.tb,t(null!=o.ca),!Is(d.Oa,l,Rr)){o.a=2;break s}if(!Pe(o,l.width))break s;if(l.da)break s;if((l.da||re(o.ca.S))&&gs(),11>o.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=o.ca.f.kb.F&&gs()),o.Pb&&0<o.s.ua&&null==o.s.vb.X&&!T(o.s.vb,o.s.Wa.Xa)){o.a=1;break s}o.xb=0}if(!Ce(o,o.V,o.Ba,o.c,o.i,l.o,Ne))break s;d.Dc=o.Ma,o=1;break t}t(0!=o.a),o=0}o=!o}o&&(s=e.a)}else s=e.a}else{if(null==(e=new Ge)){u=1;break e}if(e.Fa=d.na,e.P=d.P,e.qc=d.Sa,Ye(e,o)){if(0==(s=Fs(o.width,o.height,u.Oa,u.ba))){if(e.Aa=0,l=u.Oa,t(null!=(d=e)),null!=l){if(0<(h=0>(h=l.Md)?0:100<h?255:255*h/100)){for(x=g=0;4>x;++x)12>(f=d.pb[x]).lc&&(f.ia=h*Ra[0>f.lc?0:f.lc]>>3),g|=f.ia;g&&(alert("todo:VP8InitRandom"),d.ia=1)}d.Ga=l.Id,100<d.Ga?d.Ga=100:0>d.Ga&&(d.Ga=0)}(function(e,s){if(null==e)return 0;if(null==s)return Je(e,2,"NULL VP8Io parameter in VP8Decode().");if(!e.cb&&!Ye(e,s))return 0;if(t(e.cb),null==s.ac||s.ac(s)){s.ob&&(e.L=0);var l=Fa[e.L];if(2==e.L?(e.yb=0,e.zb=0):(e.yb=s.v-l>>4,e.zb=s.j-l>>4,0>e.yb&&(e.yb=0),0>e.zb&&(e.zb=0)),e.Va=s.o+15+l>>4,e.Hb=s.va+15+l>>4,e.Hb>e.za&&(e.Hb=e.za),e.Va>e.Ub&&(e.Va=e.Ub),0<e.L){var o=e.ed;for(l=0;4>l;++l){var d;if(e.Qa.Cb){var c=e.Qa.Lb[l];e.Qa.Fb||(c+=o.Tb)}else c=o.Tb;for(d=0;1>=d;++d){var u=e.gd[l][d],m=c;if(o.Pc&&(m+=o.vd[0],d&&(m+=o.od[0])),0<(m=0>m?0:63<m?63:m)){var h=m;0<o.wb&&(h=4<o.wb?h>>2:h>>1)>9-o.wb&&(h=9-o.wb),1>h&&(h=1),u.dd=h,u.tc=2*m+h,u.ld=40<=m?2:15<=m?1:0}else u.tc=0;u.La=d}}}l=0}else Je(e,6,"Frame setup failed"),l=e.a;if(l=0==l){if(l){e.$c=0,0<e.Aa||(e.Ic=1);t:{l=e.Ic,o=4*(h=e.za);var x=32*h,g=h+1,f=0<e.L?h*(0<e.Aa?2:1):0,p=(2==e.Aa?2:1)*h;if((u=o+832+(d=3*(16*l+Fa[e.L])/2*x)+(c=null!=e.Fa&&0<e.Fa.length?e.Kc.c*e.Kc.i:0))!=u)l=0;else{if(u>e.Vb){if(e.Vb=0,e.Ec=n(u),e.Fc=0,null==e.Ec){l=Je(e,1,"no memory during frame initialization.");break t}e.Vb=u}u=e.Ec,m=e.Fc,e.Ac=u,e.Bc=m,m+=o,e.Gd=i(x,ze),e.Hd=0,e.rb=i(g+1,Me),e.sb=1,e.wa=f?i(f,De):null,e.Y=0,e.D.Nb=0,e.D.wa=e.wa,e.D.Y=e.Y,0<e.Aa&&(e.D.Y+=h),t(!0),e.oc=u,e.pc=m,m+=832,e.ya=i(p,Ue),e.aa=0,e.D.ya=e.ya,e.D.aa=e.aa,2==e.Aa&&(e.D.aa+=h),e.R=16*h,e.B=8*h,h=(x=Fa[e.L])*e.R,x=x/2*e.B,e.sa=u,e.ta=m+h,e.qa=e.sa,e.ra=e.ta+16*l*e.R+x,e.Ha=e.qa,e.Ia=e.ra+8*l*e.B+x,e.$c=0,m+=d,e.mb=c?u:null,e.nb=c?m:null,t(m+c<=e.Fc+e.Vb),Xe(e),a(e.Ac,e.Bc,0,o),l=1}}if(l){if(s.ka=0,s.y=e.sa,s.O=e.ta,s.f=e.qa,s.N=e.ra,s.ea=e.Ha,s.Vd=e.Ia,s.fa=e.R,s.Rc=e.B,s.F=null,s.J=0,!Ar){for(l=-255;255>=l;++l)kr[255+l]=0>l?-l:l;for(l=-1020;1020>=l;++l)Cr[1020+l]=-128>l?-128:127<l?127:l;for(l=-112;112>=l;++l)$r[112+l]=-16>l?-16:15<l?15:l;for(l=-255;510>=l;++l)_r[255+l]=0>l?0:255<l?255:l;Ar=1}rr=ot,ar=at,ir=nt,lr=it,or=lt,nr=rt,dr=Gt,cr=Jt,ur=Zt,mr=Xt,hr=Kt,xr=Yt,gr=Qt,fr=es,pr=Ut,br=qt,yr=zt,vr=Wt,ca[0]=wt,ca[1]=ct,ca[2]=jt,ca[3]=Nt,ca[4]=St,ca[5]=Ct,ca[6]=kt,ca[7]=$t,ca[8]=At,ca[9]=_t,da[0]=ft,da[1]=mt,da[2]=ht,da[3]=xt,da[4]=pt,da[5]=bt,da[6]=yt,ua[0]=Tt,ua[1]=ut,ua[2]=Pt,ua[3]=Lt,ua[4]=Ot,ua[5]=It,ua[6]=Ft,l=1}else l=0}l&&(l=function(e,s){for(e.M=0;e.M<e.Va;++e.M){var i,l=e.Jc[e.M&e.Xb],o=e.m,d=e;for(i=0;i<d.za;++i){var c=o,u=d,m=u.Ac,h=u.Bc+4*i,x=u.zc,g=u.ya[u.aa+i];if(u.Qa.Bb?g.$b=_(c,u.Pa.jb[0])?2+_(c,u.Pa.jb[2]):_(c,u.Pa.jb[1]):g.$b=0,u.kc&&(g.Ad=_(c,u.Bd)),g.Za=!_(c,145)+0,g.Za){var f=g.Ob,p=0;for(u=0;4>u;++u){var b,y=x[0+u];for(b=0;4>b;++b){y=ia[m[h+b]][y];for(var v=aa[_(c,y[0])];0<v;)v=aa[2*v+_(c,y[v])];y=-v,m[h+b]=y}r(f,p,m,h,4),p+=4,x[0+u]=y}}else y=_(c,156)?_(c,128)?1:3:_(c,163)?2:0,g.Ob[0]=y,a(m,h,y,4),a(x,0,y,4);g.Dd=_(c,142)?_(c,114)?_(c,183)?1:3:2:0}if(d.m.Ka)return Je(e,7,"Premature end-of-partition0 encountered.");for(;e.ja<e.za;++e.ja){if(d=l,c=(o=e).rb[o.sb-1],m=o.rb[o.sb+o.ja],i=o.ya[o.aa+o.ja],h=o.kc?i.Ad:0)c.la=m.la=0,i.Za||(c.Na=m.Na=0),i.Hc=0,i.Gc=0,i.ia=0;else{var j,N;if(c=m,m=d,h=o.Pa.Xc,x=o.ya[o.aa+o.ja],g=o.pb[x.$b],u=x.ad,f=0,p=o.rb[o.sb-1],y=b=0,a(u,f,0,384),x.Za)var w=0,S=h[3];else{v=n(16);var k=c.Na+p.Na;if(k=ta(m,h[1],k,g.Eb,0,v,0),c.Na=p.Na=(0<k)+0,1<k)rr(v,0,u,f);else{var C=v[0]+3>>3;for(v=0;256>v;v+=16)u[f+v]=C}w=1,S=h[0]}var $=15&c.la,A=15&p.la;for(v=0;4>v;++v){var P=1&A;for(C=N=0;4>C;++C)$=$>>1|(P=(k=ta(m,S,k=P+(1&$),g.Sc,w,u,f))>w)<<7,N=N<<2|(3<k?3:1<k?2:0!=u[f+0]),f+=16;$>>=4,A=A>>1|P<<7,b=(b<<8|N)>>>0}for(S=$,w=A>>4,j=0;4>j;j+=2){for(N=0,$=c.la>>4+j,A=p.la>>4+j,v=0;2>v;++v){for(P=1&A,C=0;2>C;++C)k=P+(1&$),$=$>>1|(P=0<(k=ta(m,h[2],k,g.Qc,0,u,f)))<<3,N=N<<2|(3<k?3:1<k?2:0!=u[f+0]),f+=16;$>>=2,A=A>>1|P<<5}y|=N<<4*j,S|=$<<4<<j,w|=(240&A)<<j}c.la=S,p.la=w,x.Hc=b,x.Gc=y,x.ia=43690&y?0:g.ia,h=!(b|y)}if(0<o.L&&(o.wa[o.Y+o.ja]=o.gd[i.$b][i.Za],o.wa[o.Y+o.ja].La|=!h),d.Ka)return Je(e,7,"Premature end-of-file encountered.")}if(Xe(e),o=s,d=1,i=(l=e).D,c=0<l.L&&l.M>=l.zb&&l.M<=l.Va,0==l.Aa)t:{if(i.M=l.M,i.uc=c,Es(l,i),d=1,i=(N=l.D).Nb,c=(y=Fa[l.L])*l.R,m=y/2*l.B,v=16*i*l.R,C=8*i*l.B,h=l.sa,x=l.ta-c+v,g=l.qa,u=l.ra-m+C,f=l.Ha,p=l.Ia-m+C,A=0==($=N.M),b=$>=l.Va-1,2==l.Aa&&Es(l,N),N.uc)for(P=(k=l).D.M,t(k.D.uc),N=k.yb;N<k.Hb;++N){w=N,S=P;var L=(E=(U=k).D).Nb;j=U.R;var E=E.wa[E.Y+w],T=U.sa,I=U.ta+16*L*j+16*w,O=E.dd,F=E.tc;if(0!=F)if(t(3<=F),1==U.L)0<w&&br(T,I,j,F+4),E.La&&vr(T,I,j,F),0<S&&pr(T,I,j,F+4),E.La&&yr(T,I,j,F);else{var R=U.B,D=U.qa,M=U.ra+8*L*R+8*w,B=U.Ha,U=U.Ia+8*L*R+8*w;L=E.ld,0<w&&(cr(T,I,j,F+4,O,L),mr(D,M,B,U,R,F+4,O,L)),E.La&&(xr(T,I,j,F,O,L),fr(D,M,B,U,R,F,O,L)),0<S&&(dr(T,I,j,F+4,O,L),ur(D,M,B,U,R,F+4,O,L)),E.La&&(hr(T,I,j,F,O,L),gr(D,M,B,U,R,F,O,L))}}if(l.ia&&alert("todo:DitherRow"),null!=o.put){if(N=16*$,$=16*($+1),A?(o.y=l.sa,o.O=l.ta+v,o.f=l.qa,o.N=l.ra+C,o.ea=l.Ha,o.W=l.Ia+C):(N-=y,o.y=h,o.O=x,o.f=g,o.N=u,o.ea=f,o.W=p),b||($-=y),$>o.o&&($=o.o),o.F=null,o.J=null,null!=l.Fa&&0<l.Fa.length&&N<$&&(o.J=cs(l,o,N,$-N),o.F=l.mb,null==o.F&&0==o.F.length)){d=Je(l,3,"Could not decode alpha data.");break t}N<o.j&&(y=o.j-N,N=o.j,t(!(1&y)),o.O+=l.R*y,o.N+=l.B*(y>>1),o.W+=l.B*(y>>1),null!=o.F&&(o.J+=o.width*y)),N<$&&(o.O+=o.v,o.N+=o.v>>1,o.W+=o.v>>1,null!=o.F&&(o.J+=o.v),o.ka=N-o.j,o.U=o.va-o.v,o.T=$-N,d=o.put(o))}i+1!=l.Ic||b||(r(l.sa,l.ta-c,h,x+16*l.R,c),r(l.qa,l.ra-m,g,u+8*l.B,m),r(l.Ha,l.Ia-m,f,p+8*l.B,m))}if(!d)return Je(e,6,"Output aborted.")}return 1}(e,s)),null!=s.bc&&s.bc(s),l&=1}return l?(e.cb=0,l):0})(e,o)||(s=e.a)}}else s=e.a}0==s&&null!=u.Oa&&u.Oa.fd&&(s=Os(u.ba))}u=s}c=0!=u?null:11>c?m.f.RGBA.eb:m.f.kb.y}else c=null;return c};var Da=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(e,t){for(var s="",r=0;r<4;r++)s+=String.fromCharCode(e[t++]);return s}function c(e,t){return e[t+0]|e[t+1]<<8}function u(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16)>>>0}function m(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}new o;var h=[0],x=[0],g=[],f=new o,p=e,b=function(e,t){var s={},r=0,a=!1,n=0,i=0;if(s.frames=[],!
/** @license
       * Copyright (c) 2017 Dominik Homberger
      Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
      The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
      https://webpjs.appspot.com
      WebPRiffParser dominikhlbg@gmail.com
      */
function(e,t){for(var s=0;s<4;s++)if(e[t+s]!="RIFF".charCodeAt(s))return!0;return!1}(e,t)){for(m(e,t+=4),t+=8;t<e.length;){var l=d(e,t),o=m(e,t+=4);t+=4;var h=o+(1&o);switch(l){case"VP8 ":case"VP8L":void 0===s.frames[r]&&(s.frames[r]={}),(f=s.frames[r]).src_off=a?i:t-8,f.src_size=n+o+8,r++,a&&(a=!1,n=0,i=0);break;case"VP8X":(f=s.header={}).feature_flags=e[t];var x=t+4;f.canvas_width=1+u(e,x),x+=3,f.canvas_height=1+u(e,x),x+=3;break;case"ALPH":a=!0,n=h+8,i=t-8;break;case"ANIM":(f=s.header).bgcolor=m(e,t),x=t+4,f.loop_count=c(e,x),x+=2;break;case"ANMF":var g,f;(f=s.frames[r]={}).offset_x=2*u(e,t),t+=3,f.offset_y=2*u(e,t),t+=3,f.width=1+u(e,t),t+=3,f.height=1+u(e,t),t+=3,f.duration=u(e,t),t+=3,g=e[t++],f.dispose=1&g,f.blend=g>>1&1}"ANMF"!=l&&(t+=h)}return s}}(p,0);b.response=p,b.rgbaoutput=!0,b.dataurl=!1;var y=b.header?b.header:null,v=b.frames?b.frames:null;if(y){y.loop_counter=y.loop_count,h=[y.canvas_height],x=[y.canvas_width];for(var j=0;j<v.length&&0!=v[j].blend;j++);}var N=v[0],w=f.WebPDecodeRGBA(p,N.src_off,N.src_size,x,h);N.rgba=w,N.imgwidth=x[0],N.imgheight=h[0];for(var S=0;S<x[0]*h[0]*4;S++)g[S]=w[S];return this.width=x,this.height=h,this.data=g,this}!function(e){var t,s,r,a,n,i,l,o,d,c=function(e){return e=e||{},this.isStrokeTransparent=e.isStrokeTransparent||!1,this.strokeOpacity=e.strokeOpacity||1,this.strokeStyle=e.strokeStyle||"#000000",this.fillStyle=e.fillStyle||"#000000",this.isFillTransparent=e.isFillTransparent||!1,this.fillOpacity=e.fillOpacity||1,this.font=e.font||"10px sans-serif",this.textBaseline=e.textBaseline||"alphabetic",this.textAlign=e.textAlign||"left",this.lineWidth=e.lineWidth||1,this.lineJoin=e.lineJoin||"miter",this.lineCap=e.lineCap||"butt",this.path=e.path||[],this.transform=void 0!==e.transform?e.transform.clone():new o,this.globalCompositeOperation=e.globalCompositeOperation||"normal",this.globalAlpha=e.globalAlpha||1,this.clip_path=e.clip_path||[],this.currentPoint=e.currentPoint||new i,this.miterLimit=e.miterLimit||10,this.lastPoint=e.lastPoint||new i,this.lineDashOffset=e.lineDashOffset||0,this.lineDash=e.lineDash||[],this.margin=e.margin||[0,0,0,0],this.prevPageLastElemOffset=e.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof e.ignoreClearRect||e.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new u(this),t=this.internal.f2,s=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,n=this.internal.getVerticalCoordinate,i=this.internal.Point,l=this.internal.Rectangle,o=this.internal.Matrix,d=new c}]);var u=function(e){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var t=e;Object.defineProperty(this,"pdf",{get:function(){return t}});var s=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return s},set:function(e){s=Boolean(e)}});var r=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return r},set:function(e){r=Boolean(e)}});var a=0;Object.defineProperty(this,"posX",{get:function(){return a},set:function(e){isNaN(e)||(a=e)}});var n=0;Object.defineProperty(this,"posY",{get:function(){return n},set:function(e){isNaN(e)||(n=e)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(e){var t;"number"==typeof e?t=[e,e,e,e]:((t=new Array(4))[0]=e[0],t[1]=e.length>=2?e[1]:t[0],t[2]=e.length>=3?e[2]:t[0],t[3]=e.length>=4?e[3]:t[1]),d.margin=t}});var i=!1;Object.defineProperty(this,"autoPaging",{get:function(){return i},set:function(e){i=e}});var l=0;Object.defineProperty(this,"lastBreak",{get:function(){return l},set:function(e){l=e}});var o=[];Object.defineProperty(this,"pageBreaks",{get:function(){return o},set:function(e){o=e}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(e){e instanceof c&&(d=e)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(e){d.path=e}});var u=[];Object.defineProperty(this,"ctxStack",{get:function(){return u},set:function(e){u=e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(e){var t;t=m(e),this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(e){var t=m(e);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(e){-1!==["butt","round","square"].indexOf(e)&&(this.ctx.lineCap=e,this.pdf.setLineCap(e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(e){isNaN(e)||(this.ctx.lineWidth=e,this.pdf.setLineWidth(e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(e){-1!==["bevel","round","miter"].indexOf(e)&&(this.ctx.lineJoin=e,this.pdf.setLineJoin(e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(e){isNaN(e)||(this.ctx.miterLimit=e,this.pdf.setMiterLimit(e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(e){this.ctx.textBaseline=e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(e){-1!==["right","end","center","left","start"].indexOf(e)&&(this.ctx.textAlign=e)}});var h=null,x=null;Object.defineProperty(this,"fontFaces",{get:function(){return x},set:function(e){h=null,x=e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(e){var t;if(this.ctx.font=e,null!==(t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(e))){var s=t[1];t[2];var r=t[3],a=t[4];t[5];var n=t[6],i=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(a)[2];a="px"===i?Math.floor(parseFloat(a)*this.pdf.internal.scaleFactor):"em"===i?Math.floor(parseFloat(a)*this.pdf.getFontSize()):Math.floor(parseFloat(a)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(a);var l=function(e){var t,s,r=[],a=e.trim();if(""===a)return Hh;if(a in Th)return[Th[a]];for(;""!==a;){switch(s=null,t=(a=Oh(a)).charAt(0)){case'"':case"'":s=Fh(a.substring(1),t);break;default:s=Rh(a)}if(null===s)return Hh;if(r.push(s[0]),""!==(a=Oh(s[1]))&&","!==a.charAt(0))return Hh;a=a.replace(/^,/,"")}return r}(n);if(this.fontFaces){var o=function(e,t,s){for(var r=(s=s||{}).defaultFontFamily||"times",a=Object.assign({},Eh,s.genericFontFamilies||{}),n=null,i=null,l=0;l<t.length;++l)if(a[(n=Ph(t[l])).family]&&(n.family=a[n.family]),e.hasOwnProperty(n.family)){i=e[n.family];break}if(!(i=i||e[r]))throw new Error("Could not find a font-family for the rule '"+Ih(n)+"' and default family '"+r+"'.");if(i=function(e,t){if(t[e])return t[e];var s=$h[e],r=s<=$h.normal?-1:1,a=Lh(t,Ch,s,r);if(!a)throw new Error("Could not find a matching font-stretch value for "+e);return a}(n.stretch,i),i=function(e,t){if(t[e])return t[e];for(var s=kh[e],r=0;r<s.length;++r)if(t[s[r]])return t[s[r]];throw new Error("Could not find a matching font-style for "+e)}(n.style,i),!(i=function(e,t){if(t[e])return t[e];if(400===e&&t[500])return t[500];if(500===e&&t[400])return t[400];var s=Ah[e],r=Lh(t,_h,s,e<400?-1:1);if(!r)throw new Error("Could not find a matching font-weight for value "+e);return r}(n.weight,i)))throw new Error("Failed to resolve a font for the rule '"+Ih(n)+"'.");return i}(function(e,t){if(null===h){var s=(r=e.getFontList(),a=[],Object.keys(r).forEach(function(e){r[e].forEach(function(t){var s=null;switch(t){case"bold":s={family:e,weight:"bold"};break;case"italic":s={family:e,style:"italic"};break;case"bolditalic":s={family:e,weight:"bold",style:"italic"};break;case"":case"normal":s={family:e}}null!==s&&(s.ref={name:e,style:t},a.push(s))})}),a);h=function(e){for(var t={},s=0;s<e.length;++s){var r=Ph(e[s]),a=r.family,n=r.stretch,i=r.style,l=r.weight;t[a]=t[a]||{},t[a][n]=t[a][n]||{},t[a][n][i]=t[a][n][i]||{},t[a][n][i][l]=r}return t}(s.concat(t))}var r,a;return h}(this.pdf,this.fontFaces),l.map(function(e){return{family:e,stretch:"normal",weight:r,style:s}}));this.pdf.setFont(o.ref.name,o.ref.style)}else{var d="";("bold"===r||parseInt(r,10)>=700||"bold"===s)&&(d="bold"),"italic"===s&&(d+="italic"),0===d.length&&(d="normal");for(var c="",u={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},m=0;m<l.length;m++){if(void 0!==this.pdf.internal.getFont(l[m],d,{noFallback:!0,disableWarning:!0})){c=l[m];break}if("bolditalic"===d&&void 0!==this.pdf.internal.getFont(l[m],"bold",{noFallback:!0,disableWarning:!0}))c=l[m],d="bold";else if(void 0!==this.pdf.internal.getFont(l[m],"normal",{noFallback:!0,disableWarning:!0})){c=l[m],d="normal";break}}if(""===c)for(var x=0;x<l.length;x++)if(u[l[x]]){c=u[l[x]];break}c=""===c?"Times":c,this.pdf.setFont(c,d)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(e){this.ctx.globalCompositeOperation=e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(e){this.ctx.globalAlpha=e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(e){this.ctx.lineDashOffset=e,R.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(e){this.ctx.lineDash=e,R.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(e){this.ctx.ignoreClearRect=Boolean(e)}})};u.prototype.setLineDash=function(e){this.lineDash=e},u.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},u.prototype.fill=function(){v.call(this,"fill",!1)},u.prototype.stroke=function(){v.call(this,"stroke",!1)},u.prototype.beginPath=function(){this.path=[{type:"begin"}]},u.prototype.moveTo=function(e,t){if(isNaN(e)||isNaN(t))throw am.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var s=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"mt",x:s.x,y:s.y}),this.ctx.lastPoint=new i(e,t)},u.prototype.closePath=function(){var e=new i(0,0),t=0;for(t=this.path.length-1;-1!==t;t--)if("begin"===this.path[t].type&&"object"===td(this.path[t+1])&&"number"==typeof this.path[t+1].x){e=new i(this.path[t+1].x,this.path[t+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(e.x,e.y)},u.prototype.lineTo=function(e,t){if(isNaN(e)||isNaN(t))throw am.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var s=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"lt",x:s.x,y:s.y}),this.ctx.lastPoint=new i(s.x,s.y)},u.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),v.call(this,null,!0)},u.prototype.quadraticCurveTo=function(e,t,s,r){if(isNaN(s)||isNaN(r)||isNaN(e)||isNaN(t))throw am.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var a=this.ctx.transform.applyToPoint(new i(s,r)),n=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"qct",x1:n.x,y1:n.y,x:a.x,y:a.y}),this.ctx.lastPoint=new i(a.x,a.y)},u.prototype.bezierCurveTo=function(e,t,s,r,a,n){if(isNaN(a)||isNaN(n)||isNaN(e)||isNaN(t)||isNaN(s)||isNaN(r))throw am.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var l=this.ctx.transform.applyToPoint(new i(a,n)),o=this.ctx.transform.applyToPoint(new i(e,t)),d=this.ctx.transform.applyToPoint(new i(s,r));this.path.push({type:"bct",x1:o.x,y1:o.y,x2:d.x,y2:d.y,x:l.x,y:l.y}),this.ctx.lastPoint=new i(l.x,l.y)},u.prototype.arc=function(e,t,s,r,a,n){if(isNaN(e)||isNaN(t)||isNaN(s)||isNaN(r)||isNaN(a))throw am.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(n=Boolean(n),!this.ctx.transform.isIdentity){var l=this.ctx.transform.applyToPoint(new i(e,t));e=l.x,t=l.y;var o=this.ctx.transform.applyToPoint(new i(0,s)),d=this.ctx.transform.applyToPoint(new i(0,0));s=Math.sqrt(Math.pow(o.x-d.x,2)+Math.pow(o.y-d.y,2))}Math.abs(a-r)>=2*Math.PI&&(r=0,a=2*Math.PI),this.path.push({type:"arc",x:e,y:t,radius:s,startAngle:r,endAngle:a,counterclockwise:n})},u.prototype.arcTo=function(e,t,s,r,a){throw new Error("arcTo not implemented.")},u.prototype.rect=function(e,t,s,r){if(isNaN(e)||isNaN(t)||isNaN(s)||isNaN(r))throw am.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(e,t),this.lineTo(e+s,t),this.lineTo(e+s,t+r),this.lineTo(e,t+r),this.lineTo(e,t),this.lineTo(e+s,t),this.lineTo(e,t)},u.prototype.fillRect=function(e,t,s,r){if(isNaN(e)||isNaN(t)||isNaN(s)||isNaN(r))throw am.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var a={};"butt"!==this.lineCap&&(a.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(a.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(e,t,s,r),this.fill(),a.hasOwnProperty("lineCap")&&(this.lineCap=a.lineCap),a.hasOwnProperty("lineJoin")&&(this.lineJoin=a.lineJoin)}},u.prototype.strokeRect=function(e,t,s,r){if(isNaN(e)||isNaN(t)||isNaN(s)||isNaN(r))throw am.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(e,t,s,r),this.stroke())},u.prototype.clearRect=function(e,t,s,r){if(isNaN(e)||isNaN(t)||isNaN(s)||isNaN(r))throw am.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(e,t,s,r))},u.prototype.save=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,s=0;s<this.pdf.internal.getNumberOfPages();s++)this.pdf.setPage(s+1),this.pdf.internal.out("q");if(this.pdf.setPage(t),e){this.ctx.fontSize=this.pdf.internal.getFontSize();var r=new c(this.ctx);this.ctxStack.push(this.ctx),this.ctx=r}},u.prototype.restore=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,s=0;s<this.pdf.internal.getNumberOfPages();s++)this.pdf.setPage(s+1),this.pdf.internal.out("Q");this.pdf.setPage(t),e&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},u.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(e){var t,s,r,a;if(!0===e.isCanvasGradient&&(e=e.getColor()),!e)return{r:0,g:0,b:0,a:0,style:e};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(e))t=0,s=0,r=0,a=0;else{var n=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(e);if(null!==n)t=parseInt(n[1]),s=parseInt(n[2]),r=parseInt(n[3]),a=1;else if(null!==(n=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(e)))t=parseInt(n[1]),s=parseInt(n[2]),r=parseInt(n[3]),a=parseFloat(n[4]);else{if(a=1,"string"==typeof e&&"#"!==e.charAt(0)){var i=new dm(e);e=i.ok?i.toHex():"#000000"}4===e.length?(t=e.substring(1,2),t+=t,s=e.substring(2,3),s+=s,r=e.substring(3,4),r+=r):(t=e.substring(1,3),s=e.substring(3,5),r=e.substring(5,7)),t=parseInt(t,16),s=parseInt(s,16),r=parseInt(r,16)}}return{r:t,g:s,b:r,a:a,style:e}},h=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},x=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};u.prototype.fillText=function(e,t,s,r){if(isNaN(t)||isNaN(s)||"string"!=typeof e)throw am.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(r=isNaN(r)?void 0:r,!h.call(this)){var a=I(this.ctx.transform.rotation),n=this.ctx.transform.scaleX;_.call(this,{text:e,x:t,y:s,scale:n,angle:a,align:this.textAlign,maxWidth:r})}},u.prototype.strokeText=function(e,t,s,r){if(isNaN(t)||isNaN(s)||"string"!=typeof e)throw am.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){r=isNaN(r)?void 0:r;var a=I(this.ctx.transform.rotation),n=this.ctx.transform.scaleX;_.call(this,{text:e,x:t,y:s,scale:n,renderingMode:"stroke",angle:a,align:this.textAlign,maxWidth:r})}},u.prototype.measureText=function(e){if("string"!=typeof e)throw am.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var t=this.pdf,s=this.pdf.internal.scaleFactor,r=t.internal.getFontSize(),a=t.getStringUnitWidth(e)*r/t.internal.scaleFactor;return new function(e){var t=(e=e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return t}}),this}({width:a*=Math.round(96*s/72*1e4)/1e4})},u.prototype.scale=function(e,t){if(isNaN(e)||isNaN(t))throw am.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var s=new o(e,0,0,t,0,0);this.ctx.transform=this.ctx.transform.multiply(s)},u.prototype.rotate=function(e){if(isNaN(e))throw am.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var t=new o(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},u.prototype.translate=function(e,t){if(isNaN(e)||isNaN(t))throw am.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var s=new o(1,0,0,1,e,t);this.ctx.transform=this.ctx.transform.multiply(s)},u.prototype.transform=function(e,t,s,r,a,n){if(isNaN(e)||isNaN(t)||isNaN(s)||isNaN(r)||isNaN(a)||isNaN(n))throw am.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var i=new o(e,t,s,r,a,n);this.ctx.transform=this.ctx.transform.multiply(i)},u.prototype.setTransform=function(e,t,s,r,a,n){e=isNaN(e)?1:e,t=isNaN(t)?0:t,s=isNaN(s)?0:s,r=isNaN(r)?1:r,a=isNaN(a)?0:a,n=isNaN(n)?0:n,this.ctx.transform=new o(e,t,s,r,a,n)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};u.prototype.drawImage=function(e,t,s,r,a,n,i,d,c){var u=this.pdf.getImageProperties(e),m=1,h=1,x=1,p=1;void 0!==r&&void 0!==d&&(x=d/r,p=c/a,m=u.width/r*d/r,h=u.height/a*c/a),void 0===n&&(n=t,i=s,t=0,s=0),void 0!==r&&void 0===d&&(d=r,c=a),void 0===r&&void 0===d&&(d=u.width,c=u.height);for(var v,N=this.ctx.transform.decompose(),w=I(N.rotate.shx),S=new o,k=(S=(S=(S=S.multiply(N.translate)).multiply(N.skew)).multiply(N.scale)).applyToRectangle(new l(n-t*x,i-s*p,r*m,a*h)),C=f.call(this,k),$=[],_=0;_<C.length;_+=1)-1===$.indexOf(C[_])&&$.push(C[_]);if(y($),this.autoPaging)for(var A=$[0],P=$[$.length-1],L=A;L<P+1;L++){this.pdf.setPage(L);var E=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],T=1===L?this.posY+this.margin[0]:this.margin[0],O=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],F=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],R=1===L?0:O+(L-2)*F;if(0!==this.ctx.clip_path.length){var D=this.path;v=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(v,this.posX+this.margin[3],-R+T+this.ctx.prevPageLastElemOffset),j.call(this,"fill",!0),this.path=D}var M=JSON.parse(JSON.stringify(k));M=b([M],this.posX+this.margin[3],-R+T+this.ctx.prevPageLastElemOffset)[0];var B=(L>A||L<P)&&g.call(this);B&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],E,F,null).clip().discardPath()),this.pdf.addImage(e,"JPEG",M.x,M.y,M.w,M.h,null,null,w),B&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(e,"JPEG",k.x,k.y,k.w,k.h,null,null,w)};var f=function(e,t,s){var r=[];t=t||this.pdf.internal.pageSize.width,s=s||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var a=this.posY+this.ctx.prevPageLastElemOffset;switch(e.type){default:case"mt":case"lt":r.push(Math.floor((e.y+a)/s)+1);break;case"arc":r.push(Math.floor((e.y+a-e.radius)/s)+1),r.push(Math.floor((e.y+a+e.radius)/s)+1);break;case"qct":var n=O(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x,e.y);r.push(Math.floor((n.y+a)/s)+1),r.push(Math.floor((n.y+n.h+a)/s)+1);break;case"bct":var i=F(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x2,e.y2,e.x,e.y);r.push(Math.floor((i.y+a)/s)+1),r.push(Math.floor((i.y+i.h+a)/s)+1);break;case"rect":r.push(Math.floor((e.y+a)/s)+1),r.push(Math.floor((e.y+e.h+a)/s)+1)}for(var l=0;l<r.length;l+=1)for(;this.pdf.internal.getNumberOfPages()<r[l];)p.call(this);return r},p=function(){var e=this.fillStyle,t=this.strokeStyle,s=this.font,r=this.lineCap,a=this.lineWidth,n=this.lineJoin;this.pdf.addPage(),this.fillStyle=e,this.strokeStyle=t,this.font=s,this.lineCap=r,this.lineWidth=a,this.lineJoin=n},b=function(e,t,s){for(var r=0;r<e.length;r++)switch(e[r].type){case"bct":e[r].x2+=t,e[r].y2+=s;case"qct":e[r].x1+=t,e[r].y1+=s;default:e[r].x+=t,e[r].y+=s}return e},y=function(e){return e.sort(function(e,t){return e-t})},v=function(e,t){for(var s,r,a=this.fillStyle,n=this.strokeStyle,i=this.lineCap,l=this.lineWidth,o=Math.abs(l*this.ctx.transform.scaleX),d=this.lineJoin,c=JSON.parse(JSON.stringify(this.path)),u=JSON.parse(JSON.stringify(this.path)),m=[],h=0;h<u.length;h++)if(void 0!==u[h].x)for(var x=f.call(this,u[h]),v=0;v<x.length;v+=1)-1===m.indexOf(x[v])&&m.push(x[v]);for(var N=0;N<m.length;N++)for(;this.pdf.internal.getNumberOfPages()<m[N];)p.call(this);if(y(m),this.autoPaging)for(var w=m[0],S=m[m.length-1],k=w;k<S+1;k++){this.pdf.setPage(k),this.fillStyle=a,this.strokeStyle=n,this.lineCap=i,this.lineWidth=o,this.lineJoin=d;var C=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],$=1===k?this.posY+this.margin[0]:this.margin[0],_=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],A=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],P=1===k?0:_+(k-2)*A;if(0!==this.ctx.clip_path.length){var L=this.path;s=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(s,this.posX+this.margin[3],-P+$+this.ctx.prevPageLastElemOffset),j.call(this,e,!0),this.path=L}if(r=JSON.parse(JSON.stringify(c)),this.path=b(r,this.posX+this.margin[3],-P+$+this.ctx.prevPageLastElemOffset),!1===t||0===k){var E=(k>w||k<S)&&g.call(this);E&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],C,A,null).clip().discardPath()),j.call(this,e,t),E&&this.pdf.restoreGraphicsState()}this.lineWidth=l}else this.lineWidth=o,j.call(this,e,t),this.lineWidth=l;this.path=c},j=function(e,t){if(("stroke"!==e||t||!x.call(this))&&("stroke"===e||t||!h.call(this))){for(var s,r,a=[],n=this.path,i=0;i<n.length;i++){var l=n[i];switch(l.type){case"begin":a.push({begin:!0});break;case"close":a.push({close:!0});break;case"mt":a.push({start:l,deltas:[],abs:[]});break;case"lt":var o=a.length;if(n[i-1]&&!isNaN(n[i-1].x)&&(s=[l.x-n[i-1].x,l.y-n[i-1].y],o>0))for(;o>=0;o--)if(!0!==a[o-1].close&&!0!==a[o-1].begin){a[o-1].deltas.push(s),a[o-1].abs.push(l);break}break;case"bct":s=[l.x1-n[i-1].x,l.y1-n[i-1].y,l.x2-n[i-1].x,l.y2-n[i-1].y,l.x-n[i-1].x,l.y-n[i-1].y],a[a.length-1].deltas.push(s);break;case"qct":var d=n[i-1].x+2/3*(l.x1-n[i-1].x),c=n[i-1].y+2/3*(l.y1-n[i-1].y),u=l.x+2/3*(l.x1-l.x),m=l.y+2/3*(l.y1-l.y),g=l.x,f=l.y;s=[d-n[i-1].x,c-n[i-1].y,u-n[i-1].x,m-n[i-1].y,g-n[i-1].x,f-n[i-1].y],a[a.length-1].deltas.push(s);break;case"arc":a.push({deltas:[],abs:[],arc:!0}),Array.isArray(a[a.length-1].abs)&&a[a.length-1].abs.push(l)}}r=t?null:"stroke"===e?"stroke":"fill";for(var p=!1,b=0;b<a.length;b++)if(a[b].arc)for(var y=a[b].abs,v=0;v<y.length;v++){var j=y[v];"arc"===j.type?S.call(this,j.x,j.y,j.radius,j.startAngle,j.endAngle,j.counterclockwise,void 0,t,!p):A.call(this,j.x,j.y),p=!0}else if(!0===a[b].close)this.pdf.internal.out("h"),p=!1;else if(!0!==a[b].begin){var N=a[b].start.x,w=a[b].start.y;P.call(this,a[b].deltas,N,w),p=!0}r&&k.call(this,r),t&&C.call(this)}},N=function(e){var t=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,s=t*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return e-s;case"top":return e+t-s;case"hanging":return e+t-2*s;case"middle":return e+t/2-s;default:return e}},w=function(e){return e+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};u.prototype.createLinearGradient=function(){var e=function(){};return e.colorStops=[],e.addColorStop=function(e,t){this.colorStops.push([e,t])},e.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},e.isCanvasGradient=!0,e},u.prototype.createPattern=function(){return this.createLinearGradient()},u.prototype.createRadialGradient=function(){return this.createLinearGradient()};var S=function(e,t,s,r,a,n,i,l,o){for(var d=E.call(this,s,r,a,n),c=0;c<d.length;c++){var u=d[c];0===c&&(o?$.call(this,u.x1+e,u.y1+t):A.call(this,u.x1+e,u.y1+t)),L.call(this,e,t,u.x2,u.y2,u.x3,u.y3,u.x4,u.y4)}l?C.call(this):k.call(this,i)},k=function(e){switch(e){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},C=function(){this.pdf.clip(),this.pdf.discardPath()},$=function(e,t){this.pdf.internal.out(s(e)+" "+r(t)+" m")},_=function(e){var t;switch(e.align){case"right":case"end":t="right";break;case"center":t="center";break;default:t="left"}var s=this.pdf.getTextDimensions(e.text),r=N.call(this,e.y),a=w.call(this,r)-s.h,n=this.ctx.transform.applyToPoint(new i(e.x,r)),d=this.ctx.transform.decompose(),c=new o;c=(c=(c=c.multiply(d.translate)).multiply(d.skew)).multiply(d.scale);for(var u,m,h,x=this.ctx.transform.applyToRectangle(new l(e.x,r,s.w,s.h)),p=c.applyToRectangle(new l(e.x,a,s.w,s.h)),v=f.call(this,p),S=[],k=0;k<v.length;k+=1)-1===S.indexOf(v[k])&&S.push(v[k]);if(y(S),this.autoPaging)for(var C=S[0],$=S[S.length-1],_=C;_<$+1;_++){this.pdf.setPage(_);var A=1===_?this.posY+this.margin[0]:this.margin[0],P=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],L=this.pdf.internal.pageSize.height-this.margin[2],E=L-this.margin[0],T=this.pdf.internal.pageSize.width-this.margin[1],I=T-this.margin[3],O=1===_?0:P+(_-2)*E;if(0!==this.ctx.clip_path.length){var F=this.path;u=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(u,this.posX+this.margin[3],-1*O+A),j.call(this,"fill",!0),this.path=F}var R=b([JSON.parse(JSON.stringify(p))],this.posX+this.margin[3],-O+A+this.ctx.prevPageLastElemOffset)[0];e.scale>=.01&&(m=this.pdf.internal.getFontSize(),this.pdf.setFontSize(m*e.scale),h=this.lineWidth,this.lineWidth=h*e.scale);var D="text"!==this.autoPaging;if(D||R.y+R.h<=L){if(D||R.y>=A&&R.x<=T){var M=D?e.text:this.pdf.splitTextToSize(e.text,e.maxWidth||T-R.x)[0],B=b([JSON.parse(JSON.stringify(x))],this.posX+this.margin[3],-O+A+this.ctx.prevPageLastElemOffset)[0],U=D&&(_>C||_<$)&&g.call(this);U&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],I,E,null).clip().discardPath()),this.pdf.text(M,B.x,B.y,{angle:e.angle,align:t,renderingMode:e.renderingMode}),U&&this.pdf.restoreGraphicsState()}}else R.y<L&&(this.ctx.prevPageLastElemOffset+=L-R.y);e.scale>=.01&&(this.pdf.setFontSize(m),this.lineWidth=h)}else e.scale>=.01&&(m=this.pdf.internal.getFontSize(),this.pdf.setFontSize(m*e.scale),h=this.lineWidth,this.lineWidth=h*e.scale),this.pdf.text(e.text,n.x+this.posX,n.y+this.posY,{angle:e.angle,align:t,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&(this.pdf.setFontSize(m),this.lineWidth=h)},A=function(e,t,a,n){a=a||0,n=n||0,this.pdf.internal.out(s(e+a)+" "+r(t+n)+" l")},P=function(e,t,s){return this.pdf.lines(e,t,s,null,null)},L=function(e,s,r,i,l,o,d,c){this.pdf.internal.out([t(a(r+e)),t(n(i+s)),t(a(l+e)),t(n(o+s)),t(a(d+e)),t(n(c+s)),"c"].join(" "))},E=function(e,t,s,r){for(var a=2*Math.PI,n=Math.PI/2;t>s;)t-=a;var i=Math.abs(s-t);i<a&&r&&(i=a-i);for(var l=[],o=r?-1:1,d=t;i>1e-5;){var c=d+o*Math.min(i,n);l.push(T.call(this,e,d,c)),i-=Math.abs(c-d),d=c}return l},T=function(e,t,s){var r=(s-t)/2,a=e*Math.cos(r),n=e*Math.sin(r),i=a,l=-n,o=i*i+l*l,d=o+i*a+l*n,c=4/3*(Math.sqrt(2*o*d)-d)/(i*n-l*a),u=i-c*l,m=l+c*i,h=u,x=-m,g=r+t,f=Math.cos(g),p=Math.sin(g);return{x1:e*Math.cos(t),y1:e*Math.sin(t),x2:u*f-m*p,y2:u*p+m*f,x3:h*f-x*p,y3:h*p+x*f,x4:e*Math.cos(s),y4:e*Math.sin(s)}},I=function(e){return 180*e/Math.PI},O=function(e,t,s,r,a,n){var i=e+.5*(s-e),o=t+.5*(r-t),d=a+.5*(s-a),c=n+.5*(r-n),u=Math.min(e,a,i,d),m=Math.max(e,a,i,d),h=Math.min(t,n,o,c),x=Math.max(t,n,o,c);return new l(u,h,m-u,x-h)},F=function(e,t,s,r,a,n,i,o){var d,c,u,m,h,x,g,f,p,b,y,v,j,N,w=s-e,S=r-t,k=a-s,C=n-r,$=i-a,_=o-n;for(c=0;c<41;c++)p=(g=(u=e+(d=c/40)*w)+d*((h=s+d*k)-u))+d*(h+d*(a+d*$-h)-g),b=(f=(m=t+d*S)+d*((x=r+d*C)-m))+d*(x+d*(n+d*_-x)-f),0==c?(y=p,v=b,j=p,N=b):(y=Math.min(y,p),v=Math.min(v,b),j=Math.max(j,p),N=Math.max(N,b));return new l(Math.round(y),Math.round(v),Math.round(j-y),Math.round(N-v))},R=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var e,t,s=(e=this.ctx.lineDash,t=this.ctx.lineDashOffset,JSON.stringify({lineDash:e,lineDashOffset:t}));this.prevLineDash!==s&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=s)}}}(Om.API),
/**
 * @license
 * jsPDF filters PlugIn
 * Copyright (c) 2014 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t=function(e){var t,s,r,a,n,i,l,o,d,c;for(s=[],r=0,a=(e+=t="\0\0\0\0".slice(e.length%4||4)).length;a>r;r+=4)0!==(n=(e.charCodeAt(r)<<24)+(e.charCodeAt(r+1)<<16)+(e.charCodeAt(r+2)<<8)+e.charCodeAt(r+3))?(i=(n=((n=((n=((n=(n-(c=n%85))/85)-(d=n%85))/85)-(o=n%85))/85)-(l=n%85))/85)%85,s.push(i+33,l+33,o+33,d+33,c+33)):s.push(122);return function(e,t){for(var s=t;s>0;s--)e.pop()}(s,t.length),String.fromCharCode.apply(String,s)+"~>"},s=function(e){var t,s,r,a,n,i=String,l="length",o=255,d="charCodeAt",c="slice",u="replace";for(e[c](-2),e=e[c](0,-2)[u](/\s/g,"")[u]("z","!!!!!"),r=[],a=0,n=(e+=t="uuuuu"[c](e[l]%5||5))[l];n>a;a+=5)s=52200625*(e[d](a)-33)+614125*(e[d](a+1)-33)+7225*(e[d](a+2)-33)+85*(e[d](a+3)-33)+(e[d](a+4)-33),r.push(o&s>>24,o&s>>16,o&s>>8,o&s);return function(e,t){for(var s=t;s>0;s--)e.pop()}(r,t[l]),i.fromCharCode.apply(i,r)},r=function(e){return e.split("").map(function(e){return("0"+e.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(e){var t=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(e=e.replace(/\s/g,"")).indexOf(">")&&(e=e.substr(0,e.indexOf(">"))),e.length%2&&(e+="0"),!1===t.test(e))return"";for(var s="",r=0;r<e.length;r+=2)s+=String.fromCharCode("0x"+(e[r]+e[r+1]));return s},n=function(e){for(var t=new Uint8Array(e.length),s=e.length;s--;)t[s]=e.charCodeAt(s);return(t=Od(t)).reduce(function(e,t){return e+String.fromCharCode(t)},"")};e.processDataByFilters=function(e,i){var l=0,o=e||"",d=[];for("string"==typeof(i=i||[])&&(i=[i]),l=0;l<i.length;l+=1)switch(i[l]){case"ASCII85Decode":case"/ASCII85Decode":o=s(o),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":o=t(o),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":o=a(o),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":o=r(o),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":o=n(o),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[l]+'" is not implemented')}return{data:o,reverseChain:d.reverse().join(" ")}}}(Om.API),
/**
 * @license
 * jsPDF fileloading PlugIn
 * Copyright (c) 2018 Aras Abbasi (aras.abbasi@gmail.com)
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){e.loadFile=function(e,t,s){return function(e,t,s){t=!1!==t,s="function"==typeof s?s:function(){};var r=void 0;try{r=function(e,t,s){var r=new XMLHttpRequest,a=0,n=function(e){var t=e.length,s=[],r=String.fromCharCode;for(a=0;a<t;a+=1)s.push(r(255&e.charCodeAt(a)));return s.join("")};if(r.open("GET",e,!t),r.overrideMimeType("text/plain; charset=x-user-defined"),!1===t&&(r.onload=function(){200===r.status?s(n(this.responseText)):s(void 0)}),r.send(null),t&&200===r.status)return n(r.responseText)}(e,t,s)}catch(a){}return r}(e,t,s)},e.loadImageFile=e.loadFile}(Om.API),function(e){function t(){return(sm.html2canvas?Promise.resolve(sm.html2canvas):ed(()=>import("./html2canvas.esm-BPY6V10C.js"),[])).catch(function(e){return Promise.reject(new Error("Could not load html2canvas: "+e))}).then(function(e){return e.default?e.default:e})}function s(){return(sm.DOMPurify?Promise.resolve(sm.DOMPurify):ed(()=>import("./purify.es-biuSeZy2.js"),[])).catch(function(e){return Promise.reject(new Error("Could not load dompurify: "+e))}).then(function(e){return e.default?e.default:e})}var r=function(e){var t=td(e);return"undefined"===t?"undefined":"string"===t||e instanceof String?"string":"number"===t||e instanceof Number?"number":"function"===t||e instanceof Function?"function":e&&e.constructor===Array?"array":e&&1===e.nodeType?"element":"object"===t?"object":"unknown"},a=function(e,t){var s=document.createElement(e);for(var r in t.className&&(s.className=t.className),t.innerHTML&&t.dompurify&&(s.innerHTML=t.dompurify.sanitize(t.innerHTML)),t.style)s.style[r]=t.style[r];return s},n=function e(t,s){for(var r=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),a=t.firstChild;a;a=a.nextSibling)!0!==s&&1===a.nodeType&&"SCRIPT"===a.nodeName||r.appendChild(e(a,s));return 1===t.nodeType&&("CANVAS"===t.nodeName?(r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(r.value=t.value),r.addEventListener("load",function(){r.scrollTop=t.scrollTop,r.scrollLeft=t.scrollLeft},!0)),r},i=function e(t){var s=Object.assign(e.convert(Promise.resolve()),JSON.parse(JSON.stringify(e.template))),r=e.convert(Promise.resolve(),s);return(r=r.setProgress(1,e,1,[e])).set(t)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(e,t){return e.__proto__=t||i.prototype,e},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(e,t){return this.then(function(){switch(t=t||function(e){switch(r(e)){case"string":return"string";case"element":return"canvas"===e.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(e)){case"string":return this.then(s).then(function(t){return this.set({src:a("div",{innerHTML:e,dompurify:t})})});case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}})},i.prototype.to=function(e){switch(e){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var e={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},t=n(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===t.tagName&&(e.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:e}),this.prop.container.appendChild(t),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=Object.assign({},this.opt.html2canvas);return delete t.onrendered,e(this.prop.container,t)}).then(function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=this.opt.jsPDF,s=this.opt.fontFaces,r="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,a=Object.assign({async:!0,allowTaint:!0,scale:r,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete a.onrendered,t.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,t.context2d.margin=this.opt.margin,t.context2d.fontFaces=s,s)for(var n=0;n<s.length;++n){var i=s[n],l=i.src.find(function(e){return"truetype"===e.format});l&&t.addFont(l.url,i.ref.name,i.ref.style)}return a.windowHeight=a.windowHeight||0,a.windowHeight=0==a.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):a.windowHeight,t.context2d.save(!0),e(this.prop.container,a)}).then(function(e){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var e=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=e})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(e,t,s){return"img"===(s=s||"pdf").toLowerCase()||"image"===s.toLowerCase()?this.outputImg(e,t):this.outputPdf(e,t)},i.prototype.outputPdf=function(e,t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(e,t)})},i.prototype.outputImg=function(e){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(e){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+e+'" is not supported.'}})},i.prototype.save=function(e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(e?{filename:e}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(e){if("object"!==r(e))return this;var t=Object.keys(e||{}).map(function(t){if(t in i.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}},this);return this.then(function(){return this.thenList(t)})},i.prototype.get=function(e,t){return this.then(function(){var s=e in i.template.prop?this.prop[e]:this.opt[e];return t?t(s):s})},i.prototype.setMargin=function(e){return this.then(function(){switch(r(e)){case"number":e=[e,e,e,e];case"array":if(2===e.length&&(e=[e[0],e[1],e[0],e[1]]),4===e.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=e}).then(this.setPageSize)},i.prototype.setPageSize=function(e){function t(e,t){return Math.floor(e*t/72*96)}return this.then(function(){(e=e||Om.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(e.inner={width:e.width-this.opt.margin[1]-this.opt.margin[3],height:e.height-this.opt.margin[0]-this.opt.margin[2]},e.inner.px={width:t(e.inner.width,e.k),height:t(e.inner.height,e.k)},e.inner.ratio=e.inner.height/e.inner.width),this.prop.pageSize=e})},i.prototype.setProgress=function(e,t,s,r){return null!=e&&(this.progress.val=e),null!=t&&(this.progress.state=t),null!=s&&(this.progress.n=s),null!=r&&(this.progress.stack=r),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(e,t,s,r){return this.setProgress(e?this.progress.val+e:null,t||null,s?this.progress.n+s:null,r?this.progress.stack.concat(r):null)},i.prototype.then=function(e,t){var s=this;return this.thenCore(e,t,function(e,t){return s.updateProgress(null,null,1,[e]),Promise.prototype.then.call(this,function(t){return s.updateProgress(null,e),t}).then(e,t).then(function(e){return s.updateProgress(1),e})})},i.prototype.thenCore=function(e,t,s){s=s||Promise.prototype.then;var r=this;e&&(e=e.bind(r)),t&&(t=t.bind(r));var a=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?r:i.convert(Object.assign({},r),Promise.prototype),n=s.call(a,e,t);return i.convert(n,r.__proto__)},i.prototype.thenExternal=function(e,t){return Promise.prototype.then.call(this,e,t)},i.prototype.thenList=function(e){var t=this;return e.forEach(function(e){t=t.thenCore(e)}),t},i.prototype.catch=function(e){e&&(e=e.bind(this));var t=Promise.prototype.catch.call(this,e);return i.convert(t,this)},i.prototype.catchExternal=function(e){return Promise.prototype.catch.call(this,e)},i.prototype.error=function(e){return this.then(function(){throw new Error(e)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Om.getPageSize=function(e,t,s){if("object"===td(e)){var r=e;e=r.orientation,t=r.unit||t,s=r.format||s}t=t||"mm",s=s||"a4",e=(""+(e||"P")).toLowerCase();var a,n=(""+s).toLowerCase(),i={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(t){case"pt":a=1;break;case"mm":a=72/25.4;break;case"cm":a=72/2.54;break;case"in":a=72;break;case"px":a=.75;break;case"pc":case"em":a=12;break;case"ex":a=6;break;default:throw"Invalid unit: "+t}var l,o=0,d=0;if(i.hasOwnProperty(n))o=i[n][1]/a,d=i[n][0]/a;else try{o=s[1],d=s[0]}catch(c){throw new Error("Invalid format: "+s)}if("p"===e||"portrait"===e)e="p",d>o&&(l=d,d=o,o=l);else{if("l"!==e&&"landscape"!==e)throw"Invalid orientation: "+e;e="l",o>d&&(l=d,d=o,o=l)}return{width:d,height:o,unit:t,k:a,orientation:e}},e.html=function(e,t){(t=t||{}).callback=t.callback||function(){},t.html2canvas=t.html2canvas||{},t.html2canvas.canvas=t.html2canvas.canvas||this.canvas,t.jsPDF=t.jsPDF||this,t.fontFaces=t.fontFaces?t.fontFaces.map(Ph):null;var s=new i(t);return t.worker?s:s.from(e).doCallback()}}(Om.API),Om.API.addJS=function(e){return Bh=e,this.internal.events.subscribe("postPutResources",function(){Dh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Dh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Mh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Bh+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==Dh&&void 0!==Mh&&this.internal.out("/Names <</JavaScript "+Dh+" 0 R>>")}),this},
/**
 * @license
 * Copyright (c) 2014 Steven Spungin (TwelveTone LLC)  steven@twelvetone.tv
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t;e.events.push(["postPutResources",function(){var e=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=e.outline.render().split(/\r\n/),a=0;a<r.length;a++){var n=r[a],i=s.exec(n);if(null!=i){var l=i[1];e.internal.newObjectDeferredBegin(l,!1)}e.internal.write(n)}if(this.outline.createNamedDestinations){var o=this.internal.pages.length,d=[];for(a=0;a<o;a++){var c=e.internal.newObject();d.push(c);var u=e.internal.getPageInfo(a+1);e.internal.write("<< /D["+u.objId+" 0 R /XYZ null null null]>> endobj")}var m=e.internal.newObject();for(e.internal.write("<< /Names [ "),a=0;a<d.length;a++)e.internal.write("(page_"+(a+1)+")"+d[a]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+m+" 0 R"),e.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var e=this;e.outline.root.children.length>0&&(e.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&e.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(e,t,s){var r={title:t,options:s,children:[]};return null==e&&(e=this.root),e.children.push(r),r},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(t){t.id=e.internal.newObjectDeferred();for(var s=0;s<t.children.length;s++)this.genIds_r(t.children[s])},e.outline.renderRoot=function(e){this.objStart(e),this.line("/Type /Outlines"),e.children.length>0&&(this.line("/First "+this.makeRef(e.children[0])),this.line("/Last "+this.makeRef(e.children[e.children.length-1]))),this.line("/Count "+this.count_r({count:0},e)),this.objEnd()},e.outline.renderItems=function(t){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,r=0;r<t.children.length;r++){var a=t.children[r];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(t)),r>0&&this.line("/Prev "+this.makeRef(t.children[r-1])),r<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[r+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var n=this.count=this.count_r({count:0},a);if(n>0&&this.line("/Count "+n),a.options&&a.options.pageNumber){var i=e.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+i.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var l=0;l<t.children.length;l++)this.renderItems(t.children[l])},e.outline.line=function(e){this.ctx.val+=e+"\r\n"},e.outline.makeRef=function(e){return e.id+" 0 R"},e.outline.makeString=function(t){return"("+e.internal.pdfEscape(t)+")"},e.outline.objStart=function(e){this.ctx.val+="\r\n"+e.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(e,t){for(var s=0;s<t.children.length;s++)e.count++,this.count_r(e,t.children[s]);return e.count}}])}(Om.API),
/**
 * @license
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(e,s,r,a,n,i){var l,o=this.decode.DCT_DECODE,d=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=n||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(l=function(e){for(var s,r=256*e.charCodeAt(4)+e.charCodeAt(5),a=e.length,n={width:0,height:0,numcomponents:1},i=4;i<a;i+=2){if(i+=r,-1!==t.indexOf(e.charCodeAt(i+1))){s=256*e.charCodeAt(i+5)+e.charCodeAt(i+6),n={width:256*e.charCodeAt(i+7)+e.charCodeAt(i+8),height:s,numcomponents:e.charCodeAt(i+9)};break}r=256*e.charCodeAt(i+2)+e.charCodeAt(i+3)}return n}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:i=this.color_spaces.DEVICE_GRAY;break;case 4:i=this.color_spaces.DEVICE_CMYK;break;case 3:i=this.color_spaces.DEVICE_RGB}d={data:e,width:l.width,height:l.height,colorSpace:i,bitsPerComponent:8,filter:o,index:s,alias:r}}return d}}(Om.API),Om.API.processPNG=function(e,t,s,r){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var a,n=function(e,t){return new Qu(e,t).decode()}(e,{checkCrc:!0}),i=n.width,l=n.height,o=n.channels,d=n.palette,c=n.depth;a=d&&1===o?function(e){for(var t=e.width,s=e.height,r=e.data,a=e.palette,n=e.depth,i=!1,l=[],o=[],d=void 0,c=!1,u=0,m=0;m<a.length;m++){var h=Dd(a[m],4),x=h[0],g=h[1],f=h[2],p=h[3];l.push(x,g,f),null!=p&&(0===p?(u++,o.length<1&&o.push(m)):p<255&&(c=!0))}if(c||u>1){i=!0,o=void 0;var b=t*s;d=new Uint8Array(b);for(var y=new DataView(r.buffer),v=0;v<b;v++){var j=Dd(a[tx(y,v,n)],4)[3];d[v]=j}}else 0===u&&(o=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:i?8:void 0,colorBytes:r,alphaBytes:d,needSMask:i,palette:l,mask:o}}(n):2===o||4===o?function(e){for(var t=e.data,s=e.width,r=e.height,a=e.channels,n=e.depth,i=2===a?"DeviceGray":"DeviceRGB",l=a-1,o=s*r,d=l,c=o*d,u=1*o,m=Math.ceil(c*n/8),h=Math.ceil(u*n/8),x=new Uint8Array(m),g=new Uint8Array(h),f=new DataView(t.buffer),p=new DataView(x.buffer),b=new DataView(g.buffer),y=!1,v=0;v<o;v++){for(var j=v*a,N=0;N<d;N++)sx(p,tx(f,j+N,n),v*d+N,n);var w=tx(f,j+d,n);w<(1<<n)-1&&(y=!0),sx(b,w,1*v,n)}return{colorSpace:i,colorsPerPixel:l,sMaskBitsPerComponent:y?n:void 0,colorBytes:x,alphaBytes:g,needSMask:y}}(n):function(e){var t=e.data,s=1===e.channels?"DeviceGray":"DeviceRGB";return{colorSpace:s,colorsPerPixel:"DeviceGray"===s?1:3,colorBytes:t instanceof Uint16Array?function(e){for(var t=e.length,s=new Uint8Array(2*t),r=new DataView(s.buffer,s.byteOffset,s.byteLength),a=0;a<t;a++)r.setUint16(2*a,e[a],!1);return s}(t):t,needSMask:!1}}(n);var u,m,h,x=a,g=x.colorSpace,f=x.colorsPerPixel,p=x.sMaskBitsPerComponent,b=x.colorBytes,y=x.alphaBytes,v=x.needSMask,j=x.palette,N=x.mask,w=null;return r!==Om.API.image_compression.NONE?(w=function(e){var t;switch(e){case Om.API.image_compression.FAST:t=11;break;case Om.API.image_compression.MEDIUM:t=13;break;case Om.API.image_compression.SLOW:t=14;break;default:t=12}return t}(r),u=this.decode.FLATE_DECODE,m="/Predictor ".concat(w," /Colors ").concat(f," /BitsPerComponent ").concat(c," /Columns ").concat(i),e=Gh(b,Math.ceil(i*f*c/8),f,c,r),v&&(h=Gh(y,Math.ceil(i*p/8),1,p,r))):(u=void 0,m=void 0,e=b,v&&(h=y)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:s,data:e,index:t,filter:u,decodeParameters:m,transparency:N,palette:j,sMask:h,predictor:w,width:i,height:l,bitsPerComponent:c,sMaskBitsPerComponent:p,colorSpace:g}}},function(e){e.processGIF89A=function(t,s,r,a){var n=new ax(t),i=n.width,l=n.height,o=[];n.decodeAndBlitFrameRGBA(0,o);var d={data:o,width:i,height:l},c=new ix(100).encode(d,100);return e.processJPEG.call(this,c,s,r,a)},e.processGIF87A=e.processGIF89A}(Om.API),lx.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:r,blue:s,quad:n}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},lx.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(s){am.log("bit decode error:"+s)}},lx.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),s=t%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var n=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var o=this.palette[n>>7-l&1];this.data[i+4*l]=o.blue,this.data[i+4*l+1]=o.green,this.data[i+4*l+2]=o.red,this.data[i+4*l+3]=255}0!==s&&(this.pos+=4-s)}},lx.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,s=this.height-1;s>=0;s--){for(var r=this.bottom_up?s:this.height-1-s,a=0;a<e;a++){var n=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+2*a*4,l=n>>4,o=15&n,d=this.palette[l];if(this.data[i]=d.blue,this.data[i+1]=d.green,this.data[i+2]=d.red,this.data[i+3]=255,2*a+1>=this.width)break;d=this.palette[o],this.data[i+4]=d.blue,this.data[i+4+1]=d.green,this.data[i+4+2]=d.red,this.data[i+4+3]=255}0!==t&&(this.pos+=4-t)}},lx.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=s*this.width*4+4*r;if(a<this.palette.length){var i=this.palette[a];this.data[n]=i.red,this.data[n+1]=i.green,this.data[n+2]=i.blue,this.data[n+3]=255}else this.data[n]=255,this.data[n+1]=255,this.data[n+2]=255,this.data[n+3]=255}0!==e&&(this.pos+=4-e)}},lx.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),s=this.height-1;s>=0;s--){for(var r=this.bottom_up?s:this.height-1-s,a=0;a<this.width;a++){var n=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(n&t)/t*255|0,l=(n>>5&t)/t*255|0,o=(n>>10&t)/t*255|0,d=n>>15?255:0,c=r*this.width*4+4*a;this.data[c]=o,this.data[c+1]=l,this.data[c+2]=i,this.data[c+3]=d}this.pos+=e}},lx.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),s=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&t)/t*255|0,o=(i>>5&s)/s*255|0,d=(i>>11)/t*255|0,c=a*this.width*4+4*n;this.data[c]=d,this.data[c+1]=o,this.data[c+2]=l,this.data[c+3]=255}this.pos+=e}},lx.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*s;this.data[i]=n,this.data[i+1]=a,this.data[i+2]=r,this.data[i+3]=255}this.pos+=this.width%4}},lx.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*s;this.data[l]=n,this.data[l+1]=a,this.data[l+2]=r,this.data[l+3]=i}},lx.prototype.getData=function(){return this.data},
/**
 * @license
 * Copyright (c) 2018 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){e.processBMP=function(t,s,r,a){var n=new lx(t,!1),i=n.width,l=n.height,o={data:n.getData(),width:i,height:l},d=new ix(100).encode(o,100);return e.processJPEG.call(this,d,s,r,a)}}(Om.API),ox.prototype.getData=function(){return this.data},
/**
 * @license
 * Copyright (c) 2019 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){e.processWEBP=function(t,s,r,a){var n=new ox(t),i=n.width,l=n.height,o={data:n.getData(),width:i,height:l},d=new ix(100).encode(o,100);return e.processJPEG.call(this,d,s,r,a)}}(Om.API),Om.API.processRGBA=function(e,t,s){for(var r=e.data,a=r.length,n=new Uint8Array(a/4*3),i=new Uint8Array(a/4),l=0,o=0,d=0;d<a;d+=4){var c=r[d],u=r[d+1],m=r[d+2],h=r[d+3];n[l++]=c,n[l++]=u,n[l++]=m,i[o++]=h}var x=this.__addimage__.arrayBufferToBinaryString(n);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:x,index:t,alias:s,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Om.API.setLanguage=function(e){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]&&(this.internal.languageSettings.languageCode=e,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Uh=Om.API,qh=Uh.getCharWidthsArray=function(e,t){var s,r,a=(t=t||{}).font||this.internal.getFont(),n=t.fontSize||this.internal.getFontSize(),i=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:a.metadata.Unicode.widths,o=l.fof?l.fof:1,d=t.kerning?t.kerning:a.metadata.Unicode.kerning,c=d.fof?d.fof:1,u=!1!==t.doKerning,m=0,h=e.length,x=0,g=l[0]||o,f=[];for(s=0;s<h;s++)r=e.charCodeAt(s),"function"==typeof a.metadata.widthOfString?f.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(r))+i*(1e3/n)||0)/1e3):(m=u&&"object"===td(d[r])&&!isNaN(parseInt(d[r][x],10))?d[r][x]/c:0,f.push((l[r]||g)/o+m)),x=r;return f},zh=Uh.getStringUnitWidth=function(e,t){var s=(t=t||{}).fontSize||this.internal.getFontSize(),r=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return Uh.processArabic&&(e=Uh.processArabic(e)),"function"==typeof r.metadata.widthOfString?r.metadata.widthOfString(e,s,a)/s:qh.apply(this,arguments).reduce(function(e,t){return e+t},0)},Wh=function(e,t,s,r){for(var a=[],n=0,i=e.length,l=0;n!==i&&l+t[n]<s;)l+=t[n],n++;a.push(e.slice(0,n));var o=n;for(l=0;n!==i;)l+t[n]>r&&(a.push(e.slice(o,n)),l=0,o=n),l+=t[n],n++;return o!==n&&a.push(e.slice(o,n)),a},Vh=function(e,t,s){s||(s={});var r,a,n,i,l,o,d,c=[],u=[c],m=s.textIndent||0,h=0,x=0,g=e.split(" "),f=qh.apply(this,[" ",s])[0];if(o=-1===s.lineIndent?g[0].length+2:s.lineIndent||0){var p=Array(o).join(" "),b=[];g.map(function(e){(e=e.split(/\s*\n/)).length>1?b=b.concat(e.map(function(e,t){return(t&&e.length?"\n":"")+e})):b.push(e[0])}),g=b,o=zh.apply(this,[p,s])}for(n=0,i=g.length;n<i;n++){var y=0;if(r=g[n],o&&"\n"==r[0]&&(r=r.substr(1),y=1),m+h+(x=(a=qh.apply(this,[r,s])).reduce(function(e,t){return e+t},0))>t||y){if(x>t){for(l=Wh.apply(this,[r,a,t-(m+h),t]),c.push(l.shift()),c=[l.pop()];l.length;)u.push([l.shift()]);x=a.slice(r.length-(c[0]?c[0].length:0)).reduce(function(e,t){return e+t},0)}else c=[r];u.push(c),m=x+o,h=f}else c.push(r),m+=h+x,h=f}return d=o?function(e,t){return(t?p:"")+e.join(" ")}:function(e){return e.join(" ")},u.map(d)},Uh.splitTextToSize=function(e,t,s){var r,a=(s=s||{}).fontSize||this.internal.getFontSize(),n=function(e){if(e.widths&&e.kerning)return{widths:e.widths,kerning:e.kerning};var t=this.internal.getFont(e.fontName,e.fontStyle),s="Unicode";return t.metadata[s]?{widths:t.metadata[s].widths||{0:1},kerning:t.metadata[s].kerning||{}}:{font:t.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,s);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/a;n.textIndent=s.textIndent?1*s.textIndent*this.internal.scaleFactor/a:0,n.lineIndent=s.lineIndent;var l,o,d=[];for(l=0,o=r.length;l<o;l++)d=d.concat(Vh.apply(this,[r[l],i,n]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",s="klmnopqrstuvwxyz",r={},a={},n=0;n<16;n++)r[s[n]]=t[n],a[t[n]]=s[n];var i=function(e){return"0x"+parseInt(e,10).toString(16)},l=e.__fontmetrics__.compress=function(e){var t,s,r,n,o=["{"];for(var d in e){if(t=e[d],isNaN(parseInt(d,10))?s="'"+d+"'":(d=parseInt(d,10),s=(s=i(d).slice(2)).slice(0,-1)+a[s.slice(-1)]),"number"==typeof t)t<0?(r=i(t).slice(3),n="-"):(r=i(t).slice(2),n=""),r=n+r.slice(0,-1)+a[r.slice(-1)];else{if("object"!==td(t))throw new Error("Don't know what to do with value type "+td(t)+".");r=l(t)}o.push(s+r)}return o.push("}"),o.join("")},o=e.__fontmetrics__.uncompress=function(e){if("string"!=typeof e)throw new Error("Invalid argument passed to uncompress.");for(var t,s,a,n,i={},l=1,o=i,d=[],c="",u="",m=e.length-1,h=1;h<m;h+=1)"'"==(n=e[h])?t?(a=t.join(""),t=void 0):t=[]:t?t.push(n):"{"==n?(d.push([o,a]),o={},a=void 0):"}"==n?((s=d.pop())[0][s[1]]=o,a=void 0,o=s[0]):"-"==n?l=-1:void 0===a?r.hasOwnProperty(n)?(c+=r[n],a=parseInt(c,16)*l,l=1,c=""):c+=n:r.hasOwnProperty(n)?(u+=r[n],o[a]=parseInt(u,16)*l,l=1,a=void 0,u=""):u+=n;return i},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(e){var t=e.font,s=u.Unicode[t.postScriptName];s&&(t.metadata.Unicode={},t.metadata.Unicode.widths=s.widths,t.metadata.Unicode.kerning=s.kerning);var r=c.Unicode[t.postScriptName];r&&(t.metadata.Unicode.encoding=r,t.encoding=r.codePages[0])}])}(Om.API),
/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t=function(e){for(var t=e.length,s=new Uint8Array(t),r=0;r<t;r++)s[r]=e.charCodeAt(r);return s};e.API.events.push(["addFont",function(s){var r,a,n=void 0,i=s.font,l=s.instance;if(!i.isStandardFont){if(void 0===l)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if("string"!=typeof(n=!1===l.existsFileInVFS(i.postScriptName)?l.loadFile(i.postScriptName):l.getFileFromVFS(i.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");r=i,a=/^\x00\x01\x00\x00/.test(a=n)?t(a):t(cm(a)),r.metadata=e.API.TTFFont.open(a),r.metadata.Unicode=r.metadata.Unicode||{encoding:{},kerning:{},widths:[]},r.metadata.glyIdsUsed=[0]}}])}(Om),Om.API.addSvgAsImage=function(e,t,s,r,a,n,i,l){if(isNaN(t)||isNaN(s))throw am.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(a))throw am.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var o=document.createElement("canvas");o.width=r,o.height=a;var d=o.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,o.width,o.height);var c={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},u=this;return(sm.canvg?Promise.resolve(sm.canvg):ed(()=>import("./index.es-XNFtkdrW.js"),__vite__mapDeps([0,1,2,3]))).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e}).then(function(t){return t.fromString(d,e,c)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(e){return e.render(c)}).then(function(){u.addImage(o.toDataURL("image/jpeg",1),t,s,r,a,i,l)})},Om.API.putTotalPages=function(e){var t,s=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),s=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),s=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var a=0;a<this.internal.pages[r].length;a++)this.internal.pages[r][a]=this.internal.pages[r][a].replace(t,s);return this},Om.API.viewerPreferences=function(e,t){var s;e=e||{},t=t||!1;var r,a,n,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(i),o=[],d=0,c=0,u=0;function m(e,t){var s,r=!1;for(s=0;s<e.length;s+=1)e[s]===t&&(r=!0);return r}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),s=this.internal.viewerpreferences.configuration,"reset"===e||!0===t){var h=l.length;for(u=0;u<h;u+=1)s[l[u]].value=s[l[u]].defaultValue,s[l[u]].explicitSet=!1}if("object"===td(e))for(a in e)if(n=e[a],m(l,a)&&void 0!==n){if("boolean"===s[a].type&&"boolean"==typeof n)s[a].value=n;else if("name"===s[a].type&&m(s[a].valueSet,n))s[a].value=n;else if("integer"===s[a].type&&Number.isInteger(n))s[a].value=n;else if("array"===s[a].type){for(d=0;d<n.length;d+=1)if(r=!0,1===n[d].length&&"number"==typeof n[d][0])o.push(String(n[d]-1));else if(n[d].length>1){for(c=0;c<n[d].length;c+=1)"number"!=typeof n[d][c]&&(r=!1);!0===r&&o.push([n[d][0]-1,n[d][1]-1].join(" "))}s[a].value="["+o.join(" ")+"]"}else s[a].value=s[a].defaultValue;s[a].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var e,t=[];for(e in s)!0===s[e].explicitSet&&("name"===s[e].type?t.push("/"+e+" /"+s[e].value):t.push("/"+e+" "+s[e].value));0!==t.length&&this.internal.write("/ViewerPreferences\n<<\n"+t.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=s,this},
/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */
function(e){var t=function(){var e='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',t=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(e)),r=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),n=unescape(encodeURIComponent("</x:xmpmeta>")),i=s.length+r.length+a.length+t.length+n.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+i+" >>"),this.internal.write("stream"),this.internal.write(t+s+r+a+n),this.internal.write("endstream"),this.internal.write("endobj")},s=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(e,r){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:e,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",s),this.internal.events.subscribe("postPutResources",t)),this}}(Om.API),function(e){var t=e.API,s=t.pdfEscape16=function(e,t){for(var s,r=t.metadata.Unicode.widths,a=["","0","00","000","0000"],n=[""],i=0,l=e.length;i<l;++i){if(s=t.metadata.characterToGlyph(e.charCodeAt(i)),t.metadata.glyIdsUsed.push(s),t.metadata.toUnicode[s]=e.charCodeAt(i),-1==r.indexOf(s)&&(r.push(s),r.push([parseInt(t.metadata.widthOfGlyph(s),10)])),"0"==s)return n.join("");s=s.toString(16),n.push(a[4-s.length],s)}return n.join("")},r=function(e){var t,s,r,a,n,i,l;for(n="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",r=[],i=0,l=(s=Object.keys(e).sort(function(e,t){return e-t})).length;i<l;i++)t=s[i],r.length>=100&&(n+="\n"+r.length+" beginbfchar\n"+r.join("\n")+"\nendbfchar",r=[]),void 0!==e[t]&&null!==e[t]&&"function"==typeof e[t].toString&&(a=("0000"+e[t].toString(16)).slice(-4),t=("0000"+(+t).toString(16)).slice(-4),r.push("<"+t+"><"+a+">"));return r.length&&(n+="\n"+r.length+" beginbfchar\n"+r.join("\n")+"\nendbfchar\n"),n+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};t.events.push(["putFont",function(t){!function(t){var s=t.font,a=t.out,n=t.newObject,i=t.putStream;if(s.metadata instanceof e.API.TTFFont&&"Identity-H"===s.encoding){for(var l=s.metadata.Unicode.widths,o=s.metadata.subset.encode(s.metadata.glyIdsUsed,1),d="",c=0;c<o.length;c++)d+=String.fromCharCode(o[c]);var u=n();i({data:d,addLength1:!0,objectId:u}),a("endobj");var m=n();i({data:r(s.metadata.toUnicode),addLength1:!0,objectId:m}),a("endobj");var h=n();a("<<"),a("/Type /FontDescriptor"),a("/FontName /"+Am(s.fontName)),a("/FontFile2 "+u+" 0 R"),a("/FontBBox "+e.API.PDFObject.convert(s.metadata.bbox)),a("/Flags "+s.metadata.flags),a("/StemV "+s.metadata.stemV),a("/ItalicAngle "+s.metadata.italicAngle),a("/Ascent "+s.metadata.ascender),a("/Descent "+s.metadata.decender),a("/CapHeight "+s.metadata.capHeight),a(">>"),a("endobj");var x=n();a("<<"),a("/Type /Font"),a("/BaseFont /"+Am(s.fontName)),a("/FontDescriptor "+h+" 0 R"),a("/W "+e.API.PDFObject.convert(l)),a("/CIDToGIDMap /Identity"),a("/DW 1000"),a("/Subtype /CIDFontType2"),a("/CIDSystemInfo"),a("<<"),a("/Supplement 0"),a("/Registry (Adobe)"),a("/Ordering ("+s.encoding+")"),a(">>"),a(">>"),a("endobj"),s.objectNumber=n(),a("<<"),a("/Type /Font"),a("/Subtype /Type0"),a("/ToUnicode "+m+" 0 R"),a("/BaseFont /"+Am(s.fontName)),a("/Encoding /"+s.encoding),a("/DescendantFonts ["+x+" 0 R]"),a(">>"),a("endobj"),s.isAlreadyPutted=!0}}(t)}]),t.events.push(["putFont",function(t){!function(t){var s=t.font,a=t.out,n=t.newObject,i=t.putStream;if(s.metadata instanceof e.API.TTFFont&&"WinAnsiEncoding"===s.encoding){for(var l=s.metadata.rawData,o="",d=0;d<l.length;d++)o+=String.fromCharCode(l[d]);var c=n();i({data:o,addLength1:!0,objectId:c}),a("endobj");var u=n();i({data:r(s.metadata.toUnicode),addLength1:!0,objectId:u}),a("endobj");var m=n();a("<<"),a("/Descent "+s.metadata.decender),a("/CapHeight "+s.metadata.capHeight),a("/StemV "+s.metadata.stemV),a("/Type /FontDescriptor"),a("/FontFile2 "+c+" 0 R"),a("/Flags 96"),a("/FontBBox "+e.API.PDFObject.convert(s.metadata.bbox)),a("/FontName /"+Am(s.fontName)),a("/ItalicAngle "+s.metadata.italicAngle),a("/Ascent "+s.metadata.ascender),a(">>"),a("endobj"),s.objectNumber=n();for(var h=0;h<s.metadata.hmtx.widths.length;h++)s.metadata.hmtx.widths[h]=parseInt(s.metadata.hmtx.widths[h]*(1e3/s.metadata.head.unitsPerEm));a("<</Subtype/TrueType/Type/Font/ToUnicode "+u+" 0 R/BaseFont/"+Am(s.fontName)+"/FontDescriptor "+m+" 0 R/Encoding/"+s.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(s.metadata.hmtx.widths)+">>"),a("endobj"),s.isAlreadyPutted=!0}}(t)}]);var a=function(e){var t,r=e.text||"",a=e.x,n=e.y,i=e.options||{},l=e.mutex||{},o=l.pdfEscape,d=l.activeFontKey,c=l.fonts,u=d,m="",h=0,x="",g=c[u].encoding;if("Identity-H"!==c[u].encoding)return{text:r,x:a,y:n,options:i,mutex:l};for(x=r,u=d,Array.isArray(r)&&(x=r[0]),h=0;h<x.length;h+=1)c[u].metadata.hasOwnProperty("cmap")&&(t=c[u].metadata.cmap.unicode.codeMap[x[h].charCodeAt(0)]),t||x[h].charCodeAt(0)<256&&c[u].metadata.hasOwnProperty("Unicode")?m+=x[h]:m+="";var f="";return parseInt(u.slice(1))<14||"WinAnsiEncoding"===g?f=o(m,u).split("").map(function(e){return e.charCodeAt(0).toString(16)}).join(""):"Identity-H"===g&&(f=s(m,c[u])),l.isHex=!0,{text:f,x:a,y:n,options:i,mutex:l}};t.events.push(["postProcessText",function(e){var t=e.text||"",s=[],r={text:t,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(t)){var n=0;for(n=0;n<t.length;n+=1)Array.isArray(t[n])&&3===t[n].length?s.push([a(Object.assign({},r,{text:t[n][0]})).text,t[n][1],t[n][2]]):s.push(a(Object.assign({},r,{text:t[n]})).text);e.text=s}else e.text=a(Object.assign({},r,{text:t})).text}])}(Om),
/**
 * @license
 * jsPDF virtual FileSystem functionality
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]},e.addFileToVFS=function(e,s){return t.call(this),this.internal.vFS[e]=s,this},e.getFileFromVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(Om.API),
/**
 * @license
 * Unicode Bidi Engine based on the work of Alex Shensis (@asthensis)
 * MIT License
 */
function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(e){var s,r,a,n,i,l,o,d=t,c=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],u=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},h={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],g=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),f=!1,p=0;this.__bidiEngine__={};var b=function(e){var t=e.charCodeAt(),s=t>>8,r=h[s];return void 0!==r?d[256*r+(255&t)]:252===s||253===s?"AL":g.test(s)?"L":8===s?"R":"N"},y=function(e){for(var t,s=0;s<e.length;s++){if("L"===(t=b(e.charAt(s))))return!1;if("R"===t)return!0}return!1},v=function(e,t,i,l){var o,d,c,u,m=t[l];switch(m){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":f=!1;break;case"N":case"AN":break;case"EN":f&&(m="AN");break;case"AL":f=!0,m="R";break;case"WS":case"BN":m="N";break;case"CS":l<1||l+1>=t.length||"EN"!==(o=i[l-1])&&"AN"!==o||"EN"!==(d=t[l+1])&&"AN"!==d?m="N":f&&(d="AN"),m=d===o?d:"N";break;case"ES":m="EN"===(o=l>0?i[l-1]:"B")&&l+1<t.length&&"EN"===t[l+1]?"EN":"N";break;case"ET":if(l>0&&"EN"===i[l-1]){m="EN";break}if(f){m="N";break}for(c=l+1,u=t.length;c<u&&"ET"===t[c];)c++;m=c<u&&"EN"===t[c]?"EN":"N";break;case"NSM":if(a&&!n){for(u=t.length,c=l+1;c<u&&"NSM"===t[c];)c++;if(c<u){var h=e[l],x=h>=1425&&h<=2303||64286===h;if(o=t[c],x&&("R"===o||"AL"===o)){m="R";break}}}m=l<1||"B"===(o=t[l-1])?"N":i[l-1];break;case"B":f=!1,s=!0,m=p;break;case"S":r=!0,m="N"}return m},j=function(e,t,s){var r=e.split("");return s&&N(r,s,{hiLevel:p}),r.reverse(),t&&t.reverse(),r.join("")},N=function(e,t,a){var n,i,l,o,d,h=-1,x=e.length,g=0,y=[],j=p?u:c,N=[];for(f=!1,s=!1,r=!1,i=0;i<x;i++)N[i]=b(e[i]);for(l=0;l<x;l++){if(d=g,y[l]=v(e,N,y,l),n=240&(g=j[d][m[y[l]]]),g&=15,t[l]=o=j[g][5],n>0)if(16===n){for(i=h;i<l;i++)t[i]=1;h=-1}else h=-1;if(j[g][6])-1===h&&(h=l);else if(h>-1){for(i=h;i<l;i++)t[i]=o;h=-1}"B"===N[l]&&(t[l]=0),a.hiLevel|=o}r&&function(e,t,s){for(var r=0;r<s;r++)if("S"===e[r]){t[r]=p;for(var a=r-1;a>=0&&"WS"===e[a];a--)t[a]=p}}(N,t,x)},w=function(e,t,r,a,n){if(!(n.hiLevel<e)){if(1===e&&1===p&&!s)return t.reverse(),void(r&&r.reverse());for(var i,l,o,d,c=t.length,u=0;u<c;){if(a[u]>=e){for(o=u+1;o<c&&a[o]>=e;)o++;for(d=u,l=o-1;d<l;d++,l--)i=t[d],t[d]=t[l],t[l]=i,r&&(i=r[d],r[d]=r[l],r[l]=i);u=o}u++}}},S=function(e,t,s){var r=e.split(""),a={hiLevel:p};return s||(s=[]),N(r,s,a),function(e,t,s){if(0!==s.hiLevel&&o)for(var r,a=0;a<e.length;a++)1===t[a]&&(r=x.indexOf(e[a]))>=0&&(e[a]=x[r+1])}(r,s,a),w(2,r,t,s,a),w(1,r,t,s,a),r.join("")};return this.__bidiEngine__.doBidiReorder=function(e,t,s){if(function(e,t){if(t)for(var s=0;s<e.length;s++)t[s]=s;void 0===n&&(n=y(e)),void 0===l&&(l=y(e))}(e,t),a||!i||l)if(a&&i&&n^l)p=n?1:0,e=j(e,t,s);else if(!a&&i&&l)p=n?1:0,e=S(e,t,s),e=j(e,t);else if(!a||n||i||l){if(a&&!i&&n^l)e=j(e,t),n?(p=0,e=S(e,t,s)):(p=1,e=S(e,t,s),e=j(e,t));else if(a&&n&&!i&&l)p=1,e=S(e,t,s),e=j(e,t);else if(!a&&!i&&n^l){var r=o;n?(p=1,e=S(e,t,s),p=0,o=!1,e=S(e,t,s),o=r):(p=0,e=S(e,t,s),e=j(e,t),p=1,o=!1,e=S(e,t,s),o=r,e=j(e,t))}}else p=0,e=S(e,t,s);else p=n?1:0,e=S(e,t,s);return e},this.__bidiEngine__.setOptions=function(e){e&&(a=e.isInputVisual,i=e.isOutputVisual,n=e.isInputRtl,l=e.isOutputRtl,o=e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(e),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],s=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(e){var t=e.text;e.x,e.y;var r=e.options||{};e.mutex,r.lang;var a=[];if(r.isInputVisual="boolean"!=typeof r.isInputVisual||r.isInputVisual,s.setOptions(r),"[object Array]"===Object.prototype.toString.call(t)){var n=0;for(a=[],n=0;n<t.length;n+=1)"[object Array]"===Object.prototype.toString.call(t[n])?a.push([s.doBidiReorder(t[n][0]),t[n][1],t[n][2]]):a.push([s.doBidiReorder(t[n])]);e.text=a}else e.text=s.doBidiReorder(t);s.setOptions({isInputVisual:!0})}])}(Om),Om.API.TTFFont=function(){function e(e){var t;if(this.rawData=e,t=this.contents=new cx(e),this.contents.pos=4,"ttcf"===t.readString(4))throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new Ax(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new ux(this.contents),this.head=new xx(this),this.name=new jx(this),this.cmap=new fx(this),this.toUnicode={},this.hhea=new px(this),this.maxp=new Nx(this),this.hmtx=new wx(this),this.post=new yx(this),this.os2=new bx(this),this.loca=new _x(this),this.glyf=new kx(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var e,t,s,r,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var t,s,r,a;for(a=[],t=0,s=(r=this.bbox).length;t<s;t++)e=r[t],a.push(Math.round(e*this.scaleFactor));return a}.call(this),this.stemV=0,this.post.exists?(s=255&(r=this.post.italic_angle),32768&(t=r>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(a=this.familyClass)||2===a||3===a||4===a||5===a||7===a,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(e){var t;return(null!=(t=this.cmap.unicode)?t.codeMap[e]:void 0)||0},e.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},e.prototype.widthOfString=function(e,t,s){var r,a,n,i;for(n=0,a=0,i=(e=""+e).length;0<=i?a<i:a>i;a=0<=i?++a:--a)r=e.charCodeAt(a),n+=this.widthOfGlyph(this.characterToGlyph(r))+s*(1e3/t)||0;return n*(t/1e3)},e.prototype.lineHeight=function(e,t){var s;return null==t&&(t=!1),s=t?this.lineGap:0,(this.ascender+s-this.decender)/1e3*e},e}();var dx,cx=function(){function e(e){this.data=null!=e?e:[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(e){return this.data[this.pos++]=e},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},e.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},e.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},e.prototype.readString=function(e){var t,s;for(s=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)s[t]=String.fromCharCode(this.readByte());return s.join("")},e.prototype.writeString=function(e){var t,s,r;for(r=[],t=0,s=e.length;0<=s?t<s:t>s;t=0<=s?++t:--t)r.push(this.writeByte(e.charCodeAt(t)));return r},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(e){return this.writeInt16(e)},e.prototype.readLongLong=function(){var e,t,s,r,a,n,i,l;return e=this.readByte(),t=this.readByte(),s=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),i=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^s)+4294967296*(255^r)+16777216*(255^a)+65536*(255^n)+256*(255^i)+(255^l)+1):72057594037927940*e+281474976710656*t+1099511627776*s+4294967296*r+16777216*a+65536*n+256*i+l},e.prototype.writeLongLong=function(e){var t,s;return t=Math.floor(e/4294967296),s=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(e){return this.writeInt32(e)},e.prototype.read=function(e){var t,s;for(t=[],s=0;0<=e?s<e:s>e;s=0<=e?++s:--s)t.push(this.readByte());return t},e.prototype.write=function(e){var t,s,r,a;for(a=[],s=0,r=e.length;s<r;s++)t=e[s],a.push(this.writeByte(t));return a},e}(),ux=function(){var e;function t(e){var t,s,r;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},s=0,r=this.tableCount;0<=r?s<r:s>r;s=0<=r?++s:--s)t={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[t.tag]=t}return t.prototype.encode=function(t){var s,r,a,n,i,l,o,d,c,u,m,h,x;for(x in m=Object.keys(t).length,l=Math.log(2),c=16*Math.floor(Math.log(m)/l),n=Math.floor(c/l),d=16*m-c,(r=new cx).writeInt(this.scalarType),r.writeShort(m),r.writeShort(c),r.writeShort(n),r.writeShort(d),a=16*m,o=r.pos+a,i=null,h=[],t)for(u=t[x],r.writeString(x),r.writeInt(e(u)),r.writeInt(o),r.writeInt(u.length),h=h.concat(u),"head"===x&&(i=o),o+=u.length;o%4;)h.push(0),o++;return r.write(h),s=2981146554-e(r.data),r.pos=i+8,r.writeUInt32(s),r.data},e=function(e){var t,s,r,a;for(e=Sx.call(e);e.length%4;)e.push(0);for(r=new cx(e),s=0,t=0,a=e.length;t<a;t=t+=4)s+=r.readUInt32();return 4294967295&s},t}(),mx={}.hasOwnProperty,hx=function(e,t){for(var s in t)mx.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};dx=function(){function e(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var xx=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return hx(e,dx),e.prototype.tag="head",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},e.prototype.encode=function(e){var t;return(t=new cx).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},e}(),gx=function(){function e(e,t){var s,r,a,n,i,l,o,d,c,u,m,h,x,g,f,p,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),c=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(m=e.readUInt16(),u=m/2,e.pos+=6,a=function(){var t,s;for(s=[],l=t=0;0<=u?t<u:t>u;l=0<=u?++t:--t)s.push(e.readUInt16());return s}(),e.pos+=2,x=function(){var t,s;for(s=[],l=t=0;0<=u?t<u:t>u;l=0<=u?++t:--t)s.push(e.readUInt16());return s}(),o=function(){var t,s;for(s=[],l=t=0;0<=u?t<u:t>u;l=0<=u?++t:--t)s.push(e.readUInt16());return s}(),d=function(){var t,s;for(s=[],l=t=0;0<=u?t<u:t>u;l=0<=u?++t:--t)s.push(e.readUInt16());return s}(),r=(this.length-e.pos+this.offset)/2,i=function(){var t,s;for(s=[],l=t=0;0<=r?t<r:t>r;l=0<=r?++t:--t)s.push(e.readUInt16());return s}(),l=f=0,b=a.length;f<b;l=++f)for(g=a[l],s=p=h=x[l];h<=g?p<=g:p>=g;s=h<=g?++p:--p)0===d[l]?n=s+o[l]:0!==(n=i[d[l]/2+(s-h)-(u-l)]||0)&&(n+=o[l]),this.codeMap[s]=65535&n}e.pos=c}return e.encode=function(e,t){var s,r,a,n,i,l,o,d,c,u,m,h,x,g,f,p,b,y,v,j,N,w,S,k,C,$,_,A,P,L,E,T,I,O,F,R,D,M,B,U,q,z,W,V,H,G;switch(A=new cx,n=Object.keys(e).sort(function(e,t){return e-t}),t){case"macroman":for(x=0,g=function(){var e=[];for(h=0;h<256;++h)e.push(0);return e}(),p={0:0},a={},P=0,I=n.length;P<I;P++)null==p[W=e[r=n[P]]]&&(p[W]=++x),a[r]={old:e[r],new:p[e[r]]},g[r]=p[e[r]];return A.writeUInt16(1),A.writeUInt16(0),A.writeUInt32(12),A.writeUInt16(0),A.writeUInt16(262),A.writeUInt16(0),A.write(g),{charMap:a,subtable:A.data,maxGlyphID:x+1};case"unicode":for($=[],c=[],b=0,p={},s={},f=o=null,L=0,O=n.length;L<O;L++)null==p[v=e[r=n[L]]]&&(p[v]=++b),s[r]={old:v,new:p[v]},i=p[v]-r,null!=f&&i===o||(f&&c.push(f),$.push(r),o=i),f=r;for(f&&c.push(f),c.push(65535),$.push(65535),k=2*(S=$.length),w=2*Math.pow(Math.log(S)/Math.LN2,2),u=Math.log(w/2)/Math.LN2,N=2*S-w,l=[],j=[],m=[],h=E=0,F=$.length;E<F;h=++E){if(C=$[h],d=c[h],65535===C){l.push(0),j.push(0);break}if(C-(_=s[C].new)>=32768)for(l.push(0),j.push(2*(m.length+S-h)),r=T=C;C<=d?T<=d:T>=d;r=C<=d?++T:--T)m.push(s[r].new);else l.push(_-C),j.push(0)}for(A.writeUInt16(3),A.writeUInt16(1),A.writeUInt32(12),A.writeUInt16(4),A.writeUInt16(16+8*S+2*m.length),A.writeUInt16(0),A.writeUInt16(k),A.writeUInt16(w),A.writeUInt16(u),A.writeUInt16(N),q=0,R=c.length;q<R;q++)r=c[q],A.writeUInt16(r);for(A.writeUInt16(0),z=0,D=$.length;z<D;z++)r=$[z],A.writeUInt16(r);for(V=0,M=l.length;V<M;V++)i=l[V],A.writeUInt16(i);for(H=0,B=j.length;H<B;H++)y=j[H],A.writeUInt16(y);for(G=0,U=m.length;G<U;G++)x=m[G],A.writeUInt16(x);return{charMap:s,subtable:A.data,maxGlyphID:b+1}}},e}(),fx=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return hx(e,dx),e.prototype.tag="cmap",e.prototype.parse=function(e){var t,s,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)t=new gx(e,this.offset),this.tables.push(t),t.isUnicode&&null==this.unicode&&(this.unicode=t);return!0},e.encode=function(e,t){var s,r;return null==t&&(t="macroman"),s=gx.encode(e,t),(r=new cx).writeUInt16(0),r.writeUInt16(1),s.table=r.data.concat(s.subtable),s},e}(),px=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return hx(e,dx),e.prototype.tag="hhea",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},e}(),bx=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return hx(e,dx),e.prototype.tag="OS/2",e.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var t,s;for(s=[],t=0;t<10;++t)s.push(e.readByte());return s}(),this.charRange=function(){var t,s;for(s=[],t=0;t<4;++t)s.push(e.readInt());return s}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var t,s;for(s=[],t=0;t<2;t=++t)s.push(e.readInt());return s}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},e}(),yx=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return hx(e,dx),e.prototype.tag="post",e.prototype.parse=function(e){var t,s,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(s=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)t=e.readByte(),r.push(this.names.push(e.readString(t)));return r;case 151552:return s=e.readUInt16(),this.offsets=e.read(s);case 262144:return this.map=function(){var t,s,r;for(r=[],a=t=0,s=this.file.maxp.numGlyphs;0<=s?t<s:t>s;a=0<=s?++t:--t)r.push(e.readUInt32());return r}.call(this)}},e}(),vx=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},jx=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return hx(e,dx),e.prototype.tag="name",e.prototype.parse=function(e){var t,s,r,a,n,i,l,o,d,c,u;for(e.pos=this.offset,e.readShort(),t=e.readShort(),i=e.readShort(),s=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)s.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+i+e.readShort()});for(l={},a=d=0,c=s.length;d<c;a=++d)r=s[a],e.pos=r.offset,o=e.readString(r.length),n=new vx(o,r),null==l[u=r.nameID]&&(l[u]=[]),l[r.nameID].push(n);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(m){this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},e}(),Nx=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return hx(e,dx),e.prototype.tag="maxp",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},e}(),wx=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return hx(e,dx),e.prototype.tag="hmtx",e.prototype.parse=function(e){var t,s,r,a,n,i,l;for(e.pos=this.offset,this.metrics=[],t=0,i=this.file.hhea.numberOfMetrics;0<=i?t<i:t>i;t=0<=i?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var s,a;for(a=[],t=s=0;0<=r?s<r:s>r;t=0<=r?++s:--s)a.push(e.readInt16());return a}(),this.widths=function(){var e,t,s,r;for(r=[],e=0,t=(s=this.metrics).length;e<t;e++)a=s[e],r.push(a.advance);return r}.call(this),s=this.widths[this.widths.length-1],l=[],t=n=0;0<=r?n<r:n>r;t=0<=r?++n:--n)l.push(this.widths.push(s));return l},e.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},e}(),Sx=[].slice,kx=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return hx(e,dx),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(e){var t,s,r,a,n,i,l,o,d,c;return e in this.cache?this.cache[e]:(a=this.file.loca,t=this.file.contents,s=a.indexOf(e),0===(r=a.lengthOf(e))?this.cache[e]=null:(t.pos=this.offset+s,n=(i=new cx(t.read(r))).readShort(),o=i.readShort(),c=i.readShort(),l=i.readShort(),d=i.readShort(),this.cache[e]=-1===n?new $x(i,o,c,l,d):new Cx(i,n,o,c,l,d),this.cache[e]))},e.prototype.encode=function(e,t,s){var r,a,n,i,l;for(n=[],a=[],i=0,l=t.length;i<l;i++)r=e[t[i]],a.push(n.length),r&&(n=n.concat(r.encode(s)));return a.push(n.length),{table:n,offsets:a}},e}(),Cx=function(){function e(e,t,s,r,a,n){this.raw=e,this.numberOfContours=t,this.xMin=s,this.yMin=r,this.xMax=a,this.yMax=n,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),$x=function(){function e(e,t,s,r,a){var n,i;for(this.raw=e,this.xMin=t,this.yMin=s,this.xMax=r,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],n=this.raw;i=n.readShort(),this.glyphOffsets.push(n.pos),this.glyphIDs.push(n.readUInt16()),32&i;)n.pos+=1&i?4:2,128&i?n.pos+=8:64&i?n.pos+=4:8&i&&(n.pos+=2)}return e.prototype.encode=function(){var e,t,s;for(t=new cx(Sx.call(this.raw.data)),e=0,s=this.glyphIDs.length;e<s;++e)t.pos=this.glyphOffsets[e];return t.data},e}(),_x=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return hx(e,dx),e.prototype.tag="loca",e.prototype.parse=function(e){var t,s;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=0===t?function(){var t,r;for(r=[],s=0,t=this.length;s<t;s+=2)r.push(2*e.readUInt16());return r}.call(this):function(){var t,r;for(r=[],s=0,t=this.length;s<t;s+=4)r.push(e.readUInt32());return r}.call(this)},e.prototype.indexOf=function(e){return this.offsets[e]},e.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},e.prototype.encode=function(e,t){for(var s=new Uint32Array(this.offsets.length),r=0,a=0,n=0;n<s.length;++n)if(s[n]=r,a<t.length&&t[a]==n){++a,s[n]=r;var i=this.offsets[n],l=this.offsets[n+1]-i;l>0&&(r+=l)}for(var o=new Array(4*s.length),d=0;d<s.length;++d)o[4*d+3]=255&s[d],o[4*d+2]=(65280&s[d])>>8,o[4*d+1]=(16711680&s[d])>>16,o[4*d]=(4278190080&s[d])>>24;return o},e}(),Ax=function(){function e(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var e,t,s,r,a;for(t in r=this.font.cmap.tables[0].codeMap,e={},a=this.subset)s=a[t],e[t]=r[s];return e},e.prototype.glyphsFor=function(e){var t,s,r,a,n,i,l;for(r={},n=0,i=e.length;n<i;n++)r[a=e[n]]=this.font.glyf.glyphFor(a);for(a in t=[],r)(null!=(s=r[a])?s.compound:void 0)&&t.push.apply(t,s.glyphIDs);if(t.length>0)for(a in l=this.glyphsFor(t))s=l[a],r[a]=s;return r},e.prototype.encode=function(e,t){var s,r,a,n,i,l,o,d,c,u,m,h,x,g,f;for(r in s=fx.encode(this.generateCmap(),"unicode"),n=this.glyphsFor(e),m={0:0},f=s.charMap)m[(l=f[r]).old]=l.new;for(h in u=s.maxGlyphID,n)h in m||(m[h]=u++);return d=function(e){var t,s;for(t in s={},e)s[e[t]]=t;return s}(m),c=Object.keys(d).sort(function(e,t){return e-t}),x=function(){var e,t,s;for(s=[],e=0,t=c.length;e<t;e++)i=c[e],s.push(d[i]);return s}(),a=this.font.glyf.encode(n,x,m),o=this.font.loca.encode(a.offsets,x),g={cmap:this.font.cmap.raw(),glyf:a.table,loca:o,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(g["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g)},e}();Om.API.PDFObject=function(){var e;function t(){}return e=function(e,t){return(Array(t+1).join("0")+e).slice(-t)},t.convert=function(s){var r,a,n,i;if(Array.isArray(s))return"["+function(){var e,a,n;for(n=[],e=0,a=s.length;e<a;e++)r=s[e],n.push(t.convert(r));return n}().join(" ")+"]";if("string"==typeof s)return"/"+s;if(null!=s?s.isString:void 0)return"("+s+")";if(s instanceof Date)return"(D:"+e(s.getUTCFullYear(),4)+e(s.getUTCMonth(),2)+e(s.getUTCDate(),2)+e(s.getUTCHours(),2)+e(s.getUTCMinutes(),2)+e(s.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(s)){for(a in n=["<<"],s)i=s[a],n.push("/"+a+" "+t.convert(i));return n.push(">>"),n.join("\n")}return""+s},t}();class Px{static exportToCSV(e,t,s={}){const{filename:r="export",includeTimestamp:a=!0}=s,n=[t.map(e=>e.label),...e.map(e=>t.map(t=>{const s=e[t.key];return t.format?t.format(s,e):String(s||"")}))].map(e=>e.map(e=>`"${e.replace(/"/g,'""')}"`).join(",")).join("\n");this.downloadFile(n,`${r}${a?`_${this.getTimestamp()}`:""}.csv`,"text/csv")}static async exportToPDF(e,t,s={}){const{filename:r="export",title:a="Data Export",includeTimestamp:n=!0,logoUrl:i="/images/partners/MDRRMO.png"}=s,l=new Om,o=l.internal.pageSize.getWidth(),d=l.internal.pageSize.getHeight(),c=20;let u=45;const m=async()=>{if(l.setFillColor(248,250,252),l.rect(0,0,o,50,"F"),n){l.setFontSize(10),l.setFont("helvetica","normal"),l.setTextColor(75,85,99);const e=new Date,t=e.toLocaleString("default",{month:"long"}),s=e.getDate(),r=e.getFullYear();let a=e.getHours();const n=e.getMinutes().toString().padStart(2,"0"),i=e.getSeconds().toString().padStart(2,"0"),o=a>=12?"PM":"AM";a%=12,a=a||12;const d=`Generated: ${t} ${s}, ${r} at ${a.toString().padStart(2,"0")}:${n}:${i} ${o}`;l.text(d,c,18)}if(i)try{if(i.startsWith("data:image"))l.addImage(i,"PNG",o-c-30,10,30,20);else{const t=new Image;t.crossOrigin="Anonymous";const s=new Promise((e,s)=>{t.onload=()=>{try{const r=document.createElement("canvas"),a=r.getContext("2d");if(!a)return void s(new Error("Canvas context not available"));const n=6,i=30,d=20,u=t.width/t.height;let m=i,h=d;(t.width>i||t.height>d)&&(u>i/d?h=i/u:m=d*u),r.width=Math.max(t.width,m*n),r.height=Math.max(t.height,h*n),a.imageSmoothingEnabled=!0,a.imageSmoothingQuality="high",a.fillStyle="#FFFFFF",a.fillRect(0,0,r.width,r.height);const x=r.width/t.width,g=r.height/t.height,f=Math.min(x,g),p=(r.width-t.width*f)/2,b=(r.height-t.height*f)/2;a.drawImage(t,p,b,t.width*f,t.height*f);const y=r.toDataURL("image/png",1);l.addImage(y,"PNG",o-c-m,10,m,h),e()}catch(r){s(r)}},t.onerror=()=>{s(new Error(`Failed to load image: ${i}`))},t.src=i});try{await s}catch(e){l.setFontSize(12),l.setFont("helvetica","bold"),l.setTextColor(59,130,246),l.text("LOGO",o-c-25,20)}}}catch(t){}l.setFontSize(18),l.setFont("helvetica","bold"),l.setTextColor(17,24,39),l.text(a,o/2,35,{align:"center"}),l.setDrawColor(229,231,235),l.setLineWidth(.5),l.line(c,45,o-c,45)};await m();const h=t.map(e=>e.label),x=e.map(e=>t.map(t=>{const s=e[t.key];return t.format?t.format(s,e):String(s||"")})),g=o-40,f=[];h.forEach((e,t)=>{const s=l.getTextWidth(e)+8,r=x.length>30?x.slice(0,30):x,a=Math.max(...r.map(e=>{const s=String(e[t]||"");if(!s||"undefined"===s||"null"===s)return 0;const r=l.splitTextToSize(s,42);return Array.isArray(r)?Math.max(...r.map(e=>l.getTextWidth(e)))+8:l.getTextWidth(r)+8})),n=Math.max(s,a,20);f.push(Math.min(n,50))});const p=f.reduce((e,t)=>e+t,0);if(p>g){const e=g/p;f.forEach((t,s)=>{f[s]=Math.max(t*e,20)})}const b=(e,t)=>{l.setFillColor(59,130,246),l.rect(c,e-5,f.reduce((e,t)=>e+t,0),10,"F"),l.setLineWidth(.2),l.setDrawColor(37,99,235),l.rect(c,e-5,f.reduce((e,t)=>e+t,0),10);let s=c;for(let a=0;a<f.length;a++)a>0&&(l.setDrawColor(255,255,255),l.line(s,e-5,s,e-5+10)),s+=f[a];l.setTextColor(255,255,255),l.setFont("helvetica",1===t?"bold":"normal"),l.setFontSize(8);let r=c;return h.forEach((t,s)=>{const a=f[s],n=String(t),i=a-4,o=l.splitTextToSize(n,i);Array.isArray(o)?o.forEach((t,s)=>{l.text(t,r+2,e+4*s)}):l.text(n||"",r+2,e),r+=a}),e+8};let y=1;u+=15,u=b(u,y),l.setFont("helvetica","normal"),l.setFontSize(7);for(let j=0;j<x.length;j++){const t=x[j];let s=c,r=8;const a=[];t.forEach((e,s)=>{const n=f[s],i=String(t[s]||""),o=l.splitTextToSize(i,n-6);a.push(Array.isArray(o)?o:[o]);const d=4*(Array.isArray(o)?o.length:1)+4;r=Math.max(r,d)}),u+r>d-c-15&&(l.setFontSize(8),l.setTextColor(107,114,128),l.text(`Page ${y} of ${Math.ceil(e.length/25)}`,o/2,d-10,{align:"center"}),l.addPage(),y++,await m(),u=60,u=b(u,y),l.setFontSize(7)),j%2==1&&(l.setFillColor(249,250,251),l.rect(c,u-3,f.reduce((e,t)=>e+t,0),r,"F")),l.setLineWidth(.1),l.setDrawColor(229,231,235),l.rect(c,u-3,f.reduce((e,t)=>e+t,0),r);let n=c;for(let e=0;e<f.length;e++)e>0&&l.line(n,u-3,n,u-3+r),n+=f[e];l.setTextColor(55,65,81),s=c,a.forEach((e,t)=>{const a=f[t],n=4*e.length,i=u+(r-n)/2+1;e.forEach((e,t)=>{let r=e;if(l.getTextWidth(e)>a-6){const t=l.splitTextToSize(e,a-6);r=Array.isArray(t)?t[0]:t}l.text(r,s+3,i+4*t,{maxWidth:a-6})}),s+=a}),u+=r}u+=15,l.setFillColor(239,246,255),l.rect(c,u,g,15,"F"),l.setDrawColor(59,130,246),l.setLineWidth(.3),l.rect(c,u,g,15),l.setFont("helvetica","bold"),l.setFontSize(12),l.setTextColor(30,64,175),l.text(`Total Records: ${e.length}`,o/2,u+10,{align:"center"}),l.setFontSize(8),l.setTextColor(107,114,128);const v=`Page ${y} • Generated ${(new Date).toLocaleDateString()}`;l.text(v,o/2,d-10,{align:"center"}),l.save(`${r}${n?`_${this.getTimestamp()}`:""}.pdf`)}static exportToJSON(e,t={}){const{filename:s="export",includeTimestamp:r=!0}=t,a=JSON.stringify(e,null,2);this.downloadFile(a,`${s}${r?`_${this.getTimestamp()}`:""}.json`,"application/json")}static exportToExcel(e,t,s={}){const{filename:r="export",title:a="Data Export",includeTimestamp:n=!0}=s,i=t.map(e=>e.label),l=e.map(e=>t.map(t=>{const s=e[t.key];return t.format?t.format(s,e):String(s||"")}));let o="";a&&(o+=`"${a}"\n`,o+=`"Generated on: ${(new Date).toLocaleString()}"\n`,o+=`"Total Records: ${e.length}"\n`,o+="\n");const d=i.map(e=>`"${e.replace(/"/g,'""')}"`).join(",");o+=d+"\n",l.forEach(e=>{const t=e.map(e=>{const t=String(e||"");return!isNaN(Number(t))&&""!==t&&!t.includes("/")&&!t.includes("-")&&t.length<15?t:t.match(/^\d{1,2}\/\d{1,2}\/\d{4}$/)||t.match(/^\d{4}-\d{2}-\d{2}/)?`"${t}"`:`"${t.replace(/"/g,'""')}"`}).join(",");o+=t+"\n"}),o+="\n",o+=`"Summary","Total Records: ${e.length}","Generated: ${(new Date).toLocaleDateString()}"\n`;const c="\ufeff"+o;this.downloadFile(c,`${r}${n?`_${this.getTimestamp()}`:""}.csv`,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")}static downloadFile(e,t,s){const r=new Blob([e],{type:s}),a=URL.createObjectURL(r),n=document.createElement("a");n.href=a,n.download=t,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)}static getTimestamp(){const e=new Date;return e.getFullYear().toString()+(e.getMonth()+1).toString().padStart(2,"0")+e.getDate().toString().padStart(2,"0")+"_"+e.getHours().toString().padStart(2,"0")+e.getMinutes().toString().padStart(2,"0")+e.getSeconds().toString().padStart(2,"0")}static formatDate=e=>{if(!e)return"";return new Date(e).toLocaleDateString()};static formatDateTime=e=>{if(!e)return"";return new Date(e).toLocaleString()};static formatCurrency=e=>null==e?"":new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(e);static formatStatus=e=>{switch(e){case 1:return"Active";case 0:return"Inactive";case-1:return"Suspended";default:return"Unknown"}};static async loadImageAsBase64(e){return new Promise((t,s)=>{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const e=document.createElement("canvas"),a=e.getContext("2d");if(!a)return void s(new Error("Failed to get canvas context"));e.width=Math.max(r.width,6*r.width),e.height=Math.max(r.height,6*r.height),a.imageSmoothingEnabled=!0,a.imageSmoothingQuality="high",a.fillStyle="#FFFFFF",a.fillRect(0,0,e.width,e.height);const n=e.width/r.width,i=e.height/r.height,l=Math.min(n,i),o=(e.width-r.width*l)/2,d=(e.height-r.height*l)/2;a.drawImage(r,o,d,r.width*l,r.height*l);try{const s=e.toDataURL("image/png",1);t(s)}catch(c){s(c)}},r.onerror=()=>{s(new Error(`Failed to load image: ${e}`))},r.src=e})}}const Lx=({open:e,onClose:t,onExportPDF:s,onExportCSV:r,onExportExcel:a,data:n,columns:i,title:l})=>{if(!e)return null;const o=n.slice(0,5);return I.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",onClick:e=>{e.target===e.currentTarget&&t()},children:I.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden animate-in zoom-in-95 duration-200",children:[I.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-white",children:[I.jsxs("div",{children:[I.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:l||"Export Preview"}),I.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Preview of first 5 records • ",n.length," total records"]})]}),I.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all duration-200","aria-label":"Close modal",children:I.jsx("i",{className:"ri-close-line text-xl"})})]}),I.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-200px)]",children:I.jsx("div",{className:"p-6",children:n.length>0?I.jsx("div",{className:"overflow-x-auto",children:I.jsxs("table",{className:"w-full border-collapse bg-white rounded-lg overflow-hidden shadow-sm",children:[I.jsx("thead",{children:I.jsx("tr",{className:"bg-white",children:i.map(e=>I.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider border-b border-gray-200",children:e.label},e.key))})}),I.jsx("tbody",{className:"divide-y divide-gray-200",children:o.map((e,t)=>I.jsx("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:i.map(t=>I.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 whitespace-nowrap",children:e[t.key]||"-"},t.key))},t))})]})}):I.jsxs("div",{className:"text-center py-12",children:[I.jsx("i",{className:"ri-file-list-line text-4xl text-gray-300 mb-4"}),I.jsx("p",{className:"text-gray-500",children:"No data to preview"})]})})}),I.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 bg-white flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[I.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[I.jsx("i",{className:"ri-information-line"}),I.jsxs("span",{children:["Total records to export: ",I.jsx("strong",{className:"text-gray-900",children:n.length})]})]}),I.jsxs("div",{className:"flex flex-wrap gap-2",children:[I.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-all duration-200 font-medium",children:"Cancel"}),I.jsxs("button",{onClick:r,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 font-medium shadow-sm hover:shadow-md flex items-center gap-2",disabled:0===n.length,children:[I.jsx("i",{className:"ri-file-text-line"}),"Export CSV"]}),I.jsxs("button",{onClick:a,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-all duration-200 font-medium shadow-sm hover:shadow-md flex items-center gap-2",disabled:0===n.length,children:[I.jsx("i",{className:"ri-file-excel-line"}),"Export Excel"]}),I.jsxs("button",{onClick:s,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-all duration-200 font-medium shadow-sm hover:shadow-md flex items-center gap-2",disabled:0===n.length,children:[I.jsx("i",{className:"ri-file-pdf-line"}),"Export PDF"]})]})]})]})})},Ex=()=>{const[e,t]=n.useState({totalIncidents:0,activeIncidents:0,totalUsers:0,totalStaff:0,totalAlerts:0,activeAlerts:0}),[s,r]=n.useState([]),[a,i]=n.useState(null),[l,o]=n.useState(null),[d,c]=n.useState([]),[u,m]=n.useState([]),[h,x]=n.useState([]),[g,f]=n.useState([]),[p,b]=n.useState("days"),[y,v]=n.useState(7),[j,N]=n.useState([]),[w,S]=n.useState(""),[k,C]=n.useState([]),[$,_]=n.useState(!0),[A,P]=n.useState(!1),[L,E]=n.useState(null),[T,O]=n.useState(!1),[F,R]=n.useState([]),[D,M]=n.useState([]),[B,U]=n.useState(""),{showToast:q}=$t();n.useEffect(()=>{(async()=>{await V(),await W(p,y)})()},[]),n.useEffect(()=>{"days"===p&&y>30?v(7):("weeks"===p&&y>52||"months"===p&&y>24)&&v(12)},[p]),n.useEffect(()=>{P(!0),W(p,y)},[p,y]);const z=e=>{const t=["12 AM","1 AM","2 AM","3 AM","4 AM","5 AM","6 AM","7 AM","8 AM","9 AM","10 AM","11 AM","12 PM","1 PM","2 PM","3 PM","4 PM","5 PM","6 PM","7 PM","8 PM","9 PM","10 PM","11 PM"];return e.map(e=>{const s=(e.sample_datetimes?e.sample_datetimes.split(","):[])[0]||e.latest_datetime,r=(e=>{const t={};return e.forEach(e=>{if(!e)return;const s=new Date(e),r=s.toLocaleDateString("en-US",{month:"short"}),a=s.getDate();t[r]||(t[r]=[]),t[r].push(a)}),Object.keys(t).forEach(e=>{t[e].sort((e,t)=>e-t)}),Object.keys(t).sort((e,t)=>{const s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return s.indexOf(e)-s.indexOf(t)}).map(e=>`${e} ${t[e].join(", ")}`).join(", ")})(e.consecutive_dates?e.consecutive_dates.split(","):[]),a=e=>{if(!e)return null;const t=new Date(e);return{date:t.toLocaleDateString("en-US",{month:"long",day:"numeric"}),time:t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),full:t.toLocaleDateString("en-US",{month:"long",day:"numeric"})+" "+t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}},n=a(s),i=a(e.earliest_datetime),l=a(e.latest_datetime),o=r||n?.date||"";return{name:t[e.hour]||`${e.hour}:00`,count:e.incident_count,percentage:0,timeLabel:`${t[e.hour]||`${e.hour}:00`} (${n?.full||""})`,hour:e.hour,formattedTime:t[e.hour]||`${e.hour}:00`,displayName:t[e.hour]||`${e.hour}:00`,sampleDate:n?.date||"",sampleTime:n?.time||"",sampleDateTime:n?.full||"",dateRange:o,timeRange:i?.time&&l?.time?`${i.time} - ${l.time}`:"",consecutiveDates:r.split(", "),earliestDateTime:e.earliest_datetime,latestDateTime:e.latest_datetime}})},W=async(e="months",t=12)=>{try{P(!0);const s=await ne(e,t);if(s.success&&s.trendsData){const e=s.trendsData.map(e=>({month:e.period,period:e.period,total_incidents:e.total_incidents||0,resolved_incidents:e.resolved_incidents||0,high_priority_incidents:e.high_priority_incidents||0}));f(e)}else f([])}catch(s){f([])}finally{P(!1)}},V=async()=>{try{_(!0),E(null);const[s,a,n]=await Promise.all([ee(),te(),se()]);await W(p,y);let l=null;try{l=await re()}catch(e){l={success:!0,locationIncidents:[]}}let d=null;try{d=await ae()}catch(e){d={success:!0,seasonalData:[]}}if(s.success)if(t({totalIncidents:s.stats.incidents.total_incidents,activeIncidents:s.stats.incidents.active_incidents,totalUsers:s.stats.users.total_users,totalStaff:s.stats.staff.total_staff,totalAlerts:s.stats.alerts.total_alerts,activeAlerts:s.stats.alerts.active_alerts}),r(s.recentActivity||[]),s.trends){const e=s.trends.incidents,t=s.trends.users;if(e&&e.length>=2){const t=e[e.length-1].count,s=e[e.length-2].count,r=0===s?0:(t-s)/s*100;i(`${r>=0?"+":""}${r.toFixed(1)}% from last period`)}else i(null);if(t&&t.length>=2){const e=t[t.length-1].count,s=t[t.length-2].count,r=0===s?0:(e-s)/s*100;o(`${r>=0?"+":""}${r.toFixed(1)}% from last period`)}else o(null)}else i(null),o(null);else E("Failed to fetch dashboard statistics");if(a.success&&c(a.overview.incidentTypes||[]),n.success){m(n.analytics.incidentPriority||[]),f(n.analytics.monthlyIncidents||[]);const e=(n.analytics.peakHours||[]).map(e=>({hour:e.hour,incident_count:e.incident_count,earliest_datetime:e.earliest_datetime||"",latest_datetime:e.latest_datetime||"",sample_datetimes:e.sample_datetimes||"",consecutive_dates:e.consecutive_dates||""}));N(e),S((()=>{const e=new Date,t=new Date;t.setDate(t.getDate()-30);const s=e=>e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return`${s(t)} - ${s(e)}`})())}l&&l.success?x(l.locationIncidents||[]):x([]),d&&d.success?C(d.seasonalData||[]):C([])}catch(e){E(e instanceof Error?e.message:"Failed to fetch dashboard statistics")}finally{_(!1)}},H=({title:e,value:t,icon:s,color:r,trend:a})=>I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:e}),I.jsx("p",{className:"text-3xl font-bold text-gray-900",children:t?.toLocaleString()||"0"}),a&&I.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[I.jsx("i",{className:"ri-arrow-up-line mr-1"}),a]})]}),I.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${r}`,children:I.jsx("i",{className:`${s} text-xl text-white`})})]})});return $?I.jsx("div",{className:"flex items-center justify-center h-64",children:I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):L?I.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-error-warning-line text-red-500 text-xl mr-3"}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-red-800 font-medium",children:"Error Loading Dashboard"}),I.jsx("p",{className:"text-red-600 text-sm mt-1",children:L}),I.jsx("button",{onClick:V,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm",children:"Try Again"})]})]})}):I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard Analytics"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Overview of emergency management system"})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsxs("div",{className:"relative group",children:[I.jsxs("button",{className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center",children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export Data",I.jsx("i",{className:"ri-arrow-down-s-line ml-1"})]}),I.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50",children:I.jsxs("div",{className:"py-2",children:[I.jsxs("button",{onClick:()=>{const t=[];t.push({section:"Dashboard Statistics",metric:"Total Incidents",value:e.totalIncidents,details:"Overall incident count"}),t.push({section:"Dashboard Statistics",metric:"Active Incidents",value:e.activeIncidents,details:"Currently active incidents"}),t.push({section:"Dashboard Statistics",metric:"Total Users",value:e.totalUsers,details:"Registered users count"}),t.push({section:"Dashboard Statistics",metric:"Staff Members",value:e.totalStaff,details:"Staff members count"}),t.push({section:"Dashboard Statistics",metric:"Total Alerts",value:e.totalAlerts,details:"Total alerts count"}),t.push({section:"Dashboard Statistics",metric:"Active Alerts",value:e.activeAlerts,details:"Currently active alerts"}),d.forEach(e=>{t.push({section:"Incident Types",metric:e.incident_type,value:e.count,details:"Incident type distribution"})}),u.forEach(e=>{t.push({section:"Priority Distribution",metric:e.priority,value:e.count,details:"Priority level distribution"})}),g.forEach(e=>{t.push({section:"Trends Data",metric:e.period||e.month||"Unknown Period",value:e.total_incidents,details:`Total incidents in ${e.period||e.month||"Unknown Period"}`})});z(j).forEach(e=>{t.push({section:"Peak Hours Analysis",metric:e.name,value:e.count,details:`Peak hour: ${e.dateRange||"N/A"}`})}),h.forEach(e=>{Object.keys(e).forEach(s=>{"name"!==s&&t.push({section:"Location Data",metric:`${e.name} - ${s}`,value:e[s],details:"Barangay-based incident data"})})}),k.forEach(e=>{t.push({section:"Seasonal Patterns",metric:e.period,value:e.total,details:`Total incidents in ${e.period}`})}),s.forEach(e=>{t.push({section:"Recent Activity",metric:e.action,value:1,details:`${e.details} - ${e.user_type}`})});R(t),M([{key:"section",label:"Data Section"},{key:"metric",label:"Metric/Type"},{key:"value",label:"Value"},{key:"details",label:"Details"}]),U("Complete Dashboard Data Export"),O(!0)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center border-b border-gray-200 mb-1",children:[I.jsx("i",{className:"ri-download-cloud-line mr-3 text-green-600"}),I.jsx("span",{className:"font-semibold",children:"Export All Data"})]}),I.jsx("div",{className:"px-2 py-1 text-xs text-gray-500 mb-2",children:"Individual Exports:"}),I.jsxs("button",{onClick:()=>{const t=[{metric:"Total Incidents",value:e.totalIncidents},{metric:"Active Incidents",value:e.activeIncidents},{metric:"Total Users",value:e.totalUsers},{metric:"Staff Members",value:e.totalStaff},{metric:"Total Alerts",value:e.totalAlerts},{metric:"Active Alerts",value:e.activeAlerts}];R(t),M([{key:"metric",label:"Metric"},{key:"value",label:"Value"}]),U("Dashboard Statistics"),O(!0)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[I.jsx("i",{className:"ri-bar-chart-line mr-3 text-blue-500"}),"Dashboard Statistics"]}),I.jsxs("button",{onClick:()=>{R(d),M([{key:"incident_type",label:"Incident Type"},{key:"count",label:"Count"}]),U("Incident Types Distribution"),O(!0)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[I.jsx("i",{className:"ri-pie-chart-line mr-3 text-red-500"}),"Incident Types"]}),I.jsxs("button",{onClick:()=>{R(u),M([{key:"priority",label:"Priority Level"},{key:"count",label:"Count"}]),U("Priority Level Distribution"),O(!0)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[I.jsx("i",{className:"ri-pie-chart-2-line mr-3 text-orange-500"}),"Priority Distribution"]}),I.jsxs("button",{onClick:()=>{R(g),M([{key:"period",label:"Period"},{key:"total_incidents",label:"Total Incidents"},{key:"resolved_incidents",label:"Resolved Incidents"},{key:"high_priority_incidents",label:"High Priority Incidents"}]),U(`Incident Trends (Last ${y} ${p})`),O(!0)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[I.jsx("i",{className:"ri-line-chart-line mr-3 text-green-500"}),"Trends Data"]}),I.jsxs("button",{onClick:()=>{const e=z(j);R(e),M([{key:"name",label:"Hour"},{key:"count",label:"Incident Count"},{key:"dateRange",label:"Date Range"},{key:"sampleDateTime",label:"Sample DateTime"}]),U(`Peak Hours Analysis (${w})`),O(!0)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[I.jsx("i",{className:"ri-time-line mr-3 text-yellow-500"}),"Peak Hours Analysis"]}),I.jsxs("button",{onClick:()=>{if(0===h.length)return void q({message:"No location data available to export",type:"warning"});const e=[{key:"name",label:"Barangay"},...Object.keys(h[0]||{}).filter(e=>"name"!==e).map(e=>({key:e,label:e.charAt(0).toUpperCase()+e.slice(1)}))];R(h),M(e),U("Barangay-based Risk Analysis"),O(!0)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[I.jsx("i",{className:"ri-map-pin-line mr-3 text-purple-500"}),"Location Data"]}),I.jsxs("button",{onClick:()=>{if(0===k.length)return void q({message:"No seasonal data available to export",type:"warning"});R(k),M([{key:"period",label:"Period"},{key:"floods",label:"Floods"},{key:"fires",label:"Fires"},{key:"accidents",label:"Accidents"},{key:"otherIncidents",label:"Other Incidents"},{key:"allIncidents",label:"All Incidents"},{key:"total",label:"Total"}]),U("Seasonal Incident Patterns"),O(!0)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[I.jsx("i",{className:"ri-calendar-line mr-3 text-indigo-500"}),"Seasonal Patterns"]}),I.jsxs("button",{onClick:()=>{if(0===s.length)return void q({message:"No recent activity available to export",type:"warning"});R(s),M([{key:"action",label:"Action"},{key:"details",label:"Details"},{key:"user_type",label:"User Type"},{key:"created_at",label:"Date"}]),U("Recent Activity"),O(!0)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[I.jsx("i",{className:"ri-history-line mr-3 text-gray-500"}),"Recent Activity"]})]})})]}),I.jsxs("button",{onClick:V,disabled:$,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[I.jsx("i",{className:"ri-refresh-line mr-2 "+($?"animate-spin":"")}),"Refresh Data"]})]})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[I.jsx(H,{title:"Total Incidents",value:e.totalIncidents,icon:"ri-error-warning-line",color:"bg-red-500",trend:a||void 0}),I.jsx(H,{title:"Active Incidents",value:e.activeIncidents,icon:"ri-alarm-warning-line",color:"bg-orange-500"}),I.jsx(H,{title:"Total Users",value:e.totalUsers,icon:"ri-user-line",color:"bg-blue-500",trend:l||void 0}),I.jsx(H,{title:"Staff Members",value:e.totalStaff,icon:"ri-team-line",color:"bg-green-500"}),I.jsx(H,{title:"Total Alerts",value:e.totalAlerts,icon:"ri-notification-line",color:"bg-purple-500"}),I.jsx(H,{title:"Active Alerts",value:e.activeAlerts,icon:"ri-alarm-warning-line",color:"bg-indigo-500"})]}),I.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[I.jsx(Ho,{data:d.map(e=>({name:e.incident_type,count:e.count})),title:"Most Common Incident Types",dataKey:"count",color:"#ef4444",height:300}),I.jsx(Jo,{data:u.map(e=>({name:e.priority,count:e.count})),title:"Priority Level Distribution",dataKey:"count",nameKey:"name",height:300,colors:{low:"#10B981",moderate:"#FFD966",high:"#E67E22",critical:"#EF4444"}})]}),I.jsx("div",{className:"grid grid-cols-1 gap-6",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Incident Trends Analysis"}),I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Period:"}),I.jsxs("select",{value:p,onChange:e=>b(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[I.jsx("option",{value:"days",children:"Days"}),I.jsx("option",{value:"weeks",children:"Weeks"}),I.jsx("option",{value:"months",children:"Months"})]})]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Last:"}),I.jsxs("select",{value:y,onChange:e=>v(parseInt(e.target.value)),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:["days"===p&&I.jsxs(I.Fragment,{children:[I.jsx("option",{value:7,children:"7 days"}),I.jsx("option",{value:14,children:"14 days"}),I.jsx("option",{value:30,children:"30 days"})]}),"weeks"===p&&I.jsxs(I.Fragment,{children:[I.jsx("option",{value:4,children:"4 weeks"}),I.jsx("option",{value:8,children:"8 weeks"}),I.jsx("option",{value:12,children:"12 weeks"}),I.jsx("option",{value:24,children:"24 weeks"})]}),"months"===p&&I.jsxs(I.Fragment,{children:[I.jsx("option",{value:6,children:"6 months"}),I.jsx("option",{value:12,children:"12 months"}),I.jsx("option",{value:18,children:"18 months"}),I.jsx("option",{value:24,children:"24 months"})]})]})]}),I.jsxs("button",{onClick:()=>W(p,y),disabled:A,className:"px-3 py-1 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[I.jsx("i",{className:"ri-refresh-line mr-1 "+(A?"animate-spin":"")}),A?"Loading...":"Refresh"]})]})]}),A||0===g.length&&!A?I.jsx("div",{className:"flex items-center justify-center h-[350px] bg-gray-50 rounded-lg",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),I.jsx("p",{className:"text-gray-500",children:A?"Loading trends data...":"Loading chart data..."}),I.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Period: ",p," | Limit: ",y]})]})}):g.length>0?I.jsx(Xo,{data:g.map(e=>({date:e.period||e.month||"Unknown",count:e.total_incidents||0})),title:`Incident Trends (Last ${y} ${p})`,color:"#10b981",height:350}):I.jsx("div",{className:"flex items-center justify-center h-[350px] bg-gray-50 rounded-lg",children:I.jsxs("div",{className:"text-center",children:[I.jsx("i",{className:"ri-bar-chart-line text-4xl text-gray-400 mb-2"}),I.jsx("p",{className:"text-gray-500",children:"No data available for the selected period"}),I.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Try adjusting the time range or check back later"})]})})]})}),I.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[I.jsx(Ho,{data:z(j),title:`Peak Hours Analysis - Incident Distribution by Time (${w||"Last 30 Days"})`,dataKey:"count",color:"#f59e0b",height:350}),0===j.length&&I.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-information-line text-amber-500 text-lg mr-3"}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-amber-800 font-medium",children:"Peak Hours Analysis"}),I.jsxs("p",{className:"text-amber-600 text-sm mt-1",children:["This bar chart shows incident distribution by hour of day over the period ",w||"last 30 days",'. Hover over bars to see consecutive incident dates and exact times in 12-hour format (e.g., "September 30 8:30 PM"). It helps identify peak hours when incidents are most likely to occur, enabling better resource allocation.']})]})]})})]}),I.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[(()=>{const e=[];return h.forEach(t=>{Object.keys(t).forEach(t=>{"name"===t||e.includes(t)||e.push(t)})}),I.jsx(Zo,{data:h.length>0?h:[],title:"Risky Areas by Barangay",stackKeys:e,height:400})})(),0===h.length&&I.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-information-line text-blue-500 text-lg mr-3"}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-blue-800 font-medium",children:"Barangay-based Risk Analysis"}),I.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"This chart shows incident distribution by barangay. Barangay names are extracted from incident descriptions. If no data appears, ensure incidents have barangay information in their descriptions or check the backend server."})]})]})})]}),I.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[I.jsx(Ho,{data:k.map(e=>({name:e.period,floods:e.floods||0,fires:e.fires||0,accidents:e.accidents||0,otherIncidents:e.otherIncidents||0,allIncidents:e.allIncidents||0})),title:"Seasonal Incident Patterns",stacked:!0,stackKeys:["floods","fires","accidents","otherIncidents","allIncidents"],height:400}),0===k.length&&I.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-information-line text-purple-500 text-lg mr-3"}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-purple-800 font-medium",children:"Seasonal Patterns Analysis"}),I.jsx("p",{className:"text-purple-600 text-sm mt-1",children:"This clustered column chart compares incident patterns across different seasons: floods during rainy season (June-November), fires during summer (March-May), and accidents during holiday periods. Data covers the last 2 years."})]})]})})]}),I.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Incidents"}),I.jsx("a",{href:"/admin/incidents/view",className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"View All"})]}),I.jsx("div",{className:"space-y-3",children:s.length>0?s.slice(0,5).map((e,t)=>I.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-3 h-3 rounded-full mr-3 "+(e.action.includes("incident")?"bg-red-500":e.action.includes("alert")?"bg-orange-500":"bg-blue-500")}),I.jsxs("div",{children:[I.jsx("p",{className:"font-medium text-gray-900 capitalize",children:e.action.replace("_"," ")}),I.jsx("p",{className:"text-sm text-gray-600",children:e.details})]})]}),I.jsx("span",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]},t)):I.jsxs("div",{className:"text-center py-8 text-gray-500",children:[I.jsx("i",{className:"ri-inbox-line text-3xl mb-2"}),I.jsx("p",{children:"No recent activity"})]})})]})}),I.jsx(Lx,{open:T,onClose:()=>O(!1),data:F,columns:D,title:B,onExportCSV:()=>{try{Px.exportToCSV(F,D,{filename:B.toLowerCase().replace(/\s+/g,"_"),title:B}),q({message:"Data exported to CSV successfully!",type:"success"}),O(!1)}catch(e){q({message:"Failed to export data. Please try again.",type:"error"})}},onExportExcel:()=>{try{Px.exportToExcel(F,D,{filename:B.toLowerCase().replace(/\s+/g,"_"),title:B}),q({message:"Data exported to Excel successfully!",type:"success"}),O(!1)}catch(e){q({message:"Failed to export data. Please try again.",type:"error"})}},onExportPDF:async()=>{try{await Px.exportToPDF(F,D,{filename:B.toLowerCase().replace(/\s+/g,"_"),title:B}),q({message:"Data exported to PDF successfully!",type:"success"}),O(!1)}catch(e){q({message:"Failed to export data. Please try again.",type:"error"})}}})]})};delete Fl.Icon.Default.prototype._getIconUrl,Fl.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const Tx=Fl.divIcon({html:'\n    <div style="\n      background-color: #ef4444;\n      width: 20px;\n      height: 20px;\n      border-radius: 50%;\n      border: 3px solid white;\n      box-shadow: 0 2px 8px rgba(0,0,0,0.3);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    ">\n      <i class="ri-alert-line" style="color: white; font-size: 10px;"></i>\n    </div>\n  ',className:"alert-location-marker",iconSize:[20,20],iconAnchor:[10,10]}),Ix=[{name:"Alupay",lat:13.8404,lng:121.2922},{name:"Antipolo",lat:13.708,lng:121.3096},{name:"Bagong Pook",lat:13.8402,lng:121.2216},{name:"Balibago",lat:13.8512,lng:121.2855},{name:"Barangay A",lat:13.8457,lng:121.2104},{name:"Barangay B",lat:13.8461,lng:121.2065},{name:"Barangay C",lat:13.8467,lng:121.2032},{name:"Barangay D",lat:13.844,lng:121.2035},{name:"Barangay E",lat:13.8415,lng:121.2047},{name:"Bayawang",lat:13.7944,lng:121.2798},{name:"Baybayin",lat:13.8277,lng:121.2589},{name:"Bulihan",lat:13.7967,lng:121.2351},{name:"Cahigam",lat:13.8021,lng:121.2501},{name:"Calantas",lat:13.734,lng:121.3129},{name:"Colongan",lat:13.8114,lng:121.1762},{name:"Itlugan",lat:13.819,lng:121.2036},{name:"Leviste",lat:13.7694,lng:121.2868},{name:"Lumbangan",lat:13.8122,lng:121.2649},{name:"Maalas-as",lat:13.8112,lng:121.2122},{name:"Mabato",lat:13.8144,lng:121.2913},{name:"Mabunga",lat:13.781,lng:121.2924},{name:"Macalamcam A",lat:13.8551,lng:121.3046},{name:"Macalamcam B",lat:13.8606,lng:121.3265},{name:"Malaya",lat:13.8535,lng:121.172},{name:"Maligaya",lat:13.8182,lng:121.2742},{name:"Marilag",lat:13.8562,lng:121.1764},{name:"Masaya",lat:13.8383,lng:121.1852},{name:"Matamis",lat:13.7216,lng:121.3305},{name:"Mavalor",lat:13.8177,lng:121.2315},{name:"Mayuro",lat:13.7944,lng:121.2623},{name:"Namuco",lat:13.8382,lng:121.2036},{name:"Namunga",lat:13.8431,lng:121.1978},{name:"Nasi",lat:13.7699,lng:121.3127},{name:"Natu",lat:13.842,lng:121.2683},{name:"Palakpak",lat:13.7079,lng:121.332},{name:"Pinagsibaan",lat:13.8438,lng:121.3141},{name:"Putingkahoy",lat:13.8349,lng:121.3227},{name:"Quilib",lat:13.8603,lng:121.2002},{name:"Salao",lat:13.8578,lng:121.3455},{name:"San Carlos",lat:13.8478,lng:121.2475},{name:"San Ignacio",lat:13.8335,lng:121.1764},{name:"San Isidro",lat:13.8074,lng:121.3152},{name:"San Jose",lat:13.8419,lng:121.2329},{name:"San Roque",lat:13.8518,lng:121.2039},{name:"Santa Cruz",lat:13.8599,lng:121.1853},{name:"Timbugan",lat:13.8095,lng:121.1869},{name:"Tiquiwan",lat:13.8284,lng:121.2399},{name:"Tulos",lat:13.7231,lng:121.2971}],Ox=()=>{const[e,t]=n.useState([]),[s,r]=n.useState(!0),[a,i]=n.useState(!1),[l,o]=n.useState({title:"",message:"",type:"info",priority:"medium",status:"draft",recipients:[],latitude:null,longitude:null,radius_km:5,location_text:""}),[d,c]=n.useState(!1),[u,m]=n.useState(null),[h,x]=n.useState(""),[g,f]=n.useState(!1),[p,b]=n.useState(""),[y,v]=n.useState(!1),[j,N]=n.useState(!1),[w]=n.useState([13.84542,121.206189]),[S]=n.useState(13),{showToast:k}=$t(),C=[{key:"id",label:"ID"},{key:"title",label:"Title"},{key:"message",label:"Message"},{key:"type",label:"Type"},{key:"priority",label:"Priority"},{key:"status",label:"Status"},{key:"created_at",label:"Created Date",format:e=>Px.formatDateTime(e)},{key:"radius_km",label:"Radius (km)",format:e=>e?`${e} km`:"N/A"}],$=t=>{if(e.length)try{const s={filename:"alerts_export",title:"Alerts Management Report",includeTimestamp:!0};switch(t){case"csv":Px.exportToCSV(e,C,s);break;case"pdf":Px.exportToPDF(e,C,s);break;case"json":Px.exportToJSON(e,s);break;case"excel":Px.exportToExcel(e,C,s)}k({type:"success",message:`Data exported to ${t.toUpperCase()} successfully`})}catch(s){k({type:"error",message:"Export failed"})}else k({type:"warning",message:"No data to export"})};n.useEffect(()=>{P()},[]);const _=()=>(Wl({click:e=>{const{lat:t,lng:s}=e.latlng;o(e=>({...e,latitude:t,longitude:s,location_text:`${t.toFixed(6)}, ${s.toFixed(6)}`}))}}),null),A=()=>(Wl({click:e=>{const{lat:t,lng:s}=e.latlng,r=Number(t),a=Number(s);m(e=>e?{...e,latitude:r,longitude:a,location_text:`${r.toFixed(6)}, ${a.toFixed(6)}`}:null)}}),null),P=async()=>{try{r(!0);const e=await ge();if(e.success){const s=e.alerts.map(e=>({...e,title:e.title||"Untitled Alert",message:e.message||e.description||"No description",type:e.type||e.alert_severity||"info",status:e.status||"active",recipients:"string"==typeof e.recipients?JSON.parse(e.recipients):e.recipients||[],priority:e.priority||"medium"}));t(s)}}catch(e){}finally{r(!1)}},[L,E]=n.useState(!1),[T,O]=n.useState(null),F=e=>{switch(e){case"emergency":return"bg-red-100 text-red-800 border-red-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"info":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},R=e=>{switch(e){case"sent":return"bg-green-100 text-green-800";case"active":return"bg-blue-100 text-blue-800";case"resolved":default:return"bg-gray-100 text-gray-800";case"draft":return"bg-yellow-100 text-yellow-800"}},D=Ix.filter(e=>e.name.toLowerCase().includes(h.toLowerCase())),M=e=>{const t=l?.recipients||[];t.includes(e)?o(s=>({...s,recipients:t.filter(t=>t!==e)})):o(s=>({...s,recipients:Array.from(new Set([...t,e]))}))},B=(l?.recipients||[]).filter(e=>Ix.some(t=>t.name===e)).length,U=Ix.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())),q=e=>{const t=u?.recipients||[];t.includes(e)?m(s=>s?{...s,recipients:t.filter(t=>t!==e)}:null):m(s=>s?{...s,recipients:Array.from(new Set([...t,e]))}:null)},z=(u?.recipients||[]).filter(e=>Ix.some(t=>t.name===e)).length;return s?I.jsx("div",{className:"flex items-center justify-center h-64",children:I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Alerts Management"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Send emergency alerts and notifications via email"})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsxs("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[I.jsx("i",{className:"ri-add-line mr-2"}),"Create Alert"]}),I.jsxs("button",{onClick:()=>N(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center",title:"Export alerts data",disabled:!e.length,children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export"]})]})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-alarm-warning-line text-red-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Emergency Alerts"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(e=>"emergency"===e.type).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-error-warning-line text-yellow-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Warnings"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(e=>"warning"===e.type).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-mail-send-line text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Sent Today"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(e=>e.sent_at&&new Date(e.sent_at).toDateString()===(new Date).toDateString()).length})]})]})})]}),I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[I.jsx("div",{className:"p-6 border-b border-gray-200",children:I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Alerts"})}),I.jsx("div",{className:"divide-y divide-gray-200",children:e.map(e=>I.jsx("div",{className:"p-6 hover:bg-gray-50",children:I.jsxs("div",{className:"flex items-start justify-between",children:[I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[I.jsx("h4",{className:"text-lg font-medium text-gray-900",children:e.title}),I.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${F(e.type)}`,children:(e.type||"info").toUpperCase()}),I.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${R(e.status)}`,children:(e.status||"active").toUpperCase()})]}),I.jsx("p",{className:"text-gray-600 mb-3",children:e.message}),I.jsxs("div",{className:"flex items-center text-sm text-gray-500 space-x-4",children:[I.jsxs("span",{children:[I.jsx("i",{className:"ri-time-line mr-1"}),"Created: ",new Date(e.created_at).toLocaleString()]}),e.sent_at&&I.jsxs("span",{children:[I.jsx("i",{className:"ri-mail-send-line mr-1"}),"Sent: ",new Date(e.sent_at).toLocaleString()]}),I.jsxs("span",{children:[I.jsx("i",{className:"ri-flag-line mr-1"}),"Priority: ",e.priority||"medium"]})]})]}),I.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:["sent"!==e.status&&I.jsxs("button",{onClick:()=>(async e=>{try{(await be(e)).success?(await P(),k({type:"success",message:"Alert sent successfully"})):k({type:"error",message:"Failed to send alert"})}catch(t){k({type:"error",message:"Error sending alert"})}})(e.id),className:"px-3 py-1 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors",children:[I.jsx("i",{className:"ri-mail-send-line mr-1"}),"Send"]}),I.jsxs("button",{onClick:()=>{e&&(m({id:e.id,title:e.title,message:e.message,type:e.type,priority:e.priority,status:e.status,recipients:e.recipients,latitude:e.latitude,longitude:e.longitude,radius_km:e.radius_km,location_text:e.location_text||""}),c(!0))},className:"px-3 py-1 bg-gray-100 text-gray-700 text-sm rounded-lg hover:bg-gray-200 transition-colors",children:[I.jsx("i",{className:"ri-edit-line mr-1"}),"Edit"]}),I.jsx("button",{onClick:()=>{return t=e.id,O(t),void E(!0);var t},className:"px-3 py-1 bg-red-100 text-red-700 text-sm rounded-lg hover:bg-red-200 transition-colors",children:I.jsx("i",{className:"ri-delete-bin-line mr-1"})})]})]})},e.id))})]}),a&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-y-auto",children:[I.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-alarm-warning-line text-blue-600 text-lg"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Create New Alert"}),I.jsx("p",{className:"text-sm text-gray-600",children:"Send emergency notifications to targeted recipients"})]})]}),I.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-gray-600 hover:bg-gray-100 p-2 rounded-lg transition-colors",children:I.jsx("i",{className:"ri-close-line text-xl"})})]})}),I.jsxs("div",{className:"p-6",children:[I.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-text mr-1"}),"Alert Title *"]}),I.jsx("input",{type:"text",value:l.title,onChange:e=>o(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter alert title",required:!0})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-alert-line mr-1"}),"Alert Type *"]}),I.jsxs("select",{value:l.type,onChange:e=>o(t=>({...t,type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"info",children:"Information"}),I.jsx("option",{value:"warning",children:"Warning"}),I.jsx("option",{value:"emergency",children:"Emergency"})]})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-error-warning-line mr-1"}),"Alert Severity"]}),I.jsxs("select",{value:l.type,onChange:e=>o(t=>({...t,type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"info",children:"Low - Information"}),I.jsx("option",{value:"warning",children:"Medium - Warning"}),I.jsx("option",{value:"emergency",children:"High - Emergency"})]})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-file-text-line mr-1"}),"Description *"]}),I.jsx("textarea",{value:l.message,onChange:e=>o(t=>({...t,message:e.target.value})),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter detailed alert description",required:!0})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-map-pin-line mr-1"}),"Location"]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("input",{type:"text",value:l.location_text,onChange:e=>o(t=>({...t,location_text:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter location or click on map"}),I.jsx("div",{className:"text-xs text-gray-500",children:"Click on the map to select a location, or enter coordinates manually"})]})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-focus-3-line mr-1"}),"Alert Radius (km)"]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("input",{type:"number",min:"0.1",max:"50",step:"0.1",value:l.radius_km,onChange:e=>o(t=>({...t,radius_km:parseFloat(e.target.value)||5})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"5.0"}),I.jsx("span",{className:"text-sm text-gray-500",children:"kilometers"})]}),I.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Radius for geographic alert coverage (0.1 - 50 km)"})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-flag-line mr-1"}),"Priority"]}),I.jsxs("select",{value:l.priority||"medium",onChange:e=>o(t=>({...t,priority:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"low",children:"Low"}),I.jsx("option",{value:"medium",children:"Medium"}),I.jsx("option",{value:"high",children:"High"}),I.jsx("option",{value:"critical",children:"Critical"})]})]})]}),I.jsx("div",{className:"space-y-4",children:I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-map-2-line mr-1"}),"Location Selection"]}),I.jsx("div",{className:"text-xs text-gray-500 mb-3",children:"Click on the map below to select the alert location"}),I.jsx("div",{className:"w-full h-96 rounded-lg overflow-hidden border border-gray-300 shadow-sm",children:I.jsxs(Jl,{center:l?.latitude&&l?.longitude?[l.latitude,l.longitude]:w,zoom:S,style:{height:"100%",width:"100%"},className:"z-0",children:[I.jsx(Ql,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),I.jsx(_,{}),l?.latitude&&l?.longitude&&I.jsxs(I.Fragment,{children:[I.jsx(Kl,{position:[l.latitude,l.longitude],icon:Tx}),I.jsx(Vl,{center:[l.latitude,l.longitude],radius:1e3*(l.radius_km||5),pathOptions:{color:"#ef4444",fillColor:"#ef4444",fillOpacity:.1,weight:2,dashArray:"5, 5"}})]})]})}),l?.latitude&&l?.longitude&&I.jsxs("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:[I.jsx("div",{className:"text-sm text-blue-800",children:I.jsx("strong",{children:"Selected Location:"})}),I.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:["Latitude: ",l.latitude.toFixed(6),I.jsx("br",{}),"Longitude: ",l.longitude.toFixed(6),I.jsx("br",{}),"Radius: ",l.radius_km||5," km"]})]})]})})]}),I.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200 bg-gray-50 -mx-6 px-6 -mb-6 rounded-b-xl",children:[I.jsxs("div",{className:"mb-4",children:[I.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:[I.jsx("i",{className:"ri-group-line mr-2 text-blue-600"}),"Target Recipients"]}),I.jsx("p",{className:"text-sm text-gray-600",children:"Select the groups who should receive this alert"})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[I.jsxs("label",{className:"flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[I.jsx("input",{type:"checkbox",checked:(l?.recipients||[]).includes("all_users"),onChange:e=>{const t=l?.recipients||[];e.target.checked?o(e=>({...e,recipients:Array.from(new Set([...t,"all_users"]))})):o(e=>({...e,recipients:t.filter(e=>"all_users"!==e)}))},className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),I.jsxs("div",{children:[I.jsx("div",{className:"font-medium text-gray-900",children:"All Registered Users"}),I.jsx("div",{className:"text-sm text-gray-500",children:"Send to all users in the system"})]})]}),I.jsxs("label",{className:"flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[I.jsx("input",{type:"checkbox",checked:(l?.recipients||[]).includes("emergency_responders"),onChange:e=>{const t=l?.recipients||[];e.target.checked?o(e=>({...e,recipients:Array.from(new Set([...t,"emergency_responders"]))})):o(e=>({...e,recipients:t.filter(e=>"emergency_responders"!==e)}))},className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),I.jsxs("div",{children:[I.jsx("div",{className:"font-medium text-gray-900",children:"Emergency Responders"}),I.jsx("div",{className:"text-sm text-gray-500",children:"Send to emergency response teams"})]})]})]}),I.jsxs("div",{className:"mb-4",children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-map-pin-line mr-1"}),"Select Barangays"]}),I.jsxs("div",{className:"relative",children:[I.jsxs("button",{type:"button",onClick:()=>f(!g),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-left focus:ring-2 focus:ring-blue-500 focus:border-blue-500 flex items-center justify-between",children:[I.jsx("span",{className:"text-gray-700",children:B>0?`${B} barangay${B>1?"s":""} selected`:"Select barangays..."}),I.jsx("i",{className:`ri-arrow-${g?"up":"down"}-s-line text-gray-400`})]}),g&&I.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-hidden",children:[I.jsx("div",{className:"p-2 border-b border-gray-200",children:I.jsxs("div",{className:"relative",children:[I.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),I.jsx("input",{type:"text",placeholder:"Search barangays...",value:h,onChange:e=>x(e.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]})}),I.jsx("div",{className:"max-h-48 overflow-y-auto",children:D.length>0?D.map((e,t)=>I.jsxs("label",{className:"flex items-center px-3 py-2 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[I.jsx("input",{type:"checkbox",checked:(l?.recipients||[]).includes(e.name),onChange:()=>M(e.name),className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),I.jsx("div",{className:"flex-1",children:I.jsx("div",{className:"font-medium text-gray-900 text-sm",children:e.name})})]},t)):I.jsx("div",{className:"px-3 py-4 text-center text-gray-500 text-sm",children:"No barangays found"})}),I.jsxs("div",{className:"border-t border-gray-200 p-2 flex justify-between",children:[I.jsx("button",{type:"button",onClick:()=>{const e=Ix.map(e=>e.name);o(t=>({...t,recipients:Array.from(new Set([...t?.recipients||[],...e]))}))},className:"text-xs text-blue-600 hover:text-blue-800 px-2 py-1",children:"Select All"}),I.jsx("button",{type:"button",onClick:()=>{const e=l?.recipients||[],t=Ix.map(e=>e.name);o(s=>({...s,recipients:e.filter(e=>!t.includes(e))}))},className:"text-xs text-red-600 hover:text-red-800 px-2 py-1",children:"Clear All"})]})]})]}),B>0&&I.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[(l?.recipients||[]).filter(e=>Ix.some(t=>t.name===e)).slice(0,5).map((e,t)=>I.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:[e,I.jsx("button",{type:"button",onClick:()=>M(e),className:"ml-1 text-blue-600 hover:text-blue-800",children:I.jsx("i",{className:"ri-close-line text-xs"})})]},t)),B>5&&I.jsxs("span",{className:"text-xs text-gray-500 px-2 py-1",children:["+",B-5," more"]})]})]})]})]}),I.jsxs("div",{className:"p-6 border-t border-gray-200 bg-gray-50 flex justify-between items-center",children:[I.jsx("div",{className:"text-sm text-gray-600",children:(l?.recipients||[]).length>0&&I.jsxs("span",{children:[I.jsx("i",{className:"ri-mail-line mr-1"}),(l?.recipients||[]).length," recipient group(s) selected"]})}),I.jsxs("div",{className:"flex space-x-3",children:[I.jsx("button",{onClick:()=>i(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"}),I.jsxs("button",{onClick:async()=>{try{if(!l.title||!l.message)return void k({type:"warning",message:"Please fill in all required fields"});if(l.latitude&&l.longitude&&!l.radius_km)return void k({type:"warning",message:"Please specify alert radius"});const e={title:l.title,message:l.message,type:l.type,priority:l.priority,recipients:l.recipients,send_immediately:!1,latitude:l.latitude,longitude:l.longitude,radius_km:l.radius_km,location_text:l.location_text};(await fe(e)).success?(await P(),o({title:"",message:"",type:"info",priority:"medium",recipients:[],latitude:null,longitude:null,radius_km:5,location_text:""}),i(!1),k({type:"success",message:"Alert created successfully"})):k({type:"error",message:"Failed to create alert"})}catch(e){k({type:"error",message:"Error creating alert"})}},disabled:!l.title||!l.message,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[I.jsx("i",{className:"ri-add-line mr-2"}),"Create Alert"]})]})]})]})}),d&&u&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-y-auto",children:[I.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-edit-line text-blue-600 text-lg"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Edit Alert"}),I.jsx("p",{className:"text-sm text-gray-600",children:"Modify the alert details and settings"})]})]}),I.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600 hover:bg-gray-100 p-2 rounded-lg transition-colors",children:I.jsx("i",{className:"ri-close-line text-xl"})})]})}),I.jsxs("div",{className:"p-6",children:[I.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-text mr-1"}),"Alert Title *"]}),I.jsx("input",{type:"text",value:u?.title||"",onChange:e=>m(t=>t?{...t,title:e.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter alert title",required:!0})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-alert-line mr-1"}),"Alert Type *"]}),I.jsxs("select",{value:u?.type||"info",onChange:e=>m(t=>t?{...t,type:e.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"info",children:"Information"}),I.jsx("option",{value:"warning",children:"Warning"}),I.jsx("option",{value:"emergency",children:"Emergency"})]})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-error-warning-line mr-1"}),"Alert Severity"]}),I.jsxs("select",{value:u?.type||"info",onChange:e=>m(t=>t?{...t,type:e.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"info",children:"Low - Information"}),I.jsx("option",{value:"warning",children:"Medium - Warning"}),I.jsx("option",{value:"emergency",children:"High - Emergency"})]})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-file-text-line mr-1"}),"Description *"]}),I.jsx("textarea",{value:u?.message||"",onChange:e=>m(t=>t?{...t,message:e.target.value}:null),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter detailed alert description",required:!0})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-map-pin-line mr-1"}),"Location"]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("input",{type:"text",value:u.location_text,onChange:e=>m(t=>t?{...t,location_text:e.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter location or click on map"}),I.jsx("div",{className:"text-xs text-gray-500",children:"Click on the map to select a location, or enter coordinates manually"})]})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-focus-3-line mr-1"}),"Alert Radius (km)"]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("input",{type:"number",min:"0.1",max:"50",step:"0.1",value:u.radius_km,onChange:e=>m(t=>t?{...t,radius_km:parseFloat(e.target.value)||5}:null),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"5.0"}),I.jsx("span",{className:"text-sm text-gray-500",children:"kilometers"})]}),I.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Radius for geographic alert coverage (0.1 - 50 km)"})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-flag-line mr-1"}),"Priority"]}),I.jsxs("select",{value:u.priority||"medium",onChange:e=>m(t=>t?{...t,priority:e.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"low",children:"Low"}),I.jsx("option",{value:"medium",children:"Medium"}),I.jsx("option",{value:"high",children:"High"}),I.jsx("option",{value:"critical",children:"Critical"})]})]})]}),I.jsx("div",{className:"space-y-4",children:I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-map-2-line mr-1"}),"Location Selection"]}),I.jsx("div",{className:"text-xs text-gray-500 mb-3",children:"Click on the map below to select the alert location"}),I.jsx("div",{className:"w-full h-96 rounded-lg overflow-hidden border border-gray-300 shadow-sm",children:I.jsxs(Jl,{center:u?.latitude&&u?.longitude&&"number"==typeof u.latitude&&"number"==typeof u.longitude?[u.latitude,u.longitude]:w,zoom:S,style:{height:"100%",width:"100%"},className:"z-0",children:[I.jsx(Ql,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),I.jsx(A,{}),u?.latitude&&u?.longitude&&"number"==typeof u.latitude&&"number"==typeof u.longitude&&I.jsxs(I.Fragment,{children:[I.jsx(Kl,{position:[u.latitude,u.longitude],icon:Tx}),I.jsx(Vl,{center:[u.latitude,u.longitude],radius:1e3*(u.radius_km||5),pathOptions:{color:"#ef4444",fillColor:"#ef4444",fillOpacity:.1,weight:2,dashArray:"5, 5"}})]})]})}),u?.latitude&&u?.longitude&&"number"==typeof u.latitude&&"number"==typeof u.longitude&&I.jsxs("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:[I.jsx("div",{className:"text-sm text-blue-800",children:I.jsx("strong",{children:"Selected Location:"})}),I.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:["Latitude: ",u.latitude.toFixed(6),I.jsx("br",{}),"Longitude: ",u.longitude.toFixed(6),I.jsx("br",{}),"Radius: ",u.radius_km||5," km"]})]})]})})]}),I.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200 bg-gray-50 -mx-6 px-6 -mb-6 rounded-b-xl",children:[I.jsxs("div",{className:"mb-4",children:[I.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:[I.jsx("i",{className:"ri-group-line mr-2 text-blue-600"}),"Target Recipients"]}),I.jsx("p",{className:"text-sm text-gray-600",children:"Select the groups who should receive this alert"})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[I.jsxs("label",{className:"flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[I.jsx("input",{type:"checkbox",checked:(u?.recipients||[]).includes("all_users"),onChange:e=>{const t=u?.recipients||[];e.target.checked?m(e=>e?{...e,recipients:Array.from(new Set([...t,"all_users"]))}:null):m(e=>e?{...e,recipients:t.filter(e=>"all_users"!==e)}:null)},className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),I.jsxs("div",{children:[I.jsx("div",{className:"font-medium text-gray-900",children:"All Registered Users"}),I.jsx("div",{className:"text-sm text-gray-500",children:"Send to all users in the system"})]})]}),I.jsxs("label",{className:"flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[I.jsx("input",{type:"checkbox",checked:(u?.recipients||[]).includes("emergency_responders"),onChange:e=>{const t=u?.recipients||[];e.target.checked?m(e=>e?{...e,recipients:Array.from(new Set([...t,"emergency_responders"]))}:null):m(e=>e?{...e,recipients:t.filter(e=>"emergency_responders"!==e)}:null)},className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),I.jsxs("div",{children:[I.jsx("div",{className:"font-medium text-gray-900",children:"Emergency Responders"}),I.jsx("div",{className:"text-sm text-gray-500",children:"Send to emergency response teams"})]})]})]}),I.jsxs("div",{className:"mb-4",children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-map-pin-line mr-1"}),"Select Barangays"]}),I.jsxs("div",{className:"relative",children:[I.jsxs("button",{type:"button",onClick:()=>v(!y),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-left focus:ring-2 focus:ring-blue-500 focus:border-blue-500 flex items-center justify-between",children:[I.jsx("span",{className:"text-gray-700",children:z>0?`${z} barangay${z>1?"s":""} selected`:"Select barangays..."}),I.jsx("i",{className:`ri-arrow-${y?"up":"down"}-s-line text-gray-400`})]}),y&&I.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-hidden",children:[I.jsx("div",{className:"p-2 border-b border-gray-200",children:I.jsxs("div",{className:"relative",children:[I.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),I.jsx("input",{type:"text",placeholder:"Search barangays...",value:p,onChange:e=>b(e.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]})}),I.jsx("div",{className:"max-h-48 overflow-y-auto",children:U.length>0?U.map((e,t)=>I.jsxs("label",{className:"flex items-center px-3 py-2 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[I.jsx("input",{type:"checkbox",checked:(u?.recipients||[]).includes(e.name),onChange:()=>q(e.name),className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),I.jsx("div",{className:"flex-1",children:I.jsx("div",{className:"font-medium text-gray-900 text-sm",children:e.name})})]},t)):I.jsx("div",{className:"px-3 py-4 text-center text-gray-500 text-sm",children:"No barangays found"})}),I.jsxs("div",{className:"border-t border-gray-200 p-2 flex justify-between",children:[I.jsx("button",{type:"button",onClick:()=>{const e=Ix.map(e=>e.name);m(t=>t?{...t,recipients:Array.from(new Set([...t?.recipients||[],...e]))}:null)},className:"text-xs text-blue-600 hover:text-blue-800 px-2 py-1",children:"Select All"}),I.jsx("button",{type:"button",onClick:()=>{const e=u?.recipients||[],t=Ix.map(e=>e.name);m(s=>s?{...s,recipients:e.filter(e=>!t.includes(e))}:null)},className:"text-xs text-red-600 hover:text-red-800 px-2 py-1",children:"Clear All"})]})]})]}),z>0&&I.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[(u?.recipients||[]).filter(e=>Ix.some(t=>t.name===e)).slice(0,5).map((e,t)=>I.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:[e,I.jsx("button",{type:"button",onClick:()=>q(e),className:"ml-1 text-blue-600 hover:text-blue-800",children:I.jsx("i",{className:"ri-close-line text-xs"})})]},t)),z>5&&I.jsxs("span",{className:"text-xs text-gray-500 px-2 py-1",children:["+",z-5," more"]})]})]})]})]}),I.jsxs("div",{className:"p-6 border-t border-gray-200 bg-gray-50 flex justify-between items-center",children:[I.jsx("div",{className:"text-sm text-gray-600",children:(u?.recipients||[]).length>0&&I.jsxs("span",{children:[I.jsx("i",{className:"ri-mail-line mr-1"}),(u?.recipients||[]).length," recipient group(s) selected"]})}),I.jsxs("div",{className:"flex space-x-3",children:[I.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"}),I.jsxs("button",{onClick:async()=>{try{if(!u||!u.title||!u.message)return void k({type:"warning",message:"Please fill in all required fields"});if(u.latitude&&u.longitude&&!u.radius_km)return void k({type:"warning",message:"Please specify alert radius"});const e={title:u.title,message:u.message,type:u.type,priority:u.priority,recipients:u.recipients,latitude:u.latitude,longitude:u.longitude,radius_km:u.radius_km,location_text:u.location_text};(await pe(u.id,e)).success?(await P(),m(null),c(!1),k({type:"success",message:"Alert updated successfully"})):k({type:"error",message:"Failed to update alert"})}catch(e){k({type:"error",message:"Error updating alert"})}},disabled:!u.title||!u.message,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[I.jsx("i",{className:"ri-save-line mr-2"}),"Update Alert"]})]})]})]})}),I.jsx(wl,{isOpen:L,onClose:()=>{E(!1),O(null)},onConfirm:async()=>{if(null!=T)try{(await ye(T)).success?(await P(),k({type:"success",message:"Alert deleted successfully"})):k({type:"error",message:"Failed to delete alert"})}catch(e){k({type:"error",message:"Error deleting alert"})}finally{E(!1),O(null)}},title:"Delete Alert",message:"Are you sure you want to delete this alert? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",confirmVariant:"secondary",icon:"ri-delete-bin-line",iconColor:"text-red-600"}),I.jsx(Lx,{open:j,onClose:()=>N(!1),onExportPDF:()=>{$("pdf"),N(!1)},onExportCSV:()=>{$("csv"),N(!1)},onExportExcel:()=>{$("excel"),N(!1)},data:e,columns:C,title:"Export Alerts Data"})]})},Fx=()=>{const[e,t]=n.useState([]),[s,r]=n.useState(!0),[a,i]=n.useState(null),[l,o]=n.useState(""),[d,c]=n.useState("all"),[u,m]=n.useState("all"),[h,x]=n.useState(!1),[g,f]=n.useState(null),[p,b]=n.useState(1),[y,v]=n.useState(1),[j,N]=n.useState(0),{showToast:w}=$t(),[S,k]=n.useState(!1),[C,$]=n.useState(null),[_,A]=n.useState([]),[P,L]=n.useState(!1),E=[{key:"name",label:"Full Name"},{key:"email",label:"Email"},{key:"user_type",label:"User Type",format:e=>e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():""},{key:"phone",label:"Phone"},{key:"address",label:"Address",format:(e,t)=>{const s=[];return e&&s.push(e),t.city&&s.push(t.city),t.state&&s.push(t.state),s.join(", ")||""}}];n.useEffect(()=>{O(),T()},[d,u]);const T=async()=>{try{const e=await F();A(e)}catch(t){A(e)}};n.useEffect(()=>{O()},[p]);const O=async()=>{try{r(!0),i(null);const e={page:p,limit:10,status:d,barangay:u},s=await ie(e);s.success&&s.data?(t(s.data.users),v(s.data.pagination.totalPages),N(s.data.pagination.total)):i(s.message||"Failed to fetch users")}catch(e){i(e instanceof Error?e.message:"Failed to fetch users")}finally{r(!1)}},F=async()=>{try{const e={page:1,limit:1e3,status:d,barangay:u},t=await ie(e);if(t.success&&t.data)return t.data.users;throw new Error(t.message||"Failed to fetch users for export")}catch(e){throw e}},R=async e=>{try{let t="Users Data Export";const s=[];l&&s.push(`Search: "${l}"`),d&&"all"!==d&&s.push(`Status: ${d.charAt(0).toUpperCase()+d.slice(1)}`),u&&"all"!==u&&s.push(`Type: ${u.charAt(0).toUpperCase()+u.slice(1)}`),s.length&&(t+=` (${s.join(", ")})`);const r={filename:"users_export",title:t,includeTimestamp:!0,logoUrl:"/images/partners/MDRRMO.png"};switch(e){case"pdf":await Px.exportToPDF(_,E,r);break;case"csv":Px.exportToCSV(_,E,r);break;case"excel":Px.exportToExcel(_,E,r)}w({type:"success",message:"Users data exported successfully"}),L(!1)}catch(t){w({type:"error",message:"Failed to export users data"})}},M=e=>1===e?"bg-green-100 text-green-800":0===e?"bg-gray-100 text-gray-800":-1===e?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800",B=e=>1===e?"Active":0===e?"Inactive":-1===e?"Suspended":"Unknown",U=_.filter(e=>{const t=l.toLowerCase();return""===l.trim()||(e.first_name.toLowerCase().includes(t)||e.last_name.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)||e.name.toLowerCase().includes(t))});return s?I.jsx("div",{className:"flex items-center justify-center h-64",children:I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Manage registered users and their access"})]}),I.jsx("div",{className:"flex items-center space-x-3",children:I.jsxs("button",{onClick:()=>{L(!0)},disabled:s||0===_.length,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export Users (",_.length,")"]})})]}),a&&I.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-error-warning-line text-red-500 mr-2"}),I.jsx("span",{className:"text-red-700",children:a}),I.jsx("button",{onClick:()=>i(null),className:"ml-auto text-red-500 hover:text-red-700",children:I.jsx("i",{className:"ri-close-line"})})]})}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-user-line text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total Users"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:j})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-user-check-line text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Active Users"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:U.filter(e=>1===e.status).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-user-unfollow-line text-gray-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Inactive Users"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:U.filter(e=>0===e.status||-1===e.status).length})]})]})})]}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:I.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsxs("div",{className:"relative",children:[I.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),I.jsx("input",{type:"text",placeholder:"Search users...",value:l,onChange:e=>o(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),I.jsxs("select",{value:d,onChange:e=>c(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"all",children:"All Status"}),I.jsx("option",{value:"active",children:"Active"}),I.jsx("option",{value:"inactive",children:"Inactive"})]})]}),I.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",U.length," of ",j," users"]})]})}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:I.jsx("div",{className:"overflow-x-auto",children:I.jsxs("table",{className:"w-full",children:[I.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:I.jsxs("tr",{children:[I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Type"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profile Picture"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),I.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:U.map(e=>I.jsxs("tr",{className:"hover:bg-gray-50",children:[I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:e.profile_picture?I.jsx("img",{src:e.profile_picture,alt:e.name,className:"w-10 h-10 rounded-full object-cover"}):I.jsx("i",{className:"ri-user-line text-blue-600"})}),I.jsxs("div",{children:[I.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),I.jsx("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("div",{className:"text-sm text-gray-900 capitalize",children:e.user_type})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("div",{className:"text-sm text-gray-900",children:e.profile_picture?"Uploaded":"Not uploaded"})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full uppercase ${M(e.status)}`,children:B(e.status)})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("button",{onClick:()=>{f(e),x(!0)},className:"text-blue-600 hover:text-blue-900",children:I.jsx("i",{className:"ri-eye-line"})}),I.jsxs("select",{value:e.status,onChange:s=>(async(e,s)=>{try{const r=D(),a=r.userData?.admin_id;await le(e,s,a),t(t=>t.map(t=>t.user_id===e?{...t,status:s}:t)),w({type:"success",message:"User status updated"})}catch(r){i("Failed to update user status"),w({type:"error",message:"Failed to update user status"})}})(e.user_id,parseInt(s.target.value)),className:"text-xs border border-gray-300 rounded px-2 py-1",children:[I.jsx("option",{value:1,children:"Active"}),I.jsx("option",{value:0,children:"Inactive"})]}),I.jsx("button",{onClick:()=>{return t=e.user_id,$(t),void k(!0);var t},className:"text-red-600 hover:text-red-900 ml-2",title:"Delete User",children:I.jsx("i",{className:"ri-delete-bin-line"})})]})})]},e.user_id))})]})})}),y>1&&I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 px-6 py-4",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",p," of ",y]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("button",{onClick:()=>b(e=>Math.max(1,e-1)),disabled:1===p,className:"px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),I.jsx("button",{onClick:()=>b(e=>Math.min(y,e+1)),disabled:p===y,className:"px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})}),h&&g&&I.jsx(Nl,{isOpen:h,onClose:()=>x(!1),title:"",size:"lg",children:I.jsxs("div",{className:"max-w-4xl mx-auto",children:[I.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 mb-6 border border-blue-100",children:I.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start space-y-4 sm:space-y-0 sm:space-x-6",children:[I.jsx("div",{className:"flex-shrink-0",children:g.profile_picture?I.jsx("img",{src:g.profile_picture,alt:"Profile",className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full object-cover border-4 border-white shadow-lg"}):I.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center shadow-lg",children:I.jsx("i",{className:"ri-user-line text-3xl sm:text-5xl text-gray-400"})})}),I.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[I.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:[g.first_name," ",g.last_name]}),I.jsx("p",{className:"text-gray-600 mb-3 break-words",children:g.email}),I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-2 sm:space-y-0",children:[I.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${M(g.status)}`,children:[I.jsx("i",{className:"ri-circle-fill text-xs mr-1"}),B(g.status)]}),I.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:[I.jsx("i",{className:"ri-user-line mr-1"}),g.user_type]})]})]})]})}),I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[I.jsxs("div",{className:"flex items-center mb-4",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-user-settings-line text-blue-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Personal Information"})]}),I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"First Name"}),I.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.first_name})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Last Name"}),I.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.last_name})]})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Email Address"}),I.jsx("p",{className:"text-sm font-medium text-gray-900 break-words",children:g.email})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Phone Number"}),I.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.phone||"Not provided"})]})]})]})]}),(g.address||g.city||g.state||g.zip_code)&&I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[I.jsxs("div",{className:"flex items-center mb-4",children:[I.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-map-pin-line text-green-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Address Information"})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[g.address&&I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Street Address"}),I.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.address})]}),g.city&&I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"City"}),I.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.city})]}),g.state&&I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"State/Province"}),I.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.state})]}),g.zip_code&&I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"ZIP Code"}),I.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.zip_code})]})]})]})]})}),I.jsx(Lx,{open:P,onClose:()=>{L(!1)},onExportPDF:()=>R("pdf"),onExportCSV:()=>R("csv"),onExportExcel:()=>R("excel"),data:_,columns:E,title:(()=>{let e="Users Data Export";const t=[];return l&&t.push(`Search: "${l}"`),d&&"all"!==d&&t.push(`Status: ${d.charAt(0).toUpperCase()+d.slice(1)}`),u&&"all"!==u&&t.push(`Type: ${u.charAt(0).toUpperCase()+u.slice(1)}`),t.length&&(e+=` (${t.join(", ")})`),e})()}),I.jsx(wl,{isOpen:S,onClose:()=>{k(!1),$(null)},onConfirm:async()=>{if(null!=C)try{await oe(C),t(e=>e.filter(e=>e.user_id!==C)),w({type:"success",message:"User deleted successfully"})}catch(e){i("Failed to delete user"),w({type:"error",message:"Failed to delete user"})}finally{k(!1),$(null)}},title:"Delete User",message:"Are you sure you want to delete this user? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",confirmVariant:"secondary",icon:"ri-delete-bin-line",iconColor:"text-red-600"})]})},Rx={"Emergency Response":[1],"Risk Assessment":[3],"Medical Team":[2],Communications:[4],Logistics:[5]},Dx={"Emergency Response":"available","Risk Assessment":"available","Medical Team":"available",Communications:"available",Logistics:"available"},Mx=()=>{const[e,t]=n.useState([]),[s,r]=n.useState([]),[a,i]=n.useState(!0),[l,o]=n.useState(null),[d,c]=n.useState(""),[u,m]=n.useState("all"),[h,x]=n.useState("all"),[g,f]=n.useState("all"),[p,b]=n.useState("all"),[y,v]=n.useState(!1),[j,N]=n.useState(!1),[w,S]=n.useState(null),[k,C]=n.useState(!1),[$,_]=n.useState(1),[A,P]=n.useState(1),[L,E]=n.useState(0),{showToast:T}=$t(),[O,F]=n.useState(!1),[R,D]=n.useState([]);n.useEffect(()=>{M(),B()},[$,d,u,h,g,p]);const M=async()=>{try{i(!0),o(null);const e=new URLSearchParams({page:$.toString(),search:d,status:u,availability:h,role:g,team_id:p}),s=await fetch(`/api/staff?${e}`),r=await s.json();r.success?(t(r.staff||[]),P(r.pagination?.pages||1),E(r.pagination?.total||0)):(o(r.message||"Failed to fetch staff"),t([]))}catch(e){o("Failed to connect to server")}finally{i(!1)}},B=async()=>{try{const e=await fetch("/api/teams"),t=await e.json();t.success&&(r(t.teams||[]),D(t.teams||[]))}catch(e){}},U=e=>{if(!e)return void D(s);const t=Rx[e]||[],r=s.filter(e=>t.includes(e.id));D(r),r.length>0?z(e=>({...e,team_id:r[0].id.toString()})):z(e=>({...e,team_id:""}));const a=Dx[e]||"available";z(e=>({...e,availability:a}))},[q,z]=n.useState({name:"",email:"",phone:"",position:"",department:"",availability:"available",team_id:""}),W=e=>{const{name:t,value:s}=e.target;"department"===t?(U(s),z(e=>({...e,[t]:s}))):z(e=>({...e,[t]:s}))},V=e.filter(e=>{const t=e.name.toLowerCase().includes(d.toLowerCase())||e.email.toLowerCase().includes(d.toLowerCase())||e.position.toLowerCase().includes(d.toLowerCase())||e.department.toLowerCase().includes(d.toLowerCase()),s="all"===u||e.status===u,r="all"===g||e.position===g;return t&&s&&r}),H=e=>{switch(e){case"available":return"bg-green-100 text-green-800";case"busy":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};if(a)return I.jsx("div",{className:"flex items-center justify-center h-64",children:I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const G=[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"phone",label:"Phone"},{key:"position",label:"Position"},{key:"department",label:"Department"},{key:"availability",label:"Availability"},{key:"team_name",label:"Team"}],J=async e=>{const t=V.map(e=>({...e})),s={filename:"Staff_Export",title:"Staff List",logoUrl:"/images/partners/MDRRMO.png",includeTimestamp:!0};switch(e){case"csv":Px.exportToCSV(t,G,s);break;case"pdf":F(!0);break;case"excel":Px.exportToExcel(t,G,s);break;case"json":Px.exportToJSON(t,s)}};return I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Staff Management"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Manage emergency response staff and personnel"})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsxs("button",{onClick:()=>{S(null),z({name:"",email:"",phone:"",position:"",department:"",availability:"available",team_id:""}),D(s),C(!0),v(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[I.jsx("i",{className:"ri-user-add-line mr-2"}),"Add Staff"]}),I.jsxs("div",{className:"relative inline-block",children:[I.jsxs("button",{className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",title:"Export Staff",onClick:()=>J("pdf"),children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export Staff"]}),I.jsxs("div",{className:"absolute right-0 mt-2 w-40 bg-white border border-gray-200 rounded shadow-lg z-10 hidden group-hover:block",children:[I.jsx("button",{className:"block w-full text-left px-4 py-2 hover:bg-gray-100",onClick:()=>J("csv"),children:"Export as CSV"}),I.jsx("button",{className:"block w-full text-left px-4 py-2 hover:bg-gray-100",onClick:()=>J("excel"),children:"Export as Excel"}),I.jsx("button",{className:"block w-full text-left px-4 py-2 hover:bg-gray-100",onClick:()=>J("json"),children:"Export as JSON"})]})]})]})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-team-line text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total Staff"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-user-check-line text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Active Staff"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e?.filter(e=>"active"===e.status).length||0})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-user-unfollow-line text-yellow-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Busy"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(e=>"busy"===e.availability).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-building-2-line text-purple-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Departments"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:new Set(e.map(e=>e.department)).size})]})]})})]}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:I.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsxs("div",{className:"relative",children:[I.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),I.jsx("input",{type:"text",placeholder:"Search staff...",value:d,onChange:e=>c(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),I.jsxs("select",{value:u,onChange:e=>m(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"all",children:"All Status"}),I.jsx("option",{value:"active",children:"Active"}),I.jsx("option",{value:"inactive",children:"Inactive"})]}),I.jsxs("select",{value:h,onChange:e=>x(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"all",children:"All Availability"}),I.jsx("option",{value:"available",children:"Available"}),I.jsx("option",{value:"busy",children:"Busy"}),I.jsx("option",{value:"off-duty",children:"Off Duty"})]}),I.jsxs("select",{value:p,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"all",children:"All Teams"}),s.map(e=>I.jsx("option",{value:e.id,children:e.name},e.id))]})]}),I.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",V.length," of ",e.length," staff members"]})]})}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:I.jsx("div",{className:"overflow-x-auto",children:I.jsxs("table",{className:"w-full",children:[I.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:I.jsxs("tr",{children:[I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Staff Member"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Team"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Availability"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),I.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:V.map(e=>{return I.jsxs("tr",{className:"hover:bg-gray-50",children:[I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-user-line text-blue-600"})}),I.jsxs("div",{children:[I.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),I.jsx("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("div",{className:"text-sm text-gray-900",children:e.team_name?I.jsxs("div",{children:[I.jsx("div",{children:e.team_name}),e.team_member_no&&I.jsxs("div",{className:"text-xs text-gray-500",children:["#",e.team_member_no]})]}):"No Team"})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("div",{className:"text-sm text-gray-900",children:yl(e.phone)||e.phone})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+(s=e.status,"active"===s?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.status.replace("_"," ").toUpperCase()})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${H(e.availability)}`,children:e.availability.replace("-"," ").toUpperCase()})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("button",{onClick:()=>{return S(t=e),z({name:t.name,email:t.email,phone:t.phone,position:t.position,department:t.department,availability:t.availability,team_id:t.team_id?.toString()||""}),U(t.department),C(!0),void v(!0);var t},className:"text-blue-600 hover:text-blue-900",title:"Edit Staff",children:I.jsx("i",{className:"ri-edit-line"})}),I.jsx("button",{onClick:()=>(S(e),void N(!0)),className:"text-green-600 hover:text-green-900",title:"Assign to Team",children:I.jsx("i",{className:"ri-team-line"})}),I.jsxs("select",{value:e.status,onChange:s=>(async(e,s)=>{try{const r=await fetch(`/api/staff/${e}/status`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).token:""}`},body:JSON.stringify({status:s})});(await r.json()).success?(t(t=>t.map(t=>t.id===e?{...t,status:s}:t)),T({type:"success",message:"Staff status updated"})):T({type:"error",message:"Failed to update staff status"})}catch(r){T({type:"error",message:"Error updating staff status"})}})(e.id,s.target.value),className:"text-xs border border-gray-300 rounded px-2 py-1",title:"Change Status",children:[I.jsx("option",{value:"active",children:"Active"}),I.jsx("option",{value:"inactive",children:"Inactive"})]})]})})]},e.id);var s})})]})})}),y&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[I.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:k?w?"Edit Staff Member":"Add New Staff Member":"Staff Details"}),I.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:I.jsx("i",{className:"ri-close-line text-xl"})})]}),I.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!q.phone||(e=>{if(!e)return!1;if(e.startsWith("+63")){const t=e.replace(/\D/g,"");return/^639\d{9}$/.test(t)}if(e.startsWith("09")){const t=e.replace(/\D/g,"");return/^09\d{9}$/.test(t)}const t=e.replace(/\D/g,"");return t.startsWith("639")&&12===t.length?/^639\d{9}$/.test(t):!(!t.startsWith("9")||10!==t.length)&&/^9\d{9}$/.test(t)})(q.phone))try{const e=w?`/api/staff/${w.id}`:"/api/staff",t=w?"PUT":"POST",s={...q,team_id:""===q.team_id?null:parseInt(q.team_id),availability:q.availability},r=await fetch(e,{method:t,headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).token:""}`},body:JSON.stringify(s)});(await r.json()).success?(v(!1),M(),T({type:"success",message:w?"Staff updated successfully":"Staff added successfully. Login credentials have been sent via email."})):T({type:"error",message:"Failed to save staff"})}catch(t){T({type:"error",message:"Error saving staff"})}else T({type:"error",message:"Please enter a valid Philippine mobile number (e.g., 09123456789 or +639123456789)"})},children:[I.jsx("div",{className:"p-6 space-y-4",children:k?I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),I.jsx("input",{type:"text",name:"name",value:q.name,onChange:W,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter staff name",required:!0})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),I.jsx("input",{type:"email",name:"email",value:q.email,onChange:W,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email address",required:!0})]})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),I.jsx(bl,{international:!0,defaultCountry:"PH",value:q.phone,onChange:e=>z(t=>({...t,phone:e||""})),className:"w-full pl-10 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",inputClassName:"w-full py-4 px-4 border-0 focus:ring-0 focus:outline-none bg-transparent text-gray-900 placeholder-gray-500",buttonClassName:"px-3 py-4 border-r border-gray-300 bg-gray-50 hover:bg-gray-100",dropdownClassName:"bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",placeholder:"Enter phone number"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Position"}),I.jsx("input",{type:"text",name:"position",value:q.position,onChange:W,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter position",required:!0})]})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),I.jsxs("select",{name:"department",value:q.department,onChange:W,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[I.jsx("option",{value:"",children:"Select Department"}),I.jsx("option",{value:"Emergency Response",children:"Emergency Response"}),I.jsx("option",{value:"Risk Assessment",children:"Risk Assessment"}),I.jsx("option",{value:"Medical Team",children:"Medical Team"}),I.jsx("option",{value:"Communications",children:"Communications"}),I.jsx("option",{value:"Logistics",children:"Logistics"})]})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team"}),I.jsxs("select",{name:"team_id",value:q.team_id,onChange:W,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"",children:"No Team"}),R.map(e=>I.jsx("option",{value:e.id,children:e.name},e.id))]}),I.jsx("p",{className:"text-xs text-gray-500 mt-1",children:q.department?`Team automatically selected for ${q.department} department`:"Team will be auto-selected when department is chosen"})]})]})]}):w&&I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),I.jsx("p",{className:"text-sm text-gray-900",children:w.name})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),I.jsx("p",{className:"text-sm text-gray-900",children:w.email})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),I.jsx("p",{className:"text-sm text-gray-900",children:yl(w.phone)||w.phone})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Position"}),I.jsx("p",{className:"text-sm text-gray-900",children:w.position})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Department"}),I.jsx("p",{className:"text-sm text-gray-900",children:w.department})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Availability"}),I.jsx("p",{className:"text-sm text-gray-900",children:w.availability.replace("-"," ").toUpperCase()})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Team"}),I.jsx("p",{className:"text-sm text-gray-900",children:w.team_name||"No Team"})]}),I.jsxs("div",{className:"md:col-span-2",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created Date"}),I.jsx("p",{className:"text-sm text-gray-900",children:new Date(w.created_at).toLocaleDateString()})]})]})}),I.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[I.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),k&&I.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:w?"Update Staff":"Add Staff"})]})]})]})}),I.jsx(Lx,{open:O,onClose:()=>F(!1),onExportPDF:async()=>{const e=V.map(e=>({...e}));let t="Staff List";const r=[];if(d.trim()&&r.push(`Search: "${d.trim()}"`),"all"!==u&&r.push(`Status: ${u.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())}`),"all"!==g&&r.push(`Role: ${g.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())}`),"all"!==p){const e=s.find(e=>e.id.toString()===p);r.push(`Team: ${e?e.name:p}`)}r.length>0&&(t+=" ("+r.join(", ")+")");const a={filename:"Staff_Export",title:t,logoUrl:"/images/partners/MDRRMO.png",includeTimestamp:!0};await Px.exportToPDF(e,G,a),F(!1)},onExportCSV:()=>J("csv"),onExportExcel:()=>J("excel"),data:V,columns:G}),j&&w&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[I.jsxs("div",{className:"p-6 border-b border-gray-200",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Assign Staff to Team"}),I.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Assign ",w.name," to a team"]})]}),I.jsxs("div",{className:"p-6 space-y-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Team"}),I.jsx("p",{className:"text-sm text-gray-900",children:w.team_name||"No team assigned"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Team"}),I.jsxs("select",{onChange:e=>(async e=>{if(w){if(""!==e)try{const t=await fetch(`/api/teams/${e}`),s=await t.json();if(s.success&&s.team&&(s.team.member_count||0)>=5)return void T({type:"error",message:"Team is at maximum capacity (5 members). Choose a different team."})}catch(t){return void T({type:"error",message:"Error checking team capacity"})}try{const t=await fetch(`/api/staff/${w.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).token:""}`},body:JSON.stringify({...w,team_id:""===e?null:parseInt(e)})});(await t.json()).success?(N(!1),M(),T({type:"success",message:"Staff assigned to team"})):T({type:"error",message:"Failed to assign staff to team"})}catch(t){T({type:"error",message:"Error assigning staff to team"})}}})(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"",children:"No Team"}),s.map(e=>{const t=e.member_count||0,s=t>=5;return I.jsxs("option",{value:e.id,disabled:s,children:[e.name," (",t,"/5 members)",s?" - FULL":""]},e.id)})]}),I.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Teams with 5 members are at maximum capacity"})]})]}),I.jsx("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:I.jsx("button",{type:"button",onClick:()=>N(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"})})]})})]})};delete Fl.Icon.Default.prototype._getIconUrl,Fl.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const Bx=(e,t)=>{let s="#6b7280";return"resolved"===t||"closed"===t?s="#059669":"in_progress"===t?s="#0891b2":"pending"===t&&(s="critical"===e?"#be123c":"#f59e0b"),Fl.divIcon({className:"custom-incident-marker",html:`\n      <div style="\n        background-color: ${s};\n        width: 30px;\n        height: 30px;\n        border-radius: 50% 50% 50% 0;\n        border: 3px solid white;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        transform: rotate(-45deg);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        position: relative;\n      ">\n        <div style="\n          color: white;\n          font-weight: bold;\n          font-size: 12px;\n          transform: rotate(45deg);\n          text-shadow: 1px 1px 1px rgba(0,0,0,0.5);\n        ">!</div>\n      </div>\n    `,iconSize:[30,30],iconAnchor:[15,30],popupAnchor:[0,-30]})},Ux=({center:e,zoom:t})=>{const s=zl();return n.useEffect(()=>{s.setView(e,t)},[s,e,t]),null},qx=({isOpen:e,onClose:t,incident:s})=>{const[r,a]=n.useState([13.7565,121.3851]),[i,l]=n.useState(15);if(n.useEffect(()=>{if(s&&s.latitude&&s.longitude){const e=[s.latitude,s.longitude];a(e),l(16)}},[s]),!e||!s)return null;const o=e=>{switch(e){case"critical":return"text-red-600 bg-red-100";case"high":return"text-orange-600 bg-orange-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}};return I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[I.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:["Incident Location - #",s.id]}),I.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s.type.toUpperCase()," • ",s.location]})]}),I.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors p-2 hover:bg-gray-100 rounded-lg",children:I.jsx("i",{className:"ri-close-line text-xl"})})]}),I.jsxs("div",{className:"flex h-[calc(90vh-120px)]",children:[I.jsxs("div",{className:"flex-1 relative",children:[I.jsxs(Jl,{center:r,zoom:i,style:{height:"100%",width:"100%"},className:"z-0",zoomControl:!0,children:[I.jsx(Ux,{center:r,zoom:i}),I.jsx(Ql,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",maxZoom:19}),I.jsx(Kl,{position:[s.latitude,s.longitude],icon:Bx(s.priorityLevel,s.status),children:I.jsx(Xl,{children:I.jsxs("div",{className:"p-2 min-w-[200px]",children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsxs("h4",{className:"font-bold text-gray-900",children:["#",s.id]}),I.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${o(s.priorityLevel)}`,children:s.priorityLevel.toUpperCase()})]}),I.jsx("p",{className:"text-sm text-gray-700 mb-2",children:s.type.toUpperCase()}),I.jsx("p",{className:"text-xs text-gray-600 mb-2",children:s.description}),I.jsxs("div",{className:"text-xs text-gray-500",children:[I.jsxs("div",{children:["Reported by: ",s.reportedBy]}),I.jsxs("div",{children:["Date: ",new Date(s.dateReported).toLocaleDateString()]})]})]})})})]}),I.jsx("div",{className:"absolute top-4 right-4 bg-white rounded-lg shadow-lg border border-gray-200 p-3",children:I.jsxs("div",{className:"text-center",children:[I.jsxs("div",{className:"text-lg font-bold text-gray-800",children:["#",s.id]}),I.jsx("div",{className:"text-xs text-gray-600",children:"Incident Location"}),I.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s.latitude.toFixed(6),", ",s.longitude.toFixed(6)]})]})})]}),I.jsx("div",{className:"w-80 border-l border-gray-200 overflow-y-auto",children:I.jsxs("div",{className:"p-6 space-y-6",children:[I.jsxs("div",{children:[I.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Incident Details"}),I.jsxs("div",{className:"space-y-3",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Type:"}),I.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.type.toUpperCase()})]}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Priority:"}),I.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${o(s.priorityLevel)}`,children:s.priorityLevel.toUpperCase()})]}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),I.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${(e=>{switch(e){case"pending":default:return"text-gray-600 bg-gray-100";case"in_progress":return"text-blue-600 bg-blue-100";case"resolved":return"text-green-600 bg-green-100";case"closed":return"text-purple-600 bg-purple-100"}})(s.status)}`,children:s.status.replace("_"," ").toUpperCase()})]}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Safety:"}),I.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${(e=>{switch(e){case"safe":return"text-green-600 bg-green-100";case"at_risk":return"text-yellow-600 bg-yellow-100";case"injured":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}})(s.safetyStatus)}`,children:s.safetyStatus.replace("_"," ").toUpperCase()})]})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Location Information"}),I.jsxs("div",{className:"space-y-3",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Address:"}),I.jsx("p",{className:"text-sm text-gray-900 mt-1",children:s.location})]}),I.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Latitude:"}),I.jsx("p",{className:"text-sm font-mono text-gray-900",children:s.latitude.toFixed(6)})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Longitude:"}),I.jsx("p",{className:"text-sm font-mono text-gray-900",children:s.longitude.toFixed(6)})]})]})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Description"}),I.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 rounded-lg p-3",children:s.description})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Reporter Information"}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Name:"}),I.jsx("p",{className:"text-sm text-gray-900",children:s.reportedBy})]}),s.reporterPhone&&I.jsxs("div",{children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Phone:"}),I.jsx("p",{className:"text-sm text-gray-900",children:s.reporterPhone})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Date Reported:"}),I.jsx("p",{className:"text-sm text-gray-900",children:new Date(s.dateReported).toLocaleString()})]})]})]}),(s.assignedTeamName||s.assignedStaffName||s.allAssignedTeams)&&I.jsxs("div",{children:[I.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Assignment"}),I.jsxs("div",{className:"space-y-2",children:[s.allAssignedTeams&&I.jsxs("div",{children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Teams:"}),I.jsx("p",{className:"text-sm text-green-600 font-medium",children:s.allAssignedTeams})]}),s.assignedTeamName&&!s.allAssignedTeams&&I.jsxs("div",{children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Team:"}),I.jsx("p",{className:"text-sm text-green-600 font-medium",children:s.assignedTeamName})]}),s.assignedStaffName&&I.jsxs("div",{children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Staff:"}),I.jsx("p",{className:"text-sm text-purple-600 font-medium",children:s.assignedStaffName})]})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Validation"}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),I.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+("validated"===s.validationStatus?"text-green-600 bg-green-100":"rejected"===s.validationStatus?"text-red-600 bg-red-100":"text-yellow-600 bg-yellow-100"),children:s.validationStatus.charAt(0).toUpperCase()+s.validationStatus.slice(1)})]}),s.validationNotes&&I.jsxs("div",{children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Notes:"}),I.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 rounded-lg p-2 mt-1",children:s.validationNotes})]})]})]}),I.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[I.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Quick Actions"}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("button",{onClick:()=>{const e=`https://www.google.com/maps?q=${s.latitude},${s.longitude}`;window.open(e,"_blank")},className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center",children:[I.jsx("i",{className:"ri-external-link-line mr-2"}),"Open in Google Maps"]}),I.jsxs("button",{onClick:()=>{const e=`https://www.openstreetmap.org/?mlat=${s.latitude}&mlon=${s.longitude}&zoom=16`;window.open(e,"_blank")},className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center",children:[I.jsx("i",{className:"ri-map-line mr-2"}),"Open in OpenStreetMap"]}),I.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(`${s.latitude}, ${s.longitude}`)},className:"w-full px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center justify-center",children:[I.jsx("i",{className:"ri-clipboard-line mr-2"}),"Copy Coordinates"]})]})]})]})})]})]})})},zx=[{key:"dateReported",label:"Date Reported",format:e=>e?Px.formatDateTime(e):""},{key:"type",label:"Type",format:e=>e.toUpperCase()},{key:"priorityLevel",label:"Priority",format:e=>e?.charAt(0).toUpperCase()+e?.slice(1)||""},{key:"status",label:"Status",format:e=>e?.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())||""},{key:"location",label:"Location",format:(e,t)=>{if(e)return e;const s=t.description?.match(/Location:\s*([^\n]+)/i);return s?s[1].trim():""}},{key:"description",label:"Description",format:e=>e?.length>50?`${e.substring(0,50)}...`:e||""},{key:"reportedBy",label:"Reported By",format:(e,t)=>e||(t.reporterName||"Unknown")},{key:"assignedTeamName",label:"Team",format:e=>e||"Unassigned"}],Wx=()=>{const{showToast:e}=$t(),[t,s]=n.useState([]),[r,a]=n.useState([]),[i,l]=n.useState([]),[o,d]=n.useState(!0),[,c]=n.useState(null),[u,m]=n.useState(""),[h,x]=n.useState("all"),[g,f]=n.useState("all"),[p,b]=n.useState(""),[y,v]=n.useState(""),[j,N]=n.useState(null),[w,S]=n.useState(!1),[k,C]=n.useState(!1),[$,_]=n.useState("team"),[A,P]=n.useState(null),[L,E]=n.useState([]),[T,O]=n.useState(null),[F,R]=n.useState(null),[D,M]=n.useState(!1),[B,U]=n.useState(!1),[q,z]=n.useState(""),[W,V]=n.useState(!1),[H,G]=n.useState(!1),[J,K]=n.useState(!1),[Y,Z]=n.useState(!1),X=()=>{if(D)return!0;if(!j)return!0;if("staff"===$)return"pending"===j.status||!T;if("teams"===$){if(0===L.length)return!1;const e=L.filter(e=>{const t=r.find(t=>t.id===e);return 0===t?.member_count});return e.length>0}if("team"===$){if(!A)return!1;const e=r.find(e=>e.id===A);return 0===e?.member_count}return!1};n.useEffect(()=>{Q(),ee(),te()},[]);const Q=async()=>{try{d(!0),c(null);const e=await Oe(),t=(e?.incidents??[]).map(e=>{const t=Number(e.incident_id),s=String(e.incident_type||""),r=String(e.description||""),a=Number(e.latitude??0),n=Number(e.longitude??0),i=e.date_reported?new Date(e.date_reported).toISOString():(new Date).toISOString(),l=String(e.priority_level||"moderate"),o=String(e.reporter_safe_status||"unknown"),d=String(e.status||"pending"),c="moderate"===l?"medium":l,u="danger"===o?"unknown":o;return{id:t,type:s,description:r,location:se(r),latitude:a,longitude:n,priorityLevel:c,safetyStatus:u,status:d,validationStatus:e.validation_status||"unvalidated",validationNotes:e.validation_notes||void 0,reportedBy:"guest"===e.reporter_type?String(e.guest_name??"Unknown Guest"):String(e.reporter_name??e.reported_by??""),reporterPhone:"guest"===e.reporter_type?e.guest_contact?String(e.guest_contact):void 0:e.reporter_phone?String(e.reporter_phone):void 0,assignedTo:e.assigned_to?String(e.assigned_to):void 0,assignedTeamId:e.assigned_team_id?Number(e.assigned_team_id):void 0,assignedTeamName:e.assigned_team_name||void 0,assignedStaffId:e.assigned_staff_id?Number(e.assigned_staff_id):void 0,assignedStaffName:e.assigned_staff_name||void 0,assignedTeamIds:e.assigned_team_ids||void 0,allAssignedTeams:e.all_assigned_teams||void 0,attachment:e.attachment||void 0,dateReported:i,dateResolved:void 0}});s(t)}catch(e){c("Failed to load incidents. Please try again.")}finally{d(!1)}},ee=async()=>{try{const e=await Te();e?.teams&&a(e.teams)}catch(e){}},te=async()=>{try{const e=await de();e&&"object"==typeof e&&("staff"in e&&Array.isArray(e.staff)?l(e.staff):"data"in e&&e.data&&"staff"in e.data&&Array.isArray(e.data.staff)?l(e.data.staff):"users"in e&&Array.isArray(e.users)&&l(e.users))}catch(e){}},se=e=>{if(!e)return"";const t=/Location:\s*([^\n]+)/i.exec(e);return t?t[1].trim():""},re=async(e,r,a)=>{try{V(!0);const i=t.find(t=>t.id===e);if(!i)throw new Error("Incident not found");const l=a||i.validationNotes;try{const t=await De(e,{validationStatus:r,validationNotes:l,assignedTo:null});if(!t.success)throw new Error(t.message||"Failed to update validation")}catch(n){}s(t=>t.map(t=>{if(t.id===e){const e="validated"===r?"in_progress":"rejected"===r?"closed":t.status;return{...t,validationStatus:r,validationNotes:l,status:e}}return t})),U(!1),z("");const o="validated"===i.validationStatus,d="validated"===r?"in_progress":"rejected"===r?"closed":i.status;R({sent:!0,details:{message:o?`Incident validation updated successfully to ${r}. Status changed to ${d}.`:`Incident ${"validated"===r?"validated":"rejected"} successfully. Status changed to ${d}.`,incidentId:e,note:"Note: Validation saved locally. Backend sync may be unavailable."}}),setTimeout(()=>{R(null)},3e3)}catch(i){R({sent:!1,details:{error:i instanceof Error?i.message:"Unknown error",details:"Check console for more information"}})}finally{V(!1)}},ae=()=>{C(!1),N(null),_("team"),P(null),E([]),O(null),R(null),M(!1)},ne=e=>e.toUpperCase(),ie=t.filter(e=>{const t=ne(e.type).includes(u.toUpperCase())||e.type.toLowerCase().includes(u.toLowerCase())||e.location.toLowerCase().includes(u.toLowerCase())||e.description.toLowerCase().includes(u.toLowerCase()),s="all"===h||e.status===h,r="all"===g||e.priorityLevel===g,a=(()=>{if(!p&&!y)return!0;const t=new Date(e.dateReported),s=p?new Date(p):null,r=y?new Date(y):null;return s&&r?t>=s&&t<=r:s?t>=s:!r||t<=r})();return t&&s&&r&&a}).sort((e,t)=>{const s={pending:1,in_progress:2,resolved:3,closed:4},r={critical:1,high:2,medium:3,low:4},a=s[e.status]-s[t.status];if(0!==a)return a;const n=r[e.priorityLevel]-r[t.priorityLevel];return 0!==n?n:new Date(t.dateReported).getTime()-new Date(e.dateReported).getTime()}),le=e=>{switch(e){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},oe=e=>{switch(e){case"pending":default:return"bg-gray-100 text-gray-800";case"in_progress":return"bg-blue-100 text-blue-800";case"resolved":return"bg-green-100 text-green-800";case"closed":return"bg-purple-100 text-purple-800"}};return o?I.jsx("div",{className:"flex items-center justify-center h-64",children:I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"View Incidents"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor and manage reported incidents"})]}),I.jsx("div",{className:"flex items-center space-x-3",children:I.jsx("button",{onClick:()=>K(!0),disabled:0===ie.length||H,className:"px-4 py-2 rounded-lg transition-colors flex items-center "+(0===ie.length||H?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),title:0===ie.length?"No data to export":"Export incidents report",children:H?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Exporting..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export Report (",ie.length,")"]})})})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-error-warning-line text-red-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total Incidents"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-time-line text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"In Progress"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.filter(e=>"in_progress"===e.status).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-check-line text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Resolved"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.filter(e=>"resolved"===e.status).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-alarm-warning-line text-orange-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"High Priority"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.filter(e=>"high"===e.priorityLevel||"critical"===e.priorityLevel).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-team-line text-purple-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Team Assigned"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.filter(e=>e.assignedTeamName).length})]})]})})]}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:I.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsxs("div",{className:"relative",children:[I.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),I.jsx("input",{type:"text",placeholder:"Search incidents...",value:u,onChange:e=>m(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),I.jsxs("select",{value:h,onChange:e=>x(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"all",children:"All Status"}),I.jsx("option",{value:"pending",children:"Pending"}),I.jsx("option",{value:"in_progress",children:"In Progress"}),I.jsx("option",{value:"resolved",children:"Resolved"}),I.jsx("option",{value:"closed",children:"Closed"})]}),I.jsxs("select",{value:g,onChange:e=>f(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"all",children:"All Priority"}),I.jsx("option",{value:"low",children:"Low"}),I.jsx("option",{value:"medium",children:"Medium"}),I.jsx("option",{value:"high",children:"High"}),I.jsx("option",{value:"critical",children:"Critical"})]})]}),I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("label",{className:"text-sm font-medium text-gray-700",children:"From:"}),I.jsx("input",{type:"date",value:p,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("label",{className:"text-sm font-medium text-gray-700",children:"To:"}),I.jsx("input",{type:"date",value:y,onChange:e=>v(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(p||y)&&I.jsx("button",{onClick:()=>{b(""),v("")},className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Clear Dates"})]}),I.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",ie.length," of ",t.length," incidents"]})]})}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:I.jsx("div",{className:"divide-y divide-gray-200",children:ie.map(e=>I.jsx("div",{className:"p-6 hover:bg-gray-50",children:I.jsxs("div",{className:"flex items-start justify-between",children:[I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[I.jsxs("h4",{className:"text-lg font-medium text-gray-900",children:[ne(e.type)," - #",e.id]}),I.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${le(e.priorityLevel)}`,children:e.priorityLevel.toUpperCase()}),I.jsxs("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${"rejected"===e.validationStatus&&"closed"===e.status?"bg-red-100 text-red-800 border border-red-200":oe(e.status)}`,children:[e.status.replace("_"," ").toUpperCase(),"rejected"===e.validationStatus&&"closed"===e.status&&I.jsx("span",{className:"ml-1 text-xs",children:"(Rejected)"})]})]}),I.jsx("p",{className:"text-gray-600 mb-3",children:e.description}),I.jsxs("div",{className:"flex items-center text-sm text-gray-500 space-x-4",children:[I.jsxs("span",{children:[I.jsx("i",{className:"ri-map-pin-line mr-1"}),e.location]}),I.jsxs("span",{children:[I.jsx("i",{className:"ri-user-line mr-1"}),"Reported by: ",e.reportedBy]}),I.jsxs("span",{children:[I.jsx("i",{className:"ri-time-line mr-1"}),new Date(e.dateReported).toLocaleString()]}),e.allAssignedTeams&&I.jsxs("span",{className:"text-green-600",children:[I.jsx("i",{className:"ri-team-line mr-1"}),"Teams: ",e.allAssignedTeams,(()=>{const t=(e.assignedTeamIds?e.assignedTeamIds.split(",").map(e=>parseInt(e.trim())):[]).reduce((e,t)=>{const s=r.find(e=>e.id===t);return e+(s?.member_count||0)},0);return t>0?` (${t} total members)`:""})()]}),e.assignedTeamName&&!e.allAssignedTeams&&I.jsxs("span",{className:"text-green-600",children:[I.jsx("i",{className:"ri-team-line mr-1"}),"Team: ",e.assignedTeamName,(()=>{const t=r.find(t=>t.name===e.assignedTeamName);return t?` (${t.member_count} members)`:""})()]}),e.assignedStaffName&&I.jsxs("span",{className:"text-purple-600",children:[I.jsx("i",{className:"ri-user-line mr-1"}),"Staff: ",e.assignedStaffName]}),!e.assignedTeamName&&!e.assignedStaffName&&e.assignedTo&&I.jsxs("span",{children:[I.jsx("i",{className:"ri-team-line mr-1"}),"Assigned to: ",e.assignedTo]})]})]}),I.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[I.jsxs("button",{onClick:()=>{N(e),S(!0)},className:"px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-lg hover:bg-blue-200 transition-colors",children:[I.jsx("i",{className:"ri-eye-line mr-1"}),"View"]}),I.jsxs("button",{onClick:()=>{N(e),z(e.validationNotes||""),U(!0)},className:"px-3 py-1 text-sm rounded-lg transition-colors "+("validated"===e.validationStatus?"bg-orange-100 text-orange-700 hover:bg-orange-200":"rejected"===e.validationStatus?"bg-red-100 text-red-700 hover:bg-red-200":"bg-yellow-100 text-yellow-700 hover:bg-yellow-200"),title:"validated"===e.validationStatus?"Update Validation":"rejected"===e.validationStatus?"Update Rejection":"Validate Incident",children:[I.jsx("i",{className:"ri-check-double-line mr-1"}),"validated"===e.validationStatus||"rejected"===e.validationStatus?"Update":"Validate"]}),"validated"===e.validationStatus&&I.jsx(I.Fragment,{children:I.jsxs("button",{onClick:()=>((e,t)=>{N(e),_(t);{const t=e.assignedTeamIds?e.assignedTeamIds.split(",").map(e=>parseInt(e.trim())).filter(e=>!isNaN(e)):[];E(t),P(null)}O(e.assignedStaffId||null),R(null),C(!0)})(e,"teams"),className:"px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-lg hover:bg-blue-200 transition-colors relative group",title:"Assign Multiple Teams - All team members will receive email notifications",children:[I.jsx("i",{className:"ri-team-fill mr-1"}),"Assign Teams",I.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10",children:[I.jsx("i",{className:"ri-mail-line mr-1"}),"Multiple teams support",I.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800"})]})]})})]})]})},e.id))})}),w&&j&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[I.jsx("div",{className:"p-6 border-b border-gray-200",children:I.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Incident Details - #",j.id]})}),I.jsxs("div",{className:"p-6 space-y-4",children:[I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),I.jsx("p",{className:"text-sm text-gray-900",children:ne(j.type)})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Priority"}),I.jsx("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full border ${le(j.priorityLevel)}`,children:j.priorityLevel.toUpperCase()})]})]}),I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Safety Status"}),I.jsx("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full ${(e=>{switch(e){case"safe":return"bg-green-100 text-green-800";case"at_risk":return"bg-yellow-100 text-yellow-800";case"injured":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(j.safetyStatus)}`,children:j.safetyStatus.replace("_"," ").toUpperCase()})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Validation Status"}),I.jsx("span",{className:"inline-block px-2 py-1 text-xs font-medium rounded-full "+("validated"===j.validationStatus?"bg-green-100 text-green-800 border border-green-200":"rejected"===j.validationStatus?"bg-red-100 text-red-800 border border-red-200":"bg-yellow-100 text-yellow-800 border border-yellow-200"),children:j.validationStatus.charAt(0).toUpperCase()+j.validationStatus.slice(1)})]})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),I.jsx("p",{className:"text-sm text-gray-900",children:j.description})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),I.jsx("p",{className:"text-sm text-gray-900",children:j.location})]}),I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Latitude"}),I.jsx("p",{className:"text-sm text-gray-900",children:j.latitude})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Longitude"}),I.jsx("p",{className:"text-sm text-gray-900",children:j.longitude})]})]}),I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reported By"}),I.jsx("p",{className:"text-sm text-gray-900",children:j.reportedBy}),j.reporterPhone&&I.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[I.jsx("i",{className:"ri-phone-line mr-1"}),j.reporterPhone]})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Assigned Teams"}),I.jsx("p",{className:"text-sm text-gray-900",children:j.allAssignedTeams?I.jsx("span",{className:"text-green-600",children:j.allAssignedTeams}):j.assignedTeamName?I.jsx("span",{className:"text-green-600",children:j.assignedTeamName}):"Not assigned"})]})]}),I.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[I.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Team Information"}),I.jsx("div",{className:"space-y-3",children:j.assignedStaffName?(()=>{const e=i.find(e=>e.id===j.assignedStaffId);if(e&&e.team_id){const t=r.find(t=>t.id===e.team_id),s=i.filter(t=>t.team_id===e.team_id);return I.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center mb-3",children:[I.jsx("i",{className:"ri-team-line text-purple-600 mr-2"}),I.jsx("span",{className:"font-medium text-purple-800",children:"Assigned Staff & Team"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Assigned Staff:"}),I.jsx("span",{className:"ml-2 font-medium text-purple-700",children:j.assignedStaffName})]}),e&&I.jsxs(I.Fragment,{children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Position:"}),I.jsx("span",{className:"ml-2 font-medium text-purple-700",children:e.position})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Department:"}),I.jsx("span",{className:"ml-2 font-medium text-purple-700",children:e.department})]})]}),t&&I.jsxs("div",{children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Team:"}),I.jsx("span",{className:"ml-2 font-medium text-purple-700",children:t.name})]}),s.length>0&&I.jsxs("div",{children:[I.jsxs("span",{className:"text-gray-600 text-sm",children:["Active Team Members (",s.length,"):"]}),I.jsx("div",{className:"mt-1 space-y-1",children:s.map(e=>I.jsxs("div",{className:"text-purple-700 ml-2 flex items-center",children:[I.jsx("span",{className:"w-2 h-2 bg-purple-400 rounded-full mr-2"}),e.name," - ",e.position,e.id===j.assignedStaffId&&I.jsx("span",{className:"ml-2 text-xs bg-purple-200 text-purple-800 px-2 py-1 rounded",children:"Assigned"})]},e.id))})]})]})]})}return I.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center mb-3",children:[I.jsx("i",{className:"ri-user-line text-purple-600 mr-2"}),I.jsx("span",{className:"font-medium text-purple-800",children:"Assigned Staff"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Assigned Staff:"}),I.jsx("span",{className:"ml-2 font-medium text-purple-700",children:j.assignedStaffName})]}),e&&I.jsxs(I.Fragment,{children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Position:"}),I.jsx("span",{className:"ml-2 font-medium text-purple-700",children:e.position})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Department:"}),I.jsx("span",{className:"ml-2 font-medium text-purple-700",children:e.department})]})]}),I.jsx("div",{className:"text-gray-500 text-sm",children:"No team assignment found for this staff member"})]})]})})():j.allAssignedTeams?I.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center mb-2",children:[I.jsx("i",{className:"ri-team-fill text-blue-600 mr-2"}),I.jsx("span",{className:"font-medium text-blue-800",children:"Multiple Team Assignment"})]}),I.jsxs("div",{className:"space-y-3",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Assigned Teams:"}),I.jsx("span",{className:"ml-2 font-medium text-blue-700",children:j.allAssignedTeams})]}),(()=>{const e=j.assignedTeamIds?j.assignedTeamIds.split(",").map(e=>parseInt(e.trim())):[],t=e.reduce((e,t)=>{const s=r.find(e=>e.id===t);return e+(s?.member_count||0)},0);return I.jsxs(I.Fragment,{children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Total Teams:"}),I.jsx("span",{className:"ml-2 font-medium text-blue-700",children:e.length})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Total Members:"}),I.jsx("span",{className:"ml-2 font-medium text-blue-700",children:t})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Team Details:"}),e.map(e=>{const t=r.find(t=>t.id===e),s=t?i.filter(t=>t.team_id===e):[];return t?I.jsxs("div",{className:"ml-4 p-2 bg-white rounded border border-blue-100",children:[I.jsx("div",{className:"font-medium text-blue-800",children:t.name}),I.jsx("div",{className:"text-xs text-blue-600",children:t.description||"No description"}),I.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[s.length," active members"]})]},e):null})]})]})})()]})]}):j.assignedTeamName?I.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center mb-2",children:[I.jsx("i",{className:"ri-team-line text-green-600 mr-2"}),I.jsx("span",{className:"font-medium text-green-800",children:"Direct Team Assignment"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Team Name:"}),I.jsx("span",{className:"ml-2 font-medium text-green-700",children:j.assignedTeamName})]}),(()=>{const e=r.find(e=>e.name===j.assignedTeamName),t=e?i.filter(t=>t.team_id===e.id):[];return e?I.jsxs(I.Fragment,{children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-gray-600 text-sm",children:"Description:"}),I.jsx("span",{className:"ml-2 font-medium text-green-700",children:e.description||"No description available"})]}),t.length>0&&I.jsxs("div",{children:[I.jsxs("span",{className:"text-gray-600 text-sm",children:["Team Members (",t.length,"):"]}),I.jsx("div",{className:"mt-1 space-y-1",children:t.map(e=>I.jsxs("div",{className:"text-green-700 ml-2 flex items-center",children:[I.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full mr-2"}),e.name," - ",e.position]},e.id))})]})]}):null})()]})]}):j.assignedTo?I.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center mb-2",children:[I.jsx("i",{className:"ri-team-line text-blue-600 mr-2"}),I.jsx("span",{className:"font-medium text-blue-800",children:"Legacy Assignment"})]}),I.jsxs("div",{className:"text-sm",children:[I.jsx("span",{className:"text-gray-600",children:"Assigned to:"}),I.jsx("span",{className:"ml-2 font-medium text-blue-700",children:j.assignedTo})]})]}):I.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-user-line text-gray-400 mr-2"}),I.jsx("span",{className:"text-gray-600",children:"No staff member assigned"})]})})})]}),j.attachment&&I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attachments"}),I.jsx("div",{className:"space-y-2",children:j.attachment.split(",").map((e,t)=>I.jsxs("div",{className:"flex items-center p-2 bg-gray-50 rounded-lg border border-gray-200",children:[I.jsx("i",{className:"ri-file-line text-gray-500 mr-2"}),I.jsx("span",{className:"text-sm text-gray-700 flex-1",children:e}),I.jsxs("a",{href:`/uploads/incidents/${e}`,target:"_blank",rel:"noopener noreferrer",className:"px-3 py-1 bg-blue-100 text-blue-700 text-xs rounded hover:bg-blue-200 transition-colors",children:[I.jsx("i",{className:"ri-eye-line mr-1"}),"View"]})]},t))})]}),I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date Reported"}),I.jsx("p",{className:"text-sm text-gray-900",children:new Date(j.dateReported).toLocaleString()})]}),j.dateResolved&&I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date Resolved"}),I.jsx("p",{className:"text-sm text-gray-900",children:new Date(j.dateResolved).toLocaleString()})]})]})]}),I.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[I.jsx("button",{onClick:()=>S(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"}),I.jsxs("button",{onClick:()=>Z(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[I.jsx("i",{className:"ri-map-pin-line mr-2"}),"View on Map"]})]})]})}),k&&j&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",onClick:ae,children:I.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[I.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[I.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Assign ","team"===$?"Team":"teams"===$?"Teams":"Staff"," to Incident #",j.id]}),I.jsx("button",{onClick:ae,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:D,children:I.jsx("i",{className:"ri-close-line text-xl"})})]}),I.jsx("div",{className:"p-6 space-y-4",children:"team"===$?I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Team"}),I.jsxs("select",{value:A||"",onChange:e=>P(e.target.value?Number(e.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"",children:"No Team Assigned"}),r.filter(e=>e.member_count>0).map(e=>I.jsxs("option",{value:e.id,children:[e.name," (",e.member_count," members)"]},e.id)),r.filter(e=>0===e.member_count).length>0&&I.jsx("optgroup",{label:"Teams with no members (disabled)",children:r.filter(e=>0===e.member_count).map(e=>I.jsxs("option",{value:e.id,disabled:!0,className:"text-gray-400",children:[e.name," (0 members) - Add members first"]},e.id))})]}),A&&I.jsxs("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[I.jsxs("div",{className:"flex items-center mb-2",children:[I.jsx("i",{className:"ri-team-line text-blue-600 mr-2"}),I.jsx("span",{className:"font-medium text-blue-800",children:"Team Details"})]}),(()=>{const e=r.find(e=>e.id===A);return e?I.jsxs("div",{className:"text-sm text-blue-700",children:[I.jsxs("p",{children:[I.jsx("strong",{children:"Name:"})," ",e.name]}),I.jsxs("p",{children:[I.jsx("strong",{children:"Description:"})," ",e.description||"No description"]}),I.jsxs("p",{children:[I.jsx("strong",{children:"Active Members:"})," ",e.member_count]}),0===e.member_count?I.jsxs("div",{className:"mt-2 p-2 bg-red-50 rounded border border-red-200",children:[I.jsxs("div",{className:"flex items-center text-red-700",children:[I.jsx("i",{className:"ri-error-warning-line mr-1"}),I.jsx("span",{className:"font-medium",children:"Warning:"})]}),I.jsx("p",{className:"text-xs text-red-600 mt-1",children:"This team has no active members. Email notifications cannot be sent and the team may not be able to respond effectively."})]}):I.jsxs("p",{className:"mt-2 text-blue-600",children:[I.jsx("i",{className:"ri-mail-line mr-1"}),"All ",e.member_count," team members will receive email notifications when assigned."]})]}):null})()]}),I.jsx("div",{className:"mt-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200",children:I.jsxs("div",{className:"flex items-start",children:[I.jsx("div",{className:"flex-shrink-0",children:I.jsx("i",{className:"ri-mail-send-line text-green-600 text-lg"})}),I.jsxs("div",{className:"ml-3",children:[I.jsx("h4",{className:"text-sm font-semibold text-green-800 mb-2",children:"Automatic Email Notifications"}),I.jsxs("div",{className:"space-y-2 text-sm text-green-700",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-check-line text-green-600 mr-2"}),I.jsx("span",{children:"All active team members receive detailed incident information"})]}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-check-line text-green-600 mr-2"}),I.jsx("span",{children:"Email includes incident type, location, priority level, and description"})]}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-check-line text-green-600 mr-2"}),I.jsx("span",{children:"Direct link to incident dashboard for immediate response"})]})]}),I.jsx("div",{className:"mt-3 p-2 bg-green-100 rounded border border-green-200",children:I.jsxs("div",{className:"text-xs text-green-600",children:[I.jsx("i",{className:"ri-information-line mr-1"}),I.jsx("strong",{children:"Note:"})," Only teams with active members will receive notifications. Teams with no members are automatically excluded."]})})]})]})})]}):"teams"===$?I.jsxs("div",{children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select Teams (Multiple Selection)"}),L.length>0&&I.jsxs("button",{onClick:()=>E([]),className:"text-sm text-red-600 hover:text-red-800 flex items-center",children:[I.jsx("i",{className:"ri-close-line mr-1"}),"Clear All"]})]}),r.filter(e=>e.member_count>0).length>0&&I.jsx("div",{className:"mb-3",children:I.jsxs("button",{onClick:()=>{const e=r.filter(e=>e.member_count>0).map(e=>e.id);E(e)},className:"text-sm text-blue-600 hover:text-blue-800 flex items-center",children:[I.jsx("i",{className:"ri-checkbox-multiple-line mr-1"}),"Select All Teams with Members"]})}),I.jsxs("div",{className:"max-h-60 overflow-y-auto border border-gray-300 rounded-lg",children:[r.filter(e=>e.member_count>0).map(e=>I.jsxs("div",{className:"flex items-center p-3 hover:bg-gray-50 border-b border-gray-200 last:border-b-0 transition-colors",children:[I.jsx("input",{type:"checkbox",id:`team-${e.id}`,checked:L.includes(e.id),onChange:t=>{t.target.checked?E([...L,e.id]):E(L.filter(t=>t!==e.id))},className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),I.jsxs("label",{htmlFor:`team-${e.id}`,className:"flex-1 cursor-pointer",children:[I.jsxs("div",{className:"font-medium text-gray-900 flex items-center",children:[e.name,I.jsxs("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.member_count," member",1!==e.member_count?"s":""]})]}),I.jsx("div",{className:"text-sm text-gray-600 mt-1",children:e.description||"No description available"})]})]},e.id)),r.filter(e=>0===e.member_count).length>0&&I.jsxs("div",{className:"p-3 bg-gray-50 border-t border-gray-200",children:[I.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Teams with no members (disabled)"}),r.filter(e=>0===e.member_count).map(e=>I.jsxs("div",{className:"flex items-center p-2 text-gray-400",children:[I.jsx("input",{type:"checkbox",disabled:!0,className:"mr-3 h-4 w-4"}),I.jsxs("div",{className:"flex-1",children:[I.jsx("div",{className:"font-medium",children:e.name}),I.jsx("div",{className:"text-xs",children:"0 members - Add members first"})]})]},e.id))]})]}),L.length>0&&I.jsxs("div",{className:"mt-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-team-fill text-blue-600 mr-2"}),I.jsxs("span",{className:"font-medium text-blue-800",children:["Selected Teams (",L.length,")"]})]}),I.jsxs("div",{className:"text-sm text-blue-600 font-medium",children:[L.reduce((e,t)=>{const s=r.find(e=>e.id===t);return e+(s?.member_count||0)},0)," total members"]})]}),I.jsxs("div",{className:"space-y-2",children:[L.map(e=>{const t=r.find(t=>t.id===e);return t?I.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border border-blue-100",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-team-line text-blue-500 mr-2"}),I.jsx("span",{className:"text-sm font-medium text-blue-800",children:t.name}),I.jsxs("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:[t.member_count," member",1!==t.member_count?"s":""]})]}),I.jsx("button",{onClick:()=>E(L.filter(t=>t!==e)),className:"text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-50 transition-colors",title:"Remove team",children:I.jsx("i",{className:"ri-close-line text-sm"})})]},e):null}),I.jsx("div",{className:"mt-3 p-2 bg-blue-100 rounded border border-blue-200",children:I.jsxs("div",{className:"flex items-center text-xs text-blue-700",children:[I.jsx("i",{className:"ri-mail-line mr-1"}),I.jsx("span",{className:"font-medium",children:"Email Notifications:"}),I.jsxs("span",{className:"ml-1",children:["All ",L.reduce((e,t)=>{const s=r.find(e=>e.id===t);return e+(s?.member_count||0)},0)," team members will receive incident assignment notifications"]})]})})]})]})]}):"pending"===j.status?I.jsxs("div",{className:"p-4 bg-red-50 rounded-lg border border-red-200",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-error-warning-line text-red-600 mr-2"}),I.jsx("span",{className:"font-medium text-red-800",children:"Staff Assignment Not Available"})]}),I.jsx("p",{className:"text-sm text-red-700 mt-1",children:'Staff assignments are not available for pending incidents. Please assign a team first or change the incident status to "In Progress".'})]}):I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Staff Member"}),I.jsxs("select",{value:T||"",onChange:e=>O(e.target.value?Number(e.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"",children:"No Staff Assigned"}),i.filter(e=>"active"===e.status||1===e.status).sort((e,t)=>e.name.localeCompare(t.name)).map(e=>I.jsxs("option",{value:e.id,children:[e.name," - ",e.position,e.team_name&&` (${e.team_name})`]},e.id))]}),I.jsxs("p",{className:"text-sm text-blue-600 mt-2",children:[I.jsx("i",{className:"ri-mail-line mr-1"}),"The selected staff member will receive an email notification when assigned."]})]})}),I.jsxs("div",{className:"p-6 border-t border-gray-200",children:[F&&I.jsxs("div",{className:"mb-4 p-3 rounded-lg "+(F.sent?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"mr-2 "+(F.sent?"ri-check-line":"ri-error-warning-line")}),I.jsx("span",{className:"font-medium",children:F.sent?"Email notifications sent successfully!":"Failed to send email notifications"})]}),F.details&&I.jsx("div",{className:"mt-2 text-sm",children:F.sent?I.jsxs("div",{children:[F.details.teamName&&I.jsxs("div",{className:"mb-1",children:[I.jsx("span",{className:"font-medium",children:"Team:"})," ",F.details.teamName]}),F.details.staffName&&I.jsxs("div",{className:"mb-1",children:[I.jsx("span",{className:"font-medium",children:"Staff:"})," ",F.details.staffName]}),void 0!==F.details.totalMembers&&I.jsxs("div",{className:"mb-1",children:[I.jsx("span",{className:"font-medium",children:"Total Team Members:"})," ",F.details.totalMembers]}),void 0!==F.details.emailsSent&&I.jsxs("div",{className:"mb-1",children:[I.jsx("span",{className:"font-medium",children:"Emails Sent Successfully:"})," ",F.details.emailsSent]}),F.details.emailsFailed>0&&I.jsxs("div",{className:"mb-1 text-orange-600",children:[I.jsx("span",{className:"font-medium",children:"Failed Emails:"})," ",F.details.emailsFailed]}),F.details.failedEmails&&F.details.failedEmails.length>0&&I.jsxs("div",{className:"mt-2 p-2 bg-orange-50 rounded border border-orange-200",children:[I.jsx("div",{className:"font-medium text-orange-800 mb-1",children:"Failed Email Addresses:"}),I.jsx("div",{className:"text-xs text-orange-700",children:F.details.failedEmails.join(", ")})]}),F.details.teamName&&F.details.emailsSent>0&&I.jsxs("div",{className:"mt-2 p-2 bg-green-50 rounded border border-green-200",children:[I.jsxs("div",{className:"font-medium text-green-800 mb-1",children:[I.jsx("i",{className:"ri-mail-line mr-1"}),"Team Notification Summary"]}),I.jsxs("div",{className:"text-xs text-green-700",children:["All ",F.details.emailsSent,' active team members of "',F.details.teamName,'" have been notified about this incident assignment.']})]})]}):I.jsxs("div",{children:[I.jsx("div",{className:"font-medium mb-1",children:"Error Details:"}),I.jsx("div",{className:"text-red-700",children:F.details.error||"Unknown error occurred"}),F.details.teamName&&I.jsxs("div",{className:"mt-1",children:[I.jsx("span",{className:"font-medium",children:"Team:"})," ",F.details.teamName]}),F.details.staffName&&I.jsxs("div",{className:"mt-1",children:[I.jsx("span",{className:"font-medium",children:"Staff:"})," ",F.details.staffName]})]})})]}),I.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[I.jsx("div",{className:"text-sm text-gray-500",children:"teams"===$&&L.length>0&&I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-information-line mr-1"}),I.jsxs("span",{children:[L.length," team",1!==L.length?"s":""," selected •",L.reduce((e,t)=>{const s=r.find(e=>e.id===t);return e+(s?.member_count||0)},0)," total members"]})]})}),I.jsxs("div",{className:"flex space-x-3",children:[I.jsxs("button",{onClick:ae,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors flex items-center",disabled:D,children:[I.jsx("i",{className:"ri-close-line mr-1"}),"Cancel"]}),I.jsx("button",{onClick:()=>{if(j)if("team"===$){const t=r.find(e=>e.id===A);if(t&&0===t.member_count)return void e({type:"error",message:"Cannot assign team with no members. Please add members to the team first."});(async(t,a)=>{try{M(!0),R(null);const n=await Me(t,a);if(s(e=>e.map(e=>{if(e.id===t){const t=r.find(e=>e.id===a);return{...e,assignedTeamId:a,assignedTeamName:t?.name||void 0,assignedStaffId:void 0,assignedStaffName:void 0}}return e})),n?.emailSent){R({sent:!0,details:n.emailDetails});const t=r.find(e=>e.id===a);e({type:"success",message:`Team "${t?.name||"Unknown"}" assigned successfully!`})}else R({sent:!1,details:n.emailDetails||{error:"No email details provided"}});setTimeout(()=>{ae()},2e3)}catch(n){n instanceof Error&&n.message.includes("Cannot assign team with no active members")?R({sent:!1,details:{error:"Cannot assign team with no active members. Please add members to the team first.",teamName:"Selected Team"}}):R({sent:!1,details:{error:n instanceof Error?n.message:"Unknown error"}})}finally{M(!1)}})(j.id,A)}else if("teams"===$){const t=L.filter(e=>{const t=r.find(t=>t.id===e);return 0===t?.member_count});if(t.length>0)return void e({type:"error",message:"Cannot assign teams with no members. Please add members to the teams first."});(async(t,a)=>{try{M(!0),R(null);const n=await Be(t,a);if(s(e=>e.map(e=>{if(e.id===t){const t=r.filter(e=>a.includes(e.id));return{...e,assignedTeamIds:a.join(","),allAssignedTeams:t.map(e=>e.name).join(", "),assignedTeamId:a[0]||void 0,assignedTeamName:t[0]?.name||void 0,assignedStaffId:void 0,assignedStaffName:void 0}}return e})),n?.emailSent){R({sent:!0,details:n.emailDetails});const t=r.filter(e=>a.includes(e.id));e({type:"success",message:`${t.length} teams assigned successfully!`})}else R({sent:!1,details:n.emailDetails||{error:"No email details provided"}});setTimeout(()=>{ae()},2e3)}catch(n){n instanceof Error&&n.message.includes("Cannot assign teams with no active members")?R({sent:!1,details:{error:"Cannot assign teams with no active members. Please add members to the teams first.",teamNames:"Selected Teams"}}):R({sent:!1,details:{error:n instanceof Error?n.message:"Unknown error"}})}finally{M(!1)}})(j.id,L)}else(async(t,r)=>{try{M(!0),R(null);const a=await Ue(t,r);if(s(e=>e.map(e=>{if(e.id===t){const t=i.find(e=>e.id===r);return{...e,assignedStaffId:r,assignedStaffName:t?.name||void 0,assignedTeamId:void 0,assignedTeamName:void 0}}return e})),a?.emailSent){R({sent:!0,details:a.emailDetails});const t=i.find(e=>e.id===r);e({type:"success",message:`Staff member "${t?.name||"Unknown"}" assigned successfully!`})}else R({sent:!1,details:a.emailDetails||{error:"No email details provided"}});setTimeout(()=>{ae()},2e3)}catch(a){R({sent:!1,details:{error:a instanceof Error?a.message:"Unknown error"}})}finally{M(!1)}})(j.id,T)},disabled:X(),className:"px-6 py-2 rounded-lg transition-colors flex items-center font-medium "+(X()?"bg-gray-400 text-gray-200 cursor-not-allowed":"teams"===$&&0===L.length?"bg-orange-600 text-white hover:bg-orange-700":"bg-blue-600 text-white hover:bg-blue-700"),title:X()?"staff"===$&&"pending"===j?.status?"Staff assignment not available for pending incidents":"teams"===$&&L.some(e=>0===r.find(t=>t.id===e)?.member_count)?"Cannot assign teams with no members":"team"===$&&A&&0===r.find(e=>e.id===A)?.member_count?"Cannot assign team with no members":"Please select a team or staff member":"team"===$?A?"Assign selected team":"Unassign team":"teams"===$?L.length>0?`Assign ${L.length} teams`:"Clear all team assignments":"Assign selected staff member",children:D?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Assigning..."]}):I.jsx(I.Fragment,{children:"team"===$?A?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-team-line mr-1"}),"Assign Team"]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-team-line mr-1"}),"Unassign Team"]}):"teams"===$?L.length>0?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-team-fill mr-1"}),"Assign Teams (",L.length,")"]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-delete-bin-line mr-1"}),"Clear All Teams"]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-user-line mr-1"}),"Assign Staff"]})})})]})]})]})]})}),B&&j&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[I.jsx("div",{className:"p-6 border-b border-gray-200",children:I.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["validated"===j.validationStatus?"Update Validation":"Validate"," Incident #",j.id]})}),I.jsxs("div",{className:"p-6 space-y-4",children:[I.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-information-line text-blue-600 mr-2"}),I.jsx("span",{className:"text-sm font-medium text-blue-800",children:"validated"===j.validationStatus?"Update Validation":"Validation Required"})]}),I.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"validated"===j.validationStatus?"You can update the validation status or modify the validation notes for this incident.":"Please validate this incident before proceeding with team assignment. Note: Rejected incidents will be marked as closed."})]}),"validated"===j.validationStatus&&I.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"ri-check-line text-green-600 mr-2"}),I.jsx("span",{className:"text-sm font-medium text-green-800",children:"Currently Validated"})]}),I.jsx("p",{className:"text-sm text-green-700 mt-1",children:"This incident is currently validated. You can update the validation status or modify the notes."})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Validation Notes ",I.jsx("span",{className:"text-red-600",children:"*"})]}),"validated"===j.validationStatus&&j.validationNotes&&I.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[I.jsx("div",{className:"text-sm text-gray-600 mb-1",children:I.jsx("strong",{children:"Current Notes:"})}),I.jsx("div",{className:"text-sm text-gray-700",children:j.validationNotes})]}),I.jsx("textarea",{value:q,onChange:e=>z(e.target.value),placeholder:"validated"===j.validationStatus?"Update validation notes...":"Enter notes about the validation decision (required)...",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 "+(q.trim()?"border-gray-300":"border-red-300"),rows:3}),!q.trim()&&I.jsxs("p",{className:"mt-1 text-sm text-red-600",children:[I.jsx("i",{className:"ri-error-warning-line mr-1"}),"Validation notes are required"]})]})]}),I.jsx("div",{className:"p-6 border-t border-gray-200",children:I.jsxs("div",{className:"flex justify-end space-x-3",children:[I.jsx("button",{onClick:()=>{U(!1),z("")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),I.jsx("button",{onClick:()=>re(j.id,"rejected",q),disabled:W||!q.trim(),className:"px-4 py-2 rounded-lg transition-colors "+(W||!q.trim()?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"),title:q.trim()?"":"Validation notes are required",children:W?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"validated"===j.validationStatus?"Change to Rejected":"Reject"}),I.jsx("button",{onClick:()=>re(j.id,"validated",q),disabled:W||!q.trim(),className:"px-4 py-2 rounded-lg transition-colors "+(W||!q.trim()?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),title:q.trim()?"":"Validation notes are required",children:W?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"validated"===j.validationStatus?"Update Validation":"Validate"})]})})]})}),I.jsx(Lx,{open:J,onClose:()=>K(!1),onExportPDF:async()=>{if(0!==ie.length){G(!0);try{let e="Incidents Report";const t=[];if(u&&u.trim()&&t.push(`Search: "${u.trim()}"`),h&&"all"!==h&&t.push(`Status: ${h.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())}`),g&&"all"!==g&&t.push(`Priority: ${g.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())}`),p||y){let e="";p&&y?e=`${p} to ${y}`:p?e=`From ${p}`:y&&(e=`Until ${y}`),t.push(`Date: ${e}`)}t.length>0&&(e+=" ("+t.join(", ")+")");const s={filename:"incidents_report",title:e,includeTimestamp:!0};await Px.exportToPDF(ie,zx,s)}catch(e){}finally{G(!1)}}},onExportCSV:()=>{Px.exportToCSV(ie,zx,{filename:"incidents_export",title:"Incidents Report",includeTimestamp:!0}),e({type:"success",message:"Incidents data exported to CSV successfully"}),K(!1)},onExportExcel:()=>{Px.exportToExcel(ie,zx,{filename:"incidents_export",title:"Incidents Report",includeTimestamp:!0}),e({type:"success",message:"Incidents data exported to Excel successfully"}),K(!1)},data:ie,columns:zx.map(e=>({key:e.key,label:e.label})),title:`Incidents Report (${ie.length})`}),I.jsx(qx,{isOpen:Y,onClose:()=>Z(!1),incident:j})]})};function Vx(e,t){return function(){return e.apply(t,arguments)}}const{toString:Hx}=Object.prototype,{getPrototypeOf:Gx}=Object,{iterator:Jx,toStringTag:Kx}=Symbol,Yx=(e=>t=>{const s=Hx.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),Zx=e=>(e=e.toLowerCase(),t=>Yx(t)===e),Xx=e=>t=>typeof t===e,{isArray:Qx}=Array,eg=Xx("undefined");function tg(e){return null!==e&&!eg(e)&&null!==e.constructor&&!eg(e.constructor)&&ag(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const sg=Zx("ArrayBuffer");const rg=Xx("string"),ag=Xx("function"),ng=Xx("number"),ig=e=>null!==e&&"object"==typeof e,lg=e=>{if("object"!==Yx(e))return!1;const t=Gx(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Kx in e||Jx in e)},og=Zx("Date"),dg=Zx("File"),cg=Zx("Blob"),ug=Zx("FileList"),mg=Zx("URLSearchParams"),[hg,xg,gg,fg]=["ReadableStream","Request","Response","Headers"].map(Zx);function pg(e,t,{allOwnKeys:s=!1}={}){if(null==e)return;let r,a;if("object"!=typeof e&&(e=[e]),Qx(e))for(r=0,a=e.length;r<a;r++)t.call(null,e[r],r,e);else{if(tg(e))return;const a=s?Object.getOwnPropertyNames(e):Object.keys(e),n=a.length;let i;for(r=0;r<n;r++)i=a[r],t.call(null,e[i],i,e)}}function bg(e,t){if(tg(e))return null;t=t.toLowerCase();const s=Object.keys(e);let r,a=s.length;for(;a-- >0;)if(r=s[a],t===r.toLowerCase())return r;return null}const yg="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,vg=e=>!eg(e)&&e!==yg;const jg=(e=>t=>e&&t instanceof e)("undefined"!=typeof Uint8Array&&Gx(Uint8Array)),Ng=Zx("HTMLFormElement"),wg=(({hasOwnProperty:e})=>(t,s)=>e.call(t,s))(Object.prototype),Sg=Zx("RegExp"),kg=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),r={};pg(s,(s,a)=>{let n;!1!==(n=t(s,a,e))&&(r[a]=n||s)}),Object.defineProperties(e,r)};const Cg=Zx("AsyncFunction"),$g=(_g="function"==typeof setImmediate,Ag=ag(yg.postMessage),_g?setImmediate:Ag?(Pg=`axios@${Math.random()}`,Lg=[],yg.addEventListener("message",({source:e,data:t})=>{e===yg&&t===Pg&&Lg.length&&Lg.shift()()},!1),e=>{Lg.push(e),yg.postMessage(Pg,"*")}):e=>setTimeout(e));var _g,Ag,Pg,Lg;const Eg="undefined"!=typeof queueMicrotask?queueMicrotask.bind(yg):"undefined"!=typeof process&&process.nextTick||$g,Tg={isArray:Qx,isArrayBuffer:sg,isBuffer:tg,isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||ag(e.append)&&("formdata"===(t=Yx(e))||"object"===t&&ag(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&sg(e.buffer),t},isString:rg,isNumber:ng,isBoolean:e=>!0===e||!1===e,isObject:ig,isPlainObject:lg,isEmptyObject:e=>{if(!ig(e)||tg(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(Nh){return!1}},isReadableStream:hg,isRequest:xg,isResponse:gg,isHeaders:fg,isUndefined:eg,isDate:og,isFile:dg,isBlob:cg,isRegExp:Sg,isFunction:ag,isStream:e=>ig(e)&&ag(e.pipe),isURLSearchParams:mg,isTypedArray:jg,isFileList:ug,forEach:pg,merge:function e(){const{caseless:t}=vg(this)&&this||{},s={},r=(r,a)=>{const n=t&&bg(s,a)||a;lg(s[n])&&lg(r)?s[n]=e(s[n],r):lg(r)?s[n]=e({},r):Qx(r)?s[n]=r.slice():s[n]=r};for(let a=0,n=arguments.length;a<n;a++)arguments[a]&&pg(arguments[a],r);return s},extend:(e,t,s,{allOwnKeys:r}={})=>(pg(t,(t,r)=>{s&&ag(t)?e[r]=Vx(t,s):e[r]=t},{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,s,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},toFlatObject:(e,t,s,r)=>{let a,n,i;const l={};if(t=t||{},null==e)return t;do{for(a=Object.getOwnPropertyNames(e),n=a.length;n-- >0;)i=a[n],r&&!r(i,e,t)||l[i]||(t[i]=e[i],l[i]=!0);e=!1!==s&&Gx(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},kindOf:Yx,kindOfTest:Zx,endsWith:(e,t,s)=>{e=String(e),(void 0===s||s>e.length)&&(s=e.length),s-=t.length;const r=e.indexOf(t,s);return-1!==r&&r===s},toArray:e=>{if(!e)return null;if(Qx(e))return e;let t=e.length;if(!ng(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=e[t];return s},forEachEntry:(e,t)=>{const s=(e&&e[Jx]).call(e);let r;for(;(r=s.next())&&!r.done;){const s=r.value;t.call(e,s[0],s[1])}},matchAll:(e,t)=>{let s;const r=[];for(;null!==(s=e.exec(t));)r.push(s);return r},isHTMLForm:Ng,hasOwnProperty:wg,hasOwnProp:wg,reduceDescriptors:kg,freezeMethods:e=>{kg(e,(t,s)=>{if(ag(e)&&-1!==["arguments","caller","callee"].indexOf(s))return!1;const r=e[s];ag(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")}))})},toObjectSet:(e,t)=>{const s={},r=e=>{e.forEach(e=>{s[e]=!0})};return Qx(e)?r(e):r(String(e).split(t)),s},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,s){return t.toUpperCase()+s}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:bg,global:yg,isContextDefined:vg,isSpecCompliantForm:function(e){return!!(e&&ag(e.append)&&"FormData"===e[Kx]&&e[Jx])},toJSONObject:e=>{const t=new Array(10),s=(e,r)=>{if(ig(e)){if(t.indexOf(e)>=0)return;if(tg(e))return e;if(!("toJSON"in e)){t[r]=e;const a=Qx(e)?[]:{};return pg(e,(e,t)=>{const n=s(e,r+1);!eg(n)&&(a[t]=n)}),t[r]=void 0,a}}return e};return s(e,0)},isAsyncFn:Cg,isThenable:e=>e&&(ig(e)||ag(e))&&ag(e.then)&&ag(e.catch),setImmediate:$g,asap:Eg,isIterable:e=>null!=e&&ag(e[Jx])};function Ig(e,t,s,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}Tg.inherits(Ig,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Tg.toJSONObject(this.config),code:this.code,status:this.status}}});const Og=Ig.prototype,Fg={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Fg[e]={value:e}}),Object.defineProperties(Ig,Fg),Object.defineProperty(Og,"isAxiosError",{value:!0}),Ig.from=(e,t,s,r,a,n)=>{const i=Object.create(Og);return Tg.toFlatObject(e,i,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),Ig.call(i,e.message,t,s,r,a),i.cause=e,i.name=e.name,n&&Object.assign(i,n),i};function Rg(e){return Tg.isPlainObject(e)||Tg.isArray(e)}function Dg(e){return Tg.endsWith(e,"[]")?e.slice(0,-2):e}function Mg(e,t,s){return e?e.concat(t).map(function(e,t){return e=Dg(e),!s&&t?"["+e+"]":e}).join(s?".":""):t}const Bg=Tg.toFlatObject(Tg,{},null,function(e){return/^is[A-Z]/.test(e)});function Ug(e,t,s){if(!Tg.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(s=Tg.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!Tg.isUndefined(t[e])})).metaTokens,a=s.visitor||d,n=s.dots,i=s.indexes,l=(s.Blob||"undefined"!=typeof Blob&&Blob)&&Tg.isSpecCompliantForm(t);if(!Tg.isFunction(a))throw new TypeError("visitor must be a function");function o(e){if(null===e)return"";if(Tg.isDate(e))return e.toISOString();if(Tg.isBoolean(e))return e.toString();if(!l&&Tg.isBlob(e))throw new Ig("Blob is not supported. Use a Buffer instead.");return Tg.isArrayBuffer(e)||Tg.isTypedArray(e)?l&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function d(e,s,a){let l=e;if(e&&!a&&"object"==typeof e)if(Tg.endsWith(s,"{}"))s=r?s:s.slice(0,-2),e=JSON.stringify(e);else if(Tg.isArray(e)&&function(e){return Tg.isArray(e)&&!e.some(Rg)}(e)||(Tg.isFileList(e)||Tg.endsWith(s,"[]"))&&(l=Tg.toArray(e)))return s=Dg(s),l.forEach(function(e,r){!Tg.isUndefined(e)&&null!==e&&t.append(!0===i?Mg([s],r,n):null===i?s:s+"[]",o(e))}),!1;return!!Rg(e)||(t.append(Mg(a,s,n),o(e)),!1)}const c=[],u=Object.assign(Bg,{defaultVisitor:d,convertValue:o,isVisitable:Rg});if(!Tg.isObject(e))throw new TypeError("data must be an object");return function e(s,r){if(!Tg.isUndefined(s)){if(-1!==c.indexOf(s))throw Error("Circular reference detected in "+r.join("."));c.push(s),Tg.forEach(s,function(s,n){!0===(!(Tg.isUndefined(s)||null===s)&&a.call(t,s,Tg.isString(n)?n.trim():n,r,u))&&e(s,r?r.concat(n):[n])}),c.pop()}}(e),t}function qg(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function zg(e,t){this._pairs=[],e&&Ug(e,this,t)}const Wg=zg.prototype;function Vg(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Hg(e,t,s){if(!t)return e;const r=s&&s.encode||Vg;Tg.isFunction(s)&&(s={serialize:s});const a=s&&s.serialize;let n;if(n=a?a(t,s):Tg.isURLSearchParams(t)?t.toString():new zg(t,s).toString(r),n){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e}Wg.append=function(e,t){this._pairs.push([e,t])},Wg.toString=function(e){const t=e?function(t){return e.call(this,t,qg)}:qg;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};class Gg{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!s&&s.synchronous,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Tg.forEach(this.handlers,function(t){null!==t&&e(t)})}}const Jg={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Kg={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:zg,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Yg="undefined"!=typeof window&&"undefined"!=typeof document,Zg="object"==typeof navigator&&navigator||void 0,Xg=Yg&&(!Zg||["ReactNative","NativeScript","NS"].indexOf(Zg.product)<0),Qg="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,ef=Yg&&window.location.href||"http://localhost",tf={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Yg,hasStandardBrowserEnv:Xg,hasStandardBrowserWebWorkerEnv:Qg,navigator:Zg,origin:ef},Symbol.toStringTag,{value:"Module"})),...Kg};function sf(e){function t(e,s,r,a){let n=e[a++];if("__proto__"===n)return!0;const i=Number.isFinite(+n),l=a>=e.length;if(n=!n&&Tg.isArray(r)?r.length:n,l)return Tg.hasOwnProp(r,n)?r[n]=[r[n],s]:r[n]=s,!i;r[n]&&Tg.isObject(r[n])||(r[n]=[]);return t(e,s,r[n],a)&&Tg.isArray(r[n])&&(r[n]=function(e){const t={},s=Object.keys(e);let r;const a=s.length;let n;for(r=0;r<a;r++)n=s[r],t[n]=e[n];return t}(r[n])),!i}if(Tg.isFormData(e)&&Tg.isFunction(e.entries)){const s={};return Tg.forEachEntry(e,(e,r)=>{t(function(e){return Tg.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),r,s,0)}),s}return null}const rf={transitional:Jg,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",r=s.indexOf("application/json")>-1,a=Tg.isObject(e);a&&Tg.isHTMLForm(e)&&(e=new FormData(e));if(Tg.isFormData(e))return r?JSON.stringify(sf(e)):e;if(Tg.isArrayBuffer(e)||Tg.isBuffer(e)||Tg.isStream(e)||Tg.isFile(e)||Tg.isBlob(e)||Tg.isReadableStream(e))return e;if(Tg.isArrayBufferView(e))return e.buffer;if(Tg.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let n;if(a){if(s.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Ug(e,new tf.classes.URLSearchParams,{visitor:function(e,t,s,r){return tf.isNode&&Tg.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)},...t})}(e,this.formSerializer).toString();if((n=Tg.isFileList(e))||s.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Ug(n?{"files[]":e}:e,t&&new t,this.formSerializer)}}return a||r?(t.setContentType("application/json",!1),function(e,t,s){if(Tg.isString(e))try{return(t||JSON.parse)(e),Tg.trim(e)}catch(Nh){if("SyntaxError"!==Nh.name)throw Nh}return(s||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||rf.transitional,s=t&&t.forcedJSONParsing,r="json"===this.responseType;if(Tg.isResponse(e)||Tg.isReadableStream(e))return e;if(e&&Tg.isString(e)&&(s&&!this.responseType||r)){const s=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(Nh){if(s){if("SyntaxError"===Nh.name)throw Ig.from(Nh,Ig.ERR_BAD_RESPONSE,this,null,this.response);throw Nh}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:tf.classes.FormData,Blob:tf.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Tg.forEach(["delete","get","head","post","put","patch"],e=>{rf.headers[e]={}});const af=Tg.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),nf=Symbol("internals");function lf(e){return e&&String(e).trim().toLowerCase()}function of(e){return!1===e||null==e?e:Tg.isArray(e)?e.map(of):String(e)}function df(e,t,s,r,a){return Tg.isFunction(r)?r.call(this,t,s):(a&&(t=s),Tg.isString(t)?Tg.isString(r)?-1!==t.indexOf(r):Tg.isRegExp(r)?r.test(t):void 0:void 0)}let cf=class{constructor(e){e&&this.set(e)}set(e,t,s){const r=this;function a(e,t,s){const a=lf(t);if(!a)throw new Error("header name must be a non-empty string");const n=Tg.findKey(r,a);(!n||void 0===r[n]||!0===s||void 0===s&&!1!==r[n])&&(r[n||t]=of(e))}const n=(e,t)=>Tg.forEach(e,(e,s)=>a(e,s,t));if(Tg.isPlainObject(e)||e instanceof this.constructor)n(e,t);else if(Tg.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))n((e=>{const t={};let s,r,a;return e&&e.split("\n").forEach(function(e){a=e.indexOf(":"),s=e.substring(0,a).trim().toLowerCase(),r=e.substring(a+1).trim(),!s||t[s]&&af[s]||("set-cookie"===s?t[s]?t[s].push(r):t[s]=[r]:t[s]=t[s]?t[s]+", "+r:r)}),t})(e),t);else if(Tg.isObject(e)&&Tg.isIterable(e)){let s,r,a={};for(const t of e){if(!Tg.isArray(t))throw TypeError("Object iterator must return a key-value pair");a[r=t[0]]=(s=a[r])?Tg.isArray(s)?[...s,t[1]]:[s,t[1]]:t[1]}n(a,t)}else null!=e&&a(t,e,s);return this}get(e,t){if(e=lf(e)){const s=Tg.findKey(this,e);if(s){const e=this[s];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=s.exec(e);)t[r[1]]=r[2];return t}(e);if(Tg.isFunction(t))return t.call(this,e,s);if(Tg.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=lf(e)){const s=Tg.findKey(this,e);return!(!s||void 0===this[s]||t&&!df(0,this[s],s,t))}return!1}delete(e,t){const s=this;let r=!1;function a(e){if(e=lf(e)){const a=Tg.findKey(s,e);!a||t&&!df(0,s[a],a,t)||(delete s[a],r=!0)}}return Tg.isArray(e)?e.forEach(a):a(e),r}clear(e){const t=Object.keys(this);let s=t.length,r=!1;for(;s--;){const a=t[s];e&&!df(0,this[a],a,e,!0)||(delete this[a],r=!0)}return r}normalize(e){const t=this,s={};return Tg.forEach(this,(r,a)=>{const n=Tg.findKey(s,a);if(n)return t[n]=of(r),void delete t[a];const i=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}(a):String(a).trim();i!==a&&delete t[a],t[i]=of(r),s[i]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Tg.forEach(this,(s,r)=>{null!=s&&!1!==s&&(t[r]=e&&Tg.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach(e=>s.set(e)),s}static accessor(e){const t=(this[nf]=this[nf]={accessors:{}}).accessors,s=this.prototype;function r(e){const r=lf(e);t[r]||(!function(e,t){const s=Tg.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+s,{value:function(e,s,a){return this[r].call(this,t,e,s,a)},configurable:!0})})}(s,e),t[r]=!0)}return Tg.isArray(e)?e.forEach(r):r(e),this}};function uf(e,t){const s=this||rf,r=t||s,a=cf.from(r.headers);let n=r.data;return Tg.forEach(e,function(e){n=e.call(s,n,a.normalize(),t?t.status:void 0)}),a.normalize(),n}function mf(e){return!(!e||!e.__CANCEL__)}function hf(e,t,s){Ig.call(this,null==e?"canceled":e,Ig.ERR_CANCELED,t,s),this.name="CanceledError"}function xf(e,t,s){const r=s.config.validateStatus;s.status&&r&&!r(s.status)?t(new Ig("Request failed with status code "+s.status,[Ig.ERR_BAD_REQUEST,Ig.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s)):e(s)}cf.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Tg.reduceDescriptors(cf.prototype,({value:e},t)=>{let s=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[s]=e}}}),Tg.freezeMethods(cf),Tg.inherits(hf,Ig,{__CANCEL__:!0});const gf=(e,t,s=3)=>{let r=0;const a=function(e,t){e=e||10;const s=new Array(e),r=new Array(e);let a,n=0,i=0;return t=void 0!==t?t:1e3,function(l){const o=Date.now(),d=r[i];a||(a=o),s[n]=l,r[n]=o;let c=i,u=0;for(;c!==n;)u+=s[c++],c%=e;if(n=(n+1)%e,n===i&&(i=(i+1)%e),o-a<t)return;const m=d&&o-d;return m?Math.round(1e3*u/m):void 0}}(50,250);return function(e,t){let s,r,a=0,n=1e3/t;const i=(t,n=Date.now())=>{a=n,s=null,r&&(clearTimeout(r),r=null),e(...t)};return[(...e)=>{const t=Date.now(),l=t-a;l>=n?i(e,t):(s=e,r||(r=setTimeout(()=>{r=null,i(s)},n-l)))},()=>s&&i(s)]}(s=>{const n=s.loaded,i=s.lengthComputable?s.total:void 0,l=n-r,o=a(l);r=n;e({loaded:n,total:i,progress:i?n/i:void 0,bytes:l,rate:o||void 0,estimated:o&&i&&n<=i?(i-n)/o:void 0,event:s,lengthComputable:null!=i,[t?"download":"upload"]:!0})},s)},ff=(e,t)=>{const s=null!=e;return[r=>t[0]({lengthComputable:s,total:e,loaded:r}),t[1]]},pf=e=>(...t)=>Tg.asap(()=>e(...t)),bf=tf.hasStandardBrowserEnv?((e,t)=>s=>(s=new URL(s,tf.origin),e.protocol===s.protocol&&e.host===s.host&&(t||e.port===s.port)))(new URL(tf.origin),tf.navigator&&/(msie|trident)/i.test(tf.navigator.userAgent)):()=>!0,yf=tf.hasStandardBrowserEnv?{write(e,t,s,r,a,n){const i=[e+"="+encodeURIComponent(t)];Tg.isNumber(s)&&i.push("expires="+new Date(s).toGMTString()),Tg.isString(r)&&i.push("path="+r),Tg.isString(a)&&i.push("domain="+a),!0===n&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function vf(e,t,s){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(r||0==s)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const jf=e=>e instanceof cf?{...e}:e;function Nf(e,t){t=t||{};const s={};function r(e,t,s,r){return Tg.isPlainObject(e)&&Tg.isPlainObject(t)?Tg.merge.call({caseless:r},e,t):Tg.isPlainObject(t)?Tg.merge({},t):Tg.isArray(t)?t.slice():t}function a(e,t,s,a){return Tg.isUndefined(t)?Tg.isUndefined(e)?void 0:r(void 0,e,0,a):r(e,t,0,a)}function n(e,t){if(!Tg.isUndefined(t))return r(void 0,t)}function i(e,t){return Tg.isUndefined(t)?Tg.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function l(s,a,n){return n in t?r(s,a):n in e?r(void 0,s):void 0}const o={url:n,method:n,data:n,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(e,t,s)=>a(jf(e),jf(t),0,!0)};return Tg.forEach(Object.keys({...e,...t}),function(r){const n=o[r]||a,i=n(e[r],t[r],r);Tg.isUndefined(i)&&n!==l||(s[r]=i)}),s}const wf=e=>{const t=Nf({},e);let s,{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:i,headers:l,auth:o}=t;if(t.headers=l=cf.from(l),t.url=Hg(vf(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Tg.isFormData(r))if(tf.hasStandardBrowserEnv||tf.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(!1!==(s=l.getContentType())){const[e,...t]=s?s.split(";").map(e=>e.trim()).filter(Boolean):[];l.setContentType([e||"multipart/form-data",...t].join("; "))}if(tf.hasStandardBrowserEnv&&(a&&Tg.isFunction(a)&&(a=a(t)),a||!1!==a&&bf(t.url))){const e=n&&i&&yf.read(i);e&&l.set(n,e)}return t},Sf="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise(function(t,s){const r=wf(e);let a=r.data;const n=cf.from(r.headers).normalize();let i,l,o,d,c,{responseType:u,onUploadProgress:m,onDownloadProgress:h}=r;function x(){d&&d(),c&&c(),r.cancelToken&&r.cancelToken.unsubscribe(i),r.signal&&r.signal.removeEventListener("abort",i)}let g=new XMLHttpRequest;function f(){if(!g)return;const r=cf.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders());xf(function(e){t(e),x()},function(e){s(e),x()},{data:u&&"text"!==u&&"json"!==u?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:r,config:e,request:g}),g=null}g.open(r.method.toUpperCase(),r.url,!0),g.timeout=r.timeout,"onloadend"in g?g.onloadend=f:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(f)},g.onabort=function(){g&&(s(new Ig("Request aborted",Ig.ECONNABORTED,e,g)),g=null)},g.onerror=function(){s(new Ig("Network Error",Ig.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const a=r.transitional||Jg;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),s(new Ig(t,a.clarifyTimeoutError?Ig.ETIMEDOUT:Ig.ECONNABORTED,e,g)),g=null},void 0===a&&n.setContentType(null),"setRequestHeader"in g&&Tg.forEach(n.toJSON(),function(e,t){g.setRequestHeader(t,e)}),Tg.isUndefined(r.withCredentials)||(g.withCredentials=!!r.withCredentials),u&&"json"!==u&&(g.responseType=r.responseType),h&&([o,c]=gf(h,!0),g.addEventListener("progress",o)),m&&g.upload&&([l,d]=gf(m),g.upload.addEventListener("progress",l),g.upload.addEventListener("loadend",d)),(r.cancelToken||r.signal)&&(i=t=>{g&&(s(!t||t.type?new hf(null,e,g):t),g.abort(),g=null)},r.cancelToken&&r.cancelToken.subscribe(i),r.signal&&(r.signal.aborted?i():r.signal.addEventListener("abort",i)));const p=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);p&&-1===tf.protocols.indexOf(p)?s(new Ig("Unsupported protocol "+p+":",Ig.ERR_BAD_REQUEST,e)):g.send(a||null)})},kf=(e,t)=>{const{length:s}=e=e?e.filter(Boolean):[];if(t||s){let s,r=new AbortController;const a=function(e){if(!s){s=!0,i();const t=e instanceof Error?e:this.reason;r.abort(t instanceof Ig?t:new hf(t instanceof Error?t.message:t))}};let n=t&&setTimeout(()=>{n=null,a(new Ig(`timeout ${t} of ms exceeded`,Ig.ETIMEDOUT))},t);const i=()=>{e&&(n&&clearTimeout(n),n=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(a):e.removeEventListener("abort",a)}),e=null)};e.forEach(e=>e.addEventListener("abort",a));const{signal:l}=r;return l.unsubscribe=()=>Tg.asap(i),l}},Cf=function*(e,t){let s=e.byteLength;if(s<t)return void(yield e);let r,a=0;for(;a<s;)r=a+t,yield e.slice(a,r),a=r},$f=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:s}=await t.read();if(e)break;yield s}}finally{await t.cancel()}},_f=(e,t,s,r)=>{const a=async function*(e,t){for await(const s of $f(e))yield*Cf(s,t)}(e,t);let n,i=0,l=e=>{n||(n=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await a.next();if(t)return l(),void e.close();let n=r.byteLength;if(s){let e=i+=n;s(e)}e.enqueue(new Uint8Array(r))}catch(t){throw l(t),t}},cancel:e=>(l(e),a.return())},{highWaterMark:2})},Af="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,Pf=Af&&"function"==typeof ReadableStream,Lf=Af&&("function"==typeof TextEncoder?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Ef=(e,...t)=>{try{return!!e(...t)}catch(Nh){return!1}},Tf=Pf&&Ef(()=>{let e=!1;const t=new Request(tf.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),If=Pf&&Ef(()=>Tg.isReadableStream(new Response("").body)),Of={stream:If&&(e=>e.body)};var Ff;Af&&(Ff=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Of[e]&&(Of[e]=Tg.isFunction(Ff[e])?t=>t[e]():(t,s)=>{throw new Ig(`Response type '${e}' is not supported`,Ig.ERR_NOT_SUPPORT,s)})}));const Rf=async(e,t)=>{const s=Tg.toFiniteNumber(e.getContentLength());return null==s?(async e=>{if(null==e)return 0;if(Tg.isBlob(e))return e.size;if(Tg.isSpecCompliantForm(e)){const t=new Request(tf.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Tg.isArrayBufferView(e)||Tg.isArrayBuffer(e)?e.byteLength:(Tg.isURLSearchParams(e)&&(e+=""),Tg.isString(e)?(await Lf(e)).byteLength:void 0)})(t):s},Df=Af&&(async e=>{let{url:t,method:s,data:r,signal:a,cancelToken:n,timeout:i,onDownloadProgress:l,onUploadProgress:o,responseType:d,headers:c,withCredentials:u="same-origin",fetchOptions:m}=wf(e);d=d?(d+"").toLowerCase():"text";let h,x=kf([a,n&&n.toAbortSignal()],i);const g=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let f;try{if(o&&Tf&&"get"!==s&&"head"!==s&&0!==(f=await Rf(c,r))){let e,s=new Request(t,{method:"POST",body:r,duplex:"half"});if(Tg.isFormData(r)&&(e=s.headers.get("content-type"))&&c.setContentType(e),s.body){const[e,t]=ff(f,gf(pf(o)));r=_f(s.body,65536,e,t)}}Tg.isString(u)||(u=u?"include":"omit");const a="credentials"in Request.prototype;h=new Request(t,{...m,signal:x,method:s.toUpperCase(),headers:c.normalize().toJSON(),body:r,duplex:"half",credentials:a?u:void 0});let n=await fetch(h,m);const i=If&&("stream"===d||"response"===d);if(If&&(l||i&&g)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=n[t]});const t=Tg.toFiniteNumber(n.headers.get("content-length")),[s,r]=l&&ff(t,gf(pf(l),!0))||[];n=new Response(_f(n.body,65536,s,()=>{r&&r(),g&&g()}),e)}d=d||"text";let p=await Of[Tg.findKey(Of,d)||"text"](n,e);return!i&&g&&g(),await new Promise((t,s)=>{xf(t,s,{data:p,headers:cf.from(n.headers),status:n.status,statusText:n.statusText,config:e,request:h})})}catch(p){if(g&&g(),p&&"TypeError"===p.name&&/Load failed|fetch/i.test(p.message))throw Object.assign(new Ig("Network Error",Ig.ERR_NETWORK,e,h),{cause:p.cause||p});throw Ig.from(p,p&&p.code,e,h)}}),Mf={http:null,xhr:Sf,fetch:Df};Tg.forEach(Mf,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(Nh){}Object.defineProperty(e,"adapterName",{value:t})}});const Bf=e=>`- ${e}`,Uf=e=>Tg.isFunction(e)||null===e||!1===e,qf=e=>{e=Tg.isArray(e)?e:[e];const{length:t}=e;let s,r;const a={};for(let n=0;n<t;n++){let t;if(s=e[n],r=s,!Uf(s)&&(r=Mf[(t=String(s)).toLowerCase()],void 0===r))throw new Ig(`Unknown adapter '${t}'`);if(r)break;a[t||"#"+n]=r}if(!r){const e=Object.entries(a).map(([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build"));throw new Ig("There is no suitable adapter to dispatch the request "+(t?e.length>1?"since :\n"+e.map(Bf).join("\n"):" "+Bf(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return r};function zf(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new hf(null,e)}function Wf(e){zf(e),e.headers=cf.from(e.headers),e.data=uf.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return qf(e.adapter||rf.adapter)(e).then(function(t){return zf(e),t.data=uf.call(e,e.transformResponse,t),t.headers=cf.from(t.headers),t},function(t){return mf(t)||(zf(e),t&&t.response&&(t.response.data=uf.call(e,e.transformResponse,t.response),t.response.headers=cf.from(t.response.headers))),Promise.reject(t)})}const Vf="1.11.0",Hf={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Hf[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const Gf={};Hf.transitional=function(e,t,s){return(r,a,n)=>{if(!1===e)throw new Ig(function(e,t){return"[Axios v"+Vf+"] Transitional option '"+e+"'"+t+(s?". "+s:"")}(a," has been removed"+(t?" in "+t:"")),Ig.ERR_DEPRECATED);return t&&!Gf[a]&&(Gf[a]=!0),!e||e(r,a,n)}},Hf.spelling=function(e){return(e,t)=>!0};const Jf={assertOptions:function(e,t,s){if("object"!=typeof e)throw new Ig("options must be an object",Ig.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const n=r[a],i=t[n];if(i){const t=e[n],s=void 0===t||i(t,n,e);if(!0!==s)throw new Ig("option "+n+" must be "+s,Ig.ERR_BAD_OPTION_VALUE);continue}if(!0!==s)throw new Ig("Unknown option "+n,Ig.ERR_BAD_OPTION)}},validators:Hf},Kf=Jf.validators;let Yf=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Gg,response:new Gg}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{s.stack?t&&!String(s.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(s.stack+="\n"+t):s.stack=t}catch(Nh){}}throw s}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Nf(this.defaults,t);const{transitional:s,paramsSerializer:r,headers:a}=t;void 0!==s&&Jf.assertOptions(s,{silentJSONParsing:Kf.transitional(Kf.boolean),forcedJSONParsing:Kf.transitional(Kf.boolean),clarifyTimeoutError:Kf.transitional(Kf.boolean)},!1),null!=r&&(Tg.isFunction(r)?t.paramsSerializer={serialize:r}:Jf.assertOptions(r,{encode:Kf.function,serialize:Kf.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Jf.assertOptions(t,{baseUrl:Kf.spelling("baseURL"),withXsrfToken:Kf.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let n=a&&Tg.merge(a.common,a[t.method]);a&&Tg.forEach(["delete","get","head","post","put","patch","common"],e=>{delete a[e]}),t.headers=cf.concat(n,a);const i=[];let l=!0;this.interceptors.request.forEach(function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(l=l&&e.synchronous,i.unshift(e.fulfilled,e.rejected))});const o=[];let d;this.interceptors.response.forEach(function(e){o.push(e.fulfilled,e.rejected)});let c,u=0;if(!l){const e=[Wf.bind(this),void 0];for(e.unshift(...i),e.push(...o),c=e.length,d=Promise.resolve(t);u<c;)d=d.then(e[u++],e[u++]);return d}c=i.length;let m=t;for(u=0;u<c;){const e=i[u++],t=i[u++];try{m=e(m)}catch(h){t.call(this,h);break}}try{d=Wf.call(this,m)}catch(h){return Promise.reject(h)}for(u=0,c=o.length;u<c;)d=d.then(o[u++],o[u++]);return d}getUri(e){return Hg(vf((e=Nf(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}};Tg.forEach(["delete","get","head","options"],function(e){Yf.prototype[e]=function(t,s){return this.request(Nf(s||{},{method:e,url:t,data:(s||{}).data}))}}),Tg.forEach(["post","put","patch"],function(e){function t(t){return function(s,r,a){return this.request(Nf(a||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:s,data:r}))}}Yf.prototype[e]=t(),Yf.prototype[e+"Form"]=t(!0)});const Zf={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Zf).forEach(([e,t])=>{Zf[t]=e});const Xf=function e(t){const s=new Yf(t),r=Vx(Yf.prototype.request,s);return Tg.extend(r,Yf.prototype,s,{allOwnKeys:!0}),Tg.extend(r,s,null,{allOwnKeys:!0}),r.create=function(s){return e(Nf(t,s))},r}(rf);Xf.Axios=Yf,Xf.CanceledError=hf,Xf.CancelToken=class e{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const s=this;this.promise.then(e=>{if(!s._listeners)return;let t=s._listeners.length;for(;t-- >0;)s._listeners[t](e);s._listeners=null}),this.promise.then=e=>{let t;const r=new Promise(e=>{s.subscribe(e),t=e}).then(e);return r.cancel=function(){s.unsubscribe(t)},r},e(function(e,r,a){s.reason||(s.reason=new hf(e,r,a),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let t;return{token:new e(function(e){t=e}),cancel:t}}},Xf.isCancel=mf,Xf.VERSION=Vf,Xf.toFormData=Ug,Xf.AxiosError=Ig,Xf.Cancel=Xf.CanceledError,Xf.all=function(e){return Promise.all(e)},Xf.spread=function(e){return function(t){return e.apply(null,t)}},Xf.isAxiosError=function(e){return Tg.isObject(e)&&!0===e.isAxiosError},Xf.mergeConfig=Nf,Xf.AxiosHeaders=cf,Xf.formToJSON=e=>sf(Tg.isHTMLForm(e)?new FormData(e):e),Xf.getAdapter=qf,Xf.HttpStatusCode=Zf,Xf.default=Xf;const{Axios:Qf,AxiosError:ep,CanceledError:tp,isCancel:sp,CancelToken:rp,VERSION:ap,all:np,Cancel:ip,isAxiosError:lp,spread:op,toFormData:dp,AxiosHeaders:cp,HttpStatusCode:up,formToJSON:mp,getAdapter:hp,mergeConfig:xp}=Xf,gp=()=>{const{id:e}=u(),t=a(),[s,r]=n.useState(null),[i,l]=n.useState(!0),[o,d]=n.useState(null);n.useEffect(()=>{(async()=>{if(e)try{l(!0);const t=await Xf.get(`/api/incidents/${e}`);t.data.success?r(t.data.incident):d("Incident not found")}catch(t){d("Failed to load incident details")}finally{l(!1)}})()},[e]);return i?I.jsx("div",{className:"flex items-center justify-center min-h-screen",children:I.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):o||!s?I.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:I.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:I.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:I.jsxs("div",{className:"text-center",children:[I.jsx("i",{className:"ri-error-warning-line mx-auto text-5xl text-red-500"}),I.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Error"}),I.jsx("p",{className:"mt-1 text-sm text-gray-500",children:o||"Incident not found"}),I.jsx("div",{className:"mt-6",children:I.jsxs("button",{onClick:()=>t("/admin/incidents/view"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[I.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back to Incidents"]})})]})})})}):I.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:I.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[I.jsx("div",{className:"mb-6",children:I.jsxs("button",{onClick:()=>t("/admin/incidents/view"),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[I.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back to Incidents"]})}),I.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[I.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Incident #",s.incident_id]}),I.jsxs("div",{className:"flex space-x-2",children:[I.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"in_progress":return"bg-blue-100 text-blue-800";case"resolved":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}})(s.status)}`,children:s.status.replace("_"," ").toUpperCase()}),I.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(e=>{switch(e){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"moderate":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}})(s.priority_level)}`,children:s.priority_level.toUpperCase()})]})]})}),I.jsxs("div",{className:"px-6 py-6",children:[I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Incident Information"}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("p",{children:[I.jsx("strong",{children:"Type:"})," ",(c=s.incident_type,c.toUpperCase())]}),I.jsxs("p",{children:[I.jsx("strong",{children:"Priority:"})," ",s.priority_level]}),I.jsxs("p",{children:[I.jsx("strong",{children:"Status:"})," ",s.status]}),I.jsxs("p",{children:[I.jsx("strong",{children:"Validation:"})," ",s.validation_status]}),I.jsxs("p",{children:[I.jsx("strong",{children:"Reporter Safety:"})," ",s.reporter_safe_status]})]})]}),I.jsxs("div",{children:[I.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-2 flex items-center",children:[I.jsx("i",{className:"ri-map-pin-line mr-2"}),"Location"]}),I.jsxs("p",{className:"text-sm text-gray-600",children:["Coordinates: ",s.latitude,", ",s.longitude]})]}),I.jsxs("div",{children:[I.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-2 flex items-center",children:[I.jsx("i",{className:"ri-time-line mr-2"}),"Reported"]}),I.jsx("p",{className:"text-sm text-gray-600",children:new Date(s.date_reported).toLocaleString()})]})]}),I.jsx("div",{className:"space-y-4",children:I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Assignment Information"}),I.jsxs("div",{className:"space-y-2",children:[s.assigned_team_name&&I.jsxs("p",{children:[I.jsx("strong",{children:"Assigned Team:"})," ",s.assigned_team_name]}),s.assigned_staff_name&&I.jsxs("p",{children:[I.jsx("strong",{children:"Assigned Staff:"})," ",s.assigned_staff_name]}),s.reporter_name&&I.jsxs("p",{children:[I.jsx("strong",{children:"Reported By:"})," ",s.reporter_name]})]})]})})]}),I.jsxs("div",{className:"mt-6",children:[I.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Description"}),I.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:I.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:s.description})})]})]})]})]})});var c},fp="http://localhost:3001",pp=async e=>(await Xf.post(`${fp}/api/reports/generate`,e)).data,bp=async e=>(await Xf.get(`${fp}/api/reports/${e}/download`,{responseType:"blob"})).data,yp=async e=>(await Xf.post(`${fp}/api/reports/export`,e,{responseType:"blob"})).data,vp=()=>{const[e,t]=n.useState("all"),[s,r]=n.useState("grid"),[a,i]=n.useState({startDate:"",endDate:""}),l=[{id:"1",name:"Incident Summary Report",description:"Comprehensive summary of all incidents including status, response times, and resolutions.",type:"incidents",status:"available",frequency:"daily",lastGenerated:"2025-08-28"},{id:"2",name:"Evacuation Center Status",description:"Current status and historical data of evacuation centers including occupancy rates.",type:"evacuations",status:"generating",frequency:"daily",lastGenerated:"2025-08-27"},{id:"3",name:"Resource Allocation Report",description:"Overview of resource distribution and utilization across different centers.",type:"resources",status:"available",frequency:"weekly",lastGenerated:"2025-08-29"},{id:"4",name:"Activity Logs Report",description:"Detailed log of all system activities and user actions.",type:"activity",status:"available",frequency:"daily",lastGenerated:"2025-08-29"},{id:"5",name:"Emergency Response Times",description:"Analysis of response times for different types of emergencies and locations.",type:"response",status:"available",frequency:"weekly",lastGenerated:"2025-08-29"},{id:"6",name:"Team Performance Report",description:"Evaluation of team performance, response efficiency, and task completion rates.",type:"team",status:"failed",frequency:"monthly",lastGenerated:"2025-08-28"},{id:"7",name:"Emergency Preparedness Assessment",description:"Assessment of current emergency preparedness levels and recommendations.",type:"emergency",status:"available",frequency:"monthly",lastGenerated:"2025-08-25"}],o="all"===e?l:l.filter(t=>t.type===e),d=async e=>{try{const t=l.find(t=>t.id===e);if(!t)return;const s=await pp({title:t.name,type:t.type,description:t.description,parameters:{dateRange:a,status:"all"}});if(s.reportId){const e=await bp(s.reportId),r=window.URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=`${t.name}-${(new Date).toISOString().split("T")[0]}.pdf`,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(r),document.body.removeChild(a)}}catch(t){alert("Failed to generate report. Please try again.")}},c=async t=>{try{const s=await yp({format:t,type:e,dateRange:{startDate:a.startDate,endDate:a.endDate}}),r=window.URL.createObjectURL(s),n=document.createElement("a");n.href=r,n.download=`emergency-reports-${(new Date).toISOString().split("T")[0]}.${t}`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(r),document.body.removeChild(n)}catch(s){alert("Failed to export reports. Please try again.")}},u=e=>{switch(e){case"available":return"bg-green-100 text-green-800";case"generating":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return I.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[I.jsxs("div",{className:"mb-8",children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Reports"}),I.jsx("p",{className:"text-gray-600",children:"Generate and manage various reports for emergency management operations."})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[I.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[I.jsx("div",{className:"text-blue-600 text-sm font-medium",children:"Total Reports"}),I.jsx("div",{className:"text-2xl font-bold text-blue-900",children:l.length})]}),I.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[I.jsx("div",{className:"text-green-600 text-sm font-medium",children:"Available Reports"}),I.jsx("div",{className:"text-2xl font-bold text-green-900",children:l.filter(e=>"available"===e.status).length})]}),I.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[I.jsx("div",{className:"text-yellow-600 text-sm font-medium",children:"Generating"}),I.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:l.filter(e=>"generating"===e.status).length})]}),I.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[I.jsx("div",{className:"text-red-600 text-sm font-medium",children:"Failed"}),I.jsx("div",{className:"text-2xl font-bold text-red-900",children:l.filter(e=>"failed"===e.status).length})]})]}),I.jsxs("div",{className:"mb-6 flex flex-wrap gap-4 items-center justify-between bg-white p-4 rounded-lg shadow-sm",children:[I.jsxs("div",{className:"flex gap-4 items-center",children:[I.jsxs("select",{value:e,onChange:e=>t(e.target.value),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[I.jsx("option",{value:"all",children:"All Reports"}),I.jsx("option",{value:"incidents",children:"Incidents"}),I.jsx("option",{value:"evacuations",children:"Evacuations"}),I.jsx("option",{value:"resources",children:"Resources"}),I.jsx("option",{value:"response",children:"Response Times"}),I.jsx("option",{value:"emergency",children:"Emergency Preparedness"}),I.jsx("option",{value:"team",children:"Team Performance"}),I.jsx("option",{value:"activity",children:"Activity Logs"})]}),I.jsx("input",{type:"date",value:a.startDate,onChange:e=>i(t=>({...t,startDate:e.target.value})),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),I.jsx("span",{className:"text-gray-500",children:"to"}),I.jsx("input",{type:"date",value:a.endDate,onChange:e=>i(t=>({...t,endDate:e.target.value})),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),I.jsxs("div",{className:"flex gap-2 items-center",children:[I.jsxs("div",{className:"flex border border-gray-300 rounded-md overflow-hidden",children:[I.jsx("button",{onClick:()=>r("grid"),className:"grid"===s?"px-3 py-2 bg-blue-50 text-blue-600":"px-3 py-2 bg-white text-gray-600",children:I.jsx("i",{className:"ri-grid-line"})}),I.jsx("button",{onClick:()=>r("table"),className:"table"===s?"px-3 py-2 bg-blue-50 text-blue-600":"px-3 py-2 bg-white text-gray-600",children:I.jsx("i",{className:"ri-list-check"})})]}),I.jsx("button",{onClick:()=>c("pdf"),className:"px-4 py-2 text-sm bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500",children:"Export as PDF"}),I.jsx("button",{onClick:()=>c("excel"),className:"px-4 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500",children:"Export as Excel"})]})]}),"grid"===s?I.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map(e=>I.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-100 hover:border-blue-500 transition-colors",children:[I.jsxs("div",{className:"flex justify-between items-start mb-4",children:[I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),I.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]}),I.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:e.type})]}),I.jsxs("div",{className:"flex items-center justify-between mt-4",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${u(e.status)}`,children:e.status}),e.frequency&&I.jsxs("span",{className:"text-xs text-gray-500",children:["Generated ",e.frequency]})]}),I.jsxs("div",{className:"flex items-center gap-4",children:[I.jsx("div",{className:"text-sm text-gray-500",children:e.lastGenerated&&I.jsxs("span",{children:["Last generated: ",e.lastGenerated]})}),I.jsx("button",{onClick:()=>d(e.id),disabled:"generating"===e.status,className:"px-4 py-2 text-sm rounded-md focus:outline-none focus:ring-2 "+("generating"===e.status?"bg-gray-100 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500"),children:"generating"===e.status?"Generating...":"Generate Report"})]})]})]},e.id))}):I.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:I.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[I.jsx("thead",{className:"bg-gray-50",children:I.jsxs("tr",{children:[I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Frequency"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Generated"}),I.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),I.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(e=>I.jsxs("tr",{className:"hover:bg-gray-50",children:[I.jsx("td",{className:"px-6 py-4",children:I.jsxs("div",{children:[I.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),I.jsx("div",{className:"text-sm text-gray-500",children:e.description})]})}),I.jsx("td",{className:"px-6 py-4",children:I.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:e.type})}),I.jsx("td",{className:"px-6 py-4",children:I.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${u(e.status)}`,children:e.status})}),I.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.frequency||"-"}),I.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.lastGenerated||"-"}),I.jsx("td",{className:"px-6 py-4 text-right",children:I.jsx("button",{onClick:()=>d(e.id),disabled:"generating"===e.status,className:"px-4 py-2 text-sm rounded-md focus:outline-none focus:ring-2 "+("generating"===e.status?"bg-gray-100 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500"),children:"generating"===e.status?"Generating...":"Generate Report"})})]},e.id))})]})})]})};delete Fl.Icon.Default.prototype._getIconUrl,Fl.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const jp=Fl.divIcon({html:'\n    <div style="\n      background-color: #3b82f6;\n      width: 24px;\n      height: 24px;\n      border-radius: 50%;\n      border: 3px solid white;\n      box-shadow: 0 2px 8px rgba(0,0,0,0.3);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    ">\n      <div style="\n        width: 8px;\n        height: 8px;\n        background-color: white;\n        border-radius: 50%;\n      "></div>\n    </div>\n  ',className:"coordinate-picker-marker",iconSize:[24,24],iconAnchor:[12,12]}),Np=({onCoordinateChange:e})=>(Wl({click:t=>{const{lat:s,lng:r}=t.latlng;e(s,r)}}),null),wp=({latitude:e,longitude:t,onCoordinateChange:s,height:r="300px",center:a=[13.7565,121.3851],zoom:i=13})=>{const[l,o]=n.useState(a),d=e=>{if(null==e)return null;const t="string"==typeof e?parseFloat(e):e;return isNaN(t)?null:t};return n.useEffect(()=>{const s=d(e),r=d(t);null!==s&&null!==r&&o([s,r])},[e,t]),I.jsxs("div",{className:"w-full",children:[I.jsx("div",{className:"w-full rounded-lg overflow-hidden border border-gray-300",style:{height:r},children:I.jsxs(Jl,{center:l,zoom:i,style:{height:"100%",width:"100%"},className:"z-0",zoomControl:!0,children:[I.jsx(Ql,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",maxZoom:19}),I.jsx(Np,{onCoordinateChange:s}),e&&t&&(()=>{const s=d(e),r=d(t);return null!==s&&null!==r?I.jsx(Kl,{position:[s,r],icon:jp}):null})()]})}),I.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Click on the map to select coordinates. Selected: ",(()=>{const t=d(e);return null!==t?t.toFixed(6):"N/A"})(),", ",(()=>{const e=d(t);return null!==e?e.toFixed(6):"N/A"})()]})]})},Sp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),kp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Cp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),$p=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),_p=e=>I.jsxs("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),Ap=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),Pp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),Lp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),Ep=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),Tp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Ip=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Op=()=>{const{showToast:e}=$t(),[t,s]=n.useState([]),[r,a]=n.useState(!1),[i,l]=n.useState(""),[o,d]=n.useState("all"),[c,u]=n.useState("name"),[m,h]=n.useState(!1),[x,g]=n.useState(!1),[f,p]=n.useState(!1),[b,y]=n.useState(null),[v,j]=n.useState({}),[N,w]=n.useState({}),[S,k]=n.useState(!1),[C,$]=n.useState(!1),[_,A]=n.useState(!1);n.useEffect(()=>{P()},[]);const P=async()=>{a(!0);try{const e=await Se(),t=e?.data||e;s(Array.isArray(t)?t:[])}catch(e){}finally{a(!1)}},L=n.useMemo(()=>{let e=t;if(i.trim()){const t=i.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.address?.toLowerCase().includes(t)||e.contact_person?.toLowerCase().includes(t))}return"all"!==o&&(e=e.filter(e=>e.status===o)),e=[...e].sort((e,t)=>{switch(c){case"name":return e.name.localeCompare(t.name);case"capacity":return t.capacity-e.capacity;case"occupancy":return t.current_occupancy-e.current_occupancy;case"status":return e.status.localeCompare(t.status);default:return 0}}),e},[t,i,o,c]),E=n.useCallback(e=>{const t={};return e.name?.trim()||(t.name="Name is required"),(!e.latitude||e.latitude<-90||e.latitude>90)&&(t.latitude="Valid latitude required (-90 to 90)"),(!e.longitude||e.longitude<-180||e.longitude>180)&&(t.longitude="Valid longitude required (-180 to 180)"),(!e.capacity||e.capacity<0)&&(t.capacity="Valid capacity required (greater than 0)"),void 0!==e.current_occupancy&&e.current_occupancy<0&&(t.current_occupancy="Occupancy cannot be negative"),void 0!==e.current_occupancy&&e.capacity&&e.current_occupancy>e.capacity&&(t.current_occupancy="Occupancy cannot exceed capacity"),w(t),0===Object.keys(t).length},[]),T=async(t,s)=>{try{const r=L.map(e=>({name:e.name,status:e.status,capacity:e.capacity,current_occupancy:e.current_occupancy,occupancy_rate:`${F(e)}%`,latitude:e.latitude,longitude:e.longitude,contact_person:e.contact_person||"N/A",contact_number:e.contact_number||"N/A",address:e.address||"N/A",created_at:e.created_at||"N/A",updated_at:e.updated_at||"N/A"})),a=s.map(e=>({key:e.key,label:e.label,format:e.format}));switch(t){case"csv":Px.exportToCSV(r,a,{filename:`evacuation-centers-${(new Date).toISOString().split("T")[0]}`,title:"Evacuation Centers Report"});break;case"excel":Px.exportToExcel(r,a,{filename:`evacuation-centers-${(new Date).toISOString().split("T")[0]}`,title:"Evacuation Centers Report"});break;case"pdf":await Px.exportToPDF(r,a,{filename:`evacuation-centers-${(new Date).toISOString().split("T")[0]}`,title:"Evacuation Centers Report"})}e({type:"success",title:"Success",message:`Data exported successfully as ${t.toUpperCase()}`}),$(!1)}catch(r){e({type:"error",title:"Error",message:"Failed to export data. Please try again."})}},O=e=>{switch(e){case"open":return"bg-green-100 text-green-800";case"full":return"bg-yellow-100 text-yellow-800";case"closed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},F=e=>Math.round(e.current_occupancy/e.capacity*100),R=e=>{const t="number"==typeof e?e:"string"==typeof e?parseFloat(e):NaN;return Number.isFinite(t)?t.toFixed(4):"N/A"};return I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Evacuation Centers"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and monitor all evacuation centers in the system"})]}),I.jsxs("div",{className:"flex space-x-3",children:[I.jsxs("button",{onClick:()=>{j({}),w({}),h(!0)},className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-200 transition-all duration-200 shadow-sm hover:shadow-md",children:[I.jsx(kp,{className:"w-5 h-5 mr-2"}),"Add New Center"]}),I.jsxs("button",{onClick:()=>$(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export Centers"]})]})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(Ap,{className:"w-5 h-5 text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total Centers"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(Tp,{className:"w-5 h-5 text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Open Centers"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.filter(e=>"open"===e.status).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(Ep,{className:"w-5 h-5 text-yellow-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Full Centers"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.filter(e=>"full"===e.status).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(Ip,{className:"w-5 h-5 text-red-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Closed Centers"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.filter(e=>"closed"===e.status).length})]})]})})]}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[I.jsx("div",{className:"flex-1",children:I.jsxs("div",{className:"relative",children:[I.jsx(Sp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),I.jsx("input",{type:"text",placeholder:"Search centers...",value:i,onChange:e=>l(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),I.jsxs("select",{value:o,onChange:e=>d(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[I.jsx("option",{value:"all",children:"All Status"}),I.jsx("option",{value:"open",children:"Open"}),I.jsx("option",{value:"full",children:"Full"}),I.jsx("option",{value:"closed",children:"Closed"})]}),I.jsxs("select",{value:c,onChange:e=>u(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[I.jsx("option",{value:"name",children:"Sort by Name"}),I.jsx("option",{value:"capacity",children:"Sort by Capacity"}),I.jsx("option",{value:"occupancy",children:"Sort by Occupancy"}),I.jsx("option",{value:"status",children:"Sort by Status"})]})]})}),r?I.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,t)=>I.jsxs("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:[I.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),I.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-2"}),I.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]},t))}):0===L.length?I.jsxs("div",{className:"text-center py-12",children:[I.jsx(Ap,{className:"mx-auto h-12 w-12 text-gray-400"}),I.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No centers found"}),I.jsx("p",{className:"mt-1 text-sm text-gray-500",children:i||"all"!==o?"Try adjusting your search or filters.":"Get started by creating a new center."})]}):I.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:L.map(e=>I.jsx("div",{className:"bg-white rounded-lg shadow hover:shadow-lg transition-shadow",children:I.jsxs("div",{className:"p-6",children:[I.jsxs("div",{className:"flex items-start justify-between mb-4",children:[I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),I.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${O(e.status)}`,children:e.status})]}),I.jsxs("div",{className:"flex space-x-2",children:[I.jsx("button",{onClick:()=>(e=>{y(e),j(e),g(!0)})(e),className:"p-1 text-blue-600 hover:text-blue-800 transition-colors",title:"Edit center",children:I.jsx(Cp,{className:"w-4 h-4"})}),I.jsx("button",{onClick:()=>(e=>{y(e),p(!0)})(e),className:"p-1 text-red-600 hover:text-red-800 transition-colors",title:"Delete center",children:I.jsx($p,{className:"w-4 h-4"})})]})]}),I.jsxs("div",{className:"space-y-3",children:[I.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[I.jsx(_p,{className:"w-4 h-4 mr-2 flex-shrink-0"}),I.jsxs("span",{className:"truncate",children:[R(e.latitude),", ",R(e.longitude)]})]}),I.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[I.jsx(Ap,{className:"w-4 h-4 mr-2 flex-shrink-0"}),I.jsxs("span",{children:[e.current_occupancy," / ",e.capacity," (",F(e),"%)"]})]}),e.contact_person&&I.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[I.jsx(Pp,{className:"w-4 h-4 mr-2 flex-shrink-0"}),I.jsx("span",{className:"truncate",children:e.contact_person})]}),e.contact_number&&I.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[I.jsx(Lp,{className:"w-4 h-4 mr-2 flex-shrink-0"}),I.jsx("span",{className:"truncate",children:e.contact_number})]}),e.address&&I.jsxs("div",{className:"flex items-start text-sm text-gray-600",children:[I.jsx(_p,{className:"w-4 h-4 mr-2 flex-shrink-0 mt-0.5"}),I.jsx("span",{className:"truncate",children:e.address})]})]}),I.jsx("div",{className:"mt-4",children:I.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:I.jsx("div",{className:"h-2 rounded-full transition-all duration-300 "+(F(e)>80?"bg-red-500":F(e)>60?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.min(F(e),100)}%`}})})})]})},e.center_id))}),(m||x)&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:I.jsx("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[95vh] overflow-y-auto shadow-2xl",children:I.jsxs("div",{className:"p-6",children:[I.jsxs("div",{className:"flex items-center justify-between mb-6",children:[I.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:m?"Create New Evacuation Center":"Edit Evacuation Center"}),I.jsx("button",{onClick:()=>{h(!1),g(!1),j({}),w({})},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:I.jsx(Ip,{className:"w-5 h-5"})})]}),I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Basic Information"}),I.jsx("div",{className:"space-y-4",children:I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Center Name *"}),I.jsx("input",{type:"text",value:v.name||"",onChange:e=>j({...v,name:e.target.value}),placeholder:"Enter evacuation center name",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(N.name?"border-red-500":"border-gray-300")}),N.name&&I.jsx("p",{className:"text-red-500 text-xs mt-1",children:N.name})]})})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:[I.jsx(_p,{className:"w-5 h-5 inline mr-2"}),"Location Information"]}),I.jsx("div",{className:"space-y-4",children:I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location Coordinates *"}),I.jsx("div",{className:"text-xs text-gray-500 mb-3",children:"Click on the map below to select coordinates, or enter them manually"}),I.jsx("div",{className:"mb-4",children:I.jsx(wp,{latitude:v.latitude||null,longitude:v.longitude||null,onCoordinateChange:(e,t)=>{j(s=>({...s,latitude:e,longitude:t}))},height:"250px"})}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),I.jsx("input",{type:"number",step:"0.0001",value:v.latitude||"",onChange:e=>j({...v,latitude:parseFloat(e.target.value)}),placeholder:"e.g., 13.7565",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(N.latitude?"border-red-500":"border-gray-300")}),N.latitude&&I.jsx("p",{className:"text-red-500 text-xs mt-1",children:N.latitude})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),I.jsx("input",{type:"number",step:"0.0001",value:v.longitude||"",onChange:e=>j({...v,longitude:parseFloat(e.target.value)}),placeholder:"e.g., 121.3851",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(N.longitude?"border-red-500":"border-gray-300")}),N.longitude&&I.jsx("p",{className:"text-red-500 text-xs mt-1",children:N.longitude})]})]})]})})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:[I.jsx(Ap,{className:"w-5 h-5 inline mr-2"}),"Capacity & Status"]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacity *"}),I.jsx("input",{type:"number",min:"0",value:v.capacity||"",onChange:e=>j({...v,capacity:parseInt(e.target.value)}),placeholder:"Enter maximum capacity",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(N.capacity?"border-red-500":"border-gray-300")}),N.capacity&&I.jsx("p",{className:"text-red-500 text-xs mt-1",children:N.capacity})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Occupancy"}),I.jsx("input",{type:"number",min:"0",value:v.current_occupancy||"",onChange:e=>j({...v,current_occupancy:parseInt(e.target.value)}),placeholder:"Enter current occupancy",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(N.current_occupancy?"border-red-500":"border-gray-300")}),N.current_occupancy&&I.jsx("p",{className:"text-red-500 text-xs mt-1",children:N.current_occupancy})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),I.jsxs("select",{value:v.status||"open",onChange:e=>j({...v,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[I.jsx("option",{value:"open",children:"Open"}),I.jsx("option",{value:"full",children:"Full"}),I.jsx("option",{value:"closed",children:"Closed"})]})]})]})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:[I.jsx(Pp,{className:"w-5 h-5 inline mr-2"}),"Contact Information"]}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Person"}),I.jsx("input",{type:"text",value:v.contact_person||"",onChange:e=>j({...v,contact_person:e.target.value}),placeholder:"Enter contact person name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Number"}),I.jsx("input",{type:"tel",value:v.contact_number||"",onChange:e=>j({...v,contact_number:e.target.value}),placeholder:"Enter contact number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})]}),I.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[I.jsx("button",{onClick:()=>{h(!1),g(!1),j({}),w({})},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),I.jsx("button",{onClick:m?async()=>{if(E(v)){k(!0);try{const t={name:v.name,latitude:Number(v.latitude),longitude:Number(v.longitude),capacity:Number(v.capacity),current_occupancy:Number(v.current_occupancy)||0,status:v.status||"open",contact_person:v.contact_person||null,contact_number:v.contact_number||null,email:v.email||null,address:v.address||null},r=await ke(t),a=r?.data||r;a&&(s(e=>[a,...e]),h(!1),j({}),w({}),e({type:"success",title:"Success",message:"Evacuation center created successfully"}))}catch(t){e({type:"error",title:"Error",message:"Failed to create evacuation center. Please try again."})}finally{k(!1)}}}:async()=>{if(b&&E(v)){k(!0);try{const t={name:v.name,latitude:Number(v.latitude),longitude:Number(v.longitude),capacity:Number(v.capacity),current_occupancy:Number(v.current_occupancy)||0,status:v.status||"open",contact_person:v.contact_person||null,contact_number:v.contact_number||null,email:v.email||null,address:v.address||null},r=await Ce(b.center_id,t),a=r?.data||r;a&&(s(e=>e.map(e=>e.center_id===b.center_id?a:e)),g(!1),y(null),j({}),w({}),e({type:"success",title:"Success",message:"Evacuation center updated successfully"}))}catch(t){e({type:"error",title:"Error",message:"Failed to update evacuation center. Please try again."})}finally{k(!1)}}},disabled:S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:S?"Saving...":m?"Create":"Update"})]})]})})}),I.jsx(wl,{isOpen:f,onClose:()=>{p(!1),y(null)},onConfirm:async()=>{if(b)try{await $e(b.center_id),s(e=>e.filter(e=>e.center_id!==b.center_id)),p(!1),y(null),e({type:"success",title:"Success",message:"Evacuation center deleted successfully"})}catch(t){e({type:"error",title:"Error",message:"Failed to delete evacuation center. Please try again."})}},title:"Delete Evacuation Center",message:`Are you sure you want to delete the evacuation center "${b?.name}"? This action cannot be undone.`,confirmText:"Delete Center",cancelText:"Cancel",confirmVariant:"secondary",icon:"ri-delete-bin-line",iconColor:"text-red-600",isLoading:S}),I.jsx(Lx,{open:C,data:L,columns:[{key:"name",label:"Center Name"},{key:"status",label:"Status"},{key:"capacity",label:"Capacity"},{key:"current_occupancy",label:"Current Occupancy"},{key:"occupancy_rate",label:"Occupancy Rate"},{key:"contact_person",label:"Contact Person"},{key:"contact_number",label:"Contact Number"}],title:"Evacuation Centers Export",onClose:()=>$(!1),onExportPDF:()=>T("pdf",[{key:"name",label:"Center Name"},{key:"status",label:"Status"},{key:"capacity",label:"Capacity"},{key:"current_occupancy",label:"Current Occupancy"},{key:"occupancy_rate",label:"Occupancy Rate"},{key:"contact_person",label:"Contact Person"},{key:"contact_number",label:"Contact Number"}]),onExportCSV:()=>T("csv",[{key:"name",label:"Center Name"},{key:"status",label:"Status"},{key:"capacity",label:"Capacity"},{key:"current_occupancy",label:"Current Occupancy"},{key:"occupancy_rate",label:"Occupancy Rate"},{key:"contact_person",label:"Contact Person"},{key:"contact_number",label:"Contact Number"}]),onExportExcel:()=>T("excel",[{key:"name",label:"Center Name"},{key:"status",label:"Status"},{key:"capacity",label:"Capacity"},{key:"current_occupancy",label:"Current Occupancy"},{key:"occupancy_rate",label:"Occupancy Rate"},{key:"contact_person",label:"Contact Person"},{key:"contact_number",label:"Contact Number"}])})]})},Fp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m-6 3l6-3"})}),Rp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Dp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),Mp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Bp=e=>I.jsxs("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),Up=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),qp=e=>I.jsxs("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),zp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m-6 3l6-3"})}),Wp=[{name:"Alupay",lat:13.8404,lng:121.2922},{name:"Antipolo",lat:13.708,lng:121.3096},{name:"Bagong Pook",lat:13.8402,lng:121.2216},{name:"Balibago",lat:13.8512,lng:121.2855},{name:"Barangay A",lat:13.8457,lng:121.2104},{name:"Barangay B",lat:13.8461,lng:121.2065},{name:"Barangay C",lat:13.8467,lng:121.2032},{name:"Barangay D",lat:13.844,lng:121.2035},{name:"Barangay E",lat:13.8415,lng:121.2047},{name:"Bayawang",lat:13.7944,lng:121.2798},{name:"Baybayin",lat:13.8277,lng:121.2589},{name:"Bulihan",lat:13.7967,lng:121.2351},{name:"Cahigam",lat:13.8021,lng:121.2501},{name:"Calantas",lat:13.734,lng:121.3129},{name:"Colongan",lat:13.8114,lng:121.1762},{name:"Itlugan",lat:13.819,lng:121.2036},{name:"Leviste",lat:13.7694,lng:121.2868},{name:"Lumbangan",lat:13.8122,lng:121.2649},{name:"Maalas-as",lat:13.8112,lng:121.2122},{name:"Mabato",lat:13.8144,lng:121.2913},{name:"Mabunga",lat:13.781,lng:121.2924},{name:"Macalamcam A",lat:13.8551,lng:121.3046},{name:"Macalamcam B",lat:13.8606,lng:121.3265},{name:"Malaya",lat:13.8535,lng:121.172},{name:"Maligaya",lat:13.8182,lng:121.2742},{name:"Marilag",lat:13.8562,lng:121.1764},{name:"Masaya",lat:13.8383,lng:121.1852},{name:"Matamis",lat:13.7216,lng:121.3305},{name:"Mavalor",lat:13.8177,lng:121.2315},{name:"Mayuro",lat:13.7944,lng:121.2623},{name:"Namuco",lat:13.8382,lng:121.2036},{name:"Namunga",lat:13.8431,lng:121.1978},{name:"Nasi",lat:13.7699,lng:121.3127},{name:"Natu",lat:13.842,lng:121.2683},{name:"Palakpak",lat:13.7079,lng:121.332},{name:"Pinagsibaan",lat:13.8438,lng:121.3141},{name:"Putingkahoy",lat:13.8349,lng:121.3227},{name:"Quilib",lat:13.8603,lng:121.2002},{name:"Salao",lat:13.8578,lng:121.3455},{name:"San Carlos",lat:13.8478,lng:121.2475},{name:"San Ignacio",lat:13.8335,lng:121.1764},{name:"San Isidro",lat:13.8074,lng:121.3152},{name:"San Jose",lat:13.8419,lng:121.2329},{name:"San Roque",lat:13.8518,lng:121.2039},{name:"Santa Cruz",lat:13.8599,lng:121.1853},{name:"Timbugan",lat:13.8095,lng:121.1869},{name:"Tiquiwan",lat:13.8284,lng:121.2399},{name:"Tulos",lat:13.7231,lng:121.2971}],Vp=()=>{const[e,t]=n.useState([]),[s,r]=n.useState([]),[a,i]=n.useState(!0),[l,o]=n.useState(""),[d,c]=n.useState("all"),[u,m]=n.useState("all"),[h,x]=n.useState(!1),[g,f]=n.useState(!1),[p,b]=n.useState(null),[y,v]=n.useState(null),[j,N]=n.useState(!1),[w,S]=n.useState(null),[k,C]=n.useState(""),[$,_]=n.useState(!1),[A,P]=n.useState({name:"",description:"",center_id:"",start_location:"",end_location:"",priority:"primary",status:"active"}),{showToast:L}=$t(),[E,T]=n.useState(!1),[O,F]=n.useState(null),R=e=>{const t=Wp.find(t=>t.name===e);return t?{lat:t.lat,lng:t.lng}:null};n.useEffect(()=>{D()},[]);const D=async()=>{try{i(!0),C("");const e=await Se();let s=[];e&&"object"==typeof e&&(e.success&&e.data?s=e.data:Array.isArray(e)?s=e:e.data&&Array.isArray(e.data)&&(s=e.data)),r(s);const a=await ve();let n=[];a&&"object"==typeof a&&(a.success&&a.routes?n=a.routes:a.success&&a.data?n=a.data:Array.isArray(a)&&(n=a));const l=n.filter(e=>{const t=s.some(t=>t.center_id===e.center_id);return t});t(l)}catch(e){C("Failed to load evacuation routes data. Please try again.")}finally{i(!1)}},M=e=>{switch(e){case"emergency":return"bg-red-100 text-red-800";case"primary":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},B=e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"inactive":default:return"bg-gray-100 text-gray-800";case"under_review":return"bg-yellow-100 text-yellow-800"}},U=e=>{b(e),v(null),N(!1),(async e=>{N(!0);try{const t=s.find(t=>t.center_id===e.center_id);if(!t)return void v(null);const r=R(e.start_location);if(!r)return void v(null);const a=[[r.lat,r.lng],...e.waypoints.map(e=>[e.lat,e.lng]),[Number(t.latitude),Number(t.longitude)]];let n=0;for(let e=0;e<a.length-1;e++){const t=a[e][0],s=a[e][1],r=a[e+1][0],i=a[e+1][1],l=6371,o=(r-t)*Math.PI/180,d=(i-s)*Math.PI/180,c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(d/2)*Math.sin(d/2);n+=l*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}const i=Math.round(n/30*60),l={coordinates:a.map(e=>[e[1],e[0]])},o={distance:1e3*n,duration:60*i,distanceKm:Math.round(100*n)/100,durationMinutes:i,geometry:l,steps:[]};v(o)}catch(t){v(null)}finally{N(!1)}})(e),f(!0)},q=e.filter(e=>{const t=s.find(t=>t.center_id===e.center_id),r=e.name.toLowerCase().includes(l.toLowerCase())||e.description.toLowerCase().includes(l.toLowerCase())||e.start_location.toLowerCase().includes(l.toLowerCase())||e.end_location.toLowerCase().includes(l.toLowerCase())||t&&t.name.toLowerCase().includes(l.toLowerCase()),a="all"===d||e.priority===d,n="all"===u||e.status===u;return r&&a&&n});return a?I.jsx("div",{className:"flex items-center justify-center min-h-screen",children:I.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Evacuation Routes"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Manage evacuation routes and driving directions"})]}),I.jsxs("button",{onClick:()=>{S(null),P({name:"",description:"",center_id:"",start_location:"",end_location:"",priority:"primary",status:"active"}),C(""),x(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[I.jsx(Rp,{className:"w-4 h-4 mr-2"}),"Add New Route"]})]}),k&&I.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:I.jsxs("div",{className:"flex",children:[I.jsx("div",{className:"flex-shrink-0",children:I.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:I.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),I.jsx("div",{className:"ml-3",children:I.jsx("p",{className:"text-sm text-red-800",children:k})}),I.jsx("div",{className:"ml-auto pl-3",children:I.jsx("button",{onClick:()=>C(""),className:"inline-flex text-red-400 hover:text-red-600",children:I.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:I.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(Fp,{className:"w-5 h-5 text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total Routes"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(Fp,{className:"w-5 h-5 text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Active Routes"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(e=>"active"===e.status).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(Fp,{className:"w-5 h-5 text-red-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Emergency Routes"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(e=>"emergency"===e.priority).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(Bp,{className:"w-5 h-5 text-purple-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Centers Connected"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:new Set(e.map(e=>e.center_id)).size})]})]})})]}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[I.jsx("div",{className:"flex-1",children:I.jsxs("div",{className:"relative",children:[I.jsx(Up,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),I.jsx("input",{type:"text",placeholder:"Search routes...",value:l,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),I.jsxs("select",{value:d,onChange:e=>c(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[I.jsx("option",{value:"all",children:"All Priorities"}),I.jsx("option",{value:"primary",children:"Primary"}),I.jsx("option",{value:"secondary",children:"Secondary"}),I.jsx("option",{value:"emergency",children:"Emergency"})]}),I.jsxs("select",{value:u,onChange:e=>m(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[I.jsx("option",{value:"all",children:"All Status"}),I.jsx("option",{value:"active",children:"Active"}),I.jsx("option",{value:"inactive",children:"Inactive"}),I.jsx("option",{value:"under_review",children:"Under Review"})]})]})}),I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[I.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:I.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Evacuation Routes"})}),I.jsx("div",{className:"overflow-x-auto",children:I.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[I.jsx("thead",{className:"bg-gray-50",children:I.jsxs("tr",{children:[I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Route Name"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Destination"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),I.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:q.map(e=>{const t=s.find(t=>t.center_id===e.center_id);return I.jsxs("tr",{className:"hover:bg-gray-50",children:[I.jsxs("td",{className:"px-6 py-4",children:[I.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),I.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:e.description})]}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${M(e.priority)}`,children:e.priority})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${B(e.status)}`,children:e.status})}),I.jsx("td",{className:"px-6 py-4",children:I.jsxs("div",{className:"text-sm text-gray-900",children:[I.jsxs("div",{className:"flex items-center mb-1",children:[I.jsx(Bp,{className:"w-4 h-4 mr-1 text-gray-400"}),t?t.name:I.jsxs("span",{className:"text-red-500 text-xs",children:["Center ID: ",e.center_id," (Not Found)"]})]}),I.jsxs("div",{className:"text-xs text-gray-500",children:[e.start_location," → ",e.end_location]})]})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("button",{onClick:()=>U(e),className:"text-blue-600 hover:text-blue-900 transition-colors",title:"View route details",children:I.jsx(qp,{className:"w-4 h-4"})}),I.jsx("button",{onClick:()=>(e=>{S(e),P({name:e.name,description:e.description,center_id:e.center_id.toString(),start_location:e.start_location||"",end_location:e.end_location,priority:e.priority,status:e.status}),C(""),x(!0)})(e),className:"text-yellow-600 hover:text-yellow-900 transition-colors",title:"Edit route",children:I.jsx(Dp,{className:"w-4 h-4"})}),I.jsx("button",{onClick:()=>{return t=e.id,F(t),void T(!0);var t},className:"text-red-600 hover:text-red-900 transition-colors",title:"Delete route",children:I.jsx(Mp,{className:"w-4 h-4"})})]})})]},e.id)})})]})}),0===q.length&&I.jsxs("div",{className:"text-center py-12",children:[I.jsx(Fp,{className:"mx-auto h-12 w-12 text-gray-400"}),I.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No routes found"}),I.jsx("p",{className:"mt-1 text-sm text-gray-500",children:l||"all"!==d||"all"!==u?"Try adjusting your search or filters.":"Get started by adding a new evacuation route."})]})]}),h&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:I.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:I.jsxs("div",{className:"p-6",children:[I.jsx("h2",{className:"text-xl font-bold mb-4",children:w?"Edit Route":"Add New Route"}),k&&I.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:I.jsx("p",{className:"text-sm text-red-800",children:k})}),I.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),A.name.trim())if(A.center_id)if(A.start_location.trim())if(A.end_location.trim())try{_(!0),C("");const e=R(A.start_location),t={name:A.name.trim(),description:A.description.trim(),center_id:parseInt(A.center_id),start_location:A.start_location.trim(),end_location:A.end_location.trim(),start_latitude:e?.lat||0,start_longitude:e?.lng||0,priority:A.priority,status:A.status,distance:y?y.distanceKm:0,estimated_time:y?y.durationMinutes:0};w?(await Ne(w.id,t),L({type:"success",message:"Route updated successfully"})):(await je(t),L({type:"success",message:"Route created successfully"})),x(!1),S(null),await D()}catch(t){const e=t.message||"Failed to save route. Please try again.";C(e),L({type:"error",message:"Failed to save route"})}finally{_(!1)}else C("End location is required.");else C("Start location is required.");else C("Please select a destination center.");else C("Route name is required.")},className:"space-y-4",children:[I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Route Name *"}),I.jsx("input",{type:"text",value:A.name,onChange:e=>P({...A,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,placeholder:"Enter route name",disabled:$,maxLength:100})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination Center *"}),I.jsxs("select",{value:A.center_id,onChange:e=>(e=>{const t=s.find(t=>t.center_id.toString()===e);P(s=>({...s,center_id:e,end_location:t?`${t.name}, Rosario, Batangas`:""}))})(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:$,children:[I.jsx("option",{value:"",children:"Select a center"}),s.map(e=>I.jsx("option",{value:e.center_id,children:e.name},e.center_id))]}),A.center_id&&I.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"End location will be auto-filled when center is selected"})]})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),I.jsx("textarea",{value:A.description,onChange:e=>P({...A,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter route description",disabled:$,rows:3,maxLength:500})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Location (Barangay) *"}),I.jsxs("select",{value:A.start_location,onChange:e=>P({...A,start_location:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:$,children:[I.jsx("option",{value:"",children:"Select a barangay"}),Wp.map(e=>I.jsx("option",{value:e.name,children:e.name},e.name))]}),I.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the barangay where the evacuation route starts"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Location *"}),I.jsx("input",{type:"text",value:A.end_location,onChange:e=>P({...A,end_location:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,placeholder:"e.g., Evacuation Center Name, Rosario, Batangas",disabled:$,maxLength:255}),I.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Destination evacuation center"})]})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),I.jsxs("select",{value:A.priority,onChange:e=>P({...A,priority:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:$,children:[I.jsx("option",{value:"primary",children:"Primary"}),I.jsx("option",{value:"secondary",children:"Secondary"}),I.jsx("option",{value:"emergency",children:"Emergency"})]})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),I.jsxs("select",{value:A.status,onChange:e=>P({...A,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:$,children:[I.jsx("option",{value:"active",children:"Active"}),I.jsx("option",{value:"inactive",children:"Inactive"}),I.jsx("option",{value:"under_review",children:"Under Review"})]})]})]}),I.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[I.jsx("button",{type:"button",onClick:()=>{x(!1),S(null),C("")},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:$,children:"Cancel"}),I.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center",disabled:$,children:$?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),w?"Updating...":"Creating..."]}):I.jsx(I.Fragment,{children:w?"Update Route":"Create Route"})})]})]})]})})}),g&&p&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:I.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:I.jsxs("div",{className:"p-6",children:[I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Route Details"}),I.jsx("button",{onClick:()=>{f(!1),b(null),v(null),N(!1)},className:"text-gray-400 hover:text-gray-600",children:I.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Route Information"}),I.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[I.jsxs("div",{children:[I.jsx("strong",{children:"Name:"})," ",p.name]}),I.jsxs("div",{children:[I.jsx("strong",{children:"Description:"})," ",p.description]}),I.jsxs("div",{children:[I.jsx("strong",{children:"Status:"}),I.jsx("span",{className:`ml-1 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${B(p.status)}`,children:p.status})]}),I.jsxs("div",{children:[I.jsx("strong",{children:"Priority:"}),I.jsx("span",{className:`ml-1 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${M(p.priority)}`,children:p.priority})]}),I.jsxs("div",{children:[I.jsx("strong",{children:"Distance:"})," ",y?`${y.distanceKm} km`:`${p.distance} km`]}),I.jsxs("div",{children:[I.jsx("strong",{children:"Estimated Time:"})," ",y?`${y.durationMinutes} minutes`:`${p.estimated_time} minutes`]})]})]}),I.jsxs("div",{children:[I.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Location Details"}),I.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[I.jsxs("div",{children:[I.jsx("strong",{children:"Start:"})," ",p.start_location]}),I.jsxs("div",{children:[I.jsx("strong",{children:"End:"})," ",p.end_location]}),I.jsxs("div",{children:[I.jsx("strong",{children:"Distance:"})," ",y?`${y.distanceKm} km`:`${p.distance} km`]}),I.jsxs("div",{children:[I.jsx("strong",{children:"Estimated Time:"})," ",y?`${y.durationMinutes} minutes`:`${p.estimated_time} minutes`]})]})]})]}),I.jsxs("div",{children:[I.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Destination Center"}),I.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:(()=>{const e=s.find(e=>e.center_id===p.center_id);return e?I.jsxs("div",{className:"space-y-1 text-sm",children:[I.jsx("div",{className:"font-medium text-gray-900",children:e.name}),I.jsx("div",{className:"text-gray-600",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx(Bp,{className:"w-4 h-4 mr-1"}),Number(e.latitude).toFixed(4),", ",Number(e.longitude).toFixed(4)]})}),e.address&&I.jsx("div",{className:"text-gray-600",children:e.address})]}):I.jsx("div",{className:"text-gray-500",children:"Center information not available"})})()})]}),p.waypoints&&p.waypoints.length>0&&I.jsxs("div",{children:[I.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Waypoints"}),I.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:I.jsx("div",{className:"space-y-1 text-sm",children:p.waypoints.map((e,t)=>I.jsxs("div",{className:"flex items-center",children:[I.jsx(Fp,{className:"w-4 h-4 mr-2 text-gray-400"}),I.jsxs("span",{children:["Point ",t+1,": ",e.lat.toFixed(4),", ",e.lng.toFixed(4)]})]},t))})})]}),I.jsxs("div",{children:[I.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Route Map"}),I.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:(()=>{const e=s.find(e=>e.center_id===p.center_id),t=R(p.start_location);if(!e||!t)return I.jsxs("div",{className:"text-center py-8 text-gray-500",children:[I.jsx(Bp,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),I.jsx("p",{children:"Map data not available for this route"})]});let r=[[t.lat,t.lng],...p.waypoints.map(e=>[e.lat,e.lng]),[Number(e.latitude),Number(e.longitude)]];if(y&&y.geometry&&y.geometry.coordinates)try{r=y.geometry.coordinates.map(e=>[e[1],e[0]])}catch(n){}const a=Fl.latLngBounds(r.map(e=>[e[0],e[1]]));return I.jsxs("div",{className:"space-y-4",children:[y&&y.success?I.jsxs("div",{className:"flex items-center text-sm text-green-600",children:[I.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"Route calculated using OpenRouteService"]}):I.jsxs("div",{className:"flex items-center text-sm text-amber-600",children:[I.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full mr-2"}),"Showing direct route (routing service unavailable)"]}),I.jsx("div",{className:"h-96 rounded-lg overflow-hidden",children:I.jsxs(Jl,{bounds:a,scrollWheelZoom:!0,className:"h-full w-full",children:[I.jsx(Ql,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),I.jsx(Kl,{position:[t.lat,t.lng],children:I.jsx(Xl,{children:I.jsxs("div",{className:"text-sm",children:[I.jsx("strong",{children:"Start Location"}),I.jsx("br",{}),p.start_location]})})}),I.jsx(Kl,{position:[Number(e.latitude),Number(e.longitude)],children:I.jsx(Xl,{children:I.jsxs("div",{className:"text-sm",children:[I.jsx("strong",{children:"Evacuation Center"}),I.jsx("br",{}),e.name,I.jsx("br",{}),e.address]})})}),p.waypoints.map((e,t)=>I.jsx(Kl,{position:[e.lat,e.lng],children:I.jsx(Xl,{children:I.jsxs("div",{className:"text-sm",children:[I.jsxs("strong",{children:["Waypoint ",t+1]}),I.jsx("br",{}),e.lat.toFixed(4),", ",e.lng.toFixed(4)]})})},t)),I.jsx(Zl,{positions:r,color:y&&y.success?"blue":"orange",weight:4,opacity:.7})]})}),y&&y.steps&&y.steps.length>0&&I.jsxs("div",{className:"p-3 bg-gray-100 rounded-lg max-h-64 overflow-y-auto text-sm text-gray-700",children:[I.jsx("h4",{className:"font-semibold mb-2",children:"Turn-by-Turn Directions"}),I.jsx("ol",{className:"list-decimal list-inside space-y-1",children:y.steps.map((e,t)=>I.jsxs("li",{children:[e.instruction," (",(e.distance/1e3).toFixed(2)," km, ",(e.duration/60).toFixed(1)," min)"]},t))})]})]})})()})]})]}),I.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[I.jsxs("button",{onClick:()=>(e=>{const t=s.find(t=>t.center_id===e.center_id);if(t){const s=`${t.latitude},${t.longitude}`,r=e.start_location,a=`https://www.google.com/maps/dir/${encodeURIComponent(r)}/${encodeURIComponent(s)}`;window.open(a,"_blank")}})(p),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center",children:[I.jsx(zp,{className:"w-4 h-4 mr-2"}),"Open in Google Maps"]}),I.jsx("button",{onClick:()=>{f(!1),b(null),v(null),N(!1)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})]})]})})}),I.jsx(wl,{isOpen:E,onClose:()=>{T(!1),F(null)},onConfirm:async()=>{if(null!=O)try{C(""),await we(O),await D(),L({type:"success",message:"Route deleted successfully"})}catch(e){C("Failed to delete route. Please try again."),L({type:"error",message:"Failed to delete route"})}finally{T(!1),F(null)}},title:"Delete Route",message:"Are you sure you want to delete this route? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",confirmVariant:"secondary",icon:"ri-delete-bin-line",iconColor:"text-red-600"})]})},Hp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Gp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Jp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),Kp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Yp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),Zp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),Xp=e=>I.jsxs("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),Qp=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),eb=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),tb=e=>I.jsx("svg",{...e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),sb=()=>{const[e,t]=n.useState([]),[s,r]=n.useState([]),[a,i]=n.useState(!0),[l,o]=n.useState(!1),[d,c]=n.useState(!1),[u,m]=n.useState(null),[h,x]=n.useState(""),[g,f]=n.useState(""),[p,b]=n.useState("all"),[y,v]=n.useState(""),[j,N]=n.useState(!1),[w,S]=n.useState({type:"facility",name:"",quantity:1}),[k,C]=n.useState(null),[$,_]=n.useState(null),{showToast:A}=$t(),[P,L]=n.useState(!1),[E,T]=n.useState(null),[O,F]=n.useState(!1),[R,D]=n.useState(null),[M,B]=n.useState(!1);n.useEffect(()=>{U()},[]),n.useEffect(()=>()=>{$&&$.startsWith("blob:")&&URL.revokeObjectURL($)},[$]);const U=async()=>{try{i(!0),v("");const e=await Se();let t=[];e&&"object"==typeof e&&(e.success&&e.data?t=e.data:Array.isArray(e)?t=e:e.data&&Array.isArray(e.data)&&(t=e.data)),r(t),t.length>0&&(x(t[0].center_id),await q(t[0].center_id))}catch(e){v("Failed to load evacuation centers. Please try again.")}finally{i(!1)}},q=async e=>{try{o(!0),v("");const s=await _e(e);let r=[];s&&"object"==typeof s&&(s.success&&s.data?r=s.data:Array.isArray(s)?r=s:s.data&&Array.isArray(s.data)&&(r=s.data)),r=r.map(e=>({...e,created_at:e.created_at||e.updated_at||(new Date).toISOString(),updated_at:e.updated_at||(new Date).toISOString()})),t(r)}catch(s){v("Failed to load resources for this center. Please try again."),t([])}finally{o(!1)}},z=()=>{S({type:"facility",name:"",quantity:1}),C(null),_(null),v("")},W=e=>{switch(e){case"facility":return"bg-blue-100 text-blue-800";case"feature":return"bg-green-100 text-green-800";case"water":return"bg-cyan-100 text-cyan-800";case"supply":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},V=()=>{F(!1),D(null)},H=[{key:"name",label:"Resource Name"},{key:"type",label:"Type"},{key:"quantity",label:"Quantity"},{key:"created_at",label:"Created Date",format:e=>new Date(e).toLocaleDateString()},{key:"updated_at",label:"Last Updated",format:e=>new Date(e).toLocaleDateString()}],G=()=>J.map(e=>({name:e.name,type:e.type.charAt(0).toUpperCase()+e.type.slice(1),quantity:e.quantity,created_at:e.created_at,updated_at:e.updated_at})),J=e.filter(e=>{const t=e.name.toLowerCase().includes(g.toLowerCase()),s="all"===p||e.type===p;return t&&s}),K=e.length,Y=e.filter(e=>"facility"===e.type).length,Z=e.filter(e=>"feature"===e.type).length,X=e.filter(e=>"water"===e.type).length,Q=e.filter(e=>"supply"===e.type).length;return a?I.jsx("div",{className:"flex items-center justify-center min-h-screen",children:I.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):s.length?I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Evacuation Resources"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Manage resources and supplies at evacuation centers"})]}),h&&I.jsxs("div",{className:"flex gap-3",children:[I.jsxs("button",{onClick:()=>{v(""),c(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[I.jsx(Gp,{className:"w-4 h-4 mr-2"}),"Add New Resource"]}),I.jsxs("button",{onClick:()=>B(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center",title:"Export Resources",children:[I.jsx(tb,{className:"w-4 h-4 mr-2"}),"Export Resources"]})]})]}),y&&I.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:I.jsxs("div",{className:"flex",children:[I.jsx("div",{className:"flex-shrink-0",children:I.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:I.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),I.jsx("div",{className:"ml-3",children:I.jsx("p",{className:"text-sm text-red-800",children:y})}),I.jsx("div",{className:"ml-auto pl-3",children:I.jsx("button",{onClick:()=>v(""),className:"inline-flex text-red-400 hover:text-red-600",children:I.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:I.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:I.jsx("div",{className:"flex items-center gap-4",children:I.jsxs("div",{className:"flex-1",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Center"}),I.jsx("select",{value:h,onChange:e=>(async e=>{x(e),f(""),b("all"),await q(e)})(parseInt(e.target.value)),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:s.map(e=>I.jsx("option",{value:e.center_id,children:e.name},e.center_id))})]})})}),h&&I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(Yp,{className:"w-5 h-5 text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total Resources"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:K})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(Zp,{className:"w-5 h-5 text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Facilities"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:Y})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(Xp,{className:"w-5 h-5 text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Features"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:Z})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-cyan-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(Qp,{className:"w-5 h-5 text-cyan-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Water"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:X})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx(eb,{className:"w-5 h-5 text-orange-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Supplies"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:Q})]})]})})]}),h&&I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[I.jsx("div",{className:"flex-1",children:I.jsxs("div",{className:"relative",children:[I.jsx(Hp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),I.jsx("input",{type:"text",placeholder:"Search resources...",value:g,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),I.jsxs("select",{value:p,onChange:e=>b(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[I.jsx("option",{value:"all",children:"All Types"}),I.jsx("option",{value:"facility",children:"Facility"}),I.jsx("option",{value:"feature",children:"Feature"}),I.jsx("option",{value:"water",children:"Water"}),I.jsx("option",{value:"supply",children:"Supply"})]})]})}),h&&I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[I.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:I.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Resources at ",s.find(e=>e.center_id===h)?.name]})}),l?I.jsxs("div",{className:"flex items-center justify-center py-12",children:[I.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),I.jsx("span",{className:"ml-2 text-gray-600",children:"Loading resources..."})]}):I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"overflow-x-auto",children:I.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[I.jsx("thead",{className:"bg-gray-50",children:I.jsxs("tr",{children:[I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Resource"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Picture"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Updated"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),I.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:J.map(e=>{const t=(e=>{switch(e){case"facility":return Zp;case"feature":return Xp;case"water":return Qp;case"supply":return eb;default:return Yp}})(e.type);return I.jsxs("tr",{className:"hover:bg-gray-50",children:[I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${W(e.type)}`,children:[I.jsx(t,{className:"w-3 h-3 mr-1"}),e.type]})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.quantity}),I.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.picture?I.jsx("img",{src:e.picture,alt:e.name,className:"w-10 h-10 rounded object-cover cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>{return t=e.picture,s=e.name,D({src:t,alt:s}),void F(!0);var t,s},onError:e=>{const t=e.target;t.style.display="none",t.nextElementSibling?.classList.remove("hidden")}}):null,I.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded flex items-center justify-center "+(e.picture?"hidden":""),children:I.jsx(Yp,{className:"w-5 h-5 text-gray-400"})})]}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.updated_at).toLocaleDateString()}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:I.jsxs("div",{className:"flex space-x-2",children:[I.jsx("button",{onClick:()=>(e=>{m(e),S({type:e.type,name:e.name,quantity:e.quantity}),C(null),_(e.picture||null),c(!0)})(e),className:"text-blue-600 hover:text-blue-900 p-1 rounded transition-colors",title:"Edit resource",children:I.jsx(Jp,{className:"w-4 h-4"})}),I.jsx("button",{onClick:()=>{return t=e.resource_id,T(t),void L(!0);var t},className:"text-red-600 hover:text-red-900 p-1 rounded transition-colors",title:"Delete resource",children:I.jsx(Kp,{className:"w-4 h-4"})})]})})]},e.resource_id)})})]})}),0===J.length&&I.jsxs("div",{className:"text-center py-12",children:[I.jsx(Yp,{className:"mx-auto h-12 w-12 text-gray-400"}),I.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No resources found"}),I.jsx("p",{className:"mt-1 text-sm text-gray-500",children:g||"all"!==p?"Try adjusting your search or filters.":"Get started by adding a new resource."})]})]})]}),d&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:I.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:I.jsxs("div",{className:"p-6",children:[I.jsx("h2",{className:"text-xl font-bold mb-4",children:u?"Edit Resource":"Add New Resource"}),y&&I.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:I.jsx("p",{className:"text-sm text-red-800",children:y})}),I.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),h)if(w.name.trim())try{N(!0),v("");const e={...w,name:w.name.trim()};let s;if(u)await Pe(h,u.resource_id,e),s=u.resource_id,A({type:"success",message:"Resource updated successfully"});else{const t=await Ae(h,e);s=t.data?.resource_id,A({type:"success",message:"Resource created successfully"})}if(k&&s)try{await Ee(h,s,k)}catch(t){A({type:"warning",message:"Image upload failed, saved without image"})}c(!1),m(null),z(),$&&$.startsWith("blob:")&&URL.revokeObjectURL($),await q(h)}catch(s){const e=s.message||"Failed to save resource. Please try again.";v(e),A({type:"error",message:"Failed to save resource"})}finally{N(!1)}else v("Resource name is required.");else v("Please select a center first.")},className:"space-y-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type *"}),I.jsxs("select",{value:w.type,onChange:e=>S({...w,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:j,children:[I.jsx("option",{value:"facility",children:"Facility"}),I.jsx("option",{value:"feature",children:"Feature"}),I.jsx("option",{value:"water",children:"Water"}),I.jsx("option",{value:"supply",children:"Supply"})]})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),I.jsx("input",{type:"text",value:w.name,onChange:e=>S({...w,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,placeholder:"Enter resource name",disabled:j,maxLength:100})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),I.jsx("input",{type:"number",min:"1",max:"999999",value:w.quantity,onChange:e=>S({...w,quantity:Math.max(1,parseInt(e.target.value)||1)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,placeholder:"Enter quantity",disabled:j})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Picture"}),I.jsxs("div",{className:"space-y-2",children:[$&&I.jsxs("div",{className:"relative",children:[I.jsx("img",{src:$,alt:"Preview",className:"w-full h-32 object-cover rounded-lg border border-gray-300"}),I.jsx("button",{type:"button",onClick:()=>{C(null),$&&$.startsWith("blob:")&&URL.revokeObjectURL($),_(null)},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",disabled:j,children:"×"})]}),I.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(t){if(!t.type.startsWith("image/"))return void v("Please select an image file.");if(t.size>5242880)return void v("Image size must be less than 5MB.");C(t),v("");const e=URL.createObjectURL(t);_(e)}},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",disabled:j}),I.jsx("p",{className:"text-xs text-gray-500",children:"Accepted formats: JPG, PNG, GIF. Max size: 5MB"})]})]}),I.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[I.jsx("button",{type:"button",onClick:()=>{c(!1),m(null),z(),$&&$.startsWith("blob:")&&URL.revokeObjectURL($)},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:j,children:"Cancel"}),I.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center",disabled:j,children:j?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),u?"Updating...":"Creating..."]}):I.jsx(I.Fragment,{children:u?"Update Resource":"Create Resource"})})]})]})]})})}),I.jsx(wl,{isOpen:P,onClose:()=>{L(!1),T(null)},onConfirm:async()=>{if(h&&null!=E)try{v(""),await Le(h,E),await q(h),A({type:"success",message:"Resource deleted successfully"})}catch(e){v("Failed to delete resource. Please try again."),A({type:"error",message:"Failed to delete resource"})}finally{L(!1),T(null)}},title:"Delete Resource",message:"Are you sure you want to delete this resource? This action cannot be undone.",confirmText:"Delete Resource",cancelText:"Cancel",confirmVariant:"secondary",icon:"ri-delete-bin-line",iconColor:"text-red-600",isLoading:j}),O&&R&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",onClick:V,children:I.jsxs("div",{className:"relative max-w-4xl max-h-full",children:[I.jsx("img",{src:R.src,alt:R.alt,className:"max-w-full max-h-full object-contain",onClick:e=>e.stopPropagation()}),I.jsx("button",{onClick:V,className:"absolute top-4 right-4 bg-black bg-opacity-50 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-opacity-75 transition-all",children:I.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),I.jsx(Lx,{open:M,onClose:()=>B(!1),onExportPDF:async()=>{try{const e=G();await Px.exportToPDF(e,H,{filename:`evacuation-resources-${s.find(e=>e.center_id===h)?.name||"all"}`,title:`Evacuation Resources - ${s.find(e=>e.center_id===h)?.name||"All Centers"}`,includeTimestamp:!0}),A({type:"success",message:"PDF exported successfully"}),B(!1)}catch(e){A({type:"error",message:"Failed to export PDF"})}},onExportCSV:()=>{try{const e=G();Px.exportToCSV(e,H,{filename:`evacuation-resources-${s.find(e=>e.center_id===h)?.name||"all"}`,includeTimestamp:!0}),A({type:"success",message:"CSV exported successfully"}),B(!1)}catch(e){A({type:"error",message:"Failed to export CSV"})}},onExportExcel:()=>{try{const e=G();Px.exportToExcel(e,H,{filename:`evacuation-resources-${s.find(e=>e.center_id===h)?.name||"all"}`,title:`Evacuation Resources - ${s.find(e=>e.center_id===h)?.name||"All Centers"}`,includeTimestamp:!0}),A({type:"success",message:"Excel exported successfully"}),B(!1)}catch(e){A({type:"error",message:"Failed to export Excel"})}},data:G(),columns:H,title:`Evacuation Resources - ${s.find(e=>e.center_id===h)?.name||"All Centers"}`})]}):I.jsxs("div",{className:"space-y-6",children:[I.jsx("div",{className:"flex items-center justify-between",children:I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Evacuation Resources"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Manage resources and supplies at evacuation centers"})]})}),I.jsxs("div",{className:"text-center py-12",children:[I.jsx(Zp,{className:"mx-auto h-12 w-12 text-gray-400"}),I.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No evacuation centers found"}),I.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"You need to create evacuation centers first before managing resources."}),I.jsx("div",{className:"mt-4",children:I.jsx("button",{onClick:()=>window.location.href="/admin/evacuation/centers",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Go to Evacuation Centers"})})]})]})},rb=()=>{const[e,t]=n.useState([]),[s,r]=n.useState(!0),[a,i]=n.useState(""),[l,o]=n.useState("all"),[d,c]=n.useState(!1),[u,m]=n.useState(null),[h,x]=n.useState(!1),[g,f]=n.useState(!1),{showToast:p}=$t(),[b,y]=n.useState(!1),[v,j]=n.useState(null),[N,w]=n.useState(""),[S,k]=n.useState(""),[C,$]=n.useState(""),[_,A]=n.useState(""),[P,L]=n.useState(!1),[E,T]=n.useState(!1),[O,F]=n.useState([]),[R,D]=n.useState([]),M=()=>{let e="Export Safety Protocols";return"all"===l&&""===a.trim()||(e+=" - ","all"!==l&&(e+=l),""!==a.trim()&&(e+=("all"!==l?" | ":"")+`Search: "${a.trim()}"`)),e};n.useEffect(()=>{V()},[]);const B=e=>{const t=(e||"").toLowerCase();return"fire"===t?"Fire Safety":"earthquake"===t?"Natural Disasters":"medical"===t?"Medical":"intrusion"===t?"Security":"general"===t?"Other":e||"Other"},U=e=>{const t=(e||"").toLowerCase();return"low"===t||"medium"===t||"high"===t||"critical"===t?t:"medium"},q=e=>{const t=(e||"").toLowerCase();return"active"===t||"draft"===t||"archived"===t?t:"active"},z=e=>{if(Array.isArray(e?.steps))return e.steps;if("string"==typeof e?.steps_json)try{const t=JSON.parse(e.steps_json);if(Array.isArray(t))return t}catch{}return"string"==typeof e?.steps?e.steps.split(/\r?\n/).map(e=>e.trim()).filter(Boolean):[]},W=e=>({id:Number(e?.protocol_id??e?.id??0),title:String(e?.title??""),description:String(e?.description??""),category:B(String(e?.type??e?.category??"General")),priority:U(String(e?.priority??"medium")),status:q(String(e?.status??"active")),steps:z(e),createdAt:e?.created_at?new Date(e.created_at).toISOString():(new Date).toISOString(),updatedAt:e?.updated_at?new Date(e.updated_at).toISOString():(new Date).toISOString(),protocol_id:e?.protocol_id??null,type:e?.type??void 0,file_attachment:e?.file_attachment??null,created_by:e?.created_by??null,created_at:e?.created_at??void 0,updated_at:e?.updated_at??void 0}),V=async()=>{try{const e=await Xe(),s=Array.isArray(e)?e.map(W):[];t(s)}catch(e){}finally{r(!1)}},H=e=>{const t=e.toLowerCase();return"fire"===t?"bg-red-50 text-red-600":"earthquake"===t?"bg-orange-50 text-orange-600":"medical"===t?"bg-green-50 text-green-600":"intrusion"===t?"bg-purple-50 text-purple-600":"bg-gray-50 text-gray-600"},G=async e=>{try{const t={filename:"SafetyProtocols",title:M(),includeTimestamp:!0};switch(e){case"pdf":await Px.exportToPDF(O,R,t);break;case"csv":Px.exportToCSV(O,R,t);break;case"excel":Px.exportToExcel(O,R,t)}T(!1),p({type:"success",message:"Export successful"})}catch(t){p({type:"error",message:"Export failed"})}},J=e.filter(e=>{const t=e.title.toLowerCase().includes(a.toLowerCase())||e.description.toLowerCase().includes(a.toLowerCase())||e.category.toLowerCase().includes(a.toLowerCase()),s="all"===l||e.category===l;return t&&s});return s?I.jsx("div",{className:"flex items-center justify-center h-64",children:I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Safety Protocols Management"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Manage emergency safety protocols"})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsxs("button",{onClick:()=>{m(null),x(!0),c(!0),w(""),k(""),$(""),A("")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[I.jsx("i",{className:"ri-add-line mr-2"}),"Add Protocol"]}),I.jsxs("button",{onClick:()=>{const e=[{key:"title",label:"Title"},{key:"description",label:"Description"},{key:"category",label:"Category"},{key:"status",label:"Status"},{key:"createdAt",label:"Created At",format:Px.formatDateTime}];D(e),F(J),T(!0)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export Protocols"]})]})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-shield-check-line text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total Protocols"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-folder-line text-purple-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Categories"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:new Set(e.map(e=>e.category)).size})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-check-circle-line text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Active Protocols"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(e=>"active"===e.status).length})]})]})})]}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-5",children:I.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[I.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0 md:space-x-4",children:[I.jsxs("div",{className:"relative",children:[I.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),I.jsx("input",{type:"text",placeholder:"Search protocols...",value:a,onChange:e=>i(e.target.value),className:"w-full md:w-64 pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"})]}),I.jsxs("select",{value:l,onChange:e=>o(e.target.value),className:"w-full md:w-auto px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",children:[I.jsx("option",{value:"all",children:"All Categories"}),I.jsx("option",{value:"Fire Safety",children:"Fire Safety"}),I.jsx("option",{value:"Natural Disasters",children:"Natural Disasters"}),I.jsx("option",{value:"Medical",children:"Medical"}),I.jsx("option",{value:"Security",children:"Security"}),I.jsx("option",{value:"Other",children:"Other"})]})]}),I.jsxs("div",{className:"text-sm text-gray-500 bg-gray-50 px-3 py-1 rounded-lg",children:["Showing ",I.jsx("span",{className:"font-medium text-gray-900",children:J.length})," of ",I.jsx("span",{className:"font-medium text-gray-900",children:e.length})," protocols"]})]})}),I.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:J.map(e=>I.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-5 hover:shadow-lg transition-all duration-200 group",children:[I.jsx("div",{className:"flex items-start justify-between",children:I.jsxs("div",{className:"flex-1",children:[I.jsx("div",{className:"flex items-center space-x-2 mb-3",children:I.jsx("span",{className:`px-2.5 py-1 text-xs font-medium rounded-full ${H(e.type||"general")}`,children:e.category})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 group-hover:text-blue-600 transition-colors",children:e.title}),I.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.description})]})}),I.jsxs("div",{className:"flex items-center justify-between pt-4 mt-4 border-t border-gray-100",children:[I.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[I.jsx("i",{className:"ri-time-line mr-1"}),new Date(e.updatedAt).toLocaleDateString()]}),I.jsxs("div",{className:"flex items-center space-x-1",children:[I.jsx("button",{onClick:()=>(e=>{m(e),x(!1),c(!0)})(e),className:"p-1.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-md transition-all",title:"View Protocol",children:I.jsx("i",{className:"ri-eye-line text-lg"})}),I.jsx("button",{onClick:()=>(e=>{m(e),x(!0),c(!0),w(e.title||""),k(e.description||""),$(e.type||""),A(e.file_attachment||"")})(e),className:"p-1.5 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-md transition-all",title:"Edit Protocol",children:I.jsx("i",{className:"ri-edit-line text-lg"})}),I.jsx("button",{onClick:()=>(e=>{j(e),y(!0)})(e),className:"p-1.5 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-md transition-all",title:"Delete Protocol",children:I.jsx("i",{className:"ri-delete-bin-line text-lg"})})]})]})]},e.id))}),I.jsx(Nl,{isOpen:d,onClose:()=>c(!1),title:h?u?"Edit Safety Protocol":"Add New Safety Protocol":"Safety Protocol Details",size:"xl",children:I.jsxs("div",{className:"space-y-4",children:[u&&!h?I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("span",{className:"px-2.5 py-1 bg-blue-50 text-blue-600 text-xs font-medium rounded-full",children:u.type?"general"===u.type?"Other":u.type.charAt(0).toUpperCase()+u.type.slice(1):"General"}),I.jsxs("span",{className:"text-xs text-gray-500",children:["ID: ",u.protocol_id??u.id]})]}),u.file_attachment&&I.jsxs("a",{href:`/uploads/${u.file_attachment}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-1.5 bg-white border border-gray-200 rounded-lg text-sm text-gray-600 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-200 transition-all",children:[I.jsx("i",{className:"ri-file-text-line mr-1.5"}),"View Attachment"]})]}),I.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:u.title}),I.jsx("p",{className:"text-gray-600 mb-4 whitespace-pre-line",children:u.description})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[I.jsx("div",{className:"space-y-4",children:I.jsxs("div",{children:[I.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2",children:"Created Information"}),I.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-100",children:[I.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[I.jsx("i",{className:"ri-user-line text-gray-400"}),I.jsx("span",{className:"text-gray-600",children:"Created by:"}),I.jsx("span",{className:"font-medium "+("System"!==u.creator_name?"text-gray-900":"text-gray-500 italic"),children:u.creator_name||"System"})]}),I.jsxs("div",{className:"flex items-center space-x-3 text-sm mt-2",children:[I.jsx("i",{className:"ri-time-line text-gray-400"}),I.jsx("span",{className:"text-gray-600",children:"Date:"}),I.jsx("span",{className:"font-medium text-gray-900",children:u.created_at?new Date(u.created_at).toLocaleString():new Date(u.createdAt).toLocaleString()})]})]})]})}),I.jsx("div",{className:"space-y-4",children:I.jsxs("div",{children:[I.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2",children:"Last Update"}),I.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-100",children:I.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[I.jsx("i",{className:"ri-history-line text-gray-400"}),I.jsx("span",{className:"text-gray-600",children:"Updated:"}),I.jsx("span",{className:"font-medium text-gray-900",children:u.updated_at?new Date(u.updated_at).toLocaleString():new Date(u.updatedAt).toLocaleString()})]})})]})})]})]}):I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Title ",I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsx("input",{type:"text",value:N,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Enter protocol title"})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Type ",I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsxs("select",{value:C,onChange:e=>$(e.target.value),className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",children:[I.jsx("option",{value:"",children:"Select Type"}),I.jsx("option",{value:"fire",children:"Fire"}),I.jsx("option",{value:"earthquake",children:"Earthquake"}),I.jsx("option",{value:"medical",children:"Medical"}),I.jsx("option",{value:"intrusion",children:"Intrusion"}),I.jsx("option",{value:"general",children:"Other"})]})]})]}),I.jsxs("div",{className:"mb-6",children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Description ",I.jsx("span",{className:"text-red-500",children:"*"})]}),I.jsx("textarea",{value:S,onChange:e=>k(e.target.value),rows:4,className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Enter detailed protocol description"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"File Attachment"}),I.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-200 border-dashed rounded-lg hover:border-blue-400 transition-all cursor-pointer",children:I.jsxs("div",{className:"space-y-2 text-center",children:[I.jsxs("div",{className:"flex text-sm text-gray-600",children:[I.jsx("input",{type:"file",accept:"*/*",onChange:async e=>{const t=e.target.files&&e.target.files[0];if(t)try{L(!0);const e=await Qe(t);e&&e.filename&&(A(e.filename),p({type:"success",message:"File uploaded"}))}catch(s){p({type:"error",message:"Failed to upload file"})}finally{L(!1)}},className:"sr-only",id:"file-upload"}),I.jsx("label",{htmlFor:"file-upload",className:"relative cursor-pointer rounded-md font-medium text-blue-600 hover:text-blue-700 focus-within:outline-none",children:I.jsx("span",{children:"Upload a file"})}),I.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),I.jsx("p",{className:"text-xs text-gray-500",children:"PDF, DOC, Images up to 10MB"}),P&&I.jsxs("div",{className:"flex items-center justify-center text-sm text-blue-600",children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Uploading..."]}),_&&I.jsxs("div",{className:"flex items-center justify-center text-sm text-green-600",children:[I.jsx("i",{className:"ri-check-line mr-1"}),_]})]})})]})]}),I.jsxs("div",{className:"pt-4 mt-2 border-t border-gray-200 flex justify-end space-x-3",children:[I.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:h?"Cancel":"Close"}),h&&I.jsx("button",{onClick:async()=>{try{f(!0);const e=JSON.parse(localStorage.getItem("adminInfo")||"{}"),t=e?.admin?.id;if(u){const e=Number(u.protocol_id??u.id),t={};""!==N.trim()&&(t.title=N.trim()),""!==S.trim()&&(t.description=S.trim()),C&&""!==C&&(t.type=C),t.file_attachment=_.trim()?_.trim():null,await tt(e,t),p({type:"success",message:"Protocol updated successfully"})}else{const e={title:N.trim(),description:S.trim(),type:C||"general",file_attachment:_.trim()||null,created_by:t||null};await et(e),p({type:"success",message:"Protocol created successfully"})}await V(),c(!1)}catch(e){p({type:"error",message:"Failed to save protocol"})}finally{f(!1)}},disabled:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-60",children:g?"Saving...":u?"Update Protocol":"Create Protocol"})]})]})}),I.jsx(wl,{isOpen:b,onClose:()=>{y(!1),j(null)},onConfirm:async()=>{if(v)try{const e=Number(v.protocol_id??v.id);await st(e),await V(),p({type:"success",message:"Protocol deleted successfully"})}catch(e){p({type:"error",message:"Failed to delete protocol"})}finally{y(!1),j(null)}},title:"Delete Protocol",message:v?`Are you sure you want to delete "${v.title}"? This action cannot be undone.`:"Are you sure you want to delete this protocol?",confirmText:"Delete",cancelText:"Cancel",confirmVariant:"secondary",icon:"ri-delete-bin-line",iconColor:"text-red-600"}),I.jsx(Lx,{open:E,onClose:()=>T(!1),onExportPDF:()=>G("pdf"),onExportCSV:()=>G("csv"),onExportExcel:()=>G("excel"),data:O,columns:R,title:M()})]})},ab=[{key:"id",label:"ID"},{key:"user_type",label:"User Type",format:e=>e.charAt(0).toUpperCase()+e.slice(1)},{key:"user_name",label:"User Name"},{key:"action",label:"Action",format:e=>e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())},{key:"details",label:"Details"},{key:"ip_address",label:"IP Address"},{key:"created_at",label:"Date & Time",format:e=>new Date(e).toLocaleString()}],nb=()=>{const{showToast:e}=$t(),[t,s]=n.useState([]),[r,a]=n.useState(!0),[i,l]=n.useState(!0),[o,d]=n.useState(""),[c,u]=n.useState("all"),[m,h]=n.useState(1),[x,g]=n.useState(1),[f,p]=n.useState(0),[b,y]=n.useState(null),[v,j]=n.useState(null),[N,w]=n.useState(!1);n.useEffect(()=>{S(),k()},[m,o,c]),n.useEffect(()=>{h(1)},[o,c]);const S=async()=>{try{a(!0),j(null);const e={page:m,limit:20,search:o.trim()};if("all"!==c){const t=new Date;if("today"===c){const s=t.toISOString().split("T")[0];e.date_from=s,e.date_to=s}else if("week"===c){const s=new Date(t.getTime()-6048e5);e.date_from=s.toISOString().split("T")[0],e.date_to=t.toISOString().split("T")[0]}else if("month"===c){const s=new Date(t.getTime()-2592e6);e.date_from=s.toISOString().split("T")[0],e.date_to=t.toISOString().split("T")[0]}}const t=await he(e);if(t.success)s(t.logs),g(t.pagination.totalPages),p(t.pagination.totalLogs);else{const e=t.message||"Failed to fetch activity logs";j(e)}}catch(e){let t="Failed to fetch activity logs. Please try again.";e.message&&(t=e.message.includes("Failed to fetch")?"Unable to connect to the server. Please check if the backend is running.":e.message.includes("Table not found")?"Activity logs table not found. Please contact an administrator to set up the system.":e.message.includes("Database")?"Database connection error. Please try again later.":e.message),j(t)}finally{a(!1)}},k=async()=>{try{l(!0);const e=await xe();e.success&&y(e.stats)}catch(e){}finally{l(!1)}},C=async()=>{try{const e={limit:1e6,search:o.trim()};if("all"!==c){const t=new Date;if("today"===c){const s=t.toISOString().split("T")[0];e.date_from=s,e.date_to=s}else if("week"===c){const s=new Date(t.getTime()-6048e5);e.date_from=s.toISOString().split("T")[0],e.date_to=t.toISOString().split("T")[0]}else if("month"===c){const s=new Date(t.getTime()-2592e6);e.date_from=s.toISOString().split("T")[0],e.date_to=t.toISOString().split("T")[0]}}const t=await he(e);if(t.success)return t.logs;{const e=t.message||"Failed to fetch all activity logs";throw new Error(e)}}catch(e){throw e}},$=e=>{h(e)},_=e=>{switch(e){case"admin":return"bg-red-100 text-red-800";case"staff":return"bg-blue-100 text-blue-800";case"user":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return r&&0===t.length?I.jsx("div",{className:"flex items-center justify-center h-64",children:I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Activity Logs"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor system activities and user actions"})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsxs("button",{onClick:()=>{h(1),S(),k()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[I.jsx("i",{className:"ri-refresh-line mr-2"}),"Refresh"]}),I.jsxs("button",{onClick:()=>w(!0),disabled:0===f,className:"px-4 py-2 rounded-lg transition-colors flex items-center "+(0===f?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),title:0===f?"No data to export":"Export all activity logs with current filters",children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export All (",f,")"]})]})]}),v&&I.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:I.jsxs("div",{className:"flex",children:[I.jsx("i",{className:"ri-error-warning-line text-red-400 mr-3 mt-0.5"}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),I.jsx("p",{className:"text-sm text-red-700 mt-1",children:v})]})]})}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-history-line text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total Activities"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:f})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-admin-line text-red-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Admin Actions"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:b?.userTypeDistribution.find(e=>"admin"===e.user_type)?.count||0})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-team-line text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Staff Actions"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:b?.userTypeDistribution.find(e=>"staff"===e.user_type)?.count||0})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-user-line text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"User Actions"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:b?.userTypeDistribution.find(e=>"user"===e.user_type)?.count||0})]})]})})]}),I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[I.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[I.jsxs("div",{className:"relative",children:[I.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),I.jsx("input",{type:"text",placeholder:"Search activities...",value:o,onChange:e=>d(e.target.value),className:"pl-10 pr-4 py-2 w-96 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),I.jsxs("div",{className:"relative",children:[I.jsx("i",{className:"ri-time-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),I.jsxs("select",{value:c,onChange:e=>u(e.target.value),className:"pl-10 pr-4 py-2 w-48 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"all",children:"All Time"}),I.jsx("option",{value:"today",children:"Today"}),I.jsx("option",{value:"week",children:"Last Week"}),I.jsx("option",{value:"month",children:"Last Month"})]})]})]}),I.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:["Showing ",t.length," of ",f," activities"]})]}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:r?I.jsx("div",{className:"flex items-center justify-center h-32",children:I.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):I.jsx("div",{className:"divide-y divide-gray-200",children:t.map(e=>{return I.jsx("div",{className:"p-6 hover:bg-gray-50",children:I.jsxs("div",{className:"flex items-start space-x-4",children:[I.jsx("div",{className:"flex-shrink-0",children:I.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:(t=e.action,t.includes("create")?"ri-add-circle-line":t.includes("update")?"ri-edit-line":t.includes("delete")?"ri-delete-bin-line":t.includes("login")?"ri-login-circle-line":t.includes("logout")?"ri-logout-circle-line":t.includes("alert")?"ri-notification-3-line":t.includes("incident")?"ri-error-warning-line":"ri-information-line")+" text-gray-600"})})}),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[I.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${_(e.user_type)}`,children:e.user_type.toUpperCase()}),I.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.user_name}),I.jsx("span",{className:"text-sm text-gray-500",children:"•"}),I.jsx("span",{className:"text-sm text-gray-500",children:e.action.replace(/_/g," ")})]}),I.jsx("p",{className:"text-sm text-gray-700 mb-2",children:e.details}),I.jsxs("div",{className:"flex items-center text-xs text-gray-500 space-x-4",children:[I.jsxs("span",{children:[I.jsx("i",{className:"ri-time-line mr-1"}),new Date(e.created_at).toLocaleString()]}),e.ip_address&&I.jsxs("span",{children:[I.jsx("i",{className:"ri-computer-line mr-1"}),e.ip_address]})]})]})]})},e.id);var t})})}),x>1&&I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"text-sm text-gray-700",children:["Page ",m," of ",x," (",f," total activities)"]}),I.jsxs("div",{className:"flex space-x-2",children:[I.jsx("button",{onClick:()=>$(m-1),disabled:1===m,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:Math.min(5,x)},(e,t)=>{const s=Math.max(1,Math.min(x-4,m-2))+t;return s>x?null:I.jsx("button",{onClick:()=>$(s),className:"px-3 py-2 text-sm font-medium rounded-lg "+(s===m?"bg-blue-600 text-white":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50"),children:s},s)}),I.jsx("button",{onClick:()=>$(m+1),disabled:m===x,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})}),0===t.length&&!r&&I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[I.jsx("i",{className:"ri-history-line text-4xl text-gray-400 mb-4"}),I.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No activities found"}),I.jsx("p",{className:"text-gray-600",children:"Try adjusting your filters to see more results."})]}),I.jsx(Lx,{open:N,onClose:()=>w(!1),onExportPDF:async()=>{try{const t=await C();Px.exportToPDF(t,ab,{filename:"activity_logs_export",title:"Activity Logs Report",includeTimestamp:!0}),e({type:"success",message:`All ${t.length} activity logs exported to PDF successfully`}),w(!1)}catch(t){e({type:"error",message:"Failed to export activity logs to PDF"})}},onExportCSV:async()=>{try{const t=await C();Px.exportToCSV(t,ab,{filename:"activity_logs_export",title:"Activity Logs Report",includeTimestamp:!0}),e({type:"success",message:`All ${t.length} activity logs exported to CSV successfully`}),w(!1)}catch(t){e({type:"error",message:"Failed to export activity logs to CSV"})}},onExportExcel:async()=>{try{const t=await C();Px.exportToExcel(t,ab,{filename:"activity_logs_export",title:"Activity Logs Report",includeTimestamp:!0}),e({type:"success",message:`All ${t.length} activity logs exported to Excel successfully`}),w(!1)}catch(t){e({type:"error",message:"Failed to export activity logs to Excel"})}},data:t,columns:ab.map(e=>({key:e.key,label:e.label})),title:`Activity Logs Report (${f})`})]})};function ib(){const e=a(),[t,s]=n.useState(null),[r,i]=n.useState(!1),[l,o]=n.useState(!1),[d,c]=n.useState(!1),[u,m]=n.useState(!1),[h,x]=n.useState({}),[g,f]=n.useState(!1),[p,b]=n.useState(""),[y,v]=n.useState(!0),[j,N]=n.useState(!1),[w,S]=n.useState(""),[k,C]=n.useState(!1),[$,_]=n.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[A,P]=n.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[L,E]=n.useState(!1);n.useEffect(()=>{const t=D();if(!t.isAuthenticated||"admin"!==t.userType)return void e("/admin/login");s(t.userData||{}),i(!0);(async()=>{try{v(!0);const e=await K();e.success&&e.admin&&(s(t=>t?{...t,...e.admin}:e.admin),B(e.admin))}catch(e){b("Failed to load profile data")}finally{v(!1)}})();const r=()=>{const t=D();t.isAuthenticated&&"admin"===t.userType?(i(t.isAuthenticated),s(t.userData||{})):e("/admin/login")},a=e=>{j&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("storage",r),window.addEventListener("authStateChanged",r),window.addEventListener("beforeunload",a),()=>{window.removeEventListener("storage",r),window.removeEventListener("authStateChanged",r),window.removeEventListener("beforeunload",a)}},[e,j]),n.useEffect(()=>{if(u&&t){const e=h.name!==t.name||h.email!==t.email;N(e)}else N(!1)},[h,t,u]),n.useEffect(()=>{if(w){const e=setTimeout(()=>{S("")},5e3);return()=>clearTimeout(e)}},[w]);const T=()=>{t&&(x({...t}),m(!0),b(""),S(""))},O=(e,t)=>{_(s=>({...s,[e]:t})),A[e]&&P(t=>({...t,[e]:""}))},F=()=>{L||(C(!1),_({currentPassword:"",newPassword:"",confirmPassword:""}),P({currentPassword:"",newPassword:"",confirmPassword:""}))};return!r||y?I.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-600 rounded-2xl flex items-center justify-center",children:I.jsx("i",{className:"ri-loader-4-line text-2xl text-white animate-spin"})}),I.jsx("p",{className:"text-gray-600",children:y?"Loading profile...":"Checking authentication..."})]})}):I.jsxs("div",{className:"max-w-5xl mx-auto",children:[(w||p)&&I.jsx("div",{className:`mb-6 p-4 rounded-lg border-l-4 ${w?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} transition-all duration-300 ease-in-out`,children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:(w?"ri-check-circle-line":"ri-error-warning-line")+" text-lg mr-2"}),I.jsx("span",{children:w||p}),I.jsx("button",{onClick:()=>{S(""),b("")},className:"ml-auto text-lg hover:opacity-70",children:I.jsx("i",{className:"ri-close-line"})})]})}),I.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[I.jsx("div",{className:"lg:col-span-1",children:I.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 sticky top-8",children:I.jsxs("div",{className:"text-center mb-6",children:[I.jsx("div",{className:"mb-4",children:I.jsx(ct,{name:t?.name,email:t?.email,size:"xl",className:"mx-auto"})}),I.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:t?.name||"Admin Profile"}),I.jsx("p",{className:"text-gray-600 mb-2",children:t?.email||"No email provided"}),I.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mb-4",children:[I.jsx("i",{className:"ri-shield-check-line mr-1"}),"Administrator"]}),I.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 flex flex-col gap-2",children:u?I.jsxs(I.Fragment,{children:[j&&I.jsxs("div",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded-lg mb-2 flex items-center gap-1",children:[I.jsx("i",{className:"ri-information-line"}),"You have unsaved changes"]}),I.jsxs("div",{className:"flex gap-2",children:[I.jsx("button",{onClick:async()=>{if(!h.name||!h.email)return void b("Name and email are required");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h.email)){f(!0),b("");try{const e=await Y({name:h.name,email:h.email});e.success&&e.admin?(s(e.admin),B(e.admin),m(!1),x({}),N(!1),S("Profile updated successfully!")):b(e.message||"Failed to update profile")}catch(e){b(e.message||"Failed to update profile")}finally{f(!1)}}else b("Please enter a valid email address")},disabled:g||!j,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1",children:g?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin"}),"Saving..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-save-line"}),"Save"]})}),I.jsxs("button",{onClick:()=>{j&&!window.confirm("You have unsaved changes. Are you sure you want to cancel?")||(m(!1),x({}),b(""),N(!1))},disabled:g,className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors disabled:opacity-50 flex items-center justify-center gap-1",children:[I.jsx("i",{className:"ri-close-line"}),"Cancel"]})]})]}):I.jsxs(I.Fragment,{children:[I.jsxs("button",{onClick:T,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[I.jsx("i",{className:"ri-edit-line"}),"Edit Profile"]}),I.jsxs("button",{onClick:()=>{j&&!window.confirm("You have unsaved changes. Are you sure you want to logout?")||o(!0)},className:"w-full bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center gap-2",children:[I.jsx("i",{className:"ri-logout-box-line"}),"Logout"]})]})})]})})}),I.jsx("div",{className:"lg:col-span-2",children:I.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[I.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 px-8 py-6",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h2",{className:"text-2xl font-bold text-white",children:u?"Edit Profile Information":"Profile Information"}),I.jsx("p",{className:"text-blue-100 mt-1",children:u?"Update your admin profile details":"View your admin profile details"})]}),!u&&I.jsxs("button",{onClick:T,className:"bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-colors flex items-center gap-2",children:[I.jsx("i",{className:"ri-edit-line"}),"Edit"]})]})}),I.jsx("div",{className:"p-8",children:I.jsxs("div",{className:"space-y-8",children:[I.jsxs("div",{children:[I.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-blue-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Basic Information"})]}),I.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[I.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name ",u&&I.jsx("span",{className:"text-red-500",children:"*"})]}),u?I.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:h.name||"",onChange:e=>x({...h,name:e.target.value}),placeholder:"Enter your full name"}):I.jsx("p",{className:"text-gray-900",children:t?.name||"Not provided"})]}),!u&&I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("p",{className:"text-gray-900",children:t?.role||"Administrator"}),I.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})]})]}),I.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("p",{className:"text-gray-900",children:t?.status||"Active"}),I.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"})]})]})]})]})]}),I.jsxs("div",{className:"border-t border-gray-100 pt-8",children:[I.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[I.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-mail-line text-green-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Contact Information"})]}),I.jsx("div",{className:"grid md:grid-cols-1 gap-6",children:I.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[I.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email Address ",u&&I.jsx("span",{className:"text-red-500",children:"*"})]}),u?I.jsx("input",{type:"email",className:"w-full border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:h.email||"",onChange:e=>x({...h,email:e.target.value}),placeholder:"Enter your email address"}):I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("p",{className:"text-gray-900",children:t?.email||"Not provided"}),t?.email&&I.jsx("i",{className:"ri-verified-badge-line text-green-500",title:"Verified email"})]})]})})]}),I.jsxs("div",{className:"border-t border-gray-100 pt-8",children:[I.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[I.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-lock-line text-red-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Security"})]}),I.jsx("div",{className:"bg-gray-50 rounded-lg p-6",children:I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-gray-900",children:"Change Password"}),I.jsx("p",{className:"text-sm text-gray-600",children:"Update your password to keep your account secure"})]}),I.jsxs("button",{onClick:()=>C(!0),className:"bg-red-50 border border-red-200 text-red-600 hover:bg-red-100 px-4 py-2 rounded-lg transition-colors flex items-center gap-2",children:[I.jsx("i",{className:"ri-key-line"}),"Change Password"]})]})})]})]})})]})})]}),I.jsx(ot,{isOpen:l,onClose:()=>{o(!1)},onConfirm:async()=>{c(!0);try{await new Promise(e=>setTimeout(e,1e3)),M(),e("/admin/login")}catch(t){}finally{c(!1),o(!1)}},isLoading:d}),I.jsx(Nl,{isOpen:k,onClose:F,title:"Change Password",size:"md",children:I.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={currentPassword:"",newPassword:"",confirmPassword:""};return $.currentPassword||(e.currentPassword="Current password is required"),$.newPassword?$.newPassword.length<8?e.newPassword="Password must be at least 8 characters long":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test($.newPassword)||(e.newPassword="Password must contain at least one uppercase letter, one lowercase letter, and one number"):e.newPassword="New password is required",$.confirmPassword?$.newPassword!==$.confirmPassword&&(e.confirmPassword="Passwords do not match"):e.confirmPassword="Please confirm your new password",$.currentPassword&&$.newPassword&&$.currentPassword===$.newPassword&&(e.newPassword="New password must be different from current password"),P(e),!Object.values(e).some(e=>""!==e)})()){E(!0);try{const e=await Z($.currentPassword,$.newPassword);e.success?(_({currentPassword:"",newPassword:"",confirmPassword:""}),C(!1),S("Password changed successfully!"),setTimeout(()=>S(""),5e3)):P(t=>({...t,currentPassword:e.message||"Failed to change password"}))}catch(t){P(e=>({...e,currentPassword:t instanceof Error?t.message:"Failed to change password. Please try again."}))}finally{E(!1)}}},className:"space-y-6",children:[I.jsx("div",{children:I.jsx(pt,{label:"Current Password",type:"password",name:"currentPassword",id:"currentPassword",value:$.currentPassword,onChange:e=>O("currentPassword",e.target.value),error:A.currentPassword,placeholder:"Enter your current password",required:!0,icon:I.jsx("i",{className:"ri-lock-line"})})}),I.jsxs("div",{children:[I.jsx(pt,{label:"New Password",type:"password",name:"newPassword",id:"newPassword",value:$.newPassword,onChange:e=>O("newPassword",e.target.value),error:A.newPassword,placeholder:"Enter your new password",required:!0,icon:I.jsx("i",{className:"ri-key-line"})}),I.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long and contain uppercase, lowercase, and number."})]}),I.jsx("div",{children:I.jsx(pt,{label:"Confirm New Password",type:"password",name:"confirmPassword",id:"confirmPassword",value:$.confirmPassword,onChange:e=>O("confirmPassword",e.target.value),error:A.confirmPassword,placeholder:"Confirm your new password",required:!0,icon:I.jsx("i",{className:"ri-key-line"})})}),I.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[I.jsx(lt,{type:"button",variant:"outline",size:"md",onClick:F,disabled:L,children:"Cancel"}),I.jsx(lt,{type:"submit",variant:"primary",size:"md",disabled:L,children:L?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Changing..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-key-line mr-2"}),"Change Password"]})})]})]})})]})}const lb=()=>{const[e,t]=n.useState([]),[s,r]=n.useState(!0),[a,i]=n.useState(null),[l,o]=n.useState(""),[d,c]=n.useState(!1),[u,m]=n.useState(!1),[h,x]=n.useState(null),[g,f]=n.useState(!1),[p,b]=n.useState([]),[y,v]=n.useState(1),[j,N]=n.useState(1),[w,S]=n.useState(0),{showToast:k}=$t(),[C,$]=n.useState(!1),[_,A]=n.useState(null),[P,L]=n.useState(!1),[E,T]=n.useState({member_no:"",name:"",description:""}),[O,F]=n.useState(null),[R,D]=n.useState(""),M=[{key:"member_no",label:"Member No"},{key:"name",label:"Team Name"},{key:"description",label:"Description"},{key:"member_count",label:"Members",format:e=>`${e||0}/5 members`},{key:"created_at",label:"Created Date",format:e=>Px.formatDate(e)},{key:"updated_at",label:"Updated Date",format:e=>Px.formatDate(e)}];n.useEffect(()=>{B()},[y]);const B=async()=>{try{r(!0),i(null);const e=new URLSearchParams({page:y.toString()}),s=await fetch(`/api/teams?${e}`),a=await s.json();a.success?(t(a.teams||[]),N(a.pagination?.pages||1),S(a.pagination?.total||a.teams?.length||0)):(i(a.message||"Failed to fetch teams"),t([]))}catch(e){i("Failed to connect to server")}finally{r(!1)}},U=e=>{const{name:t,value:s}=e.target;T(e=>({...e,[t]:s}))},q=async(e,t)=>{if(h){if(t){if(p.filter(e=>e.team_id===h.id).length>=5)return void k({type:"error",message:"Team is at maximum capacity (5 members). Remove a member first."})}try{const s=await fetch(`/api/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({team_id:t?h.id:null})}),r=await s.json();if(r.success){B();const e=await fetch("/api/staff"),s=await e.json();s.success&&b(s.staff||[]),k({type:"success",message:t?"Member added to team":"Member removed from team"})}else k({type:"error",message:`Failed to update member: ${r.message}`})}catch(s){k({type:"error",message:"Error assigning staff to team"})}}},z=async e=>{try{const s=parseInt(R);if(isNaN(s)||s<3||s>5)return void k({type:"warning",message:"Team size must be between 3 and 5 members"});const r=await fetch(`/api/teams/${e}/member-count`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({member_count:s})});(await r.json()).success?(t(t=>t.map(t=>t.id===e?{...t,member_count:s}:t)),F(null),D(""),k({type:"success",message:"Member count updated"})):k({type:"error",message:"Failed to update member count"})}catch(s){k({type:"error",message:"Error updating member count"})}},W=()=>{F(null),D("")},V=e.filter(e=>e.name.toLowerCase().includes(l.toLowerCase())||e.description.toLowerCase().includes(l.toLowerCase())||e.member_no&&e.member_no.toLowerCase().includes(l.toLowerCase()));return s?I.jsx("div",{className:"flex items-center justify-center h-64",children:I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teams Management"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Manage emergency response teams and personnel groups"})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsxs("button",{onClick:()=>{x(null),T({member_no:"",name:"",description:""}),f(!0),c(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[I.jsx("i",{className:"ri-team-line mr-2"}),"Add Team"]}),I.jsxs("button",{onClick:()=>L(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export Team"]})]})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-team-line text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total Teams"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-user-line text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total Members"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.reduce((e,t)=>e+(t.member_count||0),0)}),I.jsx("p",{className:"text-xs text-gray-500",children:1===e.reduce((e,t)=>e+(t.member_count||0),0)?"member":"members"})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-team-line text-purple-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Optimal Teams"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.filter(e=>{const t=e.member_count||0;return t>=3&&t<=5}).length}),I.jsxs("p",{className:"text-xs text-gray-500",children:[e.filter(e=>(e.member_count||0)<3).length," understaffed, ",e.filter(e=>(e.member_count||0)>=5).length," full"]})]})]})})]}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:I.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[I.jsx("div",{className:"flex items-center space-x-4",children:I.jsxs("div",{className:"relative",children:[I.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),I.jsx("input",{type:"text",placeholder:"Search teams...",value:l,onChange:e=>o(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),I.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",V.length," of ",e.length," teams"]})]})}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:I.jsx("div",{className:"overflow-x-auto",children:I.jsxs("table",{className:"w-full",children:[I.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:I.jsxs("tr",{children:[I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Member No"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Team Name"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Members"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created Date"}),I.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),I.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:V.map(e=>I.jsxs("tr",{className:"hover:bg-gray-50",children:[I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.member_no||"N/A"})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-team-line text-blue-600"})}),I.jsx("div",{children:I.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name})})]})}),I.jsx("td",{className:"px-6 py-4",children:I.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:e.description||"No description"})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("div",{className:"text-sm text-gray-900",children:O===e.id?I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("input",{type:"number",min:"3",max:"5",value:R,onChange:e=>D(e.target.value),onBlur:()=>z(e.id),onKeyDown:t=>{"Enter"===t.key?z(e.id):"Escape"===t.key&&W()},className:"w-16 px-2 py-1 border border-gray-300 rounded-md text-center focus:ring-2 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0}),I.jsx("span",{className:"text-gray-500",children:1===parseInt(R)?"member":"members"}),I.jsxs("div",{className:"flex space-x-1",children:[I.jsx("button",{onClick:()=>z(e.id),className:"text-green-600 hover:text-green-800 text-xs",title:"Save",children:I.jsx("i",{className:"ri-check-line"})}),I.jsx("button",{onClick:W,className:"text-red-600 hover:text-red-800 text-xs",title:"Cancel",children:I.jsx("i",{className:"ri-close-line"})})]})]}):I.jsxs("div",{onClick:()=>(e=>{F(e.id),D((e.member_count||0).toString())})(e),className:"cursor-pointer hover:bg-blue-50 px-2 py-1 rounded-md transition-colors "+((e.member_count||0)>=5?"bg-red-50 text-red-700":(e.member_count||0)>=3?"bg-green-50 text-green-700":"bg-yellow-50 text-yellow-700"),title:"Click to edit member count (3-5 members required)",children:[I.jsxs("span",{className:"font-medium",children:[e.member_count||0,"/5"]}),I.jsx("span",{className:"ml-1 text-xs",children:1===(e.member_count||0)?"member":"members"}),(e.member_count||0)>=5&&I.jsx("i",{className:"ri-error-warning-line ml-1 text-xs",title:"Team at maximum capacity"}),(e.member_count||0)<3&&I.jsx("i",{className:"ri-alert-line ml-1 text-xs",title:"Team below minimum size"})]})})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:I.jsx("div",{className:"text-sm text-gray-900",children:new Date(e.created_at).toLocaleDateString()})}),I.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("button",{onClick:()=>(e=>{x(e),T({member_no:e.member_no||"",name:e.name,description:e.description||""}),f(!0),c(!0)})(e),className:"text-blue-600 hover:text-blue-900",title:"Edit Team",children:I.jsx("i",{className:"ri-edit-line"})}),I.jsx("button",{onClick:()=>(async e=>{x(e),m(!0);try{const e=await fetch("/api/staff"),t=await e.json();t.success&&b(t.staff||[])}catch(t){}})(e),className:"text-green-600 hover:text-green-900",title:"Manage Members",children:I.jsx("i",{className:"ri-user-settings-line"})}),I.jsx("button",{onClick:()=>{return t=e.id,A(t),void $(!0);var t},className:"text-red-600 hover:text-red-900",title:"Delete Team",children:I.jsx("i",{className:"ri-delete-bin-line"})})]})})]},e.id))})]})})}),d&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[I.jsx("div",{className:"p-6 border-b border-gray-200",children:I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:g?h?"Edit Team":"Add New Team":"Team Details"})}),I.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e=h?`/api/teams/${h.id}`:"/api/teams",t=h?"PUT":"POST",s=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(E)});(await s.json()).success?(c(!1),B(),k({type:"success",message:h?"Team updated successfully":"Team added successfully"})):k({type:"error",message:"Failed to save team"})}catch(t){k({type:"error",message:"Failed to save team"})}},children:[I.jsx("div",{className:"p-6 space-y-4",children:g?I.jsxs(I.Fragment,{children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Member No"}),I.jsx("input",{type:"text",name:"member_no",value:E.member_no,onChange:U,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter member number",required:!0})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team Name"}),I.jsx("input",{type:"text",name:"name",value:E.name,onChange:U,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter team name",required:!0})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),I.jsx("textarea",{name:"description",value:E.description,onChange:U,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter team description"})]})]}):h&&I.jsxs(I.Fragment,{children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Member No"}),I.jsx("p",{className:"text-sm text-gray-900",children:h.member_no||"N/A"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Team Name"}),I.jsx("p",{className:"text-sm text-gray-900",children:h.name})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),I.jsx("p",{className:"text-sm text-gray-900",children:h.description||"No description"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created Date"}),I.jsx("p",{className:"text-sm text-gray-900",children:new Date(h.created_at).toLocaleDateString()})]})]})}),I.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[I.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),g&&I.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:h?"Update Team":"Add Team"})]})]})]})}),u&&h&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[I.jsxs("div",{className:"p-6 border-b border-gray-200",children:[I.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Manage Team Members - ",h.name]}),I.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Assign or remove staff members from this team"}),I.jsxs("div",{className:"mt-2 flex items-center space-x-4",children:[I.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-medium "+((h.member_count||0)>=5?"bg-red-100 text-red-700":(h.member_count||0)>=3?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"),children:[h.member_count||0,"/5 members"]}),(h.member_count||0)>=5&&I.jsxs("span",{className:"text-xs text-red-600 flex items-center",children:[I.jsx("i",{className:"ri-error-warning-line mr-1"}),"Team at maximum capacity"]}),(h.member_count||0)<3&&I.jsxs("span",{className:"text-xs text-yellow-600 flex items-center",children:[I.jsx("i",{className:"ri-alert-line mr-1"}),"Team below minimum size (3 members required)"]})]})]}),I.jsx("div",{className:"p-6",children:I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Current Team Members"}),I.jsxs("div",{className:"space-y-2",children:[p.filter(e=>e.team_id===h.id).map(e=>I.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[I.jsxs("div",{children:[I.jsx("p",{className:"font-medium text-gray-900",children:e.name}),I.jsx("p",{className:"text-sm text-gray-600",children:e.position})]}),I.jsx("button",{onClick:()=>q(e.id,!1),className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},e.id)),0===p.filter(e=>e.team_id===h.id).length&&I.jsx("p",{className:"text-gray-500 text-sm",children:"No members assigned to this team"})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Available Staff"}),I.jsxs("div",{className:"space-y-2",children:[p.filter(e=>!e.team_id).map(e=>I.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[I.jsxs("div",{children:[I.jsx("p",{className:"font-medium text-gray-900",children:e.name}),I.jsx("p",{className:"text-sm text-gray-600",children:e.position}),I.jsx("p",{className:"text-xs text-green-600",children:"No team assigned"})]}),I.jsx("button",{onClick:()=>q(e.id,!0),disabled:(h.member_count||0)>=5,className:"text-sm "+((h.member_count||0)>=5?"text-gray-400 cursor-not-allowed":"text-green-600 hover:text-green-800"),title:(h.member_count||0)>=5?"Team is at maximum capacity (5 members)":"Add to team",children:"Add"})]},e.id)),0===p.filter(e=>!e.team_id).length&&I.jsx("p",{className:"text-gray-500 text-sm",children:"No available staff members"})]})]})]})}),I.jsx("div",{className:"p-6 border-t border-gray-200 flex justify-end",children:I.jsx("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"})})]})}),I.jsx(wl,{isOpen:C,onClose:()=>{$(!1),A(null)},onConfirm:async()=>{if(null!=_)try{const e=await fetch(`/api/teams/${_}`,{method:"DELETE"});(await e.json()).success?(B(),k({type:"success",message:"Team deleted successfully"})):k({type:"error",message:"Failed to delete team"})}catch(e){k({type:"error",message:"Error deleting team"})}finally{$(!1),A(null)}},title:"Delete Team",message:"Are you sure you want to delete this team? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",confirmVariant:"secondary",icon:"ri-delete-bin-line",iconColor:"text-red-600"}),I.jsx(Lx,{open:P,onClose:()=>L(!1),onExportPDF:async()=>{try{await Px.exportToPDF(V,M,{filename:"teams_export",title:"Teams Management Report"}),k({type:"success",message:"Teams exported to PDF successfully"}),L(!1)}catch(e){k({type:"error",message:"Failed to export to PDF"})}},onExportCSV:()=>{try{Px.exportToCSV(V,M,{filename:"teams_export",title:"Teams Management Report"}),k({type:"success",message:"Teams exported to CSV successfully"}),L(!1)}catch(e){k({type:"error",message:"Failed to export to CSV"})}},onExportExcel:()=>{try{Px.exportToExcel(V,M,{filename:"teams_export",title:"Teams Management Report"}),k({type:"success",message:"Teams exported to Excel successfully"}),L(!1)}catch(e){k({type:"error",message:"Failed to export to Excel"})}},data:V,columns:M.map(e=>({key:e.key,label:e.label})),title:"Export Teams Data"})]})},ob=()=>{const[e,t]=n.useState([]),[s,r]=n.useState(!0),[a,i]=n.useState(null),[l,o]=n.useState(!1),[d,c]=n.useState("all"),[u,m]=n.useState("all"),h=$t(),x=[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"type",label:"Type"},{key:"message",label:"Message"},{key:"rating",label:"Rating",format:e=>e?`${e}/5`:"N/A"},{key:"created_at",label:"Created At",format:Px.formatDateTime}],g=e.map(e=>({name:e.user_info.name,email:e.user_info.email,type:e.user_info.type,message:e.message,rating:e.rating,created_at:e.created_at})),f=async()=>{try{r(!0),i(null);const e=await Ke({page:1,limit:50});e.success?t(e.feedback):i("Failed to fetch feedback")}catch(e){i(e.message||"Failed to fetch feedback")}finally{r(!1)}};n.useEffect(()=>{f()},[]);const p=e.filter(e=>{const t="all"===d||e.user_info.type===d,s="all"===u||"none"===u&&null===e.rating||"none"!==u&&e.rating===parseInt(u);return t&&s});return I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"User Feedback"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"View and manage user feedback"})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsxs("button",{onClick:f,disabled:s,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[I.jsx("i",{className:"ri-refresh-line mr-2"}),"Refresh"]}),I.jsxs("button",{onClick:()=>o(!0),disabled:s||0===e.length,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export Feeback"]})]})]}),I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[I.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-filter-line mr-2"}),"Filter by Type"]}),I.jsxs("div",{className:"flex space-x-2",children:[I.jsx("button",{onClick:()=>c("all"),className:"px-3 py-2 text-sm rounded-lg transition-colors "+("all"===d?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"All"}),I.jsx("button",{onClick:()=>c("user"),className:"px-3 py-2 text-sm rounded-lg transition-colors "+("user"===d?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"User"}),I.jsx("button",{onClick:()=>c("staff"),className:"px-3 py-2 text-sm rounded-lg transition-colors "+("staff"===d?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Staff"})]})]}),I.jsxs("div",{children:[I.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[I.jsx("i",{className:"ri-star-line mr-2"}),"Filter by Rating"]}),I.jsxs("select",{value:u,onChange:e=>m(e.target.value),className:"w-full py-2 px-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",children:[I.jsx("option",{value:"all",children:"All Ratings"}),I.jsx("option",{value:"5",children:"5 Stars"}),I.jsx("option",{value:"4",children:"4 Stars"}),I.jsx("option",{value:"3",children:"3 Stars"}),I.jsx("option",{value:"2",children:"2 Stars"}),I.jsx("option",{value:"1",children:"1 Star"}),I.jsx("option",{value:"none",children:"No Rating"})]})]})]}),("all"!==d||"all"!==u)&&I.jsx("div",{className:"mt-4 flex justify-end",children:I.jsxs("button",{onClick:()=>{c("all"),m("all")},className:"text-blue-600 hover:text-blue-700 font-medium flex items-center space-x-1 text-sm",children:[I.jsx("i",{className:"ri-refresh-line"}),I.jsx("span",{children:"Clear Filters"})]})})]}),a&&I.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:I.jsxs("div",{className:"flex",children:[I.jsx("i",{className:"ri-error-warning-line text-red-400 mr-3 mt-0.5"}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),I.jsx("p",{className:"text-sm text-red-700 mt-1",children:a})]})]})}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:s?I.jsx("div",{className:"flex items-center justify-center h-32",children:I.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):0===p.length?I.jsxs("div",{className:"p-12 text-center",children:[I.jsx("i",{className:"ri-chat-1-line text-4xl text-gray-400 mb-4"}),I.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"all"===d&&"all"===u?"No feedback available":"No feedback matches your filters"}),I.jsx("p",{className:"text-gray-600",children:"all"===d&&"all"===u?"No user feedback has been submitted yet.":"Try adjusting your filter criteria to see more results."})]}):I.jsx("div",{className:"divide-y divide-gray-200",children:p.map(e=>I.jsx("div",{className:"p-6 hover:bg-gray-50",children:I.jsxs("div",{className:"flex items-start space-x-4",children:[I.jsx("div",{className:"flex-shrink-0",children:I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-blue-600"})})}),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[I.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.user_info.name}),"user"===e.user_info.type&&I.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-800",children:e.user_info.type.charAt(0).toUpperCase()+e.user_info.type.slice(1)}),"staff"===e.user_info.type&&I.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800",children:e.user_info.type.charAt(0).toUpperCase()+e.user_info.type.slice(1)}),"staff"===e.user_info.type&&e.user_info.department&&I.jsxs(I.Fragment,{children:[I.jsx("span",{className:"text-sm text-gray-500",children:"•"}),I.jsx("span",{className:"text-sm text-blue-600",children:e.user_info.department.charAt(0).toUpperCase()+e.user_info.department.slice(1)})]}),null!==e.rating&&I.jsxs(I.Fragment,{children:[I.jsx("span",{className:"text-sm text-gray-500",children:"•"}),I.jsxs("div",{className:"flex items-center",children:[[...Array(5)].map((t,s)=>I.jsx("i",{className:`ri-star-${s<e.rating?"fill":"line"} text-yellow-400 text-sm`},s)),I.jsxs("span",{className:"ml-1 text-sm text-gray-600",children:["(",e.rating,")"]})]})]})]}),I.jsx("p",{className:"text-sm text-gray-700 mb-2",children:e.message}),I.jsx("div",{className:"flex items-center text-xs text-gray-500",children:I.jsxs("span",{children:[I.jsx("i",{className:"ri-time-line mr-1"}),new Date(e.created_at).toLocaleString()]})})]})]})},e.id))})}),I.jsx(Lx,{open:l,onClose:()=>o(!1),onExportCSV:()=>{Px.exportToCSV(g,x,{filename:"feedback",title:"User Feedback"}),o(!1),h.showToast({type:"success",message:"Feedback exported to CSV successfully!"})},onExportExcel:()=>{Px.exportToExcel(g,x,{filename:"feedback",title:"User Feedback"}),o(!1),h.showToast({type:"success",message:"Feedback exported to Excel successfully!"})},onExportPDF:()=>{Px.exportToPDF(g,x,{filename:"feedback",title:"User Feedback"}),o(!1),h.showToast({type:"success",message:"Feedback exported to PDF successfully!"})},data:g,columns:x.map(e=>({key:e.key,label:e.label})),title:"Export User Feedback"})]})},db=[{key:"id",label:"ID"},{key:"title",label:"Title"},{key:"description",label:"Description"},{key:"isActive",label:"Status",format:e=>e?"Active":"Inactive"},{key:"messageWhenDisabled",label:"Disabled Message"},{key:"createdAt",label:"Created At",format:e=>e?new Date(e).toLocaleString():"N/A"},{key:"updatedAt",label:"Updated At",format:e=>e?new Date(e).toLocaleString():"N/A"}],cb=[{key:"first_name",label:"Name",format:(e,t)=>`${t.first_name||""} ${t.last_name||""}`.trim()||t.user_name||"N/A"},{key:"email",label:"Email",format:(e,t)=>e||t.user_email||"N/A"},{key:"address",label:"Address",format:(e,t)=>{const s=[];return t.address&&s.push(t.address),t.city&&s.push(t.city),t.state&&s.push(t.state),t.zip_code&&s.push(t.zip_code),s.length>0?s.join(", "):"N/A"}},{key:"status",label:"Status",format:e=>"safe"===e?"Safe":"Needs Help"},{key:"additional_info",label:"Additional Info"},{key:"submitted_at",label:"Submitted At",format:e=>new Date(e).toLocaleString()}];function ub(){const{showToast:e}=$t(),[t,s]=n.useState([]),[r,a]=n.useState(!1),[i,l]=n.useState(!1),[o,d]=n.useState(null),[c,u]=n.useState(!1),[m,h]=n.useState(!1),[x,g]=n.useState(null),[f,p]=n.useState(!1),[b,y]=n.useState(null),[v,j]=n.useState(!1),[N,w]=n.useState([]),[S,k]=n.useState(!1),[C,$]=n.useState(null),[_,A]=n.useState(""),[P,L]=n.useState("all"),[E,T]=n.useState(null),[O,F]=n.useState(!1),[R,D]=n.useState(!1),[M,B]=n.useState(1),[U,q]=n.useState(1),[z,W]=n.useState(0),[H,G]=n.useState(null),[J,K]=n.useState(!1),[Y,Z]=n.useState(null);n.useEffect(()=>{X(),Q()},[]),n.useEffect(()=>{B(1)},[_,P]);const X=async()=>{try{a(!0),G(null);const e={page:M,limit:20,search:_.trim()};"all"!==P&&(e.status=P);const t=await V(`/admin/welfare/settings?${new URLSearchParams(e).toString()}`);if(t.success){const e=Array.isArray(t.settings)?t.settings:t.settings?[t.settings]:[];s(e),W(e.length),q(t.pagination?.totalPages||1)}else{const e=t.message||"Failed to load welfare settings";G(e)}}catch(e){let t="Failed to fetch welfare settings. Please try again.";e.message&&(t=e.message.includes("Failed to fetch")?"Unable to connect to the server. Please check if the backend is running.":e.message.includes("Table not found")?"Welfare settings table not found. Please contact an administrator to set up the system.":e.message.includes("Database")?"Database connection error. Please try again later.":e.message),G(t)}finally{a(!1)}},Q=async()=>{try{const e=await V("/admin/welfare/stats");e.success&&T(e.stats)}catch(e){}},ee=async e=>{try{k(!0);const t=e?`/admin/welfare/reports?setting_id=${e}`:"/admin/welfare/reports",s=await V(t);if(s.success){const e=s.reports||[];w(e)}else d({type:"error",text:s.message||"Failed to load welfare reports"})}catch(t){d({type:"error",text:t.message||"Failed to load welfare reports. Please check if the backend server is running."})}finally{k(!1)}},te=async()=>{try{const e={limit:1e6,search:_.trim()};"all"!==P&&(e.status=P);const t=await V(`/admin/welfare/settings?${new URLSearchParams(e).toString()}`);if(t.success){return Array.isArray(t.settings)?t.settings:t.settings?[t.settings]:[]}{const e=t.message||"Failed to fetch all welfare settings";throw new Error(e)}}catch(e){throw e}},se=async()=>{try{const e=await V("/admin/welfare/reports");if(e.success)return e.reports||[];{const t=e.message||"Failed to fetch all welfare reports";throw new Error(t)}}catch(e){throw e}},re=e=>{B(e)},ae=()=>{g({isActive:!1,title:"Welfare Check System",description:"",messageWhenDisabled:"Welfare check system is currently disabled."}),h(!1),u(!0)},ne=async t=>{try{l(!0);const s={...t,isActive:!t.isActive},r=await V("/admin/welfare/settings",{method:"PUT",body:JSON.stringify(s)});r.success?(e({type:"success",message:`Setting ${t.isActive?"deactivated":"activated"} successfully`}),await X(),await Q()):e({type:"error",message:r.message||"Failed to toggle setting status"})}catch(s){e({type:"error",message:s.message||"Failed to toggle setting status. Please check if the backend server is running."})}finally{l(!1)}},ie=e=>{const{name:t,value:r,type:a}=e.target;x?g(s=>s?{...s,[t]:"checkbox"===a?e.target.checked:r}:null):s(s=>Array.isArray(s)?s.map(s=>({...s,[t]:"checkbox"===a?e.target.checked:r})):s)},le=e=>new Date(e).toLocaleString(),oe=e=>e?"ri-check-circle-line":"ri-close-circle-line",de=e=>{switch(e){case"safe":return"bg-green-100 text-green-800";case"needs_help":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},ce=e=>{switch(e){case"safe":return"ri-check-circle-line";case"needs_help":return"ri-error-warning-line";default:return"ri-question-line"}},ue=t.filter(e=>{const t=""===_||e.title.toLowerCase().includes(_.toLowerCase())||e.description.toLowerCase().includes(_.toLowerCase()),s="all"===P||"active"===P&&e.isActive||"disabled"===P&&!e.isActive;return t&&s});return r?I.jsx("div",{className:"flex items-center justify-center h-64",children:I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Welfare Check Management"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"Manage welfare check system settings"})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("button",{onClick:ae,disabled:i,className:"px-4 py-2 rounded-lg transition-colors flex items-center "+(i?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),title:"Add new welfare settings",children:i?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-add-line mr-2"}),"Add Welfare"]})}),I.jsxs("button",{onClick:()=>F(!0),disabled:0===z,className:"px-4 py-2 rounded-lg transition-colors flex items-center "+(0===z?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),title:0===z?"No data to export":"Export all welfare settings with current filters",children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export All (",z,")"]})]})]}),H&&I.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:I.jsxs("div",{className:"flex",children:[I.jsx("i",{className:"ri-error-warning-line text-red-400 mr-3 mt-0.5"}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),I.jsx("p",{className:"text-sm text-red-700 mt-1",children:H})]})]})}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-settings-3-line text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total Settings"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:z})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-check-circle-line text-green-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Active Settings"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:E?.activeSettings||t.filter(e=>e.isActive).length})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-file-list-3-line text-purple-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Total Reports"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:E?.totalReports||0})]})]})}),I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3",children:I.jsx("i",{className:"ri-user-line text-orange-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-600",children:"Unique Users"}),I.jsx("p",{className:"text-xl font-bold text-gray-900",children:E?.uniqueUsers||0})]})]})})]}),I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[I.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[I.jsxs("div",{className:"relative",children:[I.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),I.jsx("input",{type:"text",placeholder:"Search settings...",value:_,onChange:e=>A(e.target.value),className:"pl-10 pr-4 py-2 w-96 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),I.jsxs("div",{className:"relative",children:[I.jsx("i",{className:"ri-filter-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),I.jsxs("select",{value:P,onChange:e=>L(e.target.value),className:"pl-10 pr-4 py-2 w-48 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[I.jsx("option",{value:"all",children:"All Status"}),I.jsx("option",{value:"active",children:"Active"}),I.jsx("option",{value:"disabled",children:"Disabled"})]})]})]}),I.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:["Showing ",ue.length," of ",z," settings"]})]}),o&&I.jsx("div",{className:"p-4 rounded-lg "+("success"===o.type?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"),children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"mr-2 "+("success"===o.type?"ri-check-circle-line":"ri-error-warning-line")}),o.text]})}),I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:I.jsx("div",{className:"divide-y divide-gray-200",children:0===ue.length?I.jsxs("div",{className:"text-center py-8",children:[I.jsx("i",{className:"ri-settings-line text-4xl text-gray-300"}),I.jsx("p",{className:"text-gray-500 mt-2",children:"No welfare settings found"}),I.jsxs("button",{onClick:ae,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[I.jsx("i",{className:"ri-add-line mr-2"}),"Add First Setting"]})]}):ue.map(e=>{return I.jsx("div",{className:"p-6 hover:bg-gray-50",children:I.jsxs("div",{className:"flex items-start justify-between",children:[I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[I.jsx("h4",{className:"text-lg font-medium text-gray-900",children:e.title}),I.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(s=e.isActive,s?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[I.jsx("i",{className:`${oe(e.isActive)} mr-1`}),e.isActive?"Active":"Disabled"]}),e.isActive&&I.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[I.jsx("i",{className:"ri-star-fill mr-1"}),"Currently Active"]})]}),I.jsx("p",{className:"text-gray-600 mb-3",children:e.description||"No description provided"}),I.jsxs("div",{className:"flex items-center text-sm text-gray-500 space-x-4",children:[I.jsxs("span",{children:[I.jsx("i",{className:"ri-calendar-line mr-1"}),"Created: ",e.createdAt?le(e.createdAt):"Unknown"]}),e.updatedAt&&I.jsxs("span",{children:[I.jsx("i",{className:"ri-time-line mr-1"}),"Updated: ",le(e.updatedAt)]}),!e.isActive&&I.jsxs("span",{className:"text-red-600",children:[I.jsx("i",{className:"ri-error-warning-line mr-1"}),"Message: ",e.messageWhenDisabled]})]})]}),I.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.id&&I.jsxs("button",{onClick:()=>(async e=>{if(e.id){if(!e.isActive&&t.filter(t=>t.isActive&&t.id!==e.id).length>0)return Z(e),void K(!0);await ne(e)}else d({type:"error",text:"Cannot toggle setting without ID"})})(e),disabled:i,className:"px-3 py-1 text-sm rounded-lg transition-colors "+(i?"bg-gray-100 text-gray-400 cursor-not-allowed":e.isActive?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"),title:e.isActive?"Deactivate this setting":"Activate this setting",children:[I.jsx("i",{className:"mr-1 "+(e.isActive?"ri-pause-line":"ri-play-line")}),e.isActive?"Deactivate":"Activate"]}),I.jsxs("button",{onClick:()=>{$(e),ee(e.id),j(!0)},className:"px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-lg hover:bg-blue-200 transition-colors",children:[I.jsx("i",{className:"ri-eye-line mr-1"}),"View Reports"]}),I.jsxs("button",{onClick:()=>(e=>{e.id?(g({...e}),h(!0),u(!0)):d({type:"error",text:"Cannot edit setting without ID. Please create a new setting instead."})})(e),disabled:!e.id,className:"px-3 py-1 text-sm rounded-lg transition-colors "+(e.id?"bg-yellow-100 text-yellow-700 hover:bg-yellow-200":"bg-gray-100 text-gray-400 cursor-not-allowed"),title:e.id?"Edit setting":"Cannot edit setting without ID",children:[I.jsx("i",{className:"ri-edit-line mr-1"}),"Edit"]}),I.jsx("button",{onClick:()=>{y(e),p(!0)},className:"px-3 py-1 bg-red-100 text-red-700 text-sm rounded-lg hover:bg-red-200 transition-colors",children:I.jsx("i",{className:"ri-delete-bin-line mr-1"})})]})]})},e.id||"default");var s})})}),U>1&&I.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"text-sm text-gray-700",children:["Page ",M," of ",U," (",z," total settings)"]}),I.jsxs("div",{className:"flex space-x-2",children:[I.jsx("button",{onClick:()=>re(M-1),disabled:1===M,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:Math.min(5,U)},(e,t)=>{const s=Math.max(1,Math.min(U-4,M-2))+t;return s>U?null:I.jsx("button",{onClick:()=>re(s),className:"px-3 py-2 text-sm font-medium rounded-lg "+(s===M?"bg-blue-600 text-white":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50"),children:s},s)}),I.jsx("button",{onClick:()=>re(M+1),disabled:M===U,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})}),0===ue.length&&!r&&I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[I.jsx("i",{className:"ri-settings-3-line text-4xl text-gray-400 mb-4"}),I.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No settings found"}),I.jsx("p",{className:"text-gray-600",children:"Try adjusting your filters to see more results."})]}),v&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[I.jsx("div",{className:"p-6 border-b border-gray-200",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Welfare Check Reports",C&&I.jsxs("span",{className:"text-sm font-normal text-gray-600 ml-2",children:["- ",C.title]})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsxs("button",{onClick:()=>D(!0),disabled:0===N.length,className:"px-3 py-2 rounded-lg transition-colors flex items-center text-sm "+(0===N.length?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),title:0===N.length?"No data to export":"Export reports",children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export (",N.length,")"]}),I.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:I.jsx("i",{className:"ri-close-line text-xl"})})]})]})}),I.jsx("div",{className:"p-6",children:S?I.jsx("div",{className:"flex items-center justify-center h-32",children:I.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):0===N.length?I.jsxs("div",{className:"text-center py-8",children:[I.jsx("i",{className:"ri-file-list-line text-4xl text-gray-300"}),I.jsx("p",{className:"text-gray-500 mt-2",children:"No welfare reports found"})]}):I.jsx("div",{className:"space-y-4",children:N.map((e,t)=>I.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:I.jsx("div",{className:"flex items-start justify-between",children:I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[I.jsxs("h4",{className:"text-lg font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),I.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${de(e.status)}`,children:[I.jsx("i",{className:`mr-1 ${ce(e.status)}`}),"safe"===e.status?"Safe":"Needs Help"]})]}),I.jsx("p",{className:"text-gray-600 mb-2",children:e.email}),(e.address||e.city||e.state||e.zip_code)&&I.jsxs("div",{className:"mb-2",children:[I.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Address:"}),I.jsx("p",{className:"text-sm text-gray-600",children:[e.address,e.city,e.state,e.zip_code].filter(Boolean).join(", ")||"N/A"})]}),e.additional_info&&I.jsx("p",{className:"text-sm text-gray-700 mb-2",children:e.additional_info}),I.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[I.jsx("i",{className:"ri-time-line mr-1"}),"Submitted: ",le(e.submitted_at)]})]})})},e.report_id||t))})}),I.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[I.jsx("button",{onClick:()=>j(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"}),I.jsxs("button",{onClick:()=>ee(C?.id),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[I.jsx("i",{className:"ri-refresh-line mr-2"}),"Refresh"]})]})]})}),c&&x&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:I.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[I.jsx("div",{className:"p-6 border-b border-gray-200",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:m?"Edit Welfare Settings":"Add Welfare Settings"}),I.jsx("button",{onClick:()=>{u(!1),g(null),h(!1)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:I.jsx("i",{className:"ri-close-line text-xl"})})]})}),I.jsx("div",{className:"p-6",children:I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"System Title"}),I.jsx("input",{type:"text",name:"title",value:x.title,onChange:ie,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter system title"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),I.jsx("textarea",{name:"description",value:x.description,onChange:ie,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter system description"})]}),I.jsxs("div",{className:"flex items-center",children:[I.jsx("input",{type:"checkbox",name:"isActive",checked:x.isActive,onChange:ie,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),I.jsx("label",{className:"ml-2 block text-sm text-gray-700",children:"Enable welfare check system"})]}),!x.isActive&&I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message when disabled"}),I.jsx("textarea",{name:"messageWhenDisabled",value:x.messageWhenDisabled,onChange:ie,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter message to show when system is disabled"})]})]})}),I.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[I.jsx("button",{onClick:()=>{u(!1),g(null),h(!1)},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),I.jsx("button",{onClick:async()=>{if(x)if(!m||x.id)try{let t;l(!0),t=m?{id:x.id,isActive:x.isActive,title:x.title,description:x.description,messageWhenDisabled:x.messageWhenDisabled}:{isActive:x.isActive,title:x.title,description:x.description,messageWhenDisabled:x.messageWhenDisabled};const s=await V("/admin/welfare/settings",{method:m?"PUT":"POST",body:JSON.stringify(t)});s.success?(e({type:"success",message:`Welfare settings ${m?"updated":"created"} successfully`}),await X(),await Q(),u(!1),g(null)):e({type:"error",message:s.message||`Failed to ${m?"update":"create"} settings`})}catch(t){e({type:"error",message:t.message||`Failed to ${m?"update":"create"} settings. Please check if the backend server is running.`})}finally{l(!1)}else d({type:"error",text:"Cannot update setting without ID. Please create a new setting instead."})},disabled:i,className:"px-4 py-2 rounded-lg transition-colors "+(i?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:i?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),"Saving..."]}):m?"Update Settings":"Create Settings"})]})]})}),I.jsx(wl,{isOpen:f,onClose:()=>{p(!1),y(null)},onConfirm:()=>b&&(async t=>{if(t.id)try{l(!0);const s=await V("/admin/welfare/settings",{method:"DELETE",body:JSON.stringify({id:t.id})});s.success?(e({type:"success",message:"Welfare settings deleted successfully"}),await X(),await Q(),p(!1),y(null)):e({type:"error",message:s.message||"Failed to delete settings"})}catch(s){e({type:"error",message:s.message||"Failed to delete settings. Please check if the backend server is running."})}finally{l(!1)}else d({type:"error",text:"Cannot delete setting without ID"})})(b),title:"Delete Welfare Settings",message:`Are you sure you want to delete the welfare check settings for "${b?.title}"? This action cannot be undone.`,confirmText:"Delete Settings",cancelText:"Cancel",confirmVariant:"secondary",icon:"ri-delete-bin-line",iconColor:"text-red-600",isLoading:i}),I.jsx(wl,{isOpen:J,onClose:()=>{K(!1),Z(null)},onConfirm:async()=>{Y&&(await ne(Y),K(!1),Z(null))},title:"Activate Welfare Setting",message:`Activating "${Y?.title}" will automatically deactivate the currently active welfare setting. Are you sure you want to continue?`,confirmText:"Activate Setting",cancelText:"Cancel",confirmVariant:"primary",icon:"ri-play-line",iconColor:"text-blue-600",isLoading:i}),I.jsx(Lx,{open:O,onClose:()=>F(!1),onExportPDF:async()=>{try{const t=await te();Px.exportToPDF(t,db,{filename:"welfare_settings_export",title:"Welfare Settings Report",includeTimestamp:!0}),e({type:"success",message:`All ${t.length} welfare settings exported to PDF successfully`}),F(!1)}catch(t){e({type:"error",message:"Failed to export welfare settings to PDF"})}},onExportCSV:async()=>{try{const t=await te();Px.exportToCSV(t,db,{filename:"welfare_settings_export",title:"Welfare Settings Report",includeTimestamp:!0}),e({type:"success",message:`All ${t.length} welfare settings exported to CSV successfully`}),F(!1)}catch(t){e({type:"error",message:"Failed to export welfare settings to CSV"})}},onExportExcel:async()=>{try{const t=await te();Px.exportToExcel(t,db,{filename:"welfare_settings_export",title:"Welfare Settings Report",includeTimestamp:!0}),e({type:"success",message:`All ${t.length} welfare settings exported to Excel successfully`}),F(!1)}catch(t){e({type:"error",message:"Failed to export welfare settings to Excel"})}},data:t,columns:db.map(e=>({key:e.key,label:e.label})),title:`Welfare Settings Report (${z})`}),I.jsx(Lx,{open:R,onClose:()=>D(!1),onExportPDF:async()=>{try{const t=await se();Px.exportToPDF(t,cb,{filename:"welfare_reports_export",title:"Welfare Reports"+(C?` - ${C.title}`:""),includeTimestamp:!0}),e({type:"success",message:`All ${t.length} welfare reports exported to PDF successfully`}),D(!1)}catch(t){e({type:"error",message:"Failed to export welfare reports to PDF"})}},onExportCSV:async()=>{try{const t=await se();Px.exportToCSV(t,cb,{filename:"welfare_reports_export",title:"Welfare Reports"+(C?` - ${C.title}`:""),includeTimestamp:!0}),e({type:"success",message:`All ${t.length} welfare reports exported to CSV successfully`}),D(!1)}catch(t){e({type:"error",message:"Failed to export welfare reports to CSV"})}},onExportExcel:async()=>{try{const t=await se();Px.exportToExcel(t,cb,{filename:"welfare_reports_export",title:"Welfare Reports"+(C?` - ${C.title}`:""),includeTimestamp:!0}),e({type:"success",message:`All ${t.length} welfare reports exported to Excel successfully`}),D(!1)}catch(t){e({type:"error",message:"Failed to export welfare reports to Excel"})}},data:N,columns:cb.map(e=>({key:e.key,label:e.label})),title:`Welfare Reports${C?` - ${C.title}`:""} (${N.length})`})]})}delete Fl.Icon.Default.prototype._getIconUrl,Fl.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"}),Fl.divIcon({html:'\n    <div style="\n      background-color: #ef4444;\n      width: 20px;\n      height: 20px;\n      border-radius: 50%;\n      border: 2px solid white;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    ">\n      <i class="ri-alert-line" style="color: white; font-size: 10px;"></i>\n    </div>\n  ',className:"incident-marker",iconSize:[20,20],iconAnchor:[10,10],popupAnchor:[0,-10]});const mb=()=>{const[e,t]=n.useState([]),[s,a]=n.useState({totalIncidents:0,pendingIncidents:0,inProgressIncidents:0,resolvedIncidents:0,criticalIncidents:0,highPriorityIncidents:0}),[i,l]=n.useState(!0),[o,d]=n.useState([]),[c,u]=n.useState(new Date),[m,h]=n.useState([]),[x,g]=n.useState([]),[f,p]=n.useState([]),b=D(),y=b.userData?.id||b.userData?.staff_id||b.userData?.user_id;n.useEffect(()=>{y&&(S(),v(),j(),N());const e=setInterval(()=>{u(new Date)},6e4);return()=>clearInterval(e)},[y]),n.useEffect(()=>{const e=[...f].sort((e,t)=>new Date(t.date_reported).getTime()-new Date(e.date_reported).getTime());d(e.slice(0,5))},[f]);const v=async()=>{try{l(!0);const e=await Fe(Number(y));e.success&&e.incidents&&(p(e.incidents),t(e.incidents),w(e.incidents))}catch(e){}finally{l(!1)}},j=async()=>{try{const e=await Se();e.success&&e.data&&g(e.data)}catch(e){}},N=async()=>{try{const e=await ge();e.success&&e.alerts&&h(e.alerts)}catch(e){}},w=e=>{const t={totalIncidents:e.length,pendingIncidents:e.filter(e=>"pending"===e.status).length,inProgressIncidents:e.filter(e=>"in_progress"===e.status).length,resolvedIncidents:e.filter(e=>"resolved"===e.status).length,criticalIncidents:e.filter(e=>"critical"===e.priority_level).length,highPriorityIncidents:e.filter(e=>"high"===e.priority_level).length};a(t)},S=async()=>{try{const e=await rt();e.success&&e.stats}catch(e){}},k=e=>{switch(e){case"critical":return"bg-red-50 text-red-700 border-red-200 ring-1 ring-red-200";case"high":return"bg-orange-50 text-orange-700 border-orange-200 ring-1 ring-orange-200";case"moderate":return"bg-yellow-50 text-yellow-700 border-yellow-200 ring-1 ring-yellow-200";case"low":return"bg-green-50 text-green-700 border-green-200 ring-1 ring-green-200";default:return"bg-gray-50 text-gray-700 border-gray-200 ring-1 ring-gray-200"}},C=e=>{switch(e){case"pending":return"bg-amber-50 text-amber-700 border-amber-200 ring-1 ring-amber-200";case"in_progress":return"bg-blue-50 text-blue-700 border-blue-200 ring-1 ring-blue-200";case"resolved":return"bg-emerald-50 text-emerald-700 border-emerald-200 ring-1 ring-emerald-200";default:return"bg-gray-50 text-gray-700 border-gray-200 ring-1 ring-gray-200"}},$=e=>e.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase());return i?I.jsx("div",{className:"flex items-center justify-center min-h-[500px] bg-gradient-to-br from-slate-50 to-slate-100",children:I.jsxs("div",{className:"text-center",children:[I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto"}),I.jsx("div",{className:"absolute inset-0 w-16 h-16 border-4 border-transparent border-t-blue-400 rounded-full animate-spin mx-auto",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),I.jsx("p",{className:"mt-6 text-slate-600 font-medium",children:"Loading your dashboard..."})]})}):I.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-indigo-50/40",children:I.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 py-4 sm:py-8 space-y-6 sm:space-y-8",children:[I.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-800 rounded-2xl shadow-2xl",children:[I.jsxs("div",{className:"absolute inset-0",children:[I.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-white/10 rounded-full -translate-y-48 translate-x-48 blur-3xl"}),I.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-white/5 rounded-full translate-y-32 -translate-x-32 blur-2xl"}),I.jsx("div",{className:"absolute top-1/2 left-1/2 w-32 h-32 bg-white/10 rounded-full -translate-x-16 -translate-y-16 animate-pulse"})]}),I.jsx("div",{className:"relative z-10 p-4 sm:p-8 lg:p-12",children:I.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6 lg:gap-8",children:[I.jsxs("div",{className:"flex-1 space-y-3 sm:space-y-4",children:[I.jsxs("div",{className:"space-y-2",children:[I.jsxs("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold text-white leading-tight",children:[(()=>{const e=c.getHours();return e<12?"Good morning":e<17?"Good afternoon":"Good evening"})(),", ",I.jsx("span",{className:"text-blue-200",children:b.userData?.name}),"!"]}),I.jsx("p",{className:"text-blue-100 text-base sm:text-lg lg:text-xl font-medium",children:"Welcome to your emergency response command center"})]}),I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4 text-blue-200",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("i",{className:"ri-calendar-line text-lg sm:text-xl"}),I.jsx("span",{className:"font-medium text-sm sm:text-base",children:c.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),I.jsx("div",{className:"hidden sm:block w-1 h-1 bg-blue-300 rounded-full"}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("i",{className:"ri-time-line text-lg sm:text-xl"}),I.jsx("span",{className:"font-medium text-sm sm:text-base",children:c.toLocaleTimeString()})]})]})]}),I.jsx("div",{className:"flex justify-center lg:justify-end",children:I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 lg:w-28 lg:h-28 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center shadow-xl border border-white/30",children:I.jsx("i",{className:"ri-shield-check-line text-3xl sm:text-4xl lg:text-5xl text-white"})}),I.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-green-400 rounded-full border-2 border-white animate-pulse"})]})})]})})]}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/50 p-4 sm:p-8",children:[I.jsx("div",{className:"mb-6 sm:mb-8",children:I.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[I.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg",children:I.jsx("i",{className:"ri-dashboard-3-line text-white text-xl"})}),I.jsxs("div",{children:[I.jsx("h2",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-slate-900",children:"Priority Overview"}),I.jsx("p",{className:"text-slate-600 font-medium text-sm sm:text-base",children:"Real-time metrics for your assigned incidents"})]})]})}),I.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4 sm:gap-6",children:[I.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-50 to-blue-100/50 rounded-2xl p-4 sm:p-6 border border-blue-200/50 hover:shadow-xl hover:scale-105 transition-all duration-300 cursor-pointer",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 to-blue-600/5 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),I.jsxs("div",{className:"relative",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[I.jsx("div",{className:"p-2 sm:p-3 bg-blue-500 rounded-xl shadow-lg group-hover:scale-110 transition-transform duration-300",children:I.jsx("i",{className:"ri-alert-line text-white text-xl sm:text-2xl"})}),I.jsxs("div",{className:"text-right",children:[I.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-slate-900",children:s.totalIncidents}),I.jsx("div",{className:"text-xs font-semibold text-blue-600 uppercase tracking-wider",children:"Total"})]})]}),I.jsx("div",{className:"text-xs sm:text-sm text-slate-600 font-medium",children:"All assigned incidents"})]})]}),I.jsxs("div",{className:"group relative bg-gradient-to-br from-amber-50 to-amber-100/50 rounded-2xl p-4 sm:p-6 border border-amber-200/50 hover:shadow-xl hover:scale-105 transition-all duration-300 cursor-pointer",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/5 to-amber-600/5 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),I.jsxs("div",{className:"relative",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[I.jsx("div",{className:"p-2 sm:p-3 bg-amber-500 rounded-xl shadow-lg group-hover:scale-110 transition-transform duration-300",children:I.jsx("i",{className:"ri-time-line text-white text-xl sm:text-2xl"})}),I.jsxs("div",{className:"text-right",children:[I.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-slate-900",children:s.pendingIncidents}),I.jsx("div",{className:"text-xs font-semibold text-amber-600 uppercase tracking-wider",children:"Pending"})]})]}),I.jsx("div",{className:"text-xs sm:text-sm text-slate-600 font-medium",children:"Awaiting response"})]})]}),I.jsxs("div",{className:"group relative bg-gradient-to-br from-indigo-50 to-indigo-100/50 rounded-2xl p-4 sm:p-6 border border-indigo-200/50 hover:shadow-xl hover:scale-105 transition-all duration-300 cursor-pointer",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/5 to-indigo-600/5 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),I.jsxs("div",{className:"relative",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[I.jsx("div",{className:"p-2 sm:p-3 bg-indigo-500 rounded-xl shadow-lg group-hover:scale-110 transition-transform duration-300",children:I.jsx("i",{className:"ri-loader-4-line text-white text-xl sm:text-2xl"})}),I.jsxs("div",{className:"text-right",children:[I.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-slate-900",children:s.inProgressIncidents}),I.jsx("div",{className:"text-xs font-semibold text-indigo-600 uppercase tracking-wider",children:"Active"})]})]}),I.jsx("div",{className:"text-xs sm:text-sm text-slate-600 font-medium",children:"Currently handling"})]})]}),I.jsxs("div",{className:"group relative bg-gradient-to-br from-red-50 to-red-100/50 rounded-2xl p-4 sm:p-6 border border-red-200/50 hover:shadow-xl hover:scale-105 transition-all duration-300 cursor-pointer",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-red-500/5 to-red-600/5 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),I.jsxs("div",{className:"relative",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[I.jsx("div",{className:"p-2 sm:p-3 bg-red-500 rounded-xl shadow-lg group-hover:scale-110 transition-transform duration-300",children:I.jsx("i",{className:"ri-error-warning-line text-white text-xl sm:text-2xl"})}),I.jsxs("div",{className:"text-right",children:[I.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-slate-900",children:s.criticalIncidents}),I.jsx("div",{className:"text-xs font-semibold text-red-600 uppercase tracking-wider",children:"Critical"})]})]}),I.jsx("div",{className:"text-xs sm:text-sm text-slate-600 font-medium",children:"Immediate attention"})]})]}),I.jsxs("div",{className:"group relative bg-gradient-to-br from-orange-50 to-orange-100/50 rounded-2xl p-4 sm:p-6 border border-orange-200/50 hover:shadow-xl hover:scale-105 transition-all duration-300 cursor-pointer",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-500/5 to-orange-600/5 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),I.jsxs("div",{className:"relative",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[I.jsx("div",{className:"p-2 sm:p-3 bg-orange-500 rounded-xl shadow-lg group-hover:scale-110 transition-transform duration-300",children:I.jsx("i",{className:"ri-alert-line text-white text-xl sm:text-2xl"})}),I.jsxs("div",{className:"text-right",children:[I.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-slate-900",children:s.highPriorityIncidents}),I.jsx("div",{className:"text-xs font-semibold text-orange-600 uppercase tracking-wider",children:"High"})]})]}),I.jsx("div",{className:"text-xs sm:text-sm text-slate-600 font-medium",children:"Priority cases"})]})]}),I.jsxs("div",{className:"group relative bg-gradient-to-br from-emerald-50 to-emerald-100/50 rounded-2xl p-4 sm:p-6 border border-emerald-200/50 hover:shadow-xl hover:scale-105 transition-all duration-300 cursor-pointer",children:[I.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500/5 to-emerald-600/5 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),I.jsxs("div",{className:"relative",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[I.jsx("div",{className:"p-2 sm:p-3 bg-emerald-500 rounded-xl shadow-lg group-hover:scale-110 transition-transform duration-300",children:I.jsx("i",{className:"ri-check-double-line text-white text-xl sm:text-2xl"})}),I.jsxs("div",{className:"text-right",children:[I.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-slate-900",children:s.resolvedIncidents}),I.jsx("div",{className:"text-xs font-semibold text-emerald-600 uppercase tracking-wider",children:"Resolved"})]})]}),I.jsx("div",{className:"text-xs sm:text-sm text-slate-600 font-medium",children:"Successfully closed"})]})]})]})]}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/50 overflow-hidden",children:[I.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50 px-4 sm:px-8 py-4 sm:py-6 border-b border-slate-200/50",children:I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[I.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[I.jsx("div",{className:"p-2 sm:p-3 bg-gradient-to-br from-slate-600 to-slate-700 rounded-xl shadow-lg",children:I.jsx("i",{className:"ri-file-list-3-line text-white text-xl sm:text-2xl"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-slate-900",children:"Recent Incidents"}),I.jsx("p",{className:"text-slate-600 font-medium text-sm sm:text-base",children:"Your latest assigned cases"})]})]}),I.jsxs(r,{to:"/staff/incidents",className:"inline-flex items-center justify-center gap-2 px-4 sm:px-6 py-2 sm:py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-105 text-sm sm:text-base",children:["View All Cases",I.jsx("i",{className:"ri-arrow-right-line"})]})]})}),I.jsx("div",{className:"p-4 sm:p-8",children:0===o.length?I.jsxs("div",{className:"text-center py-12 sm:py-16",children:[I.jsxs("div",{className:"relative mb-6 sm:mb-8",children:[I.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 bg-gradient-to-br from-slate-100 to-slate-200 rounded-2xl flex items-center justify-center mx-auto shadow-lg",children:I.jsx("i",{className:"ri-inbox-line text-4xl sm:text-5xl text-slate-400"})}),I.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 sm:w-8 sm:h-8 bg-green-400 rounded-full border-4 border-white flex items-center justify-center",children:I.jsx("i",{className:"ri-check-line text-white text-xs sm:text-sm"})})]}),I.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-slate-900 mb-3",children:"All Clear!"}),I.jsx("p",{className:"text-slate-600 text-base sm:text-lg max-w-md mx-auto",children:"You don't have any assigned incidents at the moment. Great work keeping things under control!"})]}):I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"hidden lg:block overflow-hidden rounded-xl border border-slate-200",children:I.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[I.jsx("thead",{className:"bg-slate-50",children:I.jsxs("tr",{children:[I.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Incident Details"}),I.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Location"}),I.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Priority"}),I.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Status"}),I.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Date Reported"})]})}),I.jsx("tbody",{className:"bg-white divide-y divide-slate-100",children:o.map(e=>I.jsxs("tr",{className:"hover:bg-slate-50 transition-colors duration-150",children:[I.jsx("td",{className:"px-6 py-5",children:I.jsxs("div",{className:"space-y-1",children:[I.jsx("div",{className:"text-sm font-bold text-slate-900",children:e.incident_type}),I.jsx("div",{className:"text-sm text-slate-600 line-clamp-2 max-w-xs",children:e.description})]})}),I.jsx("td",{className:"px-6 py-5",children:I.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700",children:[I.jsx("i",{className:"ri-map-pin-line text-slate-400"}),e.location]})}),I.jsx("td",{className:"px-6 py-5",children:I.jsx("span",{className:`inline-flex px-3 py-1.5 text-xs font-bold rounded-lg ${k(e.priority_level)}`,children:e.priority_level.charAt(0).toUpperCase()+e.priority_level.slice(1)})}),I.jsx("td",{className:"px-6 py-5",children:I.jsx("span",{className:`inline-flex px-3 py-1.5 text-xs font-bold rounded-lg ${C(e.status)}`,children:$(e.status)})}),I.jsx("td",{className:"px-6 py-5 text-sm font-medium text-slate-700",children:new Date(e.date_reported).toLocaleDateString()})]},e.incident_id))})]})}),I.jsx("div",{className:"lg:hidden space-y-3 sm:space-y-4",children:o.map(e=>I.jsx("div",{className:"bg-gradient-to-br from-white to-slate-50/50 rounded-xl p-4 sm:p-6 border border-slate-200 shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-[1.02]",children:I.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[I.jsxs("div",{className:"flex items-start justify-between gap-3 sm:gap-4",children:[I.jsxs("div",{className:"flex-1 space-y-2",children:[I.jsx("h4",{className:"font-bold text-slate-900 text-base sm:text-lg leading-tight",children:e.incident_type}),I.jsx("p",{className:"text-slate-600 text-sm leading-relaxed line-clamp-3",children:e.description})]}),I.jsxs("div",{className:"flex flex-col gap-2 shrink-0",children:[I.jsx("span",{className:`inline-flex px-2 sm:px-3 py-1 sm:py-1.5 text-xs font-bold rounded-lg ${k(e.priority_level)}`,children:e.priority_level.charAt(0).toUpperCase()+e.priority_level.slice(1)}),I.jsx("span",{className:`inline-flex px-2 sm:px-3 py-1 sm:py-1.5 text-xs font-bold rounded-lg ${C(e.status)}`,children:$(e.status)})]})]}),I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-4 pt-3 sm:pt-4 border-t border-slate-200",children:[I.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[I.jsx("i",{className:"ri-map-pin-line text-slate-400"}),I.jsx("span",{className:"font-medium truncate",children:e.location})]}),I.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[I.jsx("i",{className:"ri-calendar-line text-slate-400"}),I.jsx("span",{children:new Date(e.date_reported).toLocaleDateString()})]})]})]})},e.incident_id))})]})})]}),I.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/50 overflow-hidden",children:[I.jsx("div",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-700 px-4 sm:px-8 py-4 sm:py-6",children:I.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:I.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[I.jsx("div",{className:"p-2 sm:p-3 bg-white/20 backdrop-blur-sm rounded-xl shadow-lg border border-white/30",children:I.jsx("i",{className:"ri-megaphone-line text-white text-xl sm:text-2xl"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-white",children:"System Announcements"}),I.jsx("p",{className:"text-blue-100 font-medium text-sm sm:text-base",children:"Latest alerts and notifications"})]})]})})}),I.jsx("div",{className:"p-4 sm:p-8",children:0===m.length?I.jsxs("div",{className:"text-center py-12 sm:py-16",children:[I.jsxs("div",{className:"relative mb-6 sm:mb-8",children:[I.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 bg-gradient-to-br from-green-100 to-green-200 rounded-2xl flex items-center justify-center mx-auto shadow-lg",children:I.jsx("i",{className:"ri-shield-check-line text-4xl sm:text-5xl text-green-500"})}),I.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 sm:w-8 sm:h-8 bg-green-400 rounded-full border-4 border-white flex items-center justify-center animate-pulse",children:I.jsx("i",{className:"ri-check-line text-white text-xs sm:text-sm"})})]}),I.jsx("h4",{className:"text-xl sm:text-2xl font-bold text-slate-900 mb-3",children:"All Systems Operational"}),I.jsx("p",{className:"text-slate-600 text-base sm:text-lg max-w-md mx-auto",children:"No active alerts or announcements. All emergency systems are running smoothly."})]}):I.jsx("div",{className:"max-w-4xl",children:(()=>{const e=m.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime())[0];return I.jsxs("div",{className:"relative bg-gradient-to-br from-slate-50 to-blue-50/30 border-2 border-blue-200/50 rounded-2xl p-4 sm:p-8 shadow-lg hover:shadow-xl transition-all duration-300",children:[I.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4",children:I.jsx("div",{className:"w-3 h-3 sm:w-4 sm:h-4 rounded-full animate-pulse "+("active"===e.status?"bg-red-500":"bg-gray-400")})}),I.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[I.jsxs("div",{className:"flex items-center flex-wrap gap-2 sm:gap-3",children:[I.jsxs("span",{className:"inline-flex items-center gap-2 px-3 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm font-bold rounded-xl shadow-sm "+("emergency"===e.alert_severity?"bg-red-100 text-red-800 border-2 border-red-200":"warning"===e.alert_severity?"bg-amber-100 text-amber-800 border-2 border-amber-200":"bg-blue-100 text-blue-800 border-2 border-blue-200"),children:[I.jsx("i",{className:"text-base sm:text-lg "+("emergency"===e.alert_severity?"ri-alarm-warning-line":"warning"===e.alert_severity?"ri-error-warning-line":"ri-information-line")}),e.alert_severity.charAt(0).toUpperCase()+e.alert_severity.slice(1)," ","Alert"]}),I.jsx("span",{className:"text-xs sm:text-sm font-bold text-slate-700 bg-slate-100 px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl border border-slate-200 capitalize",children:e.alert_type})]}),I.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[I.jsx("h4",{className:"text-lg sm:text-2xl font-bold text-slate-900 leading-tight",children:e.title}),I.jsx("p",{className:"text-slate-700 text-base sm:text-lg leading-relaxed",children:e.description})]}),I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 pt-4 sm:pt-6 border-t border-slate-200",children:[I.jsx("div",{className:"flex items-center gap-2 sm:gap-3 text-xs sm:text-sm text-slate-600",children:I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("i",{className:"ri-time-line text-blue-500 text-base sm:text-lg"}),I.jsx("span",{className:"font-semibold",children:"Posted:"}),I.jsx("span",{children:new Date(e.created_at).toLocaleString()})]})}),e.location_text&&I.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-slate-600",children:[I.jsx("i",{className:"ri-map-pin-line text-red-500 text-base sm:text-lg"}),I.jsx("span",{className:"font-semibold",children:"Location:"}),I.jsx("span",{className:"truncate",children:e.location_text})]})]})]})]})})()})})]})]})})},hb=()=>{const[e,t]=n.useState([]),[s,r]=n.useState([]),[a,i]=n.useState([]),[l,o]=n.useState([]),[d,c]=n.useState(""),[u,m]=n.useState("all"),[h,x]=n.useState("all"),[g,f]=n.useState("all"),[p,b]=n.useState("active"),[y,v]=n.useState(null),[j,N]=n.useState(!1),[w,S]=n.useState(!1),[k,C]=n.useState(!1),[$,_]=n.useState("team"),[A,P]=n.useState(null),[L,E]=n.useState(null),[T,O]=n.useState(null),[F,R]=n.useState(!1),[M,B]=n.useState(!1),[U,q]=n.useState(""),[z,W]=n.useState(""),[V,H]=n.useState([]),[G,J]=n.useState(!1),[K,Y]=n.useState(!1),Z=$t(),[X,Q]=n.useState({}),[ee,te]=n.useState({}),se=D(),re=se.userData?.id||se.userData?.staff_id||se.userData?.user_id,ae=se.userData?.assigned_team_id;n.useEffect(()=>{re&&(ie(),le(),oe())},[re]),n.useEffect(()=>{ue()},[e,d,u,h,g,p]);const ne=[{key:"incident_id",label:"Incident ID"},{key:"incident_type",label:"Type",format:e=>ge(e)},{key:"description",label:"Description"},{key:"resolvedLocation",label:"Location"},{key:"reporter_name",label:"Reporter"},{key:"reporter_type",label:"Reporter Type"},{key:"assigned_team_name",label:"Assigned Team"},{key:"date_reported",label:"Date Reported",format:e=>Px.formatDateTime(e)},{key:"updated_at",label:"Date Resolved",format:e=>e?Px.formatDateTime(e):""}],ie=async()=>{try{if(!re)return;const e=await Fe(Number(re));if(e.success&&e.incidents){const s=await Promise.all(e.incidents.map(async e=>{try{const t=await ce(e.latitude,e.longitude);return{...e,resolvedLocation:t}}catch(t){return{...e,resolvedLocation:`${Number(e.latitude).toFixed(4)}, ${Number(e.longitude).toFixed(4)}`}}}));t(s),e.staffInfo}}catch(e){}},le=async()=>{try{const e=await Te();e.success&&e.teams&&i(e.teams)}catch(e){}},oe=async()=>{try{const e=await de({status:"active"});e.success&&e.data?.users&&o(e.data.users)}catch(e){}},ce=async(e,t)=>{const s=Number(e),r=Number(t),a=`${s},${r}`;if(X[a])return X[a];te(e=>({...e,[a]:!0}));try{const e=await fetch(`/api/geocoding/reverse?lat=${s}&lon=${r}`,{headers:{Accept:"application/json","Cache-Control":"no-cache"}});if(!e.ok)throw new Error(`Geocoding failed: ${e.status} ${e.statusText}`);const t=await e.json();if(!t.success)throw new Error(t.message||"Geocoding failed");const n=t.data||"Unknown Location";return Q(e=>({...e,[a]:n})),n}catch(n){}finally{te(e=>({...e,[a]:!1}))}return`${s.toFixed(4)}, ${r.toFixed(4)}`},ue=()=>{let t=e;"active"===p?t=t.filter(e=>"pending"===e.status||"in_progress"===e.status):"history"===p&&(t=t.filter(e=>"resolved"===e.status||"closed"===e.status)),d&&(t=t.filter(e=>ge(e.incident_type).includes(d.toUpperCase())||e.incident_type.toLowerCase().includes(d.toLowerCase())||e.description.toLowerCase().includes(d.toLowerCase())||e.location.toLowerCase().includes(d.toLowerCase()))),"all"!==u&&(t=t.filter(e=>e.status===u)),"all"!==h&&(t=t.filter(e=>e.priority_level===h)),"all"!==g&&("individual"===g?t=t.filter(e=>e.assigned_staff_id===re):"team"===g&&(t=t.filter(e=>{if(e.assigned_team_id===ae)return!0;if(e.assigned_team_ids&&ae){return e.assigned_team_ids.split(",").map(e=>Number(e.trim())).includes(ae)}return!1}))),"all"===g&&ae&&(t=t.filter(e=>{if(e.assigned_team_id===ae)return!0;if(e.assigned_team_ids){return e.assigned_team_ids.split(",").map(e=>Number(e.trim())).includes(ae)}return e.assigned_staff_id===re})),r(t)},me=e=>{switch(e){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"moderate":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},he=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"in_progress":return"bg-blue-100 text-blue-800 border-blue-200";case"resolved":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},xe=e=>e.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase()),ge=e=>e.toUpperCase(),fe=e=>{const t=(e=>{if(e.assignment_type)return e.assignment_type;if(e.assigned_staff_id===re)return"individual";if(e.assigned_team_ids){const t=e.assigned_team_ids.split(",").map(e=>Number(e.trim()));if(ae&&t.includes(ae))return"teams"}else if(e.assigned_team_id===ae)return"team";return"unknown"})(e);return"individual"===t?I.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800 border border-blue-200",children:"Individual"}):"teams"===t?I.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-indigo-100 text-indigo-800 border border-indigo-200",children:"Multiple Teams"}):"team"===t?I.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800 border border-purple-200",children:"Team"}):null},pe=()=>{N(!1),v(null)},be=()=>{S(!1),v(null),P(null),E(null),O(null)},ye=e=>{"resolved"!==e.status&&"closed"!==e.status?(v(e),q(e.status),W(""),C(!0)):((e,t)=>{const s=Date.now().toString();H(r=>[...r,{id:s,message:e,type:t}]),setTimeout(()=>{H(e=>e.filter(e=>e.id!==s))},5e3)})("Cannot update incident. Resolved and closed incidents cannot be modified.","error")},ve=()=>{C(!1),v(null),q(""),W("")};return I.jsxs("div",{className:"min-h-screen bg-gray-50",children:[I.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:I.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-8 py-3 sm:py-4",children:I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"active"===p?"Active Incidents":"Incident History"}),I.jsx("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:"active"===p?"Manage incidents assigned to you individually or to your team":"View all resolved and closed incidents"})]}),I.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-3",children:I.jsxs("button",{onClick:()=>J(!0),className:"inline-flex items-center justify-center px-4 py-2.5 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[I.jsx("i",{className:"ri-download-line mr-2"}),"Export"]})})]})})}),I.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-8 py-3 sm:py-4",children:I.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-4 sm:mb-6",children:I.jsx("div",{className:"border-b border-gray-200",children:I.jsxs("nav",{className:"flex flex-col sm:flex-row sm:space-x-8 px-3 sm:px-4 md:px-6 space-y-1 sm:space-y-0","aria-label":"Tabs",children:[I.jsxs("button",{onClick:()=>b("active"),className:"py-3 sm:py-4 px-1 border-b-2 font-medium text-sm transition-colors "+("active"===p?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[I.jsx("i",{className:"ri-alert-line mr-2"}),"Active Incidents",I.jsx("span",{className:"ml-2 py-0.5 px-2 rounded-full text-xs bg-blue-100 text-blue-800",children:e.filter(e=>"pending"===e.status||"in_progress"===e.status).length})]}),I.jsxs("button",{onClick:()=>b("history"),className:"py-3 sm:py-4 px-1 border-b-2 font-medium text-sm transition-colors "+("history"===p?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[I.jsx("i",{className:"ri-history-line mr-2"}),"Incident History",I.jsx("span",{className:"ml-2 py-0.5 px-2 rounded-full text-xs bg-green-100 text-green-800",children:e.filter(e=>"resolved"===e.status||"closed"===e.status).length})]})]})})})}),I.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-8 py-3 sm:py-4 md:py-6",children:[I.jsxs("div",{className:"bg-white rounded-lg shadow p-3 sm:p-4 md:p-6 mb-4 sm:mb-6",children:[I.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3 sm:gap-4 mb-3 sm:mb-4 lg:mb-0",children:[I.jsxs("div",{className:"flex-1 lg:max-w-md",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),I.jsxs("div",{className:"relative",children:[I.jsx("input",{type:"text",placeholder:"Search incidents...",value:d,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base"}),I.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),I.jsxs("div",{className:"flex items-center justify-between lg:hidden",children:[I.jsxs("span",{className:"text-sm text-gray-600",children:[s.length," of ",e.length," incidents"]}),I.jsxs("button",{onClick:()=>Y(!K),className:"inline-flex items-center px-3 py-2.5 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[I.jsx("i",{className:"mr-2 "+(K?"ri-filter-off-line":"ri-filter-line")}),K?"Hide Filters":"Show Filters"]})]}),I.jsxs("div",{className:"hidden lg:flex items-center text-sm text-gray-600",children:[s.length," of ",e.length," incidents"]})]}),I.jsx("div",{className:(K?"block":"hidden")+" lg:block",children:I.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 pt-3 sm:pt-4 lg:pt-6 border-t border-gray-200 lg:border-t-0",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),I.jsxs("select",{value:u,onChange:e=>m(e.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",children:[I.jsxs("option",{value:"all",children:["All ","active"===p?"Active":"History"," Statuses"]}),"active"===p?I.jsxs(I.Fragment,{children:[I.jsx("option",{value:"pending",children:"Pending"}),I.jsx("option",{value:"in_progress",children:"In Progress"})]}):I.jsxs(I.Fragment,{children:[I.jsx("option",{value:"resolved",children:"Resolved"}),I.jsx("option",{value:"closed",children:"Closed"})]})]})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),I.jsxs("select",{value:h,onChange:e=>x(e.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",children:[I.jsx("option",{value:"all",children:"All Priorities"}),I.jsx("option",{value:"low",children:"Low"}),I.jsx("option",{value:"moderate",children:"Moderate"}),I.jsx("option",{value:"high",children:"High"}),I.jsx("option",{value:"critical",children:"Critical"})]})]})]})})]}),I.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[I.jsx("div",{className:"px-3 sm:px-4 md:px-6 py-3 md:py-4 border-b border-gray-200",children:I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"active"===p?"Active Incidents":"Incident History"}),I.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",s.length," of"," ","active"===p?e.filter(e=>"pending"===e.status||"in_progress"===e.status).length:e.filter(e=>"resolved"===e.status||"closed"===e.status).length," ","active"===p?"active":"resolved"," incidents"]})]})}),0===s.length?I.jsxs("div",{className:"text-center py-8 sm:py-12 px-4",children:[I.jsx("i",{className:"text-3xl sm:text-4xl mb-3 sm:mb-4 "+("active"===p?"ri-inbox-line text-gray-400":"ri-history-line text-green-400")}),I.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-2",children:"active"===p?"No active incidents":"No incident history"}),I.jsx("p",{className:"text-sm sm:text-base text-gray-600 max-w-md mx-auto",children:"active"===p?0===e.filter(e=>"pending"===e.status||"in_progress"===e.status).length?"You don't have any active incidents at the moment.":"No active incidents match your current filters.":0===e.filter(e=>"resolved"===e.status||"closed"===e.status).length?"You haven't resolved any incidents yet.":"No resolved incidents match your current filters."}),"active"===p&&0===e.filter(e=>"pending"===e.status||"in_progress"===e.status).length&&I.jsx("div",{className:"mt-3 sm:mt-4",children:I.jsxs("div",{className:"text-xs text-gray-400",children:[I.jsx("i",{className:"ri-information-line mr-1"}),"Active incidents will appear here when assigned to you or your team"]})})]}):I.jsx(I.Fragment,{children:I.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3 sm:gap-4 md:gap-6 p-3 sm:p-4 md:p-6",children:s.map(e=>I.jsxs("div",{className:"bg-white rounded-xl shadow-sm border transition-all duration-300 hover:shadow-lg "+("resolved"===e.status||"closed"===e.status?"border-green-200 bg-green-50":"border-gray-200 hover:border-blue-300"),children:[I.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[I.jsxs("div",{className:"flex items-start justify-between mb-3",children:[I.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[I.jsx("div",{className:"w-3 h-3 rounded-full "+("resolved"===e.status||"closed"===e.status?"bg-green-500":"in_progress"===e.status?"bg-blue-500":"bg-yellow-500")}),I.jsx("div",{children:I.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:["#",e.incident_id]})})]}),I.jsxs("div",{className:"flex flex-col items-end space-y-1.5 sm:space-y-2",children:[I.jsxs("span",{className:`inline-flex px-2 sm:px-3 py-1 text-xs font-semibold rounded-full border ${me(e.priority_level)}`,children:[I.jsx("i",{className:"ri-flag-line mr-1"}),e.priority_level.charAt(0).toUpperCase()+e.priority_level.slice(1)]}),I.jsx("span",{className:`inline-flex px-2 sm:px-3 py-1 text-xs font-semibold rounded-full border ${he(e.status)}`,children:xe(e.status)})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-sm sm:text-base font-semibold text-gray-900 mb-2",children:ge(e.incident_type)}),I.jsx("p",{className:"text-xs sm:text-sm text-gray-600 line-clamp-2 leading-relaxed",children:e.description})]})]}),I.jsxs("div",{className:"p-3 sm:p-4 space-y-3",children:[I.jsxs("div",{className:"flex items-start space-x-2 sm:space-x-3",children:[I.jsx("div",{className:"flex-shrink-0 w-7 h-7 sm:w-8 sm:h-8 bg-red-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-map-pin-line text-red-600 text-xs sm:text-sm"})}),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Location"}),I.jsx("p",{className:"text-xs sm:text-sm text-gray-900 break-words",children:ee[`${e.latitude},${e.longitude}`]?I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-blue-600 mr-2"}),I.jsx("span",{className:"text-gray-500",children:"Loading location..."})]}):e.resolvedLocation||e.location})]})]}),I.jsxs("div",{className:"flex items-start space-x-2 sm:space-x-3",children:[I.jsx("div",{className:"flex-shrink-0 w-7 h-7 sm:w-8 sm:h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-team-line text-blue-600 text-xs sm:text-sm"})}),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Assignment"}),I.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 sm:gap-2",children:[fe(e),e.all_assigned_teams?I.jsxs("div",{className:"flex flex-col space-y-1",children:[I.jsx("span",{className:"text-xs sm:text-sm text-gray-700 font-medium break-words",children:e.all_assigned_teams}),e.assigned_team_ids&&I.jsxs("span",{className:"text-xs text-gray-500",children:[e.assigned_team_ids.split(",").length," teams assigned"]})]}):e.assigned_team_name?I.jsx("span",{className:"text-xs sm:text-sm text-gray-700 font-medium break-words",children:e.assigned_team_name}):null,e.assigned_staff_name&&I.jsx("span",{className:"text-xs sm:text-sm text-gray-700 font-medium break-words",children:e.assigned_staff_name})]})]})]}),I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between pt-2 border-t border-gray-100 space-y-2 sm:space-y-0",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-time-line text-gray-400"}),I.jsxs("div",{className:"text-xs text-gray-500",children:[I.jsx("div",{className:"font-medium",children:new Date(e.date_reported).toLocaleDateString()}),I.jsx("div",{children:new Date(e.date_reported).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("i",{className:"ri-user-line text-gray-400"}),"guest"===e.reporter_type?I.jsxs("div",{className:"text-xs text-gray-500",children:[I.jsx("div",{className:"font-medium",children:e.guest_name||"Unknown Guest"}),I.jsxs("div",{className:"text-gray-400",children:["ID: ",e.guest_id||"N/A"]}),e.guest_contact&&I.jsxs("div",{className:"text-gray-400 break-all",children:["📞 ",e.guest_contact]})]}):I.jsxs("div",{className:"text-xs text-gray-500",children:[I.jsx("div",{className:"font-medium",children:e.reporter_name}),e.reporter_phone&&I.jsxs("div",{className:"text-gray-400 break-all",children:["📞 ",e.reporter_phone]})]})]})]})]}),I.jsx("div",{className:"px-3 sm:px-4 pb-3 sm:pb-4",children:I.jsxs("div",{className:"flex flex-col space-y-2",children:[I.jsxs("button",{onClick:()=>(e=>{v(e),N(!0)})(e),className:"w-full inline-flex items-center justify-center px-3 py-2.5 text-sm font-medium text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded-lg border border-blue-200 transition-colors",children:[I.jsx("i",{className:"ri-eye-line mr-2"}),"View Details"]}),I.jsxs("button",{onClick:()=>ye(e),disabled:"resolved"===e.status||"closed"===e.status,className:"w-full inline-flex items-center justify-center px-3 py-2.5 text-sm font-medium rounded-lg border transition-colors "+("resolved"===e.status||"closed"===e.status?"text-gray-400 bg-gray-100 border-gray-200 cursor-not-allowed":"text-green-600 hover:text-green-900 hover:bg-green-50 border-green-200"),children:[I.jsx("i",{className:"ri-edit-line mr-2"}),"resolved"===e.status||"closed"===e.status?"Completed":"Update"]})]})})]},e.incident_id))})})]})]}),j&&y&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 sm:p-4",children:I.jsxs("div",{className:"bg-white rounded-xl max-w-[95vw] sm:max-w-[90vw] md:max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl",children:[I.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-4 sm:px-6 py-3 sm:py-4 text-white",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[I.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-white bg-opacity-20 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-alert-line text-lg sm:text-xl"})}),I.jsxs("div",{children:[I.jsxs("h2",{className:"text-lg sm:text-xl font-bold",children:["Incident #",y.incident_id]}),I.jsx("p",{className:"text-blue-100 text-xs sm:text-sm",children:ge(y.incident_type)})]})]}),I.jsx("button",{onClick:pe,className:"text-white hover:text-blue-100 transition-colors p-2 rounded-lg hover:bg-white hover:bg-opacity-20",children:I.jsx("i",{className:"ri-close-line text-lg sm:text-xl"})})]})}),I.jsxs("div",{className:"p-3 sm:p-4 md:p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:[I.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[I.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[I.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 md:p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-file-text-line text-blue-600"}),I.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Description"})]}),I.jsx("p",{className:"text-gray-700 leading-relaxed text-sm sm:text-base",children:y.description})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 md:p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-map-pin-line text-red-600"}),I.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Location"})]}),I.jsx("p",{className:"text-gray-700 mb-2 text-sm sm:text-base break-words",children:y.resolvedLocation||y.location}),y.resolvedLocation&&y.resolvedLocation!==y.location&&I.jsxs("p",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded break-all",children:["Coordinates: ",Number(y.latitude).toFixed(4),","," ",Number(y.longitude).toFixed(4)]})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 md:p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-team-line text-green-600"}),I.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Assignment"})]}),I.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[fe(y),y.assigned_team_name&&I.jsxs("div",{className:"flex items-center space-x-1",children:[I.jsx("i",{className:"ri-team-line text-gray-400"}),I.jsx("span",{className:"text-xs sm:text-sm text-gray-700 break-words",children:y.assigned_team_name})]}),y.assigned_staff_name&&I.jsxs("div",{className:"flex items-center space-x-1",children:[I.jsx("i",{className:"ri-user-line text-gray-400"}),I.jsx("span",{className:"text-xs sm:text-sm text-gray-700 break-words",children:y.assigned_staff_name})]})]})]})]}),I.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[I.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[I.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 md:p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-flag-line text-orange-600"}),I.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Priority"})]}),I.jsx("span",{className:`inline-flex px-2 sm:px-3 py-1 text-xs sm:text-sm font-semibold rounded-full border ${me(y.priority_level)}`,children:y.priority_level.charAt(0).toUpperCase()+y.priority_level.slice(1)})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 md:p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-time-line text-purple-600"}),I.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Status"})]}),I.jsx("span",{className:`inline-flex px-2 sm:px-3 py-1 text-xs sm:text-sm font-semibold rounded-full border ${he(y.status)}`,children:xe(y.status)})]})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 md:p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-user-line text-indigo-600"}),I.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Reporter"})]}),"guest"===y.reporter_type?I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-indigo-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-indigo-600 text-xs sm:text-sm"})}),I.jsxs("div",{children:[I.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-900",children:y.guest_name||"Unknown Guest"}),I.jsx("div",{className:"text-xs text-gray-500",children:"Guest Reporter"})]})]}),I.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mt-3 pt-3 border-t border-gray-200",children:[I.jsxs("div",{children:[I.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Guest ID"}),I.jsx("div",{className:"text-xs sm:text-sm text-gray-900",children:y.guest_id||"N/A"})]}),I.jsxs("div",{children:[I.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Incident ID"}),I.jsx("div",{className:"text-xs sm:text-sm text-gray-900",children:y.incident_id})]}),I.jsxs("div",{className:"col-span-1 sm:col-span-2",children:[I.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Contact"}),I.jsx("div",{className:"text-xs sm:text-sm text-gray-900 break-all",children:y.guest_contact||"N/A"})]})]})]}):I.jsxs("div",{className:"space-y-1",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-indigo-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-indigo-600 text-xs sm:text-sm"})}),I.jsx("div",{className:"text-gray-700 font-medium text-sm sm:text-base",children:y.reporter_name})]}),y.reporter_phone&&I.jsxs("div",{className:"text-xs sm:text-sm text-gray-500 pl-8 sm:pl-10 break-all",children:["📞 ",y.reporter_phone]})]})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 md:p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-calendar-line text-gray-600"}),I.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Timeline"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Reported:"}),I.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:new Date(y.date_reported).toLocaleDateString()})]}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Time:"}),I.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:new Date(y.date_reported).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),y.date_resolved&&I.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-200",children:[I.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Resolved:"}),I.jsx("span",{className:"text-xs sm:text-sm font-medium text-green-600",children:new Date(y.date_resolved).toLocaleDateString()})]})]})]})]})]}),y.attachment&&I.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 md:p-4 mt-4 md:mt-6",children:[I.jsx("h3",{className:"font-semibold text-gray-900 mb-3 text-sm sm:text-base",children:"Attachments"}),I.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 sm:gap-3 md:gap-4",children:y.attachment.split(",").map((e,t)=>{const s=`/uploads/incidents/${e.trim()}`;return I.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"block border border-gray-300 rounded-lg overflow-hidden hover:shadow-lg transition-shadow",children:I.jsx("img",{src:s||"/placeholder.svg",alt:`Attachment ${t+1}`,className:"w-full h-20 sm:h-24 md:h-32 object-cover",onError:e=>{e.target.src="/images/placeholder-image.png"}})},t)})})]})]}),I.jsx("div",{className:"bg-gray-50 px-3 sm:px-4 md:px-6 py-3 md:py-4 border-t border-gray-200",children:I.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-3",children:[I.jsxs("button",{onClick:()=>{pe(),ye(y)},disabled:"resolved"===y.status||"closed"===y.status,className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2.5 rounded-lg text-sm font-medium transition-colors "+("resolved"===y.status||"closed"===y.status?"bg-gray-400 text-white cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:[I.jsx("i",{className:"ri-edit-line mr-2"}),"resolved"===y.status||"closed"===y.status?"Incident Completed":"Update Incident"]}),I.jsxs("button",{onClick:pe,className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[I.jsx("i",{className:"ri-close-line mr-2"}),"Close"]})]})})]})}),w&&y&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 sm:p-4",children:I.jsx("div",{className:"bg-white rounded-lg max-w-[95vw] sm:max-w-md w-full max-h-[90vh] overflow-y-auto",children:I.jsxs("div",{className:"p-4 md:p-6",children:[I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsxs("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:["Reassign Incident #",y.incident_id]}),I.jsx("button",{onClick:be,className:"text-gray-400 hover:text-gray-600 p-1",children:I.jsx("i",{className:"ri-close-line text-xl"})})]}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Type"}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("label",{className:"flex items-center",children:[I.jsx("input",{type:"radio",value:"team",checked:"team"===$,onChange:e=>_(e.target.value),className:"mr-2"}),I.jsx("span",{className:"text-sm text-gray-700",children:"Team Assignment"})]}),I.jsxs("label",{className:"flex items-center",children:[I.jsx("input",{type:"radio",value:"staff",checked:"staff"===$,onChange:e=>_(e.target.value),className:"mr-2"}),I.jsx("span",{className:"text-sm text-gray-700",children:"Individual Staff Assignment"})]})]})]}),"team"===$&&I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Team"}),I.jsxs("select",{value:A||"",onChange:e=>P(e.target.value?Number(e.target.value):null),className:"w-full px-3 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",children:[I.jsx("option",{value:"",children:"Clear Assignment"}),a.map(e=>I.jsxs("option",{value:e.id,children:[e.name," (",e.member_count," members)"]},e.id))]})]}),"staff"===$&&I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Staff"}),I.jsxs("select",{value:L||"",onChange:e=>E(e.target.value?Number(e.target.value):null),className:"w-full px-3 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",children:[I.jsx("option",{value:"",children:"Clear Assignment"}),l.map(e=>I.jsxs("option",{value:e.id,children:[e.name," - ",e.position]},e.id))]})]}),T&&I.jsxs("div",{className:"p-3 rounded-md "+(T.sent?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"),children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"mr-2 "+(T.sent?"ri-check-line":"ri-error-warning-line")}),I.jsx("span",{className:"text-sm font-medium",children:T.sent?"Email notifications sent successfully":"Email notifications failed"})]}),T.details&&I.jsxs("div",{className:"mt-2 text-xs",children:[T.details.error&&I.jsxs("p",{children:["Error: ",T.details.error]}),T.details.teamName&&I.jsxs("p",{children:["Team: ",T.details.teamName]}),T.details.totalMembers&&I.jsxs("p",{children:["Members: ",T.details.totalMembers]}),T.details.emailsSent&&I.jsxs("p",{children:["Sent: ",T.details.emailsSent]}),T.details.emailsFailed&&I.jsxs("p",{children:["Failed: ",T.details.emailsFailed]})]})]})]}),I.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-3",children:[I.jsx("button",{onClick:be,className:"w-full sm:w-auto px-4 py-2.5 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",disabled:F,children:"Cancel"}),I.jsx("button",{onClick:()=>{y&&("team"===$?(async(e,s)=>{try{R(!0),O(null);const r=await Me(e,s);t(t=>t.map(t=>{if(t.incident_id===e){const e=a.find(e=>e.id===s);return{...t,assigned_team_id:s,assigned_team_name:e?.name||void 0,assigned_staff_id:void 0,assigned_staff_name:void 0}}return t})),O(r?.emailSent?{sent:!0,details:r.emailDetails}:{sent:!1,details:r.emailDetails||{error:"No email details provided"}}),setTimeout(()=>{S(!1),O(null)},3e3)}catch(r){O({sent:!1,details:{error:r instanceof Error?r.message:"Unknown error"}})}finally{R(!1)}})(y.incident_id,A):(async(e,s)=>{try{R(!0),O(null);const r=await Ue(e,s);t(t=>t.map(t=>t.incident_id===e?{...t,assigned_staff_id:s,assigned_staff_name:s?"Assigned Staff":void 0,assigned_team_id:void 0,assigned_team_name:void 0}:t)),O(r?.emailSent?{sent:!0,details:r.emailDetails}:{sent:!1,details:r.emailDetails||{error:"No email details provided"}}),setTimeout(()=>{S(!1),O(null)},3e3)}catch(r){O({sent:!1,details:{error:r instanceof Error?r.message:"Unknown error"}})}finally{R(!1)}})(y.incident_id,L))},disabled:F,className:"w-full sm:w-auto px-4 py-2.5 rounded-lg transition-colors flex items-center justify-center text-sm font-medium "+(F?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:F?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Assigning..."]}):"Assign"})]})]})})}),k&&y&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-3 sm:p-4",children:I.jsx("div",{className:"bg-white rounded-lg max-w-[95vw] sm:max-w-md w-full max-h-[90vh] overflow-y-auto",children:I.jsxs("div",{className:"p-4 md:p-6",children:[I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsxs("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:["Update Incident #",y.incident_id]}),I.jsx("button",{onClick:ve,className:"text-gray-400 hover:text-gray-600 p-1",children:I.jsx("i",{className:"ri-close-line text-xl"})})]}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Status"}),I.jsx("div",{className:"text-sm text-gray-900 mb-2",children:I.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full border ${he(y.status)}`,children:xe(y.status)})})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Update Status"}),I.jsxs("select",{value:U,onChange:e=>q(e.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",children:[I.jsx("option",{value:"in_progress",children:"In Progress"}),I.jsx("option",{value:"resolved",children:"Resolved"}),I.jsx("option",{value:"closed",children:"Closed"})]})]})]}),I.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-3",children:[I.jsx("button",{onClick:ve,className:"w-full sm:w-auto px-4 py-2.5 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",disabled:M,children:"Cancel"}),I.jsx("button",{onClick:()=>{y&&(async(e,s,r)=>{try{B(!0),O(null),await qe(e,{status:s,notes:r}),t(t=>t.map(t=>t.incident_id===e?{...t,status:s}:t));const a=Date.now().toString();H(e=>[...e,{id:a,message:"Incident updated successfully",type:"success"}]),setTimeout(()=>{H(e=>e.filter(e=>e.id!==a))},3e3),setTimeout(()=>{C(!1),q(""),W("")},1e3)}catch(a){const e=Date.now().toString();H(t=>[...t,{id:e,message:"Failed to update incident",type:"error"}]),setTimeout(()=>{H(t=>t.filter(t=>t.id!==e))},3e3)}finally{B(!1)}})(y.incident_id,U,z)},disabled:M||!U,className:"w-full sm:w-auto px-4 py-2.5 rounded-lg transition-colors flex items-center justify-center text-sm font-medium "+(M||!U?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:M?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"Update Incident"})]})]})})}),I.jsx(Lx,{open:G,onClose:()=>J(!1),onExportPDF:async()=>{try{await Px.exportToPDF(s,ne,{filename:"staff_incidents",title:"Staff Incidents Report",includeTimestamp:!0}),Z.showToast({type:"success",message:"PDF export completed successfully"}),J(!1)}catch(e){Z.showToast({type:"error",message:"Failed to export PDF"})}},onExportCSV:()=>{try{Px.exportToCSV(s,ne,{filename:"staff_incidents",includeTimestamp:!0}),Z.showToast({type:"success",message:"CSV export completed successfully"}),J(!1)}catch(e){Z.showToast({type:"error",message:"Failed to export CSV"})}},onExportExcel:()=>{try{Px.exportToExcel(s,ne,{filename:"staff_incidents",includeTimestamp:!0}),Z.showToast({type:"success",message:"Excel export completed successfully"}),J(!1)}catch(e){Z.showToast({type:"error",message:"Failed to export Excel"})}},data:s,columns:ne.map(e=>({key:e.key,label:e.label})),title:"Export Staff Incidents"}),I.jsx("div",{className:"fixed top-4 right-3 sm:right-4 z-50 space-y-2 max-w-[calc(100vw-24px)] sm:max-w-sm",children:V.map(e=>I.jsx("div",{className:"px-3 sm:px-4 py-2 sm:py-3 rounded-lg shadow-lg transform transition-all duration-300 "+("success"===e.type?"bg-green-500 text-white":"error"===e.type?"bg-red-500 text-white":"warning"===e.type?"bg-yellow-500 text-white":"bg-blue-500 text-white"),children:I.jsxs("div",{className:"flex items-center",children:[I.jsx("i",{className:"mr-2 "+("success"===e.type?"ri-check-line":"error"===e.type?"ri-error-warning-line":"warning"===e.type?"ri-alert-line":"ri-information-line")}),I.jsx("span",{className:"text-xs sm:text-sm font-medium break-words",children:e.message})]})},e.id))})]})};delete Fl.Icon.Default.prototype._getIconUrl,Fl.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const xb=(e,t)=>{let s="#6b7280";return"resolved"===t||"closed"===t?s="#10b981":"in_progress"===t?s="#3b82f6":"pending"===t&&(s="#f59e0b"),"pending"!==t&&"in_progress"!==t||"critical"!==e||(s="#ef4444"),Fl.divIcon({html:`<div style="background-color: ${s}; width: 24px; height: 24px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center;">\n            <i class="ri-alert-line" style="color: white; font-size: 12px;"></i>\n          </div>`,className:"custom-incident-marker",iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-12]})},gb=({center:e,zoom:t})=>{const s=zl();return n.useEffect(()=>{s.setView(e,t)},[s,e,t]),null},fb=14.2,pb=13.5,bb=121.5,yb=120.8,vb=[13.84542,121.206189],jb="critical",Nb="pending",wb="in_progress",Sb="resolved",kb=e=>{if(!e)return 10;const{minLat:t,maxLat:s,minLng:r,maxLng:a,validIncidents:n}=e;if(1===n.length)return 15;const i=n.every(e=>{const t=Number(e.latitude),s=Number(e.longitude);return t>=pb&&t<=fb&&s>=yb&&s<=bb}),l=s-t,o=a-r,d=Math.max(l,o);return i?d<.01?16:d<.05?14:d<.2?12:10:d<.01?16:d<.05?14:d<.2?12:d<1?10:8},Cb=({incidents:e,showHeatmap:t,onHeatmapLayerChange:s})=>{const r=zl(),a={low:"#10B981",moderate:"#FFD966",high:"#E67E22",critical:"#EF4444"};return n.useEffect(()=>{if(!t)return r.eachLayer(e=>{e.options&&e.options.heatLayer&&r.removeLayer(e)}),void s([]);const n=()=>{if(window.L&&window.L.heatLayer){r.eachLayer(e=>{e.options&&e.options.heatLayer&&r.removeLayer(e)});const t=[],n={low:e.filter(e=>e.latitude&&e.longitude&&!isNaN(Number(e.latitude))&&!isNaN(Number(e.longitude))&&"low"===e.priority_level),moderate:e.filter(e=>e.latitude&&e.longitude&&!isNaN(Number(e.latitude))&&!isNaN(Number(e.longitude))&&"moderate"===e.priority_level),high:e.filter(e=>e.latitude&&e.longitude&&!isNaN(Number(e.latitude))&&!isNaN(Number(e.longitude))&&"high"===e.priority_level),critical:e.filter(e=>e.latitude&&e.longitude&&!isNaN(Number(e.latitude))&&!isNaN(Number(e.longitude))&&"critical"===e.priority_level)};Object.entries(n).forEach(([e,s])=>{const n=s.map(e=>{const t=Number(e.latitude),s=Number(e.longitude),r=(e=>{let t=.3;switch(e.priority_level){case"critical":t=1;break;case"high":t=.8;break;case"moderate":t=.6;break;case"low":t=.4}return"pending"!==e.status&&"in_progress"!==e.status||(t*=1.2),Math.min(t,1)})(e);return[t,s,r]});if(n.length>0){const s=a[e],i=window.L.heatLayer(n,{radius:35,blur:15,maxZoom:18,minZoom:8,minOpacity:.65,maxOpacity:.8,gradient:{.5:s,1:s},heatLayer:!0});i.addTo(r),t.push(i)}}),s(t),setTimeout(()=>{r.invalidateSize()},100)}else setTimeout(n,100)};(async()=>{try{await ed(()=>import("./leaflet-heat-DFy7BNl5.js"),[])}catch(e){}})().then(n)},[e,t,r,s]),null},$b=({type:e,label:t,color:s,isActive:r,onClick:a})=>{const n=(e=>{const t={red:{bg:"bg-red-50",border:"border-red-200",ring:"ring-red-300",text:"text-red-600",gradient:"from-red-500 to-red-500"},amber:{bg:"bg-amber-50",border:"border-amber-200",ring:"ring-amber-300",text:"text-amber-600",gradient:"from-amber-500 to-amber-500"},blue:{bg:"bg-blue-50",border:"border-blue-200",ring:"ring-blue-300",text:"text-blue-600",gradient:"from-blue-500 to-blue-500"},green:{bg:"bg-green-50",border:"border-green-200",ring:"ring-green-300",text:"text-green-600",gradient:"from-green-500 to-green-500"}};return t[e]||t.blue})(s);return I.jsxs("div",{className:"flex items-center text-sm cursor-pointer rounded-lg p-2 transition-all duration-200 hover:bg-gray-50 "+(r?`${n.bg} border ${n.border}`:"opacity-60"),onClick:a,children:[I.jsx("div",{className:`w-4 h-4 bg-gradient-to-r ${n.gradient} rounded-full mr-3 shadow-sm ${r?`ring-2 ${n.ring}`:""}`}),I.jsx("span",{className:"font-medium "+(r?"text-gray-900":"text-gray-500"),children:t}),r&&I.jsx("i",{className:`ri-check-line ml-auto ${n.text} text-sm`})]})},_b=({userLocation:e,incidents:t,showHeatmap:s,filteredIncidentsCount:r,onCenterUserLocation:a,onShowAllIncidents:n,onToggleHeatmap:i})=>I.jsxs("div",{className:"absolute top-4 right-4 z-10 space-y-3",children:[e&&I.jsx("button",{onClick:a,className:"group bg-white/90 backdrop-blur-sm hover:bg-white border border-white/20 rounded-xl p-3 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105",title:"Center on my location",children:I.jsx("i",{className:"ri-focus-3-line text-blue-600 text-lg group-hover:text-blue-700"})}),I.jsx("button",{onClick:n,className:"group bg-white/90 backdrop-blur-sm hover:bg-white border border-white/20 rounded-xl p-3 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105",title:"Show all incidents",children:I.jsx("i",{className:"ri-fullscreen-line text-blue-600 text-lg group-hover:text-blue-700"})}),I.jsx("button",{onClick:i,className:"group bg-white/90 backdrop-blur-sm hover:bg-white border border-white/20 rounded-xl p-3 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105 "+(s?"bg-blue-100 border-blue-300":""),title:s?"Hide heatmap":"Show heatmap",children:I.jsx("i",{className:"ri-fire-line text-lg group-hover:text-blue-700 "+(s?"text-blue-600":"text-gray-600")})}),I.jsx("div",{className:"bg-white/90 backdrop-blur-sm border border-white/20 rounded-xl p-3 shadow-xl",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"text-lg font-bold text-blue-600",children:r}),I.jsx("div",{className:"text-xs text-gray-600",children:"Incidents"})]})})]}),Ab=({incidents:e,onIncidentClick:t,height:s="24rem",showUserLocation:r=!1,userLocation:a=null})=>{const[i,l]=n.useState(vb),[o,d]=n.useState(13),[c,u]=n.useState(!0),[m,h]=n.useState(!1),[x,g]=n.useState(new Set([jb,Nb,wb,Sb])),[f,p]=n.useState(!1),[b,y]=n.useState(!1),[v,j]=n.useState(null),N=n.useMemo(()=>(e=>{const t=e.filter(e=>e.latitude&&e.longitude&&!isNaN(Number(e.latitude))&&!isNaN(Number(e.longitude)));if(0===t.length)return null;const s=t.map(e=>Number(e.latitude)),r=t.map(e=>Number(e.longitude));return{minLat:Math.min(...s),maxLat:Math.max(...s),minLng:Math.min(...r),maxLng:Math.max(...r),centerLat:(Math.min(...s)+Math.max(...s))/2,centerLng:(Math.min(...r)+Math.max(...r))/2,validIncidents:t}})(e),[e]),w=n.useMemo(()=>e.filter(e=>0===x.size||(!(!x.has(jb)||"critical"!==e.priority_level||"pending"!==e.status&&"in_progress"!==e.status)||(!(!x.has(Nb)||"pending"!==e.status||"critical"===e.priority_level)||(!(!x.has(wb)||"in_progress"!==e.status||"critical"===e.priority_level)||!(!x.has(Sb)||"resolved"!==e.status&&"closed"!==e.status))))),[e,x]),S=n.useCallback(()=>{if(N&&N.validIncidents.length>0)if(1===N.validIncidents.length){const e=N.validIncidents[0];l([Number(e.latitude),Number(e.longitude)]),d(15)}else l([N.centerLat,N.centerLng]),d(kb(N));else a?(l([a.latitude,a.longitude]),d(14)):(l(vb),d(10))},[N,a]);n.useEffect(()=>{S()},[S]),n.useEffect(()=>{(()=>{if(!document.querySelector('link[href*="leaflet"]')){const e=document.createElement("link");e.rel="stylesheet",e.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",e.integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=",e.crossOrigin="",document.head.appendChild(e)}})()},[]),n.useEffect(()=>{const e=setTimeout(()=>{c&&(h(!0),u(!1))},1e4);return()=>clearTimeout(e)},[c]);const k=e=>{switch(e){case"critical":return"text-red-600";case"high":return"text-orange-600";case"moderate":return"text-yellow-600";case"low":return"text-green-600";default:return"text-gray-600"}},C=n.useCallback(e=>{g(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),$=n.useCallback(()=>{g(new Set([jb,Nb,wb,Sb]))},[]),_=n.useCallback(()=>{y(e=>!e)},[]),A=n.useCallback(()=>{a&&(l([a.latitude,a.longitude]),d(15))},[a]),P=n.useCallback(()=>{if(N&&N.validIncidents.length>0){l([N.centerLat,N.centerLng]);const e=kb(N),t=Math.min(e,10);d(t)}},[N]);return I.jsxs("div",{className:"relative",children:[I.jsx(_b,{userLocation:a,incidents:e,showHeatmap:b,filteredIncidentsCount:w.length,onCenterUserLocation:A,onShowAllIncidents:P,onToggleHeatmap:_}),I.jsxs("div",{className:"w-full rounded-2xl overflow-hidden shadow-2xl border border-white/20 relative",style:{height:s,minHeight:"300px",position:"relative"},children:[c&&I.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-20",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),I.jsx("p",{className:"text-gray-600",children:"Loading map..."})]})}),m&&I.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-20",children:I.jsxs("div",{className:"text-center",children:[I.jsx("i",{className:"ri-error-warning-line text-4xl text-red-400 mb-4"}),I.jsx("p",{className:"text-gray-600 mb-2",children:"Failed to load interactive map"}),I.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Showing static map instead"}),I.jsx("button",{onClick:()=>{h(!1),u(!0),window.location.reload()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Retry Interactive Map"})]})}),m&&I.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center z-10",children:I.jsxs("div",{className:"text-center p-4",children:[I.jsx("i",{className:"ri-map-2-line text-6xl text-gray-400 mb-4"}),I.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Incidents Map"}),I.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:[e.length," incidents available"]}),I.jsxs("div",{className:"space-y-2 text-left max-w-md mx-auto",children:[e.slice(0,5).map(e=>I.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsxs("h4",{className:"font-medium text-gray-900",children:["#",e.incident_id," - ",e.incident_type]}),I.jsx("p",{className:"text-sm text-gray-600",children:e.description})]}),I.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("resolved"===e.status?"bg-green-100 text-green-800":"in_progress"===e.status?"bg-blue-100 text-blue-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status})]})},e.incident_id)),e.length>5&&I.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["+",e.length-5," more incidents"]})]})]})}),I.jsxs(Jl,{center:i,zoom:o,style:{height:"100%",width:"100%"},className:"z-0 h-full w-full",zoomControl:!0,whenReady:()=>{u(!1),b&&setTimeout(()=>{y(!0)},500)},children:[I.jsx(gb,{center:i,zoom:o}),I.jsx(Cb,{incidents:w,showHeatmap:b,onHeatmapLayerChange:j}),I.jsx(Ql,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",maxZoom:19,errorTileUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",eventHandlers:{loading:()=>{},load:()=>{},tileerror:e=>{h(!0)}}}),r&&a&&I.jsx(Kl,{position:[a.latitude,a.longitude],icon:Fl.divIcon({html:'<div style="background-color: #3b82f6; width: 16px; height: 16px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); animation: pulse 2s infinite;"></div>\n                       <style>@keyframes pulse { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.2); opacity: 0.7; } 100% { transform: scale(1); opacity: 1; } }</style>',className:"user-location-marker",iconSize:[16,16],iconAnchor:[8,8]}),children:I.jsx(Xl,{children:I.jsxs("div",{className:"text-center",children:[I.jsx("strong",{children:"Your Location"}),I.jsx("br",{}),I.jsxs("small",{className:"text-gray-600",children:["Lat: ",a.latitude.toFixed(6),I.jsx("br",{}),"Lng: ",a.longitude.toFixed(6)]})]})})}),!b&&w.map(e=>{const s=Number(e.latitude),r=Number(e.longitude);return isNaN(s)||isNaN(r)?null:I.jsx(Kl,{position:[s,r],icon:xb(e.priority_level,e.status),eventHandlers:{click:()=>t?.(e)},children:I.jsx(Xl,{maxWidth:350,className:"incident-popup",children:I.jsxs("div",{className:"p-3",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsxs("h3",{className:"font-bold text-lg text-gray-900",children:["Incident #",e.incident_id]}),I.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("resolved"===e.status?"bg-green-100 text-green-800":"in_progress"===e.status?"bg-blue-100 text-blue-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:(n=e.status,n.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase()))})]}),I.jsxs("div",{className:"space-y-2 mb-4",children:[I.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.incident_type}),I.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:e.description}),I.jsxs("p",{className:"text-sm text-gray-600",children:[I.jsx("span",{className:"font-medium",children:"Location:"})," ",e.resolvedLocation||e.location]}),I.jsxs("p",{className:"text-sm text-gray-600",children:[I.jsx("span",{className:"font-medium",children:"Priority:"}),I.jsx("span",{className:`ml-1 ${k(e.priority_level)}`,children:e.priority_level.charAt(0).toUpperCase()+e.priority_level.slice(1)})]}),I.jsxs("p",{className:"text-sm text-gray-600",children:[I.jsx("span",{className:"font-medium",children:"Reporter:"})," ",e.reporter_name]}),e.assigned_team_name&&I.jsxs("p",{className:"text-sm text-gray-600",children:[I.jsx("span",{className:"font-medium",children:"Assigned Team:"})," ",e.assigned_team_name]}),e.assigned_staff_name&&I.jsxs("p",{className:"text-sm text-gray-600",children:[I.jsx("span",{className:"font-medium",children:"Assigned Staff:"})," ",e.assigned_staff_name]})]}),I.jsx("div",{className:"flex gap-2",children:I.jsx("button",{onClick:()=>t?.(e),className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded text-sm hover:bg-blue-700 transition-colors",children:"View Details"})}),I.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["Reported: ",(a=e.date_reported,new Date(a).toLocaleString())]})]})})},e.incident_id);var a,n})]})]}),f?I.jsxs("div",{className:"absolute bottom-4 left-4 z-10 bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-4",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",onClick:()=>p(!1),style:{cursor:"pointer"},children:[I.jsxs("h4",{className:"text-sm font-bold text-gray-900 flex items-center",children:[I.jsx("i",{className:"ri-information-line mr-2 text-blue-600"}),"Legend"]}),I.jsx("button",{onClick:$,className:"text-xs text-blue-600 hover:text-blue-700 font-medium hover:underline",title:"Show all incident types",children:"Show All"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx($b,{type:jb,label:"Critical Pending/In Progress",color:"red",isActive:x.has(jb),onClick:()=>C(jb)}),I.jsx($b,{type:Nb,label:"Pending",color:"amber",isActive:x.has(Nb),onClick:()=>C(Nb)}),I.jsx($b,{type:wb,label:"In Progress",color:"blue",isActive:x.has(wb),onClick:()=>C(wb)}),I.jsx($b,{type:Sb,label:"Resolved/Closed",color:"green",isActive:x.has(Sb),onClick:()=>C(Sb)})]})]}):I.jsx("button",{onClick:()=>p(!0),className:"absolute bottom-4 left-4 z-10 bg-white/90 backdrop-blur-sm hover:bg-white border border-white/20 rounded-xl p-3 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105",title:"Show legend",children:I.jsx("i",{className:"ri-information-line text-blue-600 text-lg"})})]})},Pb=()=>{const[e,t]=n.useState([]),[s,a]=n.useState(null),[i,l]=n.useState(!1),[o,d]=n.useState({}),[c,u]=n.useState({}),[m,h]=n.useState(!0),[x,g]=n.useState(null),f=D(),p=f.userData?.id||f.userData?.staff_id||f.userData?.user_id;n.useEffect(()=>{(async()=>{if(!p)return g("No staff ID found. Please log in again."),void h(!1);try{h(!0),g(null);const e=Number(p),s=await Fe(e);s.success?t(s.incidents||[]):g("Failed to fetch incidents")}catch(e){g(e instanceof Error?e.message:"Failed to fetch incidents")}finally{h(!1)}})()},[p]);const b=()=>{l(!1),a(null)};return I.jsxs("div",{className:"min-h-screen bg-gray-50",children:[I.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:I.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:I.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Incident Map"}),I.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"View incidents assigned to you or your team on the map"})]}),I.jsx("div",{className:"flex items-center space-x-3",children:I.jsxs(r,{to:"/staff/incidents",className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[I.jsx("i",{className:"ri-list-unordered mr-2"}),"List View"]})})]})})}),I.jsx("div",{className:"max-w-9xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:I.jsx("div",{className:"",children:I.jsx("div",{className:"p-6",children:I.jsx(Ab,{incidents:e,onIncidentClick:e=>{a(e),l(!0)},height:"calc(100vh - 220px)",showUserLocation:!1})})})}),i&&s&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:I.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl",children:[I.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 text-white",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-10 h-10 bg-white bg-opacity-20 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-alert-line text-xl"})}),I.jsxs("div",{children:[I.jsxs("h2",{className:"text-xl font-bold",children:["Incident #",s.incident_id]}),I.jsx("p",{className:"text-blue-100 text-sm",children:s.incident_type})]})]}),I.jsx("button",{onClick:b,className:"text-white hover:text-blue-100 transition-colors p-2 rounded-lg hover:bg-white hover:bg-opacity-20",children:I.jsx("i",{className:"ri-close-line text-xl"})})]})}),I.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:[I.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-file-text-line text-blue-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Description"})]}),I.jsx("p",{className:"text-gray-700 leading-relaxed",children:s.description})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-map-pin-line text-red-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Location"})]}),I.jsx("p",{className:"text-gray-700 mb-2",children:s.resolvedLocation||s.location}),s.resolvedLocation&&s.resolvedLocation!==s.location&&I.jsxs("p",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:["Coordinates: ",Number(s.latitude).toFixed(4),", ",Number(s.longitude).toFixed(4)]})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-team-line text-green-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Assignment"})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[s.assigned_team_name&&I.jsxs("div",{className:"flex items-center space-x-1",children:[I.jsx("i",{className:"ri-team-line text-gray-400"}),I.jsx("span",{className:"text-sm text-gray-700",children:s.assigned_team_name})]}),s.assigned_staff_name&&I.jsxs("div",{className:"flex items-center space-x-1",children:[I.jsx("i",{className:"ri-user-line text-gray-400"}),I.jsx("span",{className:"text-sm text-gray-700",children:s.assigned_staff_name})]})]})]})]}),I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-flag-line text-orange-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Priority"})]}),I.jsx("span",{className:"inline-flex px-3 py-1 text-sm font-semibold rounded-full border "+("critical"===s.priority_level?"bg-red-100 text-red-800 border-red-200":"high"===s.priority_level?"bg-orange-100 text-orange-800 border-orange-200":"moderate"===s.priority_level?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-green-100 text-green-800 border-green-200"),children:s.priority_level.charAt(0).toUpperCase()+s.priority_level.slice(1)})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-time-line text-purple-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Status"})]}),I.jsx("span",{className:"inline-flex px-3 py-1 text-sm font-semibold rounded-full border "+("pending"===s.status?"bg-yellow-100 text-yellow-800 border-yellow-200":"in_progress"===s.status?"bg-blue-100 text-blue-800 border-blue-200":"resolved"===s.status?"bg-green-100 text-green-800 border-green-200":"bg-gray-100 text-gray-800 border-gray-200"),children:s.status.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())})]})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-user-line text-indigo-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Reporter"})]}),"guest"===s.reporter_type?I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-indigo-600 text-sm"})}),I.jsxs("div",{children:[I.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.guest_name||"Unknown Guest"}),I.jsx("div",{className:"text-xs text-gray-500",children:"Guest Reporter"})]})]}),I.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3 pt-3 border-t border-gray-200",children:[I.jsxs("div",{children:[I.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Guest ID"}),I.jsx("div",{className:"text-sm text-gray-900",children:s.guest_id||"N/A"})]}),I.jsxs("div",{className:"col-span-2",children:[I.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Contact"}),I.jsx("div",{className:"text-sm text-gray-900",children:s.guest_contact||"N/A"})]})]})]}):I.jsxs("div",{className:"space-y-1",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-indigo-600 text-sm"})}),I.jsx("div",{className:"text-gray-700 font-medium",children:s.reporter_name})]}),s.reporter_phone&&I.jsxs("div",{className:"text-sm text-gray-500 pl-10",children:["📞 ",s.reporter_phone]})]})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-calendar-line text-gray-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Timeline"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Reported:"}),I.jsx("span",{className:"text-sm font-medium text-gray-900",children:new Date(s.date_reported).toLocaleDateString()})]}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Time:"}),I.jsx("span",{className:"text-sm font-medium text-gray-900",children:new Date(s.date_reported).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),s.date_resolved&&I.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-200",children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Resolved:"}),I.jsx("span",{className:"text-sm font-medium text-green-600",children:new Date(s.date_resolved).toLocaleDateString()})]})]})]})]})]}),s.attachment&&I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-6",children:[I.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Attachments"}),I.jsx("div",{className:"grid grid-cols-3 gap-4",children:s.attachment.split(",").map((e,t)=>{const s=`/uploads/incidents/${e.trim()}`;return I.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"block border border-gray-300 rounded-lg overflow-hidden hover:shadow-lg transition-shadow",children:I.jsx("img",{src:s,alt:`Attachment ${t+1}`,className:"w-full h-32 object-cover",onError:e=>{e.target.src="/images/placeholder-image.png"}})},t)})})]})]}),I.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:I.jsxs("div",{className:"flex justify-end space-x-3",children:[I.jsxs(r,{to:`/staff/incidents/${s.incident_id}`,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:[I.jsx("i",{className:"ri-external-link-line mr-2"}),"View Full Details"]}),I.jsxs("button",{onClick:b,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[I.jsx("i",{className:"ri-close-line mr-2"}),"Close"]})]})})]})})]})},Lb=()=>{const{id:e}=u(),t=a(),[s,r]=n.useState(null),[i,l]=n.useState(!0),[o,d]=n.useState(null),[c,m]=n.useState(""),[h,x]=n.useState(!1),g=D(),f=g.userData?.id||g.userData?.staff_id||g.userData?.user_id;n.useEffect(()=>{e&&f&&p()},[e,f]);const p=async()=>{try{l(!0);const t=await Re(Number(e));if(t.success&&t.incident){const e=t.incident,s=e.assigned_staff_id===f,a=g.userData?.assigned_team_id;let n=!1;if(a&&(e.assigned_team_id===a&&(n=!0),e.assigned_team_ids)){e.assigned_team_ids.split(",").map(e=>Number(e.trim())).includes(a)&&(n=!0)}if(!s&&!n)return void d("You do not have permission to view this incident");r(e),e.latitude&&e.longitude&&b(e.latitude,e.longitude)}else d("Incident not found")}catch(t){d("Failed to load incident details")}finally{l(!1)}},b=async(e,t)=>{const s=Number(e),r=Number(t);if(s&&r){x(!0);try{const e=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${r}&zoom=16&addressdetails=1`);if(e.ok){const t=await e.json();if(t.display_name){const e=t.display_name.split(", ").slice(0,3).join(", ");m(e)}}}catch(a){m(`${s.toFixed(4)}, ${r.toFixed(4)}`)}finally{x(!1)}}},y=e=>"individual"===e.assignment_type?I.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800 border border-blue-200",children:"Individual"}):"team"===e.assignment_type?I.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800 border border-purple-200",children:"Team"}):null;return i?I.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o||!s?I.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:I.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:I.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:I.jsxs("div",{className:"text-center",children:[I.jsx("i",{className:"ri-error-warning-line mx-auto text-5xl text-red-500 mb-4"}),I.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Error"}),I.jsx("p",{className:"mt-1 text-sm text-gray-500",children:o||"Incident not found"}),I.jsx("div",{className:"mt-6",children:I.jsxs("button",{onClick:()=>t("/staff/incidents"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[I.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back to My Incidents"]})})]})})})}):I.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:I.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[I.jsx("div",{className:"mb-6",children:I.jsxs("button",{onClick:()=>t("/staff/incidents"),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[I.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back to My Incidents"]})}),I.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[I.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Incident #",s.incident_id]}),I.jsxs("div",{className:"flex space-x-2",children:[I.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"in_progress":return"bg-blue-100 text-blue-800 border-blue-200";case"resolved":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(s.status)}`,children:s.status.replace("_"," ").toUpperCase()}),I.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(e=>{switch(e){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"moderate":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(s.priority_level)}`,children:s.priority_level.toUpperCase()}),y(s)]})]})}),I.jsxs("div",{className:"px-6 py-6",children:[I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Incident Information"}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("p",{children:[I.jsx("strong",{children:"Type:"})," ",s.incident_type]}),I.jsxs("p",{children:[I.jsx("strong",{children:"Priority:"})," ",s.priority_level]}),I.jsxs("p",{children:[I.jsx("strong",{children:"Status:"})," ",s.status]}),I.jsxs("p",{children:[I.jsx("strong",{children:"Validation:"})," ",s.validation_status]}),I.jsxs("p",{children:[I.jsx("strong",{children:"Reporter Safety:"})," ",s.reporter_safe_status]})]})]}),I.jsxs("div",{children:[I.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-2 flex items-center",children:[I.jsx("i",{className:"ri-map-pin-line mr-2"}),"Location"]}),I.jsx("div",{className:"text-sm text-gray-600",children:h?I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-blue-600 mr-2"}),I.jsx("span",{children:"Loading location..."})]}):I.jsx("p",{children:c||`${Number(s.latitude).toFixed(4)}, ${Number(s.longitude).toFixed(4)}`})})]}),I.jsxs("div",{children:[I.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-2 flex items-center",children:[I.jsx("i",{className:"ri-time-line mr-2"}),"Reported"]}),I.jsx("p",{className:"text-sm text-gray-600",children:new Date(s.date_reported).toLocaleString()})]})]}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Assignment Information"}),I.jsxs("div",{className:"space-y-2",children:[s.assigned_team_name&&I.jsxs("p",{children:[I.jsx("strong",{children:"Assigned Team:"})," ",s.assigned_team_name]}),s.assigned_staff_name&&I.jsxs("p",{children:[I.jsx("strong",{children:"Assigned Staff:"})," ",s.assigned_staff_name]}),s.reporter_name&&I.jsxs("p",{children:[I.jsx("strong",{children:"Reported By:"})," ",s.reporter_name]})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"text-md font-medium text-gray-900 mb-2",children:"Assignment Type"}),I.jsxs("div",{className:"flex items-center space-x-2",children:[y(s),I.jsx("span",{className:"text-sm text-gray-600",children:"individual"===s.assignment_type?"Directly assigned to you":"team"===s.assignment_type?"Assigned to your team":"Assignment type unknown"})]})]})]})]}),I.jsxs("div",{className:"mt-6",children:[I.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Description"}),I.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:I.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:s.description})})]})]})]})]})})},Eb=()=>{const[e,t]=n.useState(null),[s,r]=n.useState(null),[a,i]=n.useState({totalAssigned:0,pending:0,inProgress:0,resolved:0,resolvedToday:0}),[l,o]=n.useState(!0),[d,c]=n.useState(null),[u,m]=n.useState(!1),[h,x]=n.useState({name:"",email:"",phone:"",position:"",department:"",availability:""}),[g,f]=n.useState(!1),[p,b]=n.useState(!1),[y,v]=n.useState(!1),[j,N]=n.useState(""),[w,S]=n.useState(0),[k,C]=n.useState(!1),[$,_]=n.useState(!1),[A,P]=n.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[L,E]=n.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[T,O]=n.useState(!0),[F,R]=n.useState(!1),[M,B]=n.useState(!1),U=D(),q=U.userData?.id||U.userData?.staff_id||U.userData?.user_id,z=e=>{const t=[e.name,e.email,e.phone,e.position,e.department,e.availability],s=t.filter(e=>e&&""!==e.trim()).length;return Math.round(s/t.length*100)};n.useEffect(()=>{if(e&&u){const t=h.name!==e.name||h.email!==e.email||h.phone!==e.phone||h.position!==e.position||h.department!==e.department||h.availability!==e.availability;b(t)}},[h,e,u]),n.useEffect(()=>{const e=e=>{p&&(e.preventDefault(),e.returnValue="")};return p&&window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[p]),n.useEffect(()=>{q&&W()},[q]),n.useEffect(()=>{if(y){const e=setTimeout(()=>{v(!1)},5e3);return()=>clearTimeout(e)}},[y]);const W=async()=>{try{o(!0),c(null);const s=await ce(Number(q));if(s.success&&s.staff){const a={...s.staff,availability:s.staff.availability&&""!==s.staff.availability.trim()?s.staff.availability:"available"};if(t(a),S(z(a)),s.staff.team_id)try{const e=await Ie(s.staff.team_id);e.success&&e.team&&r(e.team)}catch(e){}await V()}else c("Failed to load profile data")}catch(s){c("Failed to load profile data")}finally{o(!1)}},V=async()=>{try{const e=await Fe(Number(q));if(e.success&&e.incidents){const t=e.incidents,s=(new Date).toDateString();i({totalAssigned:t.length,pending:t.filter(e=>"pending"===e.status).length,inProgress:t.filter(e=>"in_progress"===e.status).length,resolved:t.filter(e=>"resolved"===e.status||"closed"===e.status).length,resolvedToday:t.filter(e=>("resolved"===e.status||"closed"===e.status)&&new Date(e.date_reported).toDateString()===s).length})}}catch(e){}},H=()=>{x({name:e?.name||"",email:e?.email||"",phone:e?.phone||"",position:e?.position||"",department:e?.department||"",availability:e?.availability||"available"}),m(!0)},G=(e,t)=>{x(s=>({...s,[e]:t}))},J=(e,t)=>{P(s=>({...s,[e]:t})),L[e]&&E(t=>({...t,[e]:""}))},K=()=>{C(!1),P({currentPassword:"",newPassword:"",confirmPassword:""}),E({currentPassword:"",newPassword:"",confirmPassword:""})};return l?I.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:I.jsx("div",{className:"w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:I.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[I.jsx("div",{className:"lg:col-span-2 space-y-6",children:I.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:I.jsxs("div",{className:"animate-pulse",children:[I.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsx("div",{className:"h-4 bg-gray-200 rounded"}),I.jsx("div",{className:"h-4 bg-gray-200 rounded"}),I.jsx("div",{className:"h-4 bg-gray-200 rounded"}),I.jsx("div",{className:"h-4 bg-gray-200 rounded"})]})]})})}),I.jsx("div",{className:"space-y-6",children:I.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:I.jsxs("div",{className:"animate-pulse",children:[I.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/2 mb-4"}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("div",{className:"h-4 bg-gray-200 rounded"}),I.jsx("div",{className:"h-4 bg-gray-200 rounded"})]})]})})})]})})}):d?I.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:I.jsx("i",{className:"ri-error-warning-line text-2xl text-red-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Profile"}),I.jsx("p",{className:"text-gray-600",children:d})]})}):e?I.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50",children:[I.jsx("div",{className:"container mx-auto px-4 py-8",children:I.jsxs("div",{className:"max-w-5xl mx-auto",children:[y&&I.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-xl shadow-sm animate-in slide-in-from-top-2 duration-300",children:I.jsxs("div",{className:"flex items-center gap-3 text-green-800",children:[I.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-check-circle-line text-green-600"})}),I.jsx("span",{className:"font-medium",children:j})]})}),I.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[I.jsx("div",{className:"lg:col-span-1",children:I.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 sticky top-8",children:[I.jsxs("div",{className:"text-center mb-6",children:[I.jsx("div",{className:"mb-4",children:I.jsx(ct,{name:e?.name,email:e?.email,size:"xl",className:"mx-auto"})}),I.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:e?.name||"User Profile"}),I.jsx("p",{className:"text-gray-600 mb-4",children:e?.email||"No email provided"}),!u&&I.jsxs(lt,{variant:"primary",size:"md",onClick:H,fullWidth:!0,children:[I.jsx("i",{className:"ri-edit-line mr-2"}),"Edit Profile"]})]}),I.jsxs("div",{className:"mb-6",children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Profile Completion"}),I.jsxs("span",{className:"text-sm text-gray-600",children:[w,"%"]})]}),I.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:I.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-300",style:{width:`${w}%`}})})]}),I.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:I.jsxs(lt,{variant:"outline",size:"md",onClick:()=>{R(!0)},fullWidth:!0,children:[I.jsx("i",{className:"ri-logout-box-line mr-2"}),"Sign Out"]})})]})}),I.jsx("div",{className:"lg:col-span-2",children:I.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[I.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 px-8 py-6",children:I.jsxs("div",{className:"flex justify-between items-center",children:[I.jsxs("div",{children:[I.jsx("h2",{className:"text-2xl font-bold text-white",children:"Personal Information"}),I.jsx("p",{className:"text-blue-100 mt-1",children:"Keep your information up to date"})]}),u&&I.jsxs("div",{className:"flex items-center gap-2 text-blue-100",children:[I.jsx("i",{className:"ri-edit-line"}),I.jsx("span",{className:"text-sm font-medium",children:"Editing Mode"})]})]})}),I.jsx("div",{className:"p-8",children:I.jsxs("form",{onSubmit:async()=>{try{if(f(!0),c(null),!h.name.trim())return void c("Name is required");if(!h.email.trim())return void c("Email is required");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h.email))return void c("Please enter a valid email address");if(!(e=>{if(!e)return!1;if(e.startsWith("+63")){const t=e.replace(/\D/g,"");return/^639\d{9}$/.test(t)}if(e.startsWith("09")){const t=e.replace(/\D/g,"");return/^09\d{9}$/.test(t)}const t=e.replace(/\D/g,"");return t.startsWith("639")&&12===t.length?/^639\d{9}$/.test(t):!(!t.startsWith("9")||10!==t.length)&&/^9\d{9}$/.test(t)})(h.phone))return void c("Please enter a valid Philippine mobile number (e.g., 09123456789 or +639123456789)");const s={name:h.name.trim(),email:h.email.trim(),phone:h.phone.trim(),position:h.position.trim(),department:h.department.trim()};if(!(await ue(Number(q),s)).success)return void c("Failed to update profile");if(h.availability!==e?.availability){if(!(await me(Number(q),h.availability)).success)return void c("Profile updated but failed to update availability status")}const r={...e,...s,availability:h.availability};t(r),S(z(r)),m(!1),b(!1),N("Profile updated successfully!"),v(!0),await W()}catch(s){c("Failed to update profile")}finally{f(!1)}},className:"space-y-8",children:[I.jsxs("div",{children:[I.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[I.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-blue-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Basic Information"})]}),!u&&I.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),I.jsx("p",{className:"text-gray-900 font-medium",children:e?.name?.split(" ")[0]||"Not provided"})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),I.jsx("p",{className:"text-gray-900 font-medium",children:e?.name?.split(" ").slice(1).join(" ")||"Not provided"})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Position"}),I.jsx("p",{className:"text-gray-900 font-medium",children:e?.position||"Not provided"})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),I.jsx("p",{className:"text-gray-900 font-medium",children:e?.department||"Not provided"})]})]}),u&&I.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[I.jsx(pt,{label:"First Name",type:"text",name:"firstName",id:"firstName",value:h.name.split(" ")[0]||"",onChange:e=>{const t=h.name.split(" ").slice(1).join(" ")||"",s=e.target.value+(t?" "+t:"");G("name",s)},error:"",placeholder:"Enter your first name",required:!0,disabled:!u,icon:I.jsx("i",{className:"ri-user-line"})}),I.jsx(pt,{label:"Last Name",type:"text",name:"lastName",id:"lastName",value:h.name.split(" ").slice(1).join(" ")||"",onChange:e=>{const t=(h.name.split(" ")[0]||"")+(e.target.value?" "+e.target.value:"");G("name",t)},error:"",placeholder:"Enter your last name",required:!0,disabled:!u,icon:I.jsx("i",{className:"ri-user-line"})}),I.jsx(pt,{label:"Position",type:"text",name:"position",id:"position",value:h.position,onChange:e=>G("position",e.target.value),error:"",placeholder:"Enter your position",required:!0,disabled:!u,icon:I.jsx("i",{className:"ri-briefcase-line"})}),I.jsx(pt,{label:"Department",type:"text",name:"department",id:"department",value:h.department,onChange:e=>G("department",e.target.value),error:"",placeholder:"Enter your department",required:!0,disabled:!u,icon:I.jsx("i",{className:"ri-building-line"})})]})]}),I.jsxs("div",{className:"border-t border-gray-100 pt-8",children:[I.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[I.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-phone-line text-green-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Contact Information"})]}),!u&&I.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),I.jsx("p",{className:"text-gray-900 font-medium",children:e?.email||"Not provided"})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),I.jsx("p",{className:"text-gray-900 font-medium",children:yl(e?.phone)||"Not provided"})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Availability"}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("i",{className:`${(e=>{switch(e){case"available":return"ri-check-circle-line";case"busy":return"ri-time-line";case"off-duty":return"ri-moon-line";default:return"ri-question-line"}})(e?.availability||"available")} text-lg`}),I.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(e=>{switch(e){case"available":return"bg-green-100 text-green-800 border-green-200";case"busy":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e?.availability||"available")}`,children:e?.availability||"Not set"})]})]})]}),u&&I.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[I.jsx(pt,{label:"Email Address",type:"email",name:"email",id:"email",value:h.email,onChange:e=>G("email",e.target.value),error:"",placeholder:"Enter your email",required:!0,disabled:!u,icon:I.jsx("i",{className:"ri-mail-line"})}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),I.jsx(bl,{international:!0,defaultCountry:"PH",value:h.phone,onChange:e=>G("phone",e||""),className:"w-full pl-10 pr-4 py-4 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all border-gray-300",inputClassName:"w-full py-4 px-4 border-0 focus:ring-0 focus:outline-none bg-transparent text-gray-900 placeholder-gray-500",buttonClassName:"px-3 py-4 border-r border-gray-300 bg-gray-50 hover:bg-gray-100",dropdownClassName:"bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",inputProps:{required:!0},placeholder:"Enter your phone number",disabled:!u})]}),I.jsx(jl,{label:"Availability",name:"availability",id:"availability",value:h.availability,onChange:e=>G("availability",e.target.value),error:"",required:!0,disabled:!u,options:[{value:"available",label:"Available"},{value:"busy",label:"Busy"},{value:"off-duty",label:"Off Duty"}]})]})]}),I.jsxs("div",{className:"border-t border-gray-100 pt-8",children:[I.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[I.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-lock-line text-red-600"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Security"})]}),I.jsx("div",{className:"bg-gray-50 rounded-lg p-6",children:I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-gray-900",children:"Change Password"}),I.jsx("p",{className:"text-sm text-gray-600",children:"Update your password to keep your account secure"})]}),I.jsxs(lt,{type:"button",variant:"outline",size:"md",onClick:()=>C(!0),className:"border-red-200 text-red-600 hover:bg-red-50",children:[I.jsx("i",{className:"ri-key-line mr-2"}),"Change Password"]})]})})]}),u&&I.jsx("div",{className:"border-t border-gray-100 pt-8",children:I.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[I.jsx(lt,{type:"submit",variant:"primary",size:"lg",disabled:g,children:g?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Saving Changes..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-save-line mr-2"}),"Save Changes"]})}),I.jsxs(lt,{type:"button",variant:"outline",size:"lg",onClick:()=>{p&&!window.confirm("You have unsaved changes. Are you sure you want to cancel?")||(m(!1),b(!1),x({name:e?.name||"",email:e?.email||"",phone:e?.phone||"",position:e?.position||"",department:e?.department||"",availability:e?.availability||"available"}))},disabled:g,children:[I.jsx("i",{className:"ri-close-line mr-2"}),"Cancel"]})]})})]})})]})})]}),!u&&I.jsx("div",{className:"fixed bottom-6 right-6 lg:hidden",children:I.jsx(lt,{variant:"primary",size:"lg",onClick:H,className:"rounded-full w-14 h-14 shadow-2xl hover:shadow-3xl",children:I.jsx("i",{className:"ri-edit-line text-xl"})})})]})}),I.jsx(Nl,{isOpen:k,onClose:K,title:"Change Password",size:"md",children:I.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),E({currentPassword:"",newPassword:"",confirmPassword:""}),!A.currentPassword)return void E(e=>({...e,currentPassword:"Current password is required"}));const t=(s=A.newPassword).length<8?"Password must be at least 8 characters long":/(?=.*[a-z])/.test(s)?/(?=.*[A-Z])/.test(s)?/(?=.*\d)/.test(s)?"":"Password must contain at least one number":"Password must contain at least one uppercase letter":"Password must contain at least one lowercase letter";var s;if(t)E(e=>({...e,newPassword:t}));else if(A.newPassword===A.confirmPassword)try{_(!0),await new Promise(e=>setTimeout(e,1e3)),N("Password changed successfully!"),v(!0),K()}catch(r){E(e=>({...e,currentPassword:"Failed to change password. Please try again."}))}finally{_(!1)}else E(e=>({...e,confirmPassword:"Passwords do not match"}))},className:"space-y-6",children:[I.jsx("div",{children:I.jsx(pt,{label:"Current Password",type:"password",name:"currentPassword",id:"currentPassword",value:A.currentPassword,onChange:e=>J("currentPassword",e.target.value),error:L.currentPassword,placeholder:"Enter your current password",required:!0,icon:I.jsx("i",{className:"ri-lock-line"})})}),I.jsxs("div",{children:[I.jsx(pt,{label:"New Password",type:"password",name:"newPassword",id:"newPassword",value:A.newPassword,onChange:e=>J("newPassword",e.target.value),error:L.newPassword,placeholder:"Enter your new password",required:!0,icon:I.jsx("i",{className:"ri-key-line"})}),I.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long and contain uppercase, lowercase, and number."})]}),I.jsx("div",{children:I.jsx(pt,{label:"Confirm New Password",type:"password",name:"confirmPassword",id:"confirmPassword",value:A.confirmPassword,onChange:e=>J("confirmPassword",e.target.value),error:L.confirmPassword,placeholder:"Confirm your new password",required:!0,icon:I.jsx("i",{className:"ri-key-line"})})}),I.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[I.jsx(lt,{type:"button",variant:"outline",size:"md",onClick:K,disabled:$,children:"Cancel"}),I.jsx(lt,{type:"submit",variant:"primary",size:"md",disabled:$,children:$?I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Changing..."]}):I.jsxs(I.Fragment,{children:[I.jsx("i",{className:"ri-key-line mr-2"}),"Change Password"]})})]})]})}),I.jsx(ot,{isOpen:F,onClose:()=>{R(!1)},onConfirm:async()=>{try{B(!0),await new Promise(e=>setTimeout(e,1e3)),O(!1),R(!1),window.location.href="/login"}catch(e){R(!1)}finally{B(!1)}},isLoading:M})]}):I.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:I.jsx("i",{className:"ri-user-line text-2xl text-gray-400"})}),I.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Profile Not Found"}),I.jsx("p",{className:"text-gray-600",children:"Unable to load staff profile data."})]})})},Tb=({children:e})=>{const t=a(),s=i(),[r,l]=n.useState(null),[o,d]=n.useState(!1),[u,m]=n.useState(!1),[h,x]=n.useState(!1),[g,f]=n.useState(!1);n.useEffect(()=>{const e=D();e.isAuthenticated?"staff"===e.userType?l(e.userData):t("/"):t("/auth/login")},[t]),n.useEffect(()=>{const e=e=>{"Escape"===e.key&&(o&&d(!1),u&&m(!1))},t=e=>{const t=e.target;u&&!t.closest(".profile-dropdown")&&m(!1)};return o?(document.addEventListener("keydown",e),document.body.style.overflow="hidden"):document.body.style.overflow="unset",u&&(document.addEventListener("keydown",e),document.addEventListener("click",t)),()=>{document.removeEventListener("keydown",e),document.removeEventListener("click",t),document.body.style.overflow="unset"}},[o,u]);const p=()=>{d(!1)},b=()=>{m(!1)},y=e=>{b(),p(),t(e)},v=()=>{x(!0),b(),p()},j=e=>s.pathname===e||s.pathname.startsWith(e+"/");return r?I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"min-h-screen bg-gray-50",children:[I.jsx("header",{className:"bg-white/95 backdrop-blur-sm shadow-lg border-b border-gray-200 sticky top-0 z-50 transition-all duration-200",children:I.jsx("div",{className:"container mx-auto px-4",children:I.jsxs("div",{className:"flex items-center justify-between h-16",children:[I.jsxs("div",{className:"flex items-center",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center shadow-md",children:I.jsx("i",{className:"ri-shield-check-line text-xl text-white"})}),I.jsxs("div",{className:"ml-3",children:[I.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Staff Portal"}),I.jsx("span",{className:"block text-sm text-gray-600",children:"Emergency Response Management"})]})]}),I.jsxs("div",{className:"hidden md:flex items-center space-x-6",children:[I.jsx("button",{onClick:()=>y("/staff"),className:"px-3 py-2 rounded-md text-sm font-medium transition-colors "+(j("/staff")&&!j("/staff/incidents")?"bg-blue-100 text-blue-700":"text-gray-700 hover:text-blue-600 hover:bg-blue-50"),children:"Home"}),I.jsx("button",{onClick:()=>y("/staff/incidents"),className:"px-3 py-2 rounded-md text-sm font-medium transition-colors "+(j("/staff/incidents")&&!j("/staff/incidents/map")?"bg-blue-100 text-blue-700":"text-gray-700 hover:text-blue-600 hover:bg-blue-50"),children:"Incident Assigned"}),I.jsx("button",{onClick:()=>y("/staff/incidents/map"),className:"px-3 py-2 rounded-md text-sm font-medium transition-colors "+(j("/staff/incidents/map")?"bg-blue-100 text-blue-700":"text-gray-700 hover:text-blue-600 hover:bg-blue-50"),children:"Map View"})]}),I.jsx("div",{className:"hidden md:flex items-center space-x-4",children:I.jsxs("div",{className:"relative profile-dropdown",children:[I.jsxs("button",{onClick:()=>{m(!u),d(!1)},className:"flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 font-medium focus:outline-none group",children:[I.jsx("div",{className:"w-9 h-9 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center shadow-sm",children:I.jsx("span",{className:"text-white font-semibold text-sm",children:r.name?.charAt(0)?.toUpperCase()||r.email?.charAt(0)?.toUpperCase()||"S"})}),I.jsxs("div",{className:"hidden lg:block text-left",children:[I.jsx("p",{className:"text-sm font-medium text-gray-900 group-hover:text-blue-600",children:r.name||r.email?.split("@")[0]||"Staff Member"}),I.jsx("p",{className:"text-xs text-gray-500 truncate max-w-32",title:r?.email||"No email",children:r?.email||"No email"})]}),I.jsx("i",{className:`ri-arrow-down-s-line ml-1 transition-transform duration-200 ${u?"rotate-180":""} group-hover:text-blue-600`})]}),u&&I.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white border border-gray-200 rounded-lg shadow-xl z-50 animate-in fade-in slide-in-from-top-2 duration-200",children:[I.jsx("div",{className:"px-4 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-200 rounded-t-lg",children:I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center shadow-md",children:I.jsx("span",{className:"text-white font-semibold text-lg",children:r.name?.charAt(0)?.toUpperCase()||r.email?.charAt(0)?.toUpperCase()||"S"})}),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsx("p",{className:"font-semibold text-gray-900 text-sm truncate",children:r.name||r.email?.split("@")[0]||"Staff Member"}),I.jsx("p",{className:"text-gray-600 text-xs truncate",title:r?.email||"No email",children:r?.email||"No email provided"}),I.jsx("p",{className:"text-gray-500 text-xs",children:r.position||"Staff Member"}),I.jsxs("div",{className:"flex items-center mt-1",children:[I.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-1"}),I.jsx("span",{className:"text-xs text-gray-500",children:"Online"})]})]})]})}),I.jsxs("div",{className:"py-2",children:[I.jsxs("button",{onClick:()=>y("/staff/profile"),className:"flex items-center w-full text-left px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group",children:[I.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-blue-100 transition-colors",children:I.jsx("i",{className:"ri-user-settings-line text-gray-600 group-hover:text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"font-medium text-sm",children:"Account Settings"}),I.jsx("p",{className:"text-xs text-gray-500",children:"Manage your profile"})]})]}),I.jsxs("button",{onClick:()=>y("/staff/feedback"),className:"flex items-center w-full text-left px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group",children:[I.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-blue-100 transition-colors",children:I.jsx("i",{className:"ri-feedback-line text-gray-600 group-hover:text-blue-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"font-medium text-sm",children:"Submit Feedback"}),I.jsx("p",{className:"text-xs text-gray-500",children:"Help us improve the app"})]})]}),I.jsx("div",{className:"border-t border-gray-100 my-1"}),I.jsxs("button",{onClick:v,className:"flex items-center w-full text-left px-4 py-3 text-gray-700 hover:bg-red-50 hover:text-red-600 transition-all duration-200 group",children:[I.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-red-100 transition-colors",children:I.jsx("i",{className:"ri-logout-box-line text-gray-600 group-hover:text-red-600"})}),I.jsxs("div",{children:[I.jsx("p",{className:"font-medium text-sm",children:"Sign Out"}),I.jsx("p",{className:"text-xs text-gray-500",children:"Logout from your account"})]})]})]})]})]})}),I.jsx("button",{className:"md:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors focus:outline-none",onClick:()=>{d(!o),m(!1)},"aria-label":"Toggle mobile menu",children:I.jsx("i",{className:`ri-${o?"close":"menu"}-line text-xl text-gray-700`})})]})})}),o&&I.jsxs("div",{className:"fixed inset-0 z-40 md:hidden",children:[I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:p}),I.jsx("div",{className:"fixed top-16 left-0 right-0 bg-white shadow-xl border-t border-gray-200 max-h-[calc(100vh-4rem)] overflow-y-auto",children:I.jsxs("div",{className:"px-4 py-6 space-y-2",children:[I.jsxs("button",{onClick:()=>y("/staff"),className:"flex items-center w-full px-4 py-3 rounded-lg transition-all duration-200 font-medium "+(j("/staff")&&!j("/staff/incidents")?"bg-blue-100 text-blue-700":"text-gray-700 hover:text-blue-600 hover:bg-blue-50"),children:[I.jsx("i",{className:"ri-dashboard-line text-lg mr-3"}),"Dashboard"]}),I.jsxs("button",{onClick:()=>y("/staff/incidents"),className:"flex items-center w-full px-4 py-3 rounded-lg transition-all duration-200 font-medium "+(j("/staff/incidents")&&!j("/staff/incidents/map")?"bg-blue-100 text-blue-700":"text-gray-700 hover:text-blue-600 hover:bg-blue-50"),children:[I.jsx("i",{className:"ri-error-warning-line text-lg mr-3"}),"Incident Assigned"]}),I.jsxs("button",{onClick:()=>y("/staff/incidents/map"),className:"flex items-center w-full px-4 py-3 rounded-lg transition-all duration-200 font-medium "+(j("/staff/incidents/map")?"bg-blue-100 text-blue-700":"text-gray-700 hover:text-blue-600 hover:bg-blue-50"),children:[I.jsx("i",{className:"ri-map-pin-line text-lg mr-3"}),"Map View"]}),I.jsx("div",{className:"border-t border-gray-200 my-4"}),I.jsx("div",{className:"px-4 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100",children:I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center shadow-md",children:I.jsx("span",{className:"text-white font-semibold text-lg",children:r.name?.charAt(0)?.toUpperCase()||r.email?.charAt(0)?.toUpperCase()||"S"})}),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsx("p",{className:"font-semibold text-gray-900 text-base truncate",children:r.name||r.email?.split("@")[0]||"Staff Member"}),I.jsx("p",{className:"text-gray-600 text-sm truncate",title:r?.email||"No email",children:r?.email||"No email provided"}),I.jsx("p",{className:"text-gray-500 text-xs",children:r.position||"Staff Member"}),I.jsxs("div",{className:"flex items-center mt-1",children:[I.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-1"}),I.jsx("span",{className:"text-xs text-gray-500",children:"Online"})]})]})]})}),I.jsxs("button",{onClick:()=>y("/staff/profile"),className:"flex items-center w-full px-4 py-3 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 group",children:[I.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-blue-100 transition-colors",children:I.jsx("i",{className:"ri-settings-line text-gray-600 group-hover:text-blue-600"})}),I.jsxs("div",{className:"text-left",children:[I.jsx("p",{className:"font-medium text-sm",children:"Account Settings"}),I.jsx("p",{className:"text-xs text-gray-500",children:"Manage your profile"})]})]}),I.jsxs("button",{onClick:v,className:"flex items-center w-full px-4 py-3 rounded-lg text-gray-700 hover:text-red-600 hover:bg-red-50 transition-all duration-200 group",children:[I.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-red-100 transition-colors",children:I.jsx("i",{className:"ri-logout-box-line text-gray-600 group-hover:text-red-600"})}),I.jsxs("div",{className:"text-left",children:[I.jsx("p",{className:"font-medium text-sm",children:"Sign Out"}),I.jsx("p",{className:"text-xs text-gray-500",children:"Logout from your account"})]})]})]})})]}),I.jsx("div",{className:"pt-4",children:I.jsx("main",{className:"max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e||I.jsx(c,{})})})]}),I.jsx(ot,{isOpen:h,onClose:()=>{x(!1)},onConfirm:async()=>{f(!0);try{await Q(),M(),t("/")}catch(e){M(),t("/")}finally{f(!1),x(!1)}},isLoading:g})]}):I.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:I.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})};const Ib=new class{cache={};pendingRequests={};rateLimitDelay=100;lastRequestTime=0;CACHE_DURATION=864e5;MAX_BATCH_SIZE=5;BATCH_DELAY=200;constructor(){this.loadCacheFromStorage()}loadCacheFromStorage(){try{const e=localStorage.getItem("geocoding_cache");e&&(this.cache=JSON.parse(e),this.cleanExpiredCache())}catch(e){this.cache={}}}saveCacheToStorage(){try{localStorage.setItem("geocoding_cache",JSON.stringify(this.cache))}catch(e){}}cleanExpiredCache(){const e=Date.now();let t=!1;Object.keys(this.cache).forEach(s=>{this.cache[s].expiresAt<e&&(delete this.cache[s],t=!0)}),t&&this.saveCacheToStorage()}generateCacheKey(e,t){return`${e.toFixed(4)},${t.toFixed(4)}`}async makeGeocodingRequest(e,t){const s=Date.now();s-this.lastRequestTime<this.rateLimitDelay&&await new Promise(e=>setTimeout(e,this.rateLimitDelay-(s-this.lastRequestTime))),this.lastRequestTime=Date.now();try{const s=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${t}&zoom=16&addressdetails=1`,{headers:{"User-Agent":"PROTEQ-MDRRMO/1.0"}});if(!s.ok)throw new Error(`Geocoding API error: ${s.status}`);const r=await s.json();let a="";if(r.display_name){a=r.display_name.split(", ").slice(0,3).join(", ")}else if(r.address){const e=r.address;a=e.road&&e.city?`${e.road}, ${e.city}`:e.city?e.city:e.town?e.town:e.village?e.village:"Unknown Location"}else a="Unknown Location";return a}catch(r){throw r}}async processBatch(e){const t=e.map(async e=>{try{const t=await this.makeGeocodingRequest(e.lat,e.lng);e.resolve(t)}catch(t){e.reject(t instanceof Error?t:new Error("Geocoding failed"))}});await Promise.allSettled(t),Object.keys(this.pendingRequests).length>0&&await new Promise(e=>setTimeout(e,this.BATCH_DELAY))}async getLocationName(e,t){const s=this.generateCacheKey(e,t),r=Date.now(),a=this.cache[s];return a&&a.expiresAt>r?a.locationName:this.pendingRequests[s]?new Promise((r,a)=>{this.pendingRequests[s].push({lat:e,lng:t,resolve:r,reject:a})}):new Promise(async(a,n)=>{this.pendingRequests[s]=[{lat:e,lng:t,resolve:a,reject:n}];try{const a=await this.makeGeocodingRequest(e,t);this.cache[s]={locationName:a,timestamp:r,expiresAt:r+this.CACHE_DURATION},this.saveCacheToStorage();const n=this.pendingRequests[s];delete this.pendingRequests[s],n.forEach(e=>e.resolve(a))}catch(i){const r=this.pendingRequests[s];delete this.pendingRequests[s],r.forEach(e=>e.reject(i instanceof Error?i:new Error("Geocoding failed")));a(`${e.toFixed(4)}, ${t.toFixed(4)}`)}})}async getLocationNamesBatch(e){const t=[];for(let s=0;s<e.length;s+=this.MAX_BATCH_SIZE){const r=e.slice(s,s+this.MAX_BATCH_SIZE).map(e=>this.getLocationName(e.lat,e.lng)),a=(await Promise.allSettled(r)).map(e=>"fulfilled"===e.status?e.value:"Unknown Location");t.push(...a),s+this.MAX_BATCH_SIZE<e.length&&await new Promise(e=>setTimeout(e,this.BATCH_DELAY))}return t}clearCache(){this.cache={},localStorage.removeItem("geocoding_cache")}getCacheStats(){const e=Date.now();let t=0,s=0;return Object.values(this.cache).forEach(r=>{r.expiresAt<e?t++:s++}),{total:t+s,expired:t,valid:s}}},Ob=()=>{const[e,t]=n.useState([]),[s,a]=n.useState(null),[i,l]=n.useState(!1),[o,d]=n.useState({}),[c,u]=n.useState({}),[m,h]=n.useState(null);n.useEffect(()=>{x()},[]);const x=async()=>{try{h(null);const e=await Oe();if(e.success&&e.incidents){const s=await Promise.all(e.incidents.map(async e=>{try{const t=await g(e.latitude,e.longitude);return{...e,resolvedLocation:t}}catch(t){return{...e,resolvedLocation:`${Number(e.latitude).toFixed(4)}, ${Number(e.longitude).toFixed(4)}`}}}));t(s)}else t([])}catch(e){h("An error occurred while loading incidents. Please try again later."),t([])}},g=async(e,t)=>{const s=Number(e),r=Number(t);try{return await Ib.getLocationName(s,r)}catch(a){return`${s.toFixed(4)}, ${r.toFixed(4)}`}},f=()=>{l(!1),a(null)};return m?I.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:I.jsxs("div",{className:"text-center",children:[I.jsxs("div",{className:"bg-red-100 text-red-800 p-4 rounded-lg max-w-md",children:[I.jsx("i",{className:"ri-error-warning-line text-2xl mb-2"}),I.jsx("p",{className:"font-semibold",children:"Error Loading Incidents"}),I.jsx("p",{className:"text-sm mt-1",children:m})]}),I.jsxs("button",{onClick:x,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[I.jsx("i",{className:"ri-refresh-line mr-2"}),"Try Again"]})]})}):I.jsxs("div",{className:"min-h-screen bg-gray-50",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Incident Map"}),I.jsx("p",{className:"text-gray-600 mt-1",children:"View all incidents across the system on the interactive map"})]}),I.jsx("div",{className:"flex items-center space-x-3"})]}),I.jsx("div",{className:"",children:I.jsx("div",{className:"",children:I.jsx("div",{className:"p-6",children:I.jsx(Ab,{incidents:e,onIncidentClick:e=>{a(e),l(!0)},height:"calc(100vh - 220px)",showUserLocation:!1})})})}),i&&s&&I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:I.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl",children:[I.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 text-white",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-10 h-10 bg-white bg-opacity-20 rounded-lg flex items-center justify-center",children:I.jsx("i",{className:"ri-alert-line text-xl"})}),I.jsxs("div",{children:[I.jsxs("h2",{className:"text-xl font-bold",children:["Incident #",s.incident_id]}),I.jsx("p",{className:"text-blue-100 text-sm",children:s.incident_type})]})]}),I.jsx("button",{onClick:f,className:"text-white hover:text-blue-100 transition-colors p-2 rounded-lg hover:bg-white hover:bg-opacity-20",children:I.jsx("i",{className:"ri-close-line text-xl"})})]})}),I.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:[I.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-file-text-line text-blue-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Description"})]}),I.jsx("p",{className:"text-gray-700 leading-relaxed",children:s.description})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-map-pin-line text-red-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Location"})]}),I.jsx("p",{className:"text-gray-700 mb-2",children:s.resolvedLocation||s.location}),s.resolvedLocation&&s.resolvedLocation!==s.location&&I.jsxs("p",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:["Coordinates: ",Number(s.latitude).toFixed(4),", ",Number(s.longitude).toFixed(4)]})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-team-line text-green-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Assignment"})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[s.assigned_team_name&&I.jsxs("div",{className:"flex items-center space-x-1",children:[I.jsx("i",{className:"ri-team-line text-gray-400"}),I.jsx("span",{className:"text-sm text-gray-700",children:s.assigned_team_name})]}),s.assigned_staff_name&&I.jsxs("div",{className:"flex items-center space-x-1",children:[I.jsx("i",{className:"ri-user-line text-gray-400"}),I.jsx("span",{className:"text-sm text-gray-700",children:s.assigned_staff_name})]}),!s.assigned_team_name&&!s.assigned_staff_name&&I.jsx("span",{className:"text-sm text-gray-500 italic",children:"Not assigned"})]})]})]}),I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-flag-line text-orange-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Priority"})]}),I.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full border ${(e=>{switch(e){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"moderate":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(s.priority_level)}`,children:s.priority_level.charAt(0).toUpperCase()+s.priority_level.slice(1)})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-time-line text-purple-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Status"})]}),I.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full border ${(e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"in_progress":return"bg-blue-100 text-blue-800 border-blue-200";case"resolved":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(s.status)}`,children:s.status.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())})]})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-shield-check-line text-indigo-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Validation"})]}),I.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full border ${(e=>{switch(e){case"validated":return"bg-green-100 text-green-800 border-green-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(s.validation_status||"unvalidated")}`,children:(s.validation_status||"unvalidated").charAt(0).toUpperCase()+(s.validation_status||"unvalidated").slice(1)})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-user-line text-indigo-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Reporter"})]}),"guest"===s.reporter_type?I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-indigo-600 text-sm"})}),I.jsxs("div",{children:[I.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.guest_name||"Unknown Guest"}),I.jsx("div",{className:"text-xs text-gray-500",children:"Guest Reporter"})]})]}),I.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3 pt-3 border-t border-gray-200",children:[I.jsxs("div",{children:[I.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Guest ID"}),I.jsx("div",{className:"text-sm text-gray-900",children:s.guest_id||"N/A"})]}),I.jsxs("div",{className:"col-span-2",children:[I.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Contact"}),I.jsx("div",{className:"text-sm text-gray-900",children:s.guest_contact||"N/A"})]})]})]}):I.jsxs("div",{className:"space-y-1",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center",children:I.jsx("i",{className:"ri-user-line text-indigo-600 text-sm"})}),I.jsx("div",{className:"text-gray-700 font-medium",children:s.reporter_name})]}),s.reporter_phone&&I.jsxs("div",{className:"text-sm text-gray-500 pl-10",children:["📞 ",s.reporter_phone]})]})]}),I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[I.jsx("i",{className:"ri-calendar-line text-gray-600"}),I.jsx("h3",{className:"font-semibold text-gray-900",children:"Timeline"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Reported:"}),I.jsx("span",{className:"text-sm font-medium text-gray-900",children:new Date(s.date_reported).toLocaleDateString()})]}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Time:"}),I.jsx("span",{className:"text-sm font-medium text-gray-900",children:new Date(s.date_reported).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),s.date_resolved&&I.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-200",children:[I.jsx("span",{className:"text-sm text-gray-600",children:"Resolved:"}),I.jsx("span",{className:"text-sm font-medium text-green-600",children:new Date(s.date_resolved).toLocaleDateString()})]})]})]})]})]}),s.attachment&&I.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-6",children:[I.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Attachments"}),I.jsx("div",{className:"grid grid-cols-3 gap-4",children:s.attachment.split(",").map((e,t)=>{const s=`/uploads/incidents/${e.trim()}`;return I.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"block border border-gray-300 rounded-lg overflow-hidden hover:shadow-lg transition-shadow",children:I.jsx("img",{src:s,alt:`Attachment ${t+1}`,className:"w-full h-32 object-cover",onError:e=>{e.target.src="/images/placeholder-image.png"}})},t)})})]})]}),I.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:I.jsxs("div",{className:"flex justify-end space-x-3",children:[I.jsxs(r,{to:`/admin/incidents/view/${s.incident_id}`,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:[I.jsx("i",{className:"ri-external-link-line mr-2"}),"View Full Details"]}),I.jsxs("button",{onClick:f,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[I.jsx("i",{className:"ri-close-line mr-2"}),"Close"]})]})})]})})]})},Fb=[{path:"/",element:I.jsx(ft,{})},{path:"/auth/login",element:I.jsx(vt,{})},{path:"/auth/signup",element:I.jsx(jt,{})},{path:"/auth/forgot-password",element:I.jsx(Nt,{})},{path:"/auth/verify-otp",element:I.jsx(wt,{})},{path:"/auth/reset-password",element:I.jsx(St,{})},{path:"/incident-report",element:I.jsx(vl,{})},{path:"/profile",element:I.jsx(kl,{})},{path:"/evacuation-center",element:I.jsx(uo,{})},{path:"/safety-protocols",element:I.jsx(mo,{})},{path:"/history-report",element:I.jsx(wo,{})},{path:"/feedback",element:I.jsx(So,{})},{path:"/welfare-check",element:I.jsx(ko,{})},{path:"/notifications",element:I.jsx(Co,{})},{path:"/sitemap",element:I.jsx(Ro,{})},{path:"/about",element:I.jsx(Do,{})},{path:"/admin/login",element:I.jsx(zo,{})},{path:"/admin/signup",element:I.jsx(Wo,{})},{path:"/admin",element:I.jsx(qo,{}),children:[{path:"dashboard",element:I.jsx(Ex,{})},{path:"alerts",element:I.jsx(Ox,{})},{path:"users",element:I.jsx(Fx,{})},{path:"staff",element:I.jsx(Mx,{})},{path:"teams",element:I.jsx(lb,{})},{path:"incidents/view",element:I.jsx(Wx,{})},{path:"incidents/view/:id",element:I.jsx(gp,{})},{path:"incidents/map",element:I.jsx(Ob,{})},{path:"evacuation/centers",element:I.jsx(Op,{})},{path:"evacuation/routes",element:I.jsx(Vp,{})},{path:"evacuation/resources",element:I.jsx(sb,{})},{path:"safety-protocols",element:I.jsx(rb,{})},{path:"activity-logs",element:I.jsx(nb,{})},{path:"welfare",element:I.jsx(ub,{})},{path:"feedback",element:I.jsx(ob,{})},{path:"reports",element:I.jsx(vp,{})},{path:"profile",element:I.jsx(ib,{})},{path:"",element:I.jsx(Ex,{})}]},{path:"/staff",element:I.jsx(Tb,{}),children:[{path:"",element:I.jsx(mb,{})},{path:"dashboard",element:I.jsx(mb,{})},{path:"incidents",element:I.jsx(hb,{})},{path:"incidents/map",element:I.jsx(Pb,{})},{path:"incidents/:id",element:I.jsx(Lb,{})},{path:"feedback",element:I.jsx($o,{})},{path:"profile",element:I.jsx(Eb,{})}]},{path:"*",element:I.jsx(R,{})}];let Rb;function Db(){const e=m(Fb),t=a();return window.REACT_APP_NAVIGATE=t,Rb(t),e}function Mb(){return I.jsx(_t,{children:I.jsx(h,{basename:"/",future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:I.jsx(Db,{})})})}new Promise(e=>{Rb=e}),F.createRoot(document.getElementById("root")).render(I.jsx(n.StrictMode,{children:I.jsx(Mb,{})}));export{td as _};
